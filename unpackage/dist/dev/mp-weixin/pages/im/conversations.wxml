<scroll-view class="conversations" scroll-y="true"><block wx:if="{{$root.g0>0}}"><view><block wx:for="{{$root.l0}}" wx:for-item="conversation" wx:for-index="key" wx:key="key"><view class="scroll-item"><view class="item-head"><image class="head-icon" src="{{conversation.$orig.data.avatar}}"></image><block wx:if="{{conversation.$orig.unread}}"><view class="item-head_unread">{{conversation.$orig.unread}}</view></block></view><view data-event-opts="{{[['tap',[['chat',['$0'],[[['conversations','',key]]]]]]]}}" class="scroll-item_info" bindtap="__e"><view class="item-info-top"><text class="item-info-top_name">{{conversation.$orig.data.name}}</text><view class="item-info-top_time">{{conversation.m0}}</view></view><view class="item-info-bottom"><view class="item-info-bottom-item"><block wx:if="{{!conversation.$orig.lastMessage.recalled}}"><view class="item-info-top_content"><text class="unread-text">{{''+(conversation.$orig.lastMessage.read===false&&conversation.$orig.lastMessage.senderId===currentUser.id?'[未读]':'')+''}}</text><block wx:if="{{conversation.$orig.lastMessage.senderId===currentUser.id}}"><text>我:</text></block><block wx:else><text>{{(conversation.$orig.type==='group'?conversation.$orig.lastMessage.senderData.name:conversation.$orig.data.name)+':'}}</text></block><block wx:if="{{conversation.$orig.lastMessage.type==='text'}}"><text>{{conversation.$orig.lastMessage.payload.text}}</text></block><block wx:else><block wx:if="{{conversation.$orig.lastMessage.type==='video'}}"><text>[视频消息]</text></block><block wx:else><block wx:if="{{conversation.$orig.lastMessage.type==='audio'}}"><text>[语音消息]</text></block><block wx:else><block wx:if="{{conversation.$orig.lastMessage.type==='image'}}"><text>[图片消息]</text></block><block wx:else><block wx:if="{{conversation.$orig.lastMessage.type==='file'}}"><text>[文件消息]</text></block><block wx:else><block wx:if="{{conversation.$orig.lastMessage.type==='order'}}"><text>[自定义消息:订单]</text></block><block wx:else><text>[[未识别内容]]</text></block></block></block></block></block></block></view></block><block wx:else><view class="item-info-top_content"><text>{{''+(conversation.$orig.lastMessage.recaller.id===currentUser.id?'你':conversation.$orig.lastMessage.recaller.data.name)+'撤回了一条消息'}}</text></view></block><view data-event-opts="{{[['tap',[['showAction',['$0'],[[['conversations','',key]]]]]]]}}" class="item-info-bottom_action" catchtap="__e"></view></view></view></view></view></block></view></block><block wx:else><view class="no-conversation"><text>当前没有消息</text></view></block><block wx:if="{{actionPopup.visible}}"><view class="action-container"><view data-event-opts="{{[['tap',[['e0',['$event']]]]]}}" class="layer" bindtap="__e"></view><view class="action-box"><view data-event-opts="{{[['tap',[['topConversation',['$event']]]]]}}" class="action-item" bindtap="__e">{{''+(actionPopup.conversation.top?'取消置顶':'置顶聊天')+''}}</view><view data-event-opts="{{[['tap',[['deleteConversation',['$event']]]]]}}" class="action-item" bindtap="__e">删除聊天</view></view></view></block></scroll-view>