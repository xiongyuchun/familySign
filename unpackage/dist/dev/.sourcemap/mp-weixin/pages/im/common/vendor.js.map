{"version":3,"sources":["uni-app:///lib/EmojiDecoder.js","uni-app:///lib/restapi.js","uni-app:///lib/RecorderManager.js"],"names":["EmojiDecoder","url","emojiMap","i","hasOwnProperty","patterns","push","replace","metaChars","text","RegExp","join","match","RestApi","id","name","password","avatar","email","phone","userList","price","count","users","user","filter","v","groups","find","username","orders","groupId","group","userId","members","includes","RecorderManager","recorder","uni","getRecorderManager","callBack","onRecordingComplete","initUniRecorder","onStop","res","duration","Date","now","uniStartTime","onError","e","recording","stop","console","log","Promise","resolve","reject","authorize","scope","success","fail","start"],"mappings":"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","file":"pages/im/common/vendor.js","sourcesContent":["class EmojiDecoder {\r\n    emojiMap = null;\r\n    url = \"\";\r\n    patterns = [];\r\n    metaChars = /[[\\]{}()*+?.\\\\|^$\\-,&#\\s]/g;\r\n\r\n    constructor(url,emojiMap) {\r\n        this.url = url || '';\r\n        this.emojiMap = emojiMap || {};\r\n        for (let i in this.emojiMap) {\r\n            if (this.emojiMap.hasOwnProperty(i)){\r\n                this.patterns.push('('+i.replace(this.metaChars, \"\\\\$&\")+')');\r\n            }\r\n        }\r\n    }\r\n\r\n    decode (text) {\r\n        return text.replace(new RegExp(this.patterns.join('|'),'g'),  (match) => {\r\n            return typeof this.emojiMap[match] != 'undefined' ? '<img height=\"20rpx\" width=\"20rpx\" src=\"'+this.url+this.emojiMap[match]+'\" />' : match;\r\n        });\r\n    }\r\n}\r\n\r\nexport default EmojiDecoder","class RestApi {\r\n    //用户数据示例\r\n    users = [\r\n        {\r\n            id: '08c0a6ec-a42b-47b2-bb1e-15e0f5f9a19a',\r\n            name: 'Mattie',\r\n            password: '123',\r\n            avatar: '/static/images/Avatar-1.png',\r\n            email: 'Mattie@goeasy.io',\r\n            phone: '138xxxxxxxx',\r\n        },\r\n        {\r\n            id: '3bb179af-bcc5-4fe0-9dac-c05688484649',\r\n            name: 'Wallace',\r\n            password: '123',\r\n            avatar: '/static/images/Avatar-2.png',\r\n            email: 'Wallace@goeasy.io',\r\n            phone: '138xxxxxxxx',\r\n        },\r\n        {\r\n            id: 'fdee46b0-4b01-4590-bdba-6586d7617f95',\r\n            name: 'Tracy',\r\n            password: '123',\r\n            avatar: '/static/images/Avatar-3.png',\r\n            email: 'Tracy@goeasy.io',\r\n            phone: '138xxxxxxxx',\r\n        },\r\n        {\r\n            id: '33c3693b-dbb0-4bc9-99c6-fa77b9eb763f',\r\n            name: 'Juanita',\r\n            password: '123',\r\n            avatar: '/static/images/Avatar-4.png',\r\n            email: 'Juanita@goeasy.io',\r\n            phone: '138xxxxxxxx',\r\n        },\r\n\t\t{\r\n\t\t    id: 'lwm007',\r\n\t\t    name: 'Simon',\r\n\t\t    password: '123',\r\n\t\t    avatar: 'https://img1.baidu.com/it/u=2881900602,1595911074&fm=253&app=138&size=w931&n=0&f=JPEG&fmt=auto?sec=1716483600&t=7cda88b22eee9444e9478d3e368a0984',\r\n\t\t    email: 'Juanita@goeasy.io',\r\n\t\t    phone: '136xxxxxxxx',\r\n\t\t},\r\n    ];\r\n    //群数据示例\r\n    groups = [\r\n        {\r\n            id: 'group-a42b-47b2-bb1e-15e0f5f9a19a',\r\n            name: '小程序交流群',\r\n            avatar: '/static/images/wx.png',\r\n            userList: [\r\n                '08c0a6ec-a42b-47b2-bb1e-15e0f5f9a19a',\r\n                '3bb179af-bcc5-4fe0-9dac-c05688484649',\r\n                'fdee46b0-4b01-4590-bdba-6586d7617f95',\r\n                '33c3693b-dbb0-4bc9-99c6-fa77b9eb763f',\r\n            ],\r\n        },\r\n        {\r\n            id: 'group-4b01-4590-bdba-6586d7617f95',\r\n            name: 'UniApp交流群',\r\n            avatar: '/static/images/uniapp.png',\r\n            userList: [\r\n                '08c0a6ec-a42b-47b2-bb1e-15e0f5f9a19a',\r\n                'fdee46b0-4b01-4590-bdba-6586d7617f95',\r\n                '33c3693b-dbb0-4bc9-99c6-fa77b9eb763f',\r\n            ],\r\n        },\r\n        {\r\n            id: 'group-dbb0-4bc9-99c6-fa77b9eb763f',\r\n            name: 'GoEasy交流群',\r\n            avatar: '/static/images/goeasy.jpeg',\r\n            userList: ['08c0a6ec-a42b-47b2-bb1e-15e0f5f9a19a', '3bb179af-bcc5-4fe0-9dac-c05688484649'],\r\n        },\r\n    ];\r\n    // 订单\r\n    orders = [\r\n        {\r\n            id: '252364104325',\r\n            url: '/static/images/goods1-1.jpg',\r\n            name: '青桔柠檬气泡美式',\r\n            price: '￥23',\r\n            count: 1\r\n        },\r\n        {\r\n            id: '251662058022',\r\n            url: '/static/images/goods1-2.jpg',\r\n            name: '咸柠七',\r\n            price: '￥8',\r\n            count: 2\r\n        },\r\n        {\r\n            id: '250676186141',\r\n            url: '/static/images/goods1-3.jpg',\r\n            name: '黑糖波波鲜奶茶',\r\n            price: '￥12',\r\n            count: 1\r\n        }\r\n    ];\r\n\r\n    findUsers() {\r\n        return this.users;\r\n    };\r\n\r\n    findFriends(user) {\r\n        return this.users.filter((v) => v.id !== user.id);\r\n    }\r\n\r\n    findGroups(user) {\r\n        return this.groups.filter((v) => v.userList.find((id) => id === user.id));\r\n    }\r\n\r\n    findUser(username, password) {\r\n        return this.users.find((user) => user.name === username && user.password === password);\r\n    }\r\n\r\n    getOrderList() {\r\n        return this.orders;\r\n    }\r\n\r\n    findGroupById(groupId) {\r\n        return this.groups.find((group) => group.id === groupId);\r\n    }\r\n\r\n    findUserById(userId) {\r\n        return this.users.find((user) => user.id === userId);\r\n    }\r\n\r\n    findGroupMembers (groupId) {\r\n        let members = [];\r\n        let group = this.groups.find(v => v.id === groupId);\r\n        if (group) {\r\n            members = this.users.filter(user => group.userList.includes(user.id));\r\n        }\r\n        return members;\r\n    }\r\n}\r\n\r\nexport default new RestApi();\r\n","\r\n\r\n\r\n\r\nexport default class RecorderManager {\r\n    recorder = null;\r\n    //录音开始时间\r\n    uniStartTime = null;\r\n    //语音录音中\r\n    recording = false;\r\n    onRecordingComplete = null;\r\n\r\n    constructor() {\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n        this.recorder = uni.getRecorderManager();\r\n\r\n    }\r\n    \r\n    onRecordComplete(callBack) {\r\n      this.onRecordingComplete = callBack;\r\n\r\n      this.initUniRecorder();\r\n\r\n    }\r\n\r\n    initUniRecorder() {\r\n        //录音结束后，发送\r\n        this.recorder.onStop((res) => {\r\n            const duration = Date.now() - this.uniStartTime;\r\n            res.duration = duration;\r\n            this.onRecordingComplete(res, duration);\r\n        });\r\n        // 监听录音报错\r\n        this.recorder.onError((e) => {\r\n            this.recording = false;\r\n            this.recorder.stop();\r\n            console.log('录音失败：', e);\r\n        })\r\n    }\r\n\r\n    authorize() {\r\n        return new Promise((resolve,reject) => {\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n            if (uni.authorize) {\r\n                uni.authorize({\r\n                    scope: 'scope.record',\r\n                    success() {\r\n                        resolve()\r\n                    },\r\n                    fail: (e) => {\r\n                        reject(e)\r\n                    }\r\n                });\r\n            }\r\n\r\n        });\r\n    }\r\n\r\n    start() {\r\n        this.recording = true;\r\n\r\n\r\n\r\n\r\n\r\n\r\n        try {\r\n            // 更多配置参考uniapp：https://uniapp.dcloud.net.cn/api/media/record-manager.html#getrecordermanager\r\n            this.recorder.start({\r\n                duration: 600000 // 指定录音的时长,单位 ms\r\n            });\r\n            this.uniStartTime = Date.now();\r\n        } catch (e) {\r\n            console.log(e);\r\n        }\r\n\r\n    }\r\n\r\n    stop() {\r\n        this.recording = false;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n        try {\r\n            this.recorder.stop();\r\n        } catch (e) {\r\n            console.log(e);\r\n        }\r\n\r\n    }\r\n\r\n}\r\n"],"sourceRoot":""}