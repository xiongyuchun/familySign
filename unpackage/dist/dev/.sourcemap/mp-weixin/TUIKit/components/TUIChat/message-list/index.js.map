{"version":3,"sources":["webpack:///D:/sign/familySign/TUIKit/components/TUIChat/message-list/index.vue?9ef0","webpack:///D:/sign/familySign/TUIKit/components/TUIChat/message-list/index.vue?f7c8","webpack:///D:/sign/familySign/TUIKit/components/TUIChat/message-list/index.vue?ef87","webpack:///D:/sign/familySign/TUIKit/components/TUIChat/message-list/index.vue?05ef","uni-app:///TUIKit/components/TUIChat/message-list/index.vue?vue&type=script&lang=ts&"],"names":["__sfc_main","props","groupID","type","String","default","isGroup","Boolean","setup","__props","__ctx","observer","groupType","sentReceiptMessageID","Set","thisInstance","proxy","messageListRef","title","messageList","isCompleted","currentConversationID","nextReqMessageID","toggleID","scrollTop","TYPES","TUIChatEngine","listRef","isLoadMessage","isLongpressing","blinkMessageIDList","readStatusMessage","isShowReadUserStatusPanel","groupApplicationCount","showGroupApplication","applicationUserIDList","reSendDialogShow","resendMessageData","emits","emit","showImagePreview","currentImagePreview","imageMessageList","value","filter","item","isRevoked","hasRiskContent","MSG_IMAGE","scrollToBottom","timer","setTimeout","clearTimeout","onCurrentConversationIDUpdated","conversationID","TUIGroupService","getGroupApplicationList","then","res","applicationList","data","application","map","applicationType","applicant","userID","TUIStore","update","StoreName","CUSTOM","length","getConversationModel","groupProfile","onGroupSystemNoticeList","list","systemNoticeList","operationType","message","payload","to","forEach","systemNotice","operatorID","includes","push","inviteeList","invitee","applicationCount","watch","CHAT","onMessageListUpdated","onChatCompletedUpdated","CONV","GRP","groupSystemNoticeList","onGroupApplicationCountUpdated","instanceMapping","set","unwatch","disconnect","isDeleted","vueForRenderKey","ID","bindIntersectionObserver","flag","count","getHistoryMessageList","TUIChatService","getMessageList","toggleApplicationList","handleGroupApplication","index","indexOf","splice","openComplaintLink","handleToggleMessageItem","e","isLongpress","handleH5LongPress","isH5","longPressHandler","touchStartHandler","touchEndHandler","handleEdit","resendMessage","handleImagePreview","onImagePreviewerClose","resendMessageConfirm","messageModel","blinkMessage","messageID","Promise","resolve","scrollTo","scrollHeight","scrollToLatestMessage","height","GRP_AVCHATROOM","GRP_COMMUNITY","uni","createIntersectionObserver","threshold","observeAll","relativeTo","top","observe","has","id","matchingMessage","find","needReadReceipt","flow","readReceiptInfo","isPeerRead","sendMessageReadReceipt","add","setReadReciptPanelVisible","visible","undefined","TUITranslateService","Link","isPluginMessage","isCreateGroupCustomMessage","isPC","components","Object","assign","MessageTimestamp","MessageTip","MessageBubble","MessageText","ProgressMessage","MessageImage","MessageVideo","MessageAudio","MessageFile","MessageFace","MessageLocation","MessageCustom","MessagePlugin","MessageRevoked","MessageTool","Dialog","ImagePreviewer","MessageGroupSystem","ReadReciptPanel"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA8H;AAC9H;AACyD;AACL;AAC6C;;;AAGjG;AACqM;AACrM,gBAAgB,8MAAU;AAC1B,EAAE,2EAAM;AACR,EAAE,4FAAM;AACR,EAAE,qGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,gGAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACzHA;AAAA;AAAA;AAAA;AAA49B,CAAgB,29BAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;AC6Lh/B;AACA;AACA;AAkBA;AAGA;AACA;AAEA;AAAgD;AAAA;AAAA;EAAA;IAAA;EAAA;AAAA;AAAA;EAAA;IAAA;EAAA;AAAA;AAAA;EAAA;IAAA;EAAA;AAAA;AAAA;EAAA;IAAA;EAAA;AAAA;AAAA;EAAA;IAAA;EAAA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","file":"TUIKit/components/TUIChat/message-list/index.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./index.vue?vue&type=template&id=405c635c&scoped=true&\"\nvar renderjs\nimport script from \"./index.vue?vue&type=script&lang=ts&\"\nexport * from \"./index.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./style/index.scss?vue&type=style&index=0&id=405c635c&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!E:\\\\HBuilderX.2.7.14.20200618.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"405c635c\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"TUIKit/components/TUIChat/message-list/index.vue\"\nexport default component.exports","export * from \"-!E:\\\\HBuilderX.2.7.14.20200618.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!E:\\\\HBuilderX.2.7.14.20200618.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--17-0!E:\\\\HBuilderX.2.7.14.20200618.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!E:\\\\HBuilderX.2.7.14.20200618.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!E:\\\\HBuilderX.2.7.14.20200618.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\HBuilderX.2.7.14.20200618.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!../../../../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue2-script-setup!./index.vue?vue&type=template&id=405c635c&scoped=true&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var g0 = _vm.TUITranslateService.t(\n    \"TUIChat.【安全提示】本 APP 仅用于体验腾讯云即时通信 IM 产品功能，不可用于业务洽谈与拓展。请勿轻信汇款、中奖等涉及钱款的信息，勿轻易拨打陌生电话，谨防上当受骗。\"\n  )\n  var g1 = _vm.TUITranslateService.t(\"TUIChat.点此投诉\")\n  var g2 =\n    _vm.isGroup && _vm.groupApplicationCount > 0\n      ? _vm.TUITranslateService.t(\"TUIChat.条入群申请\")\n      : null\n  var g3 =\n    _vm.isGroup && _vm.groupApplicationCount > 0\n      ? _vm.TUITranslateService.t(\"TUIChat.点击处理\")\n      : null\n  var g4 = !_vm.isCompleted\n    ? _vm.TUITranslateService.t(\"TUIChat.查看更多\")\n    : null\n  var l0 = _vm.__map(_vm.messageList, function (item, index) {\n    var $orig = _vm.__get_orig(item)\n    var m0 =\n      item.type === _vm.TYPES.MSG_GRP_TIP ||\n      _vm.isCreateGroupCustomMessage(item)\n    var g5 = m0 ? item.getMessageContent() : null\n    var m1 = !m0 ? !item.isRevoked && !_vm.isPluginMessage(item) : null\n    var g6 = !m0 && m1 ? item.getMessageContent() : null\n    var g7 =\n      !m0 && m1 && item.type === _vm.TYPES.MSG_TEXT\n        ? item.getMessageContent()\n        : null\n    var g8 =\n      !m0 && m1 && item.type === _vm.TYPES.MSG_IMAGE\n        ? item.getMessageContent()\n        : null\n    var g9 =\n      !m0 && m1 && item.type === _vm.TYPES.MSG_IMAGE\n        ? item.getMessageContent()\n        : null\n    var g10 =\n      !m0 && m1 && item.type === _vm.TYPES.MSG_VIDEO\n        ? item.getMessageContent()\n        : null\n    var g11 =\n      !m0 && m1 && item.type === _vm.TYPES.MSG_VIDEO\n        ? item.getMessageContent()\n        : null\n    var g12 =\n      !m0 && m1 && item.type === _vm.TYPES.MSG_AUDIO\n        ? item.getMessageContent()\n        : null\n    var g13 =\n      !m0 && m1 && item.type === _vm.TYPES.MSG_FILE\n        ? item.getMessageContent()\n        : null\n    var g14 =\n      !m0 && m1 && item.type === _vm.TYPES.MSG_FACE\n        ? item.getMessageContent()\n        : null\n    var g15 =\n      !m0 && m1 && item.type === _vm.TYPES.MSG_LOCATION\n        ? item.getMessageContent()\n        : null\n    var g16 =\n      !m0 && m1 && item.type === _vm.TYPES.MSG_CUSTOM\n        ? item.getMessageContent()\n        : null\n    var m2 = !m0 && !m1 ? !item.isRevoked && _vm.isPluginMessage(item) : null\n    return {\n      $orig: $orig,\n      m0: m0,\n      g5: g5,\n      m1: m1,\n      g6: g6,\n      g7: g7,\n      g8: g8,\n      g9: g9,\n      g10: g10,\n      g11: g11,\n      g12: g12,\n      g13: g13,\n      g14: g14,\n      g15: g15,\n      g16: g16,\n      m2: m2,\n    }\n  })\n  var g17 = _vm.reSendDialogShow\n    ? _vm.TUITranslateService.t(\"TUIChat.确认重发该消息？\")\n    : null\n  var g18 = _vm.isShowReadUserStatusPanel\n    ? Object.assign({}, _vm.readStatusMessage)\n    : null\n  if (!_vm._isMounted) {\n    _vm.e0 = function ($event) {\n      $event.stopPropagation()\n      _vm.toggleID = \"\"\n    }\n    _vm.e1 = function (e) {\n      return (_vm.reSendDialogShow = e)\n    }\n  }\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        g0: g0,\n        g1: g1,\n        g2: g2,\n        g3: g3,\n        g4: g4,\n        l0: l0,\n        g17: g17,\n        g18: g18,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!E:\\\\HBuilderX.2.7.14.20200618.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!E:\\\\HBuilderX.2.7.14.20200618.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\ts-loader\\\\index.js??ref--14-1!E:\\\\HBuilderX.2.7.14.20200618.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--14-2!E:\\\\HBuilderX.2.7.14.20200618.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!E:\\\\HBuilderX.2.7.14.20200618.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\HBuilderX.2.7.14.20200618.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!../../../../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue2-script-setup!./index.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!E:\\\\HBuilderX.2.7.14.20200618.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!E:\\\\HBuilderX.2.7.14.20200618.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\ts-loader\\\\index.js??ref--14-1!E:\\\\HBuilderX.2.7.14.20200618.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--14-2!E:\\\\HBuilderX.2.7.14.20200618.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!E:\\\\HBuilderX.2.7.14.20200618.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\HBuilderX.2.7.14.20200618.full\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!../../../../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue2-script-setup!./index.vue?vue&type=script&lang=ts&\"","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { ref, computed, nextTick, onMounted, onUnmounted, getCurrentInstance } from \"../../../adapter-vue\";\nimport TUIChatEngine, { IMessageModel, TUIStore, StoreName, TUITranslateService, TUIChatService, TUIGroupService } from \"@tencentcloud/chat-uikit-engine\";\nimport Link from \"./link\";\nimport MessageText from \"./message-elements/message-text.vue\";\nimport ProgressMessage from \"../../common/ProgressMessage/index.vue\";\nimport MessageImage from \"./message-elements/message-image.vue\";\nimport MessageAudio from \"./message-elements/message-audio.vue\";\nimport MessageFile from \"./message-elements/message-file.vue\";\nimport MessageFace from \"./message-elements/message-face.vue\";\nimport MessageCustom from \"./message-elements/message-custom.vue\";\nimport MessageTip from \"./message-elements/message-tip.vue\";\nimport MessageBubble from \"./message-elements/message-bubble.vue\";\nimport MessageLocation from \"./message-elements/message-location.vue\";\nimport MessageTimestamp from \"./message-elements/message-timestamp.vue\";\nimport MessageVideo from \"./message-elements/message-video.vue\";\nimport MessageTool from \"./message-tool/index.vue\";\nimport MessageRevoked from \"./message-tool/message-revoked.vue\";\nimport MessageGroupSystem from \"./message-elements/message-group-system.vue\";\nimport MessagePlugin from \"../../../plugins/plugin-components/message-plugin.vue\";\nimport ReadReciptPanel from \"./read-receipt-panel/index.vue\";\nimport { isPluginMessage } from \"../../../plugins/plugin-components/index\";\nimport Dialog from \"../../common/Dialog/index.vue\";\nimport ImagePreviewer from \"../../common/ImagePreviewer/index.vue\";\nimport { isCreateGroupCustomMessage } from \"../utils/utils\";\nimport { getBoundingClientRect, getScrollInfo, instanceMapping } from \"../../../utils/universal-api/domOperation\";\nimport { isEnabledMessageReadReceiptGlobal } from \"../utils/utils\";\nimport { isPC, isH5 } from \"../../../utils/env\";\nconst __sfc_main = {};\n__sfc_main.props = {\n  groupID: {\n    type: String,\n    default: \"\"\n  },\n  isGroup: {\n    type: Boolean,\n    default: false\n  }\n};\n__sfc_main.setup = (__props, __ctx) => {\n  const props = __props;\n  let observer: any = null;\n  let groupType: string | undefined;\n  const sentReceiptMessageID = new Set<string>();\n  const thisInstance = getCurrentInstance()?.proxy || getCurrentInstance();\n  const messageListRef = ref();\n  const title = ref(\"TUIChat\");\n  const messageList = ref();\n  const isCompleted = ref(false);\n  const currentConversationID = ref(\"\");\n  const nextReqMessageID = ref();\n  const toggleID = ref(\"\");\n  const scrollTop = ref(5000); // 首次是 15 条消息，最大消息高度为300\n  const TYPES = ref(TUIChatEngine.TYPES);\n  const listRef = ref();\n  const isLoadMessage = ref(false);\n  const isLongpressing = ref(false);\n  const blinkMessageIDList = ref<string[]>([]);\n  // 阅读回执状态message\n  const readStatusMessage = ref<IMessageModel>();\n  const isShowReadUserStatusPanel = ref<boolean>(false);\n\n  // 加群申请系统消息\n  const groupApplicationCount = ref(0);\n  const showGroupApplication = ref(false);\n  const applicationUserIDList = ref([]);\n\n  // 消息重发 Dialog\n  const reSendDialogShow = ref(false);\n  const resendMessageData = ref();\n  const emits = __ctx.emit;\n\n  // 图片预览相关\n  const showImagePreview = ref(false);\n  const currentImagePreview = ref<IMessageModel>();\n  const imageMessageList = computed(() => messageList?.value?.filter((item: IMessageModel) => {\n    return !item.isRevoked && !item.hasRiskContent && item.type === TYPES.value.MSG_IMAGE;\n  }));\n\n  // 消息滑动到底部，建议搭配 nextTick 使用\n  const scrollToBottom = () => {\n    // 文本消息高度：60, 最大消息高度 280\n    scrollTop.value += 300;\n    // 解决 uniapp 打包到 app 首次进入滑动到底部，300 可设置\n    const timer = setTimeout(() => {\n      scrollTop.value += 1;\n      clearTimeout(timer);\n    }, 300);\n  };\n\n  // 监听回调函数\n  const onCurrentConversationIDUpdated = (conversationID: string) => {\n    currentConversationID.value = conversationID;\n    TUIGroupService.getGroupApplicationList().then((res: any) => {\n      const applicationList = res.data.applicationList.filter((application: any) => application.groupID === props.groupID);\n      applicationUserIDList.value = applicationList.map((application: any) => {\n        return application.applicationType === 0 ? application.applicant : application.userID;\n      });\n      TUIStore.update(StoreName.CUSTOM, \"groupApplicationCount\", applicationList.length);\n    });\n\n    // 开启已读回执的状态 群聊缓存群类型\n    if (isEnabledMessageReadReceiptGlobal()) {\n      const {\n        groupProfile\n      } = TUIStore.getConversationModel(conversationID) || {};\n      groupType = groupProfile?.type;\n    }\n  };\n\n  // operationType 操作类型 1: 有用户申请加群   23: 普通群成员邀请用户进群\n  const onGroupSystemNoticeList = (list: Array<IMessageModel>) => {\n    const systemNoticeList = list.filter(message => {\n      const {\n        operationType\n      } = message.payload;\n      return (operationType === 1 || operationType === 23) && message.to === props.groupID;\n    });\n    systemNoticeList.forEach(systemNotice => {\n      const {\n        operationType\n      } = systemNotice.payload;\n      if (operationType === 1) {\n        const {\n          operatorID\n        } = systemNotice.payload;\n        if (!applicationUserIDList.value.includes(operatorID)) {\n          applicationUserIDList.value.push(operatorID);\n        }\n      }\n      if (operationType === 23) {\n        const {\n          inviteeList\n        } = systemNotice.payload;\n        inviteeList.forEach(invitee => {\n          if (!applicationUserIDList.value.includes(invitee)) {\n            applicationUserIDList.value.push(invitee);\n          }\n        });\n      }\n    });\n    const applicationCount = applicationUserIDList.value.length;\n    TUIStore.update(StoreName.CUSTOM, \"groupApplicationCount\", applicationCount);\n  };\n\n  // 消息列表监听\n  TUIStore.watch(StoreName.CHAT, {\n    messageList: onMessageListUpdated,\n    isCompleted: onChatCompletedUpdated\n  });\n  TUIStore.watch(StoreName.CONV, {\n    currentConversationID: onCurrentConversationIDUpdated\n  });\n\n  // 群系统消息\n  TUIStore.watch(StoreName.GRP, {\n    groupSystemNoticeList: onGroupSystemNoticeList\n  });\n\n  // 群系统消息数量\n  TUIStore.watch(StoreName.CUSTOM, {\n    groupApplicationCount: onGroupApplicationCountUpdated\n  });\n  onMounted(() => {\n    instanceMapping.set('messageList', thisInstance);\n  });\n\n  // 取消监听\n  onUnmounted(() => {\n    TUIStore.unwatch(StoreName.CHAT, {\n      messageList: onMessageListUpdated,\n      isCompleted: onChatCompletedUpdated\n    });\n    TUIStore.unwatch(StoreName.CONV, {\n      currentConversationID: onCurrentConversationIDUpdated\n    });\n\n    // 群系统消息\n    TUIStore.unwatch(StoreName.GRP, {\n      groupSystemNoticeList: onGroupSystemNoticeList\n    });\n    TUIStore.unwatch(StoreName.CUSTOM, {\n      groupApplicationCount: onGroupApplicationCountUpdated\n    });\n    observer?.disconnect();\n    observer = null;\n  });\n  function onMessageListUpdated(list: IMessageModel[]) {\n    observer?.disconnect();\n    messageList.value = list.filter(message => !message.isDeleted).map(message => {\n      message.vueForRenderKey = `${message.ID}`;\n      return message;\n    });\n    // 点击加载更多的消息不需要滑动到底部\n    if (!isLoadMessage.value) {\n      scrollToBottom();\n    }\n    if (isEnabledMessageReadReceiptGlobal()) {\n      nextTick(() => bindIntersectionObserver());\n    }\n  }\n  function onChatCompletedUpdated(flag: boolean) {\n    isCompleted.value = flag;\n  }\n  function onGroupApplicationCountUpdated(count: number) {\n    groupApplicationCount.value = count;\n  }\n\n  // 获取历史消息\n  const getHistoryMessageList = () => {\n    isLoadMessage.value = true;\n    TUIChatService.getMessageList().then((res: any) => {\n      const {\n        nextReqMessageID: ID\n      } = res.data;\n      nextReqMessageID.value = ID;\n      isLoadMessage.value = false;\n    });\n  };\n  const toggleApplicationList = () => {\n    showGroupApplication.value = !showGroupApplication.value;\n  };\n  const handleGroupApplication = (userID: string) => {\n    const index = applicationUserIDList.value.indexOf(userID);\n    if (index !== -1) {\n      applicationUserIDList.value.splice(index, 1);\n    }\n  };\n  // todo: webview 跳转\n  const openComplaintLink = (type: any) => {};\n\n  // 消息操作\n  const handleToggleMessageItem = (e: any, message: IMessageModel, index: number, isLongpress = false) => {\n    if (isLongpress) {\n      isLongpressing.value = true;\n    }\n    toggleID.value = message.ID;\n  };\n\n  // h5 long press\n  let timer: number;\n  const handleH5LongPress = (e: any, message: IMessageModel, index: number, type: string) => {\n    if (!isH5) return;\n    function longPressHandler() {\n      clearTimeout(timer);\n      handleToggleMessageItem(e, message, index, true);\n    }\n    function touchStartHandler() {\n      timer = setTimeout(longPressHandler, 500);\n    }\n    function touchEndHandler() {\n      clearTimeout(timer);\n    }\n    switch (type) {\n      case \"touchstart\":\n        touchStartHandler();\n        break;\n      case \"touchend\":\n        touchEndHandler();\n        setTimeout(() => {\n          isLongpressing.value = false;\n        }, 200);\n        break;\n    }\n  };\n\n  // 消息撤回后，编辑消息\n  const handleEdit = (message: IMessageModel) => {\n    emits(\"handleEditor\", message, \"reedit\");\n  };\n\n  // 重发消息\n  const resendMessage = (message: IMessageModel) => {\n    reSendDialogShow.value = true;\n    resendMessageData.value = message;\n  };\n\n  // 图片预览\n  // 开启图片预览\n  const handleImagePreview = (message: IMessageModel) => {\n    if (showImagePreview.value || currentImagePreview.value || isLongpressing.value) {\n      return;\n    }\n    showImagePreview.value = true;\n    currentImagePreview.value = message;\n  };\n  // 关闭图片预览\n  const onImagePreviewerClose = () => {\n    showImagePreview.value = false;\n    setTimeout(() => {\n      currentImagePreview.value = null;\n    }, 50);\n  };\n  const resendMessageConfirm = () => {\n    reSendDialogShow.value = !reSendDialogShow.value;\n    const messageModel = resendMessageData.value;\n    messageModel.resendMessage();\n  };\n  function blinkMessage(messageID: string): Promise<void> {\n    return new Promise(resolve => {\n      const index = blinkMessageIDList.value.indexOf(messageID);\n      if (index < 0) {\n        blinkMessageIDList.value.push(messageID);\n        const timer = setTimeout(() => {\n          blinkMessageIDList.value.splice(blinkMessageIDList.value.indexOf(messageID), 1);\n          clearTimeout(timer);\n          resolve();\n        }, 3000);\n      }\n    });\n  }\n  function scrollTo(scrollHeight: number) {\n    scrollTop.value = scrollHeight;\n  }\n\n  // 滚动到最新消息\n  async function scrollToLatestMessage() {\n    const {\n      scrollHeight\n    } = await getScrollInfo('#messageScrollList', 'messageList');\n    const {\n      height\n    } = await getBoundingClientRect('#messageScrollList', 'messageList');\n    scrollTop.value = scrollHeight - height;\n  }\n  async function bindIntersectionObserver() {\n    if (messageList.value.length === 0) {\n      return;\n    }\n    if (groupType === TYPES.value.GRP_AVCHATROOM || groupType === TYPES.value.GRP_COMMUNITY) {\n      // 直播群以及社群不进行消息的已读回执监听\n      return;\n    }\n    observer?.disconnect();\n    observer = uni.createIntersectionObserver(thisInstance, {\n      threshold: [0.7],\n      observeAll: true\n      // uni 下会把 safetip 也算进去 需要负 margin 来排除\n    }).relativeTo('#messageScrollList', {\n      top: -70\n    });\n    observer?.observe('.message-li.in .message-bubble-container', (res: any) => {\n      if (sentReceiptMessageID.has(res.id)) {\n        return;\n      }\n      const matchingMessage = messageList.value.find((message: IMessageModel) => {\n        return res.id.indexOf(message.ID) > -1;\n      });\n      if (matchingMessage && matchingMessage.needReadReceipt && matchingMessage.flow === 'in' && !matchingMessage.readReceiptInfo?.isPeerRead) {\n        TUIChatService.sendMessageReadReceipt([matchingMessage]);\n        sentReceiptMessageID.add(res.id);\n      }\n    });\n  }\n  function setReadReciptPanelVisible(visible: boolean, message?: IMessageModel) {\n    if (!visible) {\n      readStatusMessage.value = undefined;\n    } else {\n      readStatusMessage.value = message;\n    }\n    isShowReadUserStatusPanel.value = visible;\n  }\n  return {\n    TUITranslateService,\n    Link,\n    isPluginMessage,\n    isCreateGroupCustomMessage,\n    isPC,\n    messageList,\n    isCompleted,\n    toggleID,\n    scrollTop,\n    TYPES,\n    blinkMessageIDList,\n    readStatusMessage,\n    isShowReadUserStatusPanel,\n    groupApplicationCount,\n    showGroupApplication,\n    reSendDialogShow,\n    showImagePreview,\n    currentImagePreview,\n    imageMessageList,\n    getHistoryMessageList,\n    toggleApplicationList,\n    handleGroupApplication,\n    openComplaintLink,\n    handleToggleMessageItem,\n    handleH5LongPress,\n    handleEdit,\n    resendMessage,\n    handleImagePreview,\n    onImagePreviewerClose,\n    resendMessageConfirm,\n    blinkMessage,\n    scrollTo,\n    setReadReciptPanelVisible\n  };\n};\n__sfc_main.components = Object.assign({\n  MessageTimestamp,\n  MessageTip,\n  MessageBubble,\n  MessageText,\n  ProgressMessage,\n  MessageImage,\n  MessageVideo,\n  MessageAudio,\n  MessageFile,\n  MessageFace,\n  MessageLocation,\n  MessageCustom,\n  MessagePlugin,\n  MessageRevoked,\n  MessageTool,\n  Dialog,\n  ImagePreviewer,\n  MessageGroupSystem,\n  ReadReciptPanel\n}, __sfc_main.components);\nexport default __sfc_main;\n"],"sourceRoot":""}