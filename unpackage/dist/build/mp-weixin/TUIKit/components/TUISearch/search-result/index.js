require('../../../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["TUIKit/components/TUISearch/search-result/index"],{4615:function(e,a,l){"use strict";l.r(a);var o=l("5fd3"),n=l.n(o);for(var r in o)["default"].indexOf(r)<0&&function(e){l.d(a,e,(function(){return o[e]}))}(r);a["default"]=n.a},"5fd3":function(e,a,l){"use strict";var o=l("4ea4");Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var n=o(l("9523")),r=o(l("448a")),t=l("a6ed"),i=l("be0f"),s=o(l("156b")),u=o(l("1515")),v=l("2ab0"),c=l("d94a"),d=l("d31c"),h=l("1e3e"),g={};g.props={searchType:{type:String,default:"global",validator:function(e){return["global","conversation"].includes(e)}}},g.setup=function(e,a){var l,o,g=e,p=(0,v.ref)([]),T=(0,v.ref)(null===(l=i.searchMessageTypeDefault[g.searchType])||void 0===l?void 0:l.value),f=(0,v.ref)(0),S=(0,v.ref)(0),y=(0,v.ref)("and"),m=(0,v.ref)(null===(o=i.searchMessageTypeDefault[g.searchType])||void 0===o?void 0:o.key),I=(0,v.ref)({}),b=(0,v.ref)([]),D=(0,v.ref)(0),M=((0,v.ref)([]),(0,v.ref)([]),(0,v.ref)("")),C=(0,v.ref)(),L=(0,v.ref)([]),U=(0,v.ref)(),R=(0,v.ref)([]),w=(0,v.ref)(!1),_=(0,v.ref)(!1),K=(0,v.ref)(!1),O=(0,v.computed)((function(){return!_.value&&("global"===g.searchType?!(null===p||void 0===p||null===(e=p.value)||void 0===e||!e.length||null!==Object&&void 0!==Object&&null!==(a=Object.keys(I.value))&&void 0!==a&&a.length):null===L||void 0===L||null===(l=L.value)||void 0===l||!l.length);var e,a,l}));t.TUIStore.watch(t.StoreName.CONV,{currentConversationID:function(e){"conversation"===g.searchType&&(M.value=e)}}),t.TUIStore.watch(t.StoreName.CUSTOM,{currentSearchInputValue:function(e){(null===e||void 0===e?void 0:e.searchType)===(null===g||void 0===g?void 0:g.searchType)&&(p.value=null!==e&&void 0!==e&&e.value?e.value.trim().split(/\s+/):[])},currentSearchMessageType:function(e){var a,l,o,n;(null===e||void 0===e?void 0:e.searchType)===(null===g||void 0===g?void 0:g.searchType)&&(m.value=(null===e||void 0===e||null===(a=e.value)||void 0===a?void 0:a.key)||(null===(l=i.searchMessageTypeDefault[g.searchType])||void 0===l?void 0:l.key),T.value=(null===e||void 0===e||null===(o=e.value)||void 0===o?void 0:o.value)||(null===(n=i.searchMessageTypeDefault[g.searchType])||void 0===n?void 0:n.value))},currentSearchMessageTime:function(e){var a,l,o,n;(null===e||void 0===e?void 0:e.searchType)===(null===g||void 0===g?void 0:g.searchType)&&(f.value=null===e||void 0===e||null===(a=e.value)||void 0===a||null===(l=a.value)||void 0===l?void 0:l.timePosition,S.value=null===e||void 0===e||null===(o=e.value)||void 0===o||null===(n=o.value)||void 0===n?void 0:n.timePeriod)}});var k=function(e){var a;(0,c.searchCloudMessages)({keywordList:null!==p&&void 0!==p&&null!==(a=p.value)&&void 0!==a&&a.length?p.value:void 0,messageTypeList:T.value,timePosition:f.value,timePeriod:S.value,conversationID:(null===e||void 0===e?void 0:e.conversationID)||void 0,cursor:(null===e||void 0===e?void 0:e.cursor)||void 0,keywordListMatchType:y.value}).then((function(a){if((0,h.enableSampleTaskStatus)("searchCloudMessage"),null!==e&&void 0!==e&&e.conversationID){var l,o,t,s,u;C.value=null===a||void 0===a?void 0:a.data,null!==e&&void 0!==e&&e.cursor?L.value=[].concat((0,r.default)(L.value),(0,r.default)(null===a||void 0===a||null===(l=a.data)||void 0===l||null===(o=l.searchResultList[0])||void 0===o?void 0:o.messageList)):L.value=null===a||void 0===a||null===(t=a.data)||void 0===t||null===(s=t.searchResultList[0])||void 0===s?void 0:s.messageList,U.value=null===a||void 0===a||null===(u=a.data)||void 0===u?void 0:u.totalCount,"conversation"!==(null===g||void 0===g?void 0:g.searchType)||"fileMessage"!==m.value&&"imageMessage"!==m.value?R.value=[]:R.value=N(L.value)}else{var v,c,d,p;null!==e&&void 0!==e&&e.cursor?b.value=[].concat((0,r.default)(b.value),(0,r.default)(null===a||void 0===a||null===(v=a.data)||void 0===v?void 0:v.searchResultList)):b.value=null===a||void 0===a||null===(c=a.data)||void 0===c?void 0:c.searchResultList,D.value=null===a||void 0===a||null===(d=a.data)||void 0===d?void 0:d.totalCount;var T,f,S="all"===m.value?"allMessage":m.value;if(null!==b&&void 0!==b&&null!==(p=b.value)&&void 0!==p&&p.length&&"contact"!==m.value&&"group"!==m.value)I.value=Object.assign({},I.value,(0,n.default)({},S,{key:S,label:i.searchMessageTypeList[S].label,list:"all"===m.value?null===b||void 0===b||null===(T=b.value)||void 0===T?void 0:T.slice(0,3):null===b||void 0===b?void 0:b.value,cursor:(null===a||void 0===a||null===(f=a.data)||void 0===f?void 0:f.cursor)||null}));else null===I||void 0===I||delete I.value[S]}_.value=!1,K.value=!1}))},P=(0,c.debounce)(k,500),j=function(){I.value={},C.value={},L.value=[],R.value=[]};(0,v.watch)((function(){return[p.value,m.value,f.value,S.value]}),(function(e,a){var l;if(e!==a)if(null!==p&&void 0!==p&&null!==(l=p.value)&&void 0!==l&&l.length||"global"!==(null===g||void 0===g?void 0:g.searchType))if(_.value=!0,"conversation"===g.searchType)j(),k({conversationID:M.value});else{var o,n;if(a&&"all"===a[1]&&e&&"allMessage"===e[1])return(null===I||void 0===I||null===(o=I.value["allMessage"])||void 0===o?void 0:o.list)&&(I.value["allMessage"].list=null===b||void 0===b?void 0:b.value),null===Object||void 0===Object||null===(n=Object.keys(null===I||void 0===I?void 0:I.value))||void 0===n||n.forEach((function(e){"allMessage"!==e&&(null===I||void 0===I||delete I.value[e])})),void(_.value=!1);w.value=!1,j(),P()}else j()}),{immediate:!0});var N=function(e){var a,l=[];if(null===e||void 0===e||!e.length)return l;if(1===(null===e||void 0===e?void 0:e.length))return l.push({date:(0,c.generateSearchResultYMD)(null===(a=e[0])||void 0===a?void 0:a.time),list:e}),l;for(var o="",n="",r=0;r<(null===e||void 0===e?void 0:e.length);r++){var t,i,s;if(n=(0,c.generateSearchResultYMD)(null===(t=e[r])||void 0===t?void 0:t.time),o!==n)l.push({date:n,list:[e[r]]});else null===(i=l[(null===l||void 0===l?void 0:l.length)-1])||void 0===i||null===(s=i.list)||void 0===s||s.push(e[r]);o=n}return l};return{TUITranslateService:t.TUITranslateService,searchMessageTypeList:i.searchMessageTypeList,searchIcon:s.default,enterIcon:u.default,enterConversation:c.enterConversation,isPC:d.isPC,props:g,keywordList:p,currentSearchTabKey:m,searchResult:I,currentSearchConversationID:M,searchConversationResult:C,searchConversationMessageList:L,searchConversationMessageTotalCount:U,searchConversationResultGroupByDate:R,isResultDetailShow:w,isLoading:_,isSearchDetailLoading:K,isSearchDefaultShow:O,getMoreResult:function(e){"all"===m.value?t.TUIStore.update(t.StoreName.CUSTOM,"currentSearchMessageType",{value:i.searchMessageTypeList[e.key],searchType:g.searchType}):k({cursor:null===e||void 0===e?void 0:e.cursor})},getMoreResultInConversation:function(){var e;k({cursor:null===C||void 0===C||null===(e=C.value)||void 0===e?void 0:e.cursor,conversationID:null===M||void 0===M?void 0:M.value})},showResultDetail:function(e,a,l){var o;w.value=e,a&&t.TUIStore.update(t.StoreName.CUSTOM,"currentSearchMessageType",{value:i.searchMessageTypeList[a],searchType:g.searchType}),M.value=null===l||void 0===l||null===(o=l.conversation)||void 0===o?void 0:o.conversationID,U.value=null===l||void 0===l?void 0:l.messageCount,l&&(K.value=!0,P({conversationID:M.value}))},generateListItemClass:function(e){var a;return M.value===(null===e||void 0===e||null===(a=e.conversation)||void 0===a?void 0:a.conversationID)?["list-item","list-item-selected"]:["list-item"]},generateResultItemDisplayType:function(){return"conversation"===g.searchType&&"fileMessage"===m.value?"file":"conversation"===g.searchType&&"imageMessage"===m.value?"image":d.isPC?"bubble":"info"},navigateToChatPosition:function(e){"global"===g.searchType?(t.TUIStore.update(t.StoreName.CUSTOM,"currentSearchingStatus",{isSearching:!1,searchType:g.searchType}),t.TUIConversationService.switchConversation(null===e||void 0===e?void 0:e.conversationID).then((function(){t.TUIStore.update(t.StoreName.CHAT,"messageSource",e)}))):"conversation"===g.searchType&&(t.TUIStore.update(t.StoreName.CUSTOM,"isShowInConversationSearch",!1),t.TUIStore.update(t.StoreName.CHAT,"messageSource",e))},generateVueRenderKey:function(e){return"".concat(m,"-").concat(e)}}},g.components=Object.assign({SearchResultLoading:function(){l.e("TUIKit/components/TUISearch/search-result/search-result-loading/index").then(function(){return resolve(l("bb83"))}.bind(null,l)).catch(l.oe)},SearchResultDefault:function(){Promise.all([l.e("TUIKit/common/vendor"),l.e("TUIKit/components/TUISearch/search-result/search-result-default/index")]).then(function(){return resolve(l("5ab8"))}.bind(null,l)).catch(l.oe)},SearchResultItem:function(){Promise.all([l.e("TUIKit/common/vendor"),l.e("TUIKit/components/TUISearch/search-result/search-result-item/index")]).then(function(){return resolve(l("c9e8"))}.bind(null,l)).catch(l.oe)},Icon:function(){l.e("TUIKit/components/common/Icon").then(function(){return resolve(l("b42b"))}.bind(null,l)).catch(l.oe)}},g.components);var p=g;a.default=p},"8bdf":function(e,a,l){"use strict";l.d(a,"b",(function(){return o})),l.d(a,"c",(function(){return n})),l.d(a,"a",(function(){}));var o=function(){var e=this,a=e.$createElement,l=(e._self._c,e.isLoading||e.isSearchDefaultShow||"conversation"===e.props.searchType||!e.isPC&&e.isResultDetailShow?null:e.__map(e.searchResult,(function(a,l){var o=e.__get_orig(a),n="global"===e.props.searchType?e.TUITranslateService.t("TUISearch."+a.label):null,r=e.__map(a.list,(function(a,l){var o=e.__get_orig(a),n=e.generateListItemClass(a);return{$orig:o,m0:n}})),t="all"===e.currentSearchTabKey||a.cursor?e.TUITranslateService.t("TUISearch.查看更多"):null,i="all"===e.currentSearchTabKey||a.cursor?e.TUITranslateService.t("TUISearch."+a.label):null;return{$orig:o,g0:n,l0:r,g1:t,g2:i}}))),o=e.isLoading||e.isSearchDefaultShow||!e.isResultDetailShow&&"conversation"!==e.props.searchType||e.isSearchDetailLoading||!e.isResultDetailShow||"conversation"===e.props.searchType?null:e.TUITranslateService.t("TUISearch.条与"),n=e.isLoading||e.isSearchDefaultShow||!e.isResultDetailShow&&"conversation"!==e.props.searchType||e.isSearchDetailLoading||!e.isResultDetailShow||"conversation"===e.props.searchType?null:e.TUITranslateService.t("TUISearch.相关的"),r=e.isLoading||e.isSearchDefaultShow||!e.isResultDetailShow&&"conversation"!==e.props.searchType||e.isSearchDetailLoading||!e.isResultDetailShow||"conversation"===e.props.searchType?null:e.TUITranslateService.t("TUISearch."+("allMessage"===e.currentSearchTabKey?"结果":e.searchMessageTypeList[e.currentSearchTabKey].label)),t=e.isLoading||e.isSearchDefaultShow||!e.isResultDetailShow&&"conversation"!==e.props.searchType||e.isSearchDetailLoading||!e.isResultDetailShow||"conversation"===e.props.searchType?null:e.TUITranslateService.t("TUISearch.进入聊天"),i=e.isLoading||e.isSearchDefaultShow||!e.isResultDetailShow&&"conversation"!==e.props.searchType||e.isSearchDetailLoading||!e.searchConversationMessageList||!e.searchConversationMessageList[0]||"global"!==e.props.searchType&&("imageMessage"===e.currentSearchTabKey||"fileMessage"===e.currentSearchTabKey)?null:e.__map(e.searchConversationMessageList,(function(a,l){var o=e.__get_orig(a),n=e.generateVueRenderKey(a.ID),r=a.getMessageContent(),t=e.generateResultItemDisplayType();return{$orig:o,m1:n,g7:r,m2:t}})),s=e.isLoading||e.isSearchDefaultShow||!e.isResultDetailShow&&"conversation"!==e.props.searchType||e.isSearchDetailLoading||!e.searchConversationMessageList||!e.searchConversationMessageList[0]||"global"===e.props.searchType||"imageMessage"!==e.currentSearchTabKey&&"fileMessage"!==e.currentSearchTabKey?null:e.__map(e.searchConversationResultGroupByDate,(function(a,l){var o=e.__get_orig(a),n=e.generateVueRenderKey(a.date),r=e.generateResultItemDisplayType(),t=e.__map(a.list,(function(a,l){var o=e.__get_orig(a),n=e.generateVueRenderKey(a.ID),r=a.getMessageContent();return{$orig:o,m4:n,g8:r}}));return{$orig:o,m3:n,m5:r,l3:t}})),u=!e.isLoading&&!e.isSearchDefaultShow&&(e.isResultDetailShow||"conversation"===e.props.searchType)&&!e.isSearchDetailLoading&&e.searchConversationMessageList&&e.searchConversationMessageList[0]&&e.searchConversationResult&&e.searchConversationResult.cursor?e.TUITranslateService.t("TUISearch.查看更多历史记录"):null;e.$mp.data=Object.assign({},{$root:{l1:l,g3:o,g4:n,g5:r,g6:t,l2:i,l4:s,g9:u}})},n=[]},eef1:function(e,a,l){"use strict";l.r(a);var o=l("8bdf"),n=l("4615");for(var r in n)["default"].indexOf(r)<0&&function(e){l.d(a,e,(function(){return n[e]}))}(r);l("e487");var t=l("f0c5"),i=Object(t["a"])(n["default"],o["b"],o["c"],!1,null,"2991516a",null,!1,o["a"],void 0);a["default"]=i.exports}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'TUIKit/components/TUISearch/search-result/index-create-component',
    {
        'TUIKit/components/TUISearch/search-result/index-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("eef1"))
        })
    },
    [['TUIKit/components/TUISearch/search-result/index-create-component']]
]);
