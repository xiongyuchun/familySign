require('../../../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["TUIKit/components/common/ImagePreviewer/index"],{"269c":function(e,n,t){"use strict";t.d(n,"b",(function(){return o})),t.d(n,"c",(function(){return a})),t.d(n,"a",(function(){}));var o=function(){var e=this,n=e.$createElement,t=(e._self._c,e.imageList.length),o=e.imageList.length,a=e.__map(e.imageList,(function(n,t){var o=e.__get_orig(n),a=e.getImageUrl(n);return{$orig:o,m0:a}})),i=e.isPC&&e.currentImageIndex<e.imageList.length-1,l=e.imageList.length;e.$mp.data=Object.assign({},{$root:{g0:t,g1:o,l0:a,g2:i,g3:l}})},a=[]},"3e7c":function(e,n,t){"use strict";t.r(n);var o=t("a313"),a=t.n(o);for(var i in o)["default"].indexOf(i)<0&&function(e){t.d(n,e,(function(){return o[e]}))}(i);n["default"]=a.a},"6f9d":function(e,n,t){"use strict";t.r(n);var o=t("269c"),a=t("3e7c");for(var i in a)["default"].indexOf(i)<0&&function(e){t.d(n,e,(function(){return a[e]}))}(i);t("8725");var l=t("f0c5"),u=Object(l["a"])(a["default"],o["b"],o["c"],!1,null,"79095723",null,!1,o["a"],void 0);n["default"]=u.exports},8725:function(e,n,t){"use strict";var o=t("a1fd"),a=t.n(o);a.a},a1fd:function(e,n,t){},a313:function(e,n,t){"use strict";var o=t("4ea4");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=t("2ab0"),i=t("a6ed"),l=o(t("3379")),u=o(t("e3ba")),c=o(t("ad76")),r=o(t("317c")),d=o(t("b848")),s=o(t("3a84")),f=o(t("6038")),v=t("9c83"),g=t("d31c"),m=t("8e85"),p={};p.props={imageList:{key:"imageList",required:!1,type:Array,default:function(){return[]}},currentImage:{key:"currentImage",required:!0,type:null}},p.setup=function(e,n){var t=e,o=new Map([[1,"jpg"],[2,"gif"],[3,"png"],[4,"bmp"]]),p=n.emit,h=(0,a.ref)(1),T=(0,a.ref)(0),b=(0,a.ref)(.1),I=(0,a.ref)(0),w=(0,a.ref)(),y=(0,a.ref)(),U=0,L={},Y=!1,R=!1,E=null;(0,a.watchEffect)((function(){I.value=t.imageList.findIndex((function(e){var n;return e.ID===(null===t||void 0===t||null===(n=t.currentImage)||void 0===n?void 0:n.ID)}))}));var P=function(e){return"number"===typeof e&&isFinite(e)},O=function(e){var n;U=null===e||void 0===e||null===(n=e.changedTouches[0])||void 0===n?void 0:n.pageX,Y=!1},S=function(e){var n=null===e||void 0===e?void 0:e.touches[0],t=null===e||void 0===e?void 0:e.touches[1];L.pageX1=null===n||void 0===n?void 0:n.pageX,L.pageY1=null===n||void 0===n?void 0:n.pageY,t&&(L.pageX2=null===t||void 0===t?void 0:t.pageX,L.pageY2=null===t||void 0===t?void 0:t.pageY)},X=function(e){var n=null===e||void 0===e?void 0:e.touches[0],t=null===e||void 0===e?void 0:e.touches[1];t&&(P(L.pageX2)||(L.pageX2=t.pageX),P(L.pageY2)||(L.pageY2=t.pageY));var o=function(e,n,t,o){return Math.hypot(t-e,o-n)};if(P(L.pageX1)&&P(L.pageY1)&&P(L.pageX2)&&P(L.pageY2)){var a=o(n.pageX,n.pageY,t.pageX,t.pageY)/o(L.pageX1,L.pageY1,L.pageX2,L.pageY2);h.value=Math.min(Math.max(.5,h.value*a),4)}};(0,a.onMounted)((function(){var e,n;(null===(e=document)||void 0===e?void 0:e.addEventListener)&&(null===(n=document)||void 0===n||n.addEventListener("keydown",k))}));var k=function(e){e.preventDefault(),27===(null===e||void 0===e?void 0:e.keyCode)&&_()},_=function(){p("close")},A=function(){I.value<t.imageList.length-1&&I.value++,x()},M=function(){I.value>0&&I.value--,x()},x=function(){h.value=1,T.value=0},C=function(e){m.TUIGlobal.showLoading({title:"大图提取中"}),m.TUIGlobal.downloadFile({url:e,success:function(e){m.TUIGlobal.hideLoading(),m.TUIGlobal.saveImageToPhotosAlbum({filePath:e.tempFilePath,success:function(){(0,v.Toast)({message:i.TUITranslateService.t("component.已保存至相册"),type:v.TOAST_TYPE.SUCCESS})}})},fail:function(e){m.TUIGlobal.hideLoading(),(0,v.Toast)({message:i.TUITranslateService.t("component.图片下载失败"),type:v.TOAST_TYPE.ERROR})}})},G=function(e){var n,a={mode:"cors",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded"})},l=t.imageList[I.value],u=null===l||void 0===l||null===(n=l.payload)||void 0===n?void 0:n.imageFormat;if(o.has(u))if(window.fetch)fetch(e,a).then((function(e){return e.blob()})).then((function(e){var n=document.createElement("a"),t=window.URL.createObjectURL(e);n.href=t,n.download=t+"."+o.get(u),n.click()}));else{var c=document.createElement("a");c.href=e,c.target="_blank",c.download=e+"."+o.get(u),c.click()}else(0,v.Toast)({message:i.TUITranslateService.t("component.暂不支持下载此类型图片"),type:v.TOAST_TYPE.ERROR})};return(0,a.onUnmounted)((function(){var e,n;(null===(e=document)||void 0===e?void 0:e.removeEventListener)&&(null===(n=document)||void 0===n||n.removeEventListener("keydown",k))})),{iconClose:l.default,iconArrowLeft:u.default,iconZoomIn:c.default,iconZoomOut:r.default,iconRotateLeft:d.default,iconRotateRight:s.default,iconDownload:f.default,isPC:g.isPC,isMobile:g.isMobile,isUniFrameWork:g.isUniFrameWork,zoom:h,rotate:T,currentImageIndex:I,image:w,ulRef:y,handleTouchStart:function(e){e.preventDefault(),O(e),S(e)},handleTouchMove:function(e){e.preventDefault(),Y=!0,e.touches&&2===e.touches.length&&(R=!0,X(e))},handleTouchEnd:function(e){var n;e.preventDefault(),e.stopPropagation();var t=0,o=0;if(R)E||(R=!1,delete L.pageX2,delete L.pageY2,E=setTimeout((function(){E=null}),200));else if(null===E){switch(Y){case!0:t=null===e||void 0===e||null===(n=e.changedTouches[0])||void 0===n?void 0:n.pageX,o=t-U,o>100?M():o<-100&&A();break;case!1:_();break}E=setTimeout((function(){E=null}),200)}},handleTouchCancel:function(e){R=!1,delete L.pageX1,delete L.pageY1},handleWheel:function(e){if(e.preventDefault(),0===Math.abs(e.deltaX)||0===Math.abs(e.deltaY)){var n=h.value;n+=e.deltaY*(e.ctrlKey?-.01:.002),n=Math.min(Math.max(.125,n),4),h.value=n}},zoomIn:function(){h.value+=.1},zoomOut:function(){h.value=h.value-.1>b.value?h.value-.1:b.value},close:_,rotateLeft:function(){T.value-=90},rotateRight:function(){T.value+=90},goNext:A,goPrev:M,getImageUrl:function(e){var n,t,o,a;return g.isPC?null===e||void 0===e||null===(n=e.payload)||void 0===n||null===(t=n.imageInfoArray[0])||void 0===t?void 0:t.url:null===e||void 0===e||null===(o=e.payload)||void 0===o||null===(a=o.imageInfoArray[2])||void 0===a?void 0:a.url},save:function(){var e,n,o=t.imageList[I.value],a=null===o||void 0===o||null===(e=o.payload)||void 0===e||null===(n=e.imageInfoArray[0])||void 0===n?void 0:n.url;if(a)switch((0,m.getPlatform)()){case"wechat":m.TUIGlobal.getSetting({success:function(e){null!==e&&void 0!==e&&e.authSetting["scope.writePhotosAlbum"]?C(a):m.TUIGlobal.authorize({scope:"scope.writePhotosAlbum",success:function(){C(a)},fail:function(){m.TUIGlobal.showModal({title:"您已拒绝获取相册权限",content:"是否进入权限管理，调整授权？",success:function(e){if(e.confirm)m.TUIGlobal.openSetting({success:function(e){console.log(e.authSetting)}});else if(e.cancel)return(0,v.Toast)({message:i.TUITranslateService.t("component.已取消"),type:v.TOAST_TYPE.ERROR})}})}})},fail:function(){(0,v.Toast)({message:i.TUITranslateService.t("component.获取权限失败"),type:v.TOAST_TYPE.ERROR})}});break;case"app":C(a);break;default:G(a);break}else(0,v.Toast)({message:i.TUITranslateService.t("component.图片 url 不存在"),type:v.TOAST_TYPE.ERROR})}}},p.components=Object.assign({ImageItem:function(){t.e("TUIKit/components/common/ImagePreviewer/image-item").then(function(){return resolve(t("bb66"))}.bind(null,t)).catch(t.oe)},Icon:function(){t.e("TUIKit/components/common/Icon").then(function(){return resolve(t("b42b"))}.bind(null,t)).catch(t.oe)}},p.components);var h=p;n.default=h}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'TUIKit/components/common/ImagePreviewer/index-create-component',
    {
        'TUIKit/components/common/ImagePreviewer/index-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("6f9d"))
        })
    },
    [['TUIKit/components/common/ImagePreviewer/index-create-component']]
]);
