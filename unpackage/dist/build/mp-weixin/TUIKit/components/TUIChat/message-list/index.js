require('../../../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["TUIKit/components/TUIChat/message-list/index"],{"309f":function(e,t,n){"use strict";n.r(t);var o=n("df46"),a=n("561c");for(var s in a)["default"].indexOf(s)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(s);n("1723");var i=n("f0c5"),r=Object(i["a"])(a["default"],o["b"],o["c"],!1,null,"5d969ff5",null,!1,o["a"],void 0);t["default"]=r.exports},"561c":function(e,t,n){"use strict";n.r(t);var o=n("d82e"),a=n.n(o);for(var s in o)["default"].indexOf(s)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(s);t["default"]=a.a},d82e:function(e,t,n){"use strict";(function(e){var o=n("4ea4"),a=n("7037");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=o(n("2eee")),i=o(n("c973")),r=n("2ab0"),u=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!==typeof e)return{default:e};var n=d(t);if(n&&n.has(e))return n.get(e);var o={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var r=s?Object.getOwnPropertyDescriptor(e,i):null;r&&(r.get||r.set)?Object.defineProperty(o,i,r):o[i]=e[i]}o.default=e,n&&n.set(e,o);return o}(n("a6ed")),l=o(n("080d")),c=n("f121"),g=n("6ef6"),f=n("0454"),m=n("d31c");function d(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(d=function(e){return e?n:t})(e)}var p={};p.props={groupID:{type:String,default:""},isGroup:{type:Boolean,default:!1}},p.setup=function(t,n){var o,a,d=t,p=null,v=new Set,T=(null===(o=(0,r.getCurrentInstance)())||void 0===o?void 0:o.proxy)||(0,r.getCurrentInstance)(),I=((0,r.ref)(),(0,r.ref)("TUIChat"),(0,r.ref)()),h=(0,r.ref)(!1),M=(0,r.ref)(""),U=(0,r.ref)(),S=(0,r.ref)(""),C=(0,r.ref)(5e3),b=(0,r.ref)(u.default.TYPES),P=((0,r.ref)(),(0,r.ref)(!1)),y=(0,r.ref)(!1),w=(0,r.ref)([]),O=(0,r.ref)(),G=(0,r.ref)(!1),K=(0,r.ref)(0),R=(0,r.ref)(!1),E=(0,r.ref)([]),_=(0,r.ref)(!1),D=(0,r.ref)(),A=n.emit,L=(0,r.ref)(!1),k=(0,r.ref)(),x=(0,r.computed)((function(){var e;return null===I||void 0===I||null===(e=I.value)||void 0===e?void 0:e.filter((function(e){return!e.isRevoked&&!e.hasRiskContent&&e.type===b.value.MSG_IMAGE}))})),N=function(e){if(M.value=e,u.TUIGroupService.getGroupApplicationList().then((function(e){var t=e.data.applicationList.filter((function(e){return e.groupID===d.groupID}));E.value=t.map((function(e){return 0===e.applicationType?e.applicant:e.userID})),u.TUIStore.update(u.StoreName.CUSTOM,"groupApplicationCount",t.length)})),(0,g.isEnabledMessageReadReceiptGlobal)()){var t=u.TUIStore.getConversationModel(e)||{},n=t.groupProfile;a=null===n||void 0===n?void 0:n.type}},Y=function(e){var t=e.filter((function(e){var t=e.payload.operationType;return(1===t||23===t)&&e.to===d.groupID}));t.forEach((function(e){var t=e.payload.operationType;if(1===t){var n=e.payload.operatorID;E.value.includes(n)||E.value.push(n)}if(23===t){var o=e.payload.inviteeList;o.forEach((function(e){E.value.includes(e)||E.value.push(e)}))}}));var n=E.value.length;u.TUIStore.update(u.StoreName.CUSTOM,"groupApplicationCount",n)};function j(e){var t;null===(t=p)||void 0===t||t.disconnect(),I.value=e.filter((function(e){return!e.isDeleted})).map((function(e){return e.vueForRenderKey="".concat(e.ID),e})),P.value||function(){C.value+=300;var e=setTimeout((function(){C.value+=1,clearTimeout(e)}),300)}(),(0,g.isEnabledMessageReadReceiptGlobal)()&&(0,r.nextTick)((function(){return function(){return W.apply(this,arguments)}()}))}function V(e){h.value=e}function H(e){K.value=e}u.TUIStore.watch(u.StoreName.CHAT,{messageList:j,isCompleted:V}),u.TUIStore.watch(u.StoreName.CONV,{currentConversationID:N}),u.TUIStore.watch(u.StoreName.GRP,{groupSystemNoticeList:Y}),u.TUIStore.watch(u.StoreName.CUSTOM,{groupApplicationCount:H}),(0,r.onMounted)((function(){f.instanceMapping.set("messageList",T)})),(0,r.onUnmounted)((function(){var e;u.TUIStore.unwatch(u.StoreName.CHAT,{messageList:j,isCompleted:V}),u.TUIStore.unwatch(u.StoreName.CONV,{currentConversationID:N}),u.TUIStore.unwatch(u.StoreName.GRP,{groupSystemNoticeList:Y}),u.TUIStore.unwatch(u.StoreName.CUSTOM,{groupApplicationCount:H}),null===(e=p)||void 0===e||e.disconnect(),p=null}));var F,$=function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];o&&(y.value=!0),S.value=t.ID};function W(){return W=(0,i.default)(s.default.mark((function t(){var n,o;return s.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(0!==I.value.length){t.next=2;break}return t.abrupt("return");case 2:if(a!==b.value.GRP_AVCHATROOM&&a!==b.value.GRP_COMMUNITY){t.next=4;break}return t.abrupt("return");case 4:null===(n=p)||void 0===n||n.disconnect(),p=e.createIntersectionObserver(T,{threshold:[.7],observeAll:!0}).relativeTo("#messageScrollList",{top:-70}),null===(o=p)||void 0===o||o.observe(".message-li.in .message-bubble-container",(function(e){var t;if(!v.has(e.id)){var n=I.value.find((function(t){return e.id.indexOf(t.ID)>-1}));!n||!n.needReadReceipt||"in"!==n.flow||null!==(t=n.readReceiptInfo)&&void 0!==t&&t.isPeerRead||(u.TUIChatService.sendMessageReadReceipt([n]),v.add(e.id))}}));case 7:case"end":return t.stop()}}),t)}))),W.apply(this,arguments)}return{TUITranslateService:u.TUITranslateService,Link:l.default,isPluginMessage:c.isPluginMessage,isCreateGroupCustomMessage:g.isCreateGroupCustomMessage,isPC:m.isPC,messageList:I,isCompleted:h,toggleID:S,scrollTop:C,TYPES:b,blinkMessageIDList:w,readStatusMessage:O,isShowReadUserStatusPanel:G,groupApplicationCount:K,showGroupApplication:R,reSendDialogShow:_,showImagePreview:L,currentImagePreview:k,imageMessageList:x,getHistoryMessageList:function(){P.value=!0,u.TUIChatService.getMessageList().then((function(e){var t=e.data.nextReqMessageID;U.value=t,P.value=!1}))},toggleApplicationList:function(){R.value=!R.value},handleGroupApplication:function(e){var t=E.value.indexOf(e);-1!==t&&E.value.splice(t,1)},openComplaintLink:function(e){},handleToggleMessageItem:$,handleH5LongPress:function(e,t,n,o){if(m.isH5)switch(o){case"touchstart":(function(){F=setTimeout(a,500)})();break;case"touchend":(function(){clearTimeout(F)})(),setTimeout((function(){y.value=!1}),200);break}function a(){clearTimeout(F),$(e,t,n,!0)}},handleEdit:function(e){A("handleEditor",e,"reedit")},resendMessage:function(e){_.value=!0,D.value=e},handleImagePreview:function(e){L.value||k.value||y.value||(L.value=!0,k.value=e)},onImagePreviewerClose:function(){L.value=!1,setTimeout((function(){k.value=null}),50)},resendMessageConfirm:function(){_.value=!_.value;var e=D.value;e.resendMessage()},blinkMessage:function(e){return new Promise((function(t){var n=w.value.indexOf(e);if(n<0){w.value.push(e);var o=setTimeout((function(){w.value.splice(w.value.indexOf(e),1),clearTimeout(o),t()}),3e3)}}))},scrollTo:function(e){C.value=e},setReadReciptPanelVisible:function(e,t){O.value=e?t:void 0,G.value=e}}},p.components=Object.assign({MessageTimestamp:function(){n.e("TUIKit/components/TUIChat/message-list/message-elements/message-timestamp").then(function(){return resolve(n("e8ad"))}.bind(null,n)).catch(n.oe)},MessageTip:function(){n.e("TUIKit/components/TUIChat/message-list/message-elements/message-tip").then(function(){return resolve(n("3d62"))}.bind(null,n)).catch(n.oe)},MessageBubble:function(){Promise.all([n.e("TUIKit/common/vendor"),n.e("TUIKit/components/TUIChat/message-list/message-elements/message-bubble")]).then(function(){return resolve(n("9f36"))}.bind(null,n)).catch(n.oe)},MessageText:function(){n.e("TUIKit/components/TUIChat/message-list/message-elements/message-text").then(function(){return resolve(n("782f"))}.bind(null,n)).catch(n.oe)},ProgressMessage:function(){n.e("TUIKit/components/common/ProgressMessage/index").then(function(){return resolve(n("51a0"))}.bind(null,n)).catch(n.oe)},MessageImage:function(){n.e("TUIKit/components/TUIChat/message-list/message-elements/message-image").then(function(){return resolve(n("b151"))}.bind(null,n)).catch(n.oe)},MessageVideo:function(){Promise.all([n.e("TUIKit/common/vendor"),n.e("TUIKit/components/TUIChat/message-list/message-elements/message-video")]).then(function(){return resolve(n("d695"))}.bind(null,n)).catch(n.oe)},MessageAudio:function(){Promise.all([n.e("TUIKit/common/vendor"),n.e("TUIKit/components/TUIChat/message-list/message-elements/message-audio")]).then(function(){return resolve(n("6019"))}.bind(null,n)).catch(n.oe)},MessageFile:function(){Promise.all([n.e("TUIKit/common/vendor"),n.e("TUIKit/components/TUIChat/message-list/message-elements/message-file")]).then(function(){return resolve(n("3840"))}.bind(null,n)).catch(n.oe)},MessageFace:function(){n.e("TUIKit/components/TUIChat/message-list/message-elements/message-face").then(function(){return resolve(n("6c0b"))}.bind(null,n)).catch(n.oe)},MessageLocation:function(){n.e("TUIKit/components/TUIChat/message-list/message-elements/message-location").then(function(){return resolve(n("1eb0"))}.bind(null,n)).catch(n.oe)},MessageCustom:function(){Promise.all([n.e("common/vendor"),n.e("TUIKit/common/vendor"),n.e("TUIKit/components/TUIChat/message-list/message-elements/message-custom")]).then(function(){return resolve(n("4776"))}.bind(null,n)).catch(n.oe)},MessagePlugin:function(){n.e("TUIKit/plugins/plugin-components/message-plugin").then(function(){return resolve(n("d75b"))}.bind(null,n)).catch(n.oe)},MessageRevoked:function(){n.e("TUIKit/components/TUIChat/message-list/message-tool/message-revoked").then(function(){return resolve(n("e2e7"))}.bind(null,n)).catch(n.oe)},MessageTool:function(){Promise.all([n.e("common/vendor"),n.e("TUIKit/common/vendor"),n.e("TUIKit/components/TUIChat/message-list/message-tool/index")]).then(function(){return resolve(n("4e81"))}.bind(null,n)).catch(n.oe)},Dialog:function(){Promise.all([n.e("TUIKit/common/vendor"),n.e("TUIKit/components/common/Dialog/index")]).then(function(){return resolve(n("f0db"))}.bind(null,n)).catch(n.oe)},ImagePreviewer:function(){Promise.all([n.e("TUIKit/common/vendor"),n.e("TUIKit/components/common/ImagePreviewer/index")]).then(function(){return resolve(n("6f9d"))}.bind(null,n)).catch(n.oe)},MessageGroupSystem:function(){n.e("TUIKit/components/TUIChat/message-list/message-elements/message-group-system").then(function(){return resolve(n("a719"))}.bind(null,n)).catch(n.oe)},ReadReciptPanel:function(){Promise.all([n.e("TUIKit/common/vendor"),n.e("TUIKit/components/TUIChat/message-list/read-receipt-panel/index")]).then(function(){return resolve(n("0c36"))}.bind(null,n)).catch(n.oe)}},p.components);var v=p;t.default=v}).call(this,n("543d")["default"])},df46:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){}));var o=function(){var e=this,t=e.$createElement,n=(e._self._c,e.TUITranslateService.t("TUIChat.【安全提示】本 APP 仅用于体验腾讯云即时通信 IM 产品功能，不可用于业务洽谈与拓展。请勿轻信汇款、中奖等涉及钱款的信息，勿轻易拨打陌生电话，谨防上当受骗。")),o=e.TUITranslateService.t("TUIChat.点此投诉"),a=e.isGroup&&e.groupApplicationCount>0?e.TUITranslateService.t("TUIChat.条入群申请"):null,s=e.isGroup&&e.groupApplicationCount>0?e.TUITranslateService.t("TUIChat.点击处理"):null,i=e.isCompleted?null:e.TUITranslateService.t("TUIChat.查看更多"),r=e.__map(e.messageList,(function(t,n){var o=e.__get_orig(t),a=t.type===e.TYPES.MSG_GRP_TIP||e.isCreateGroupCustomMessage(t),s=a?t.getMessageContent():null,i=a?null:!t.isRevoked&&!e.isPluginMessage(t),r=!a&&i?t.getMessageContent():null,u=!a&&i&&t.type===e.TYPES.MSG_TEXT?t.getMessageContent():null,l=!a&&i&&t.type===e.TYPES.MSG_IMAGE?t.getMessageContent():null,c=!a&&i&&t.type===e.TYPES.MSG_IMAGE?t.getMessageContent():null,g=!a&&i&&t.type===e.TYPES.MSG_VIDEO?t.getMessageContent():null,f=!a&&i&&t.type===e.TYPES.MSG_VIDEO?t.getMessageContent():null,m=!a&&i&&t.type===e.TYPES.MSG_AUDIO?t.getMessageContent():null,d=!a&&i&&t.type===e.TYPES.MSG_FILE?t.getMessageContent():null,p=!a&&i&&t.type===e.TYPES.MSG_FACE?t.getMessageContent():null,v=!a&&i&&t.type===e.TYPES.MSG_LOCATION?t.getMessageContent():null,T=!a&&i&&t.type===e.TYPES.MSG_CUSTOM?t.getMessageContent():null,I=a||i?null:!t.isRevoked&&e.isPluginMessage(t);return{$orig:o,m0:a,g5:s,m1:i,g6:r,g7:u,g8:l,g9:c,g10:g,g11:f,g12:m,g13:d,g14:p,g15:v,g16:T,m2:I}})),u=e.reSendDialogShow?e.TUITranslateService.t("TUIChat.确认重发该消息？"):null,l=e.isShowReadUserStatusPanel?Object.assign({},e.readStatusMessage):null;e._isMounted||(e.e0=function(t){t.stopPropagation(),e.toggleID=""},e.e1=function(t){return e.reSendDialogShow=t}),e.$mp.data=Object.assign({},{$root:{g0:n,g1:o,g2:a,g3:s,g4:i,l0:r,g17:u,g18:l}})},a=[]}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'TUIKit/components/TUIChat/message-list/index-create-component',
    {
        'TUIKit/components/TUIChat/message-list/index-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("309f"))
        })
    },
    [['TUIKit/components/TUIChat/message-list/index-create-component']]
]);
