(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["common/vendor"],{"0676":function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports["default"]=e.exports},"0af7":function(e,t,n){"use strict";var r=n("4ea4"),o=n("7037");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n("970b")),a=r(n("5bc3")),s=r(n("9523")),u=v(n("e16a")),c=v(n("a6ed")),l=r(n("13aa")),d=n("f7e4"),f=n("d31c"),p=n("8e85"),h=r(n("4481"));function g(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(g=function(e){return e?n:t})(e)}function v(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==o(e)&&"function"!==typeof e)return{default:e};var n=g(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(r,a,s):r[a]=e[a]}return r.default=e,n&&n.set(e,r),r}function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var m=function(){function e(){(0,i.default)(this,e),(0,s.default)(this,"chat",void 0),(0,s.default)(this,"SDKAppID",void 0),(0,s.default)(this,"TUICore",void 0),(0,s.default)(this,"TUIChatEngine",void 0),(0,s.default)(this,"TUIGlobal",void 0),(0,s.default)(this,"TUIComponents",{}),(0,s.default)(this,"TUIPlugins",{}),this.TUICore=u.default,this.TUIChatEngine=c.default,this.TUIGlobal=p.TUIGlobal,this.SDKAppID=0,this.TUIGlobal._isTIMCallKit=!0,u.default.registerEvent(u.TUIConstants.TUILogin.EVENT.LOGIN_STATE_CHANGED,u.TUIConstants.TUILogin.EVENT_SUB_KEY.USER_LOGIN_SUCCESS,this)}return(0,a.default)(e,[{key:"onNotifyEvent",value:function(e,t){if(e===u.TUIConstants.TUILogin.EVENT.LOGIN_STATE_CHANGED)switch(t){case u.TUIConstants.TUILogin.EVENT_SUB_KEY.USER_LOGIN_SUCCESS:this.login();break}}},{key:"init",value:function(){f.isApp&&new h.default,c.TUITranslateService.provideLanguages(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){(0,s.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},l.default)),c.TUITranslateService.useI18n(),p.TUIGlobal.TUIComponents=this.TUIComponents,p.TUIGlobal.TUIPlugins=this.TUIPlugins,console.warn("[TUIChatKit]: init success.")}},{key:"login",value:function(){var e=u.TUILogin.getContext(),t=e.chat,n=e.SDKAppID,r=e.userID,o=e.userSig;return this.SDKAppID=n,this.TUIChatEngine.login({chat:t,SDKAppID:n,userID:r,userSig:o}),this.chat=t,this.TUIChatEngine}},{key:"component",value:function(e,t,n){var r,o;null!==this&&void 0!==this&&null!==(r=this.TUIComponents)&&void 0!==r&&r.componentName?console.warn("[TUIChatKit]: ".concat(null===this||void 0===this||null===(o=this.TUIComponents)||void 0===o?void 0:o.componentName," component has already been applied to target TUIChatEngine.")):(this.TUIComponents[e]=t,null===n||void 0===n||n.component(e,t));return n&&!p.TUIGlobal.Vue&&(p.TUIGlobal.Vue=n),this.TUIChatEngine}},{key:"components",value:function(e,t){var n,r=this;e&&(0,d.isObject)(e)?null===Object||void 0===Object||null===(n=Object.keys(e))||void 0===n||n.forEach((function(n){r.component(n,e[n],t)})):console.warn("[TUIChatKit]: components is empty or not object.");return this.TUIChatEngine}},{key:"use",value:function(e,t,n){if(this.TUICore)return this.TUIPlugins[e]?console.warn("[TUIChatKit]: Plugin ".concat(this.TUIPlugins[e]," has already been applied to target TUIChatEngine.")):t&&(0,d.isFunction)(null===t||void 0===t?void 0:t.plugin)?(this.TUIPlugins[e]=t,null===t||void 0===t||t.plugin(this,n)):(0,d.isFunction)(t)?(this.TUIPlugins[e]=t,t(this,n)):console.warn('[TUIChatKit]: A plugin must either be a function or an object with an "plugin" function.'+this.TUIPlugins[e]+"does not comply with the above rules."),this.TUIChatEngine;console.warn("[TUIChatKit]: Plugin ".concat(this.TUIPlugins[e]," can't be used before init."))}}]),e}();t.default=m},"0baf":function(e){e.exports=JSON.parse('{"uni-datetime-picker.selectDate":"select date","uni-datetime-picker.selectTime":"select time","uni-datetime-picker.selectDateTime":"select datetime","uni-datetime-picker.startDate":"start date","uni-datetime-picker.endDate":"end date","uni-datetime-picker.startTime":"start time","uni-datetime-picker.endTime":"end time","uni-datetime-picker.ok":"ok","uni-datetime-picker.clear":"clear","uni-datetime-picker.cancel":"cancel","uni-datetime-picker.year":"-","uni-datetime-picker.month":"","uni-calender.MON":"MON","uni-calender.TUE":"TUE","uni-calender.WED":"WED","uni-calender.THU":"THU","uni-calender.FRI":"FRI","uni-calender.SAT":"SAT","uni-calender.SUN":"SUN","uni-calender.confirm":"confirm"}')},"0ccb":function(e,t,n){"use strict";var r=n("4ea4"),o=n("7037");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n("2eee")),a=r(n("c973")),s=r(n("970b")),u=r(n("5bc3")),c=r(n("9523")),l=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==o(e)&&"function"!==typeof e)return{default:e};var n=m(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(r,a,s):r[a]=e[a]}r.default=e,n&&n.set(e,r);return r}(n("e16a")),d=n("a6ed"),f=n("dafa"),p=n("d31c"),h=n("8e85"),g=r(n("24ef")),v=r(n("577a")),_=n("1e3e");function m(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(m=function(e){return e?n:t})(e)}var y=function(){function e(){(0,s.default)(this,e),(0,c.default)(this,"onCallParamsMap",void 0),(0,c.default)(this,"onCallCallbackMap",void 0),(0,c.default)(this,"constants",void 0),(0,c.default)(this,"hideConversationHeader",(function(){d.TUIStore.update(d.StoreName.CUSTOM,"isShowConversationHeader",!1)})),l.default.registerService(l.TUIConstants.TUIConversation.SERVICE.NAME,this),l.default.registerExtension(l.TUIConstants.TUISearch.EXTENSION.SEARCH_MORE.EXT_ID,this),this.onCallParamsMap=new Map,this.onCallCallbackMap=new Map,this.constants=l.TUIConstants}return(0,u.default)(e,[{key:"getOnCallParams",value:function(e){return this.onCallParamsMap.get(e)}},{key:"getOnCallCallback",value:function(e){return this.onCallCallbackMap.get(e)}},{key:"onCall",value:function(e,t,n){switch(this.onCallParamsMap.set(e,t),this.onCallCallbackMap.set(e,n),e){case l.TUIConstants.TUIConversation.SERVICE.METHOD.CREATE_CONVERSATION:this.createConversation(t);break;case l.TUIConstants.TUIConversation.SERVICE.METHOD.HIDE_CONVERSATION_HEADER:this.hideConversationHeader();break}}},{key:"onGetExtension",value:function(e,t){if(e===l.TUIConstants.TUISearch.EXTENSION.SEARCH_MORE.EXT_ID){var n=[{weight:100,icon:v.default,text:d.TUITranslateService.t("TUIConversation.发起单聊"),data:{name:f.CONV_CREATE_TYPE.TYPEC2C},listener:{onClicked:this.createConversation.bind(this)}},{weight:100,icon:g.default,text:d.TUITranslateService.t("TUIConversation.发起群聊"),data:{name:f.CONV_CREATE_TYPE.TYPEGROUP},listener:{onClicked:this.createConversation.bind(this)}}];return n}}},{key:"createConversation",value:function(e){var t=this;l.default.callService({serviceName:l.TUIConstants.TUIContact.SERVICE.NAME,method:l.TUIConstants.TUIContact.SERVICE.METHOD.SELECT_FRIEND,params:{title:e.text,isRadio:e.data.name!==f.CONV_CREATE_TYPE.TYPEGROUP,isNeedSearch:!d.TUIStore.getData(d.StoreName.APP,"isOfficial")},callback:function(){var n=(0,a.default)(i.default.mark((function n(r){var o;return i.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r&&0!==r.length){n.next=2;break}return n.abrupt("return",t.routerForward(null));case 2:if(e.data.name!==f.CONV_CREATE_TYPE.TYPEGROUP){n.next=6;break}t.createGroup(r),n.next=10;break;case 6:return o=r[0].userID,n.next=9,t.generateConversation("C2C".concat(o));case 9:t.routerForward("C2C".concat(o));case 10:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()})}},{key:"createGroup",value:function(e){var t=this;l.default.callService({serviceName:l.TUIConstants.TUIGroup.SERVICE.NAME,method:l.TUIConstants.TUIGroup.SERVICE.METHOD.CREATE_GROUP,params:{title:d.TUITranslateService.t("TUIConversation.发起群聊"),memberList:e},callback:function(){var e=(0,a.default)(i.default.mark((function e(n){var r,o;return i.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=null,!n){e.next=6;break}return o=n.groupID,e.next=5,t.generateConversation("GROUP".concat(o));case 5:r="GROUP".concat(o);case 6:t.routerForward(r);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()})}},{key:"routerForward",value:function(){var e=(0,a.default)(i.default.mark((function e(t){return i.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!p.isUniFrameWork){e.next=4;break}return e.next=3,null===h.TUIGlobal||void 0===h.TUIGlobal?void 0:h.TUIGlobal.reLaunch({url:"/TUIKit/components/TUIConversation/index"});case 3:t&&(null===h.TUIGlobal||void 0===h.TUIGlobal||h.TUIGlobal.navigateTo({url:"/TUIKit/components/TUIChat/index"}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"generateConversation",value:function(e){d.TUIConversationService.switchConversation(e).then((function(){e.startsWith("GROUP")&&(0,_.enableSampleTaskStatus)("groupChat"),console.warn("打开会话成功")})).catch((function(e){console.warn("打开会话失败",e.code,e.msg)}))}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();t.default=y,(0,c.default)(y,"instance",void 0)},"0e47":function(e,t,n){(function(r){var o,i,a=n("7037");!function(r,s){"object"==a(t)&&"undefined"!=typeof e?e.exports=s():(o=s,i="function"===typeof o?o.call(t,n,t,e):o,void 0===i||(e.exports=i))}(0,(function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(o=r.key,void 0,"symbol"==a(i=function(e,t){if("object"!=a(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(o,"string"))?i:String(i)),r)}var o,i}function n(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],u=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){c=!0,o=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw o}}return s}}(e,t)||s(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e){return function(e){if(Array.isArray(e))return u(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||s(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){if(e){if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function c(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=s(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw i}}}}var l=function(){for(var e=" \t\r\n~!@#$%^&*()_+-=【】、{}|;':\"，。、《》？αβγδεζηθικλμνξοπρστυφχψωΑΒΓΔΕΖΗΘΙΚΛΜΝΞΟΠΡΣΤΥΦΧΨΩ。，、；：？！…—·ˉ¨‘’“”々～‖∶＂＇｀｜〃〔〕〈〉《》「」『』．〖〗【】（）［］｛｝ⅠⅡⅢⅣⅤⅥⅦⅧⅨⅩⅪⅫ⒈⒉⒊⒋⒌⒍⒎⒏⒐⒑⒒⒓⒔⒕⒖⒗⒘⒙⒚⒛㈠㈡㈢㈣㈤㈥㈦㈧㈨㈩①②③④⑤⑥⑦⑧⑨⑩⑴⑵⑶⑷⑸⑹⑺⑻⑼⑽⑾⑿⒀⒁⒂⒃⒄⒅⒆⒇≈≡≠＝≤≥＜＞≮≯∷±＋－×÷／∫∮∝∞∧∨∑∏∪∩∈∵∴⊥∥∠⌒⊙≌∽√§№☆★○●◎◇◆□℃‰€■△▲※→←↑↓〓¤°＃＆＠＼︿＿￣―♂♀┌┍┎┐┑┒┓─┄┈├┝┞┟┠┡┢┣│┆┊┬┭┮┯┰┱┲┳┼┽┾┿╀╁╂╃└┕┖┗┘┙┚┛━┅┉┤┥┦┧┨┩┪┫┃┇┋┴┵┶┷┸┹┺┻╋╊╉╈╇╆╅╄",t=new Map,n=0,r=e.length;n<r;n++)t.set(e.charCodeAt(0),!0);return t}(),d=function(){function t(n){e(this,t);var r,o=n.input,a=n.isArray,s=n.isMap;this._trieTree={},a(o)?r=o:s(o)&&(r=i(o.keys()),this._map=o);for(var u=0,c=r.length;u<c;u++)if(r[u]){for(var l=this._trieTree,d=r[u],f=0,p=d.length;f<p;f++)l[d[f]]||(l[d[f]]={}),l=l[d[f]];l.isEnd=!0}}return n(t,[{key:"filter",value:function(e){var t=e.text,n=e.replacingEnabled;if(0===Object.keys(this._trieTree).length)return{isMatched:!1,modifiedText:t};for(var r=this._trieTree,o=t.toLowerCase(),i="",a=!1,s=o.length,u=0;u<s;u++)if(!0!==l.get(o.charCodeAt(u))){for(var c=0,d="",f=!1,p=u;p<s;p++){if(!r[o[p]]){r=this._trieTree;break}if(d+=o[p],r[o[p]].isEnd){f=!0,c=p-u,r=this._trieTree;break}r=r[o[p]]}if(c>1&&(u+=c),f){if(a=!0,!n)break;var h=this._map.get(d)||"*";i=t.replace(new RegExp(d,"gi"),h)}}return{isMatched:a,modifiedText:i}}},{key:"reset",value:function(){this._trieTree={},this._map=null}}]),t}(),f="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof r?r:"undefined"!=typeof self?self:{},p={},h=function(e,t){return function(e,t){var n,r,o,i,a,s;e.exports=(s=s||function(e,t){var n;if("undefined"!=typeof window&&window.crypto&&(n=window.crypto),!n&&"undefined"!=typeof window&&window.msCrypto&&(n=window.msCrypto),!n&&void 0!==f&&f.crypto&&(n=f.crypto),!n)try{n=p}catch(_){}var r=function(){if(n){if("function"==typeof n.getRandomValues)try{return n.getRandomValues(new Uint32Array(1))[0]}catch(_){}if("function"==typeof n.randomBytes)try{return n.randomBytes(4).readInt32LE()}catch(_){}}throw new Error("Native crypto module could not be used to get secure random number.")},o=Object.create||function(){function e(){}return function(t){var n;return e.prototype=t,n=new e,e.prototype=null,n}}(),i={},a=i.lib={},s=a.Base={extend:function(e){var t=o(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},u=a.WordArray=s.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||l).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes,o=e.sigBytes;if(this.clamp(),r%4)for(var i=0;i<o;i++){var a=n[i>>>2]>>>24-i%4*8&255;t[r+i>>>2]|=a<<24-(r+i)%4*8}else for(i=0;i<o;i+=4)t[r+i>>>2]=n[i>>>2];return this.sigBytes+=o,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=s.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],n=0;n<e;n+=4)t.push(r());return new u.init(t,e)}}),c=i.enc={},l=c.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],o=0;o<n;o++){var i=t[o>>>2]>>>24-o%4*8&255;r.push((i>>>4).toString(16)),r.push((15&i).toString(16))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new u.init(n,t/2)}},d=c.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],o=0;o<n;o++){var i=t[o>>>2]>>>24-o%4*8&255;r.push(String.fromCharCode(i))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new u.init(n,t)}},h=c.Utf8={stringify:function(e){try{return decodeURIComponent(escape(d.stringify(e)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(e){return d.parse(unescape(encodeURIComponent(e)))}},g=a.BufferedBlockAlgorithm=s.extend({reset:function(){this._data=new u.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=h.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n,r=this._data,o=r.words,i=r.sigBytes,a=this.blockSize,s=i/(4*a),c=(s=t?e.ceil(s):e.max((0|s)-this._minBufferSize,0))*a,l=e.min(4*c,i);if(c){for(var d=0;d<c;d+=a)this._doProcessBlock(o,d);n=o.splice(0,c),r.sigBytes-=l}return new u.init(n,l)},clone:function(){var e=s.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),v=(a.Hasher=g.extend({cfg:s.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){g.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new v.HMAC.init(e,n).finalize(t)}}}),i.algo={});return i}(Math),a=(i=s).lib.WordArray,i.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp();for(var o=[],i=0;i<n;i+=3)for(var a=(t[i>>>2]>>>24-i%4*8&255)<<16|(t[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|t[i+2>>>2]>>>24-(i+2)%4*8&255,s=0;s<4&&i+.75*s<n;s++)o.push(r.charAt(a>>>6*(3-s)&63));var u=r.charAt(64);if(u)for(;o.length%4;)o.push(u);return o.join("")},parse:function(e){var t=e.length,n=this._map,r=this._reverseMap;if(!r){r=this._reverseMap=[];for(var o=0;o<n.length;o++)r[n.charCodeAt(o)]=o}var i=n.charAt(64);if(i){var s=e.indexOf(i);-1!==s&&(t=s)}return function(e,t,n){for(var r=[],o=0,i=0;i<t;i++)if(i%4){var s=n[e.charCodeAt(i-1)]<<i%4*2,u=n[e.charCodeAt(i)]>>>6-i%4*2,c=s|u;r[o>>>2]|=c<<24-o%4*8,o++}return a.create(r,o)}(e,t,r)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},function(e){var t=s,n=t.lib,r=n.WordArray,o=n.Hasher,i=t.algo,a=[];!function(){for(var t=0;t<64;t++)a[t]=4294967296*e.abs(e.sin(t+1))|0}();var u=i.MD5=o.extend({_doReset:function(){this._hash=new r.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var n=0;n<16;n++){var r=t+n,o=e[r];e[r]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8)}var i=this._hash.words,s=e[t+0],u=e[t+1],p=e[t+2],h=e[t+3],g=e[t+4],v=e[t+5],_=e[t+6],m=e[t+7],y=e[t+8],I=e[t+9],M=e[t+10],T=e[t+11],S=e[t+12],E=e[t+13],C=e[t+14],k=e[t+15],b=i[0],D=i[1],A=i[2],O=i[3];b=c(b,D,A,O,s,7,a[0]),O=c(O,b,D,A,u,12,a[1]),A=c(A,O,b,D,p,17,a[2]),D=c(D,A,O,b,h,22,a[3]),b=c(b,D,A,O,g,7,a[4]),O=c(O,b,D,A,v,12,a[5]),A=c(A,O,b,D,_,17,a[6]),D=c(D,A,O,b,m,22,a[7]),b=c(b,D,A,O,y,7,a[8]),O=c(O,b,D,A,I,12,a[9]),A=c(A,O,b,D,M,17,a[10]),D=c(D,A,O,b,T,22,a[11]),b=c(b,D,A,O,S,7,a[12]),O=c(O,b,D,A,E,12,a[13]),A=c(A,O,b,D,C,17,a[14]),b=l(b,D=c(D,A,O,b,k,22,a[15]),A,O,u,5,a[16]),O=l(O,b,D,A,_,9,a[17]),A=l(A,O,b,D,T,14,a[18]),D=l(D,A,O,b,s,20,a[19]),b=l(b,D,A,O,v,5,a[20]),O=l(O,b,D,A,M,9,a[21]),A=l(A,O,b,D,k,14,a[22]),D=l(D,A,O,b,g,20,a[23]),b=l(b,D,A,O,I,5,a[24]),O=l(O,b,D,A,C,9,a[25]),A=l(A,O,b,D,h,14,a[26]),D=l(D,A,O,b,y,20,a[27]),b=l(b,D,A,O,E,5,a[28]),O=l(O,b,D,A,p,9,a[29]),A=l(A,O,b,D,m,14,a[30]),b=d(b,D=l(D,A,O,b,S,20,a[31]),A,O,v,4,a[32]),O=d(O,b,D,A,y,11,a[33]),A=d(A,O,b,D,T,16,a[34]),D=d(D,A,O,b,C,23,a[35]),b=d(b,D,A,O,u,4,a[36]),O=d(O,b,D,A,g,11,a[37]),A=d(A,O,b,D,m,16,a[38]),D=d(D,A,O,b,M,23,a[39]),b=d(b,D,A,O,E,4,a[40]),O=d(O,b,D,A,s,11,a[41]),A=d(A,O,b,D,h,16,a[42]),D=d(D,A,O,b,_,23,a[43]),b=d(b,D,A,O,I,4,a[44]),O=d(O,b,D,A,S,11,a[45]),A=d(A,O,b,D,k,16,a[46]),b=f(b,D=d(D,A,O,b,p,23,a[47]),A,O,s,6,a[48]),O=f(O,b,D,A,m,10,a[49]),A=f(A,O,b,D,C,15,a[50]),D=f(D,A,O,b,v,21,a[51]),b=f(b,D,A,O,S,6,a[52]),O=f(O,b,D,A,h,10,a[53]),A=f(A,O,b,D,M,15,a[54]),D=f(D,A,O,b,u,21,a[55]),b=f(b,D,A,O,y,6,a[56]),O=f(O,b,D,A,k,10,a[57]),A=f(A,O,b,D,_,15,a[58]),D=f(D,A,O,b,E,21,a[59]),b=f(b,D,A,O,g,6,a[60]),O=f(O,b,D,A,T,10,a[61]),A=f(A,O,b,D,p,15,a[62]),D=f(D,A,O,b,I,21,a[63]),i[0]=i[0]+b|0,i[1]=i[1]+D|0,i[2]=i[2]+A|0,i[3]=i[3]+O|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,o=8*t.sigBytes;n[o>>>5]|=128<<24-o%32;var i=e.floor(r/4294967296),a=r;n[15+(o+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),n[14+(o+64>>>9<<4)]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),t.sigBytes=4*(n.length+1),this._process();for(var s=this._hash,u=s.words,c=0;c<4;c++){var l=u[c];u[c]=16711935&(l<<8|l>>>24)|4278255360&(l<<24|l>>>8)}return s},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}});function c(e,t,n,r,o,i,a){var s=e+(t&n|~t&r)+o+a;return(s<<i|s>>>32-i)+t}function l(e,t,n,r,o,i,a){var s=e+(t&r|n&~r)+o+a;return(s<<i|s>>>32-i)+t}function d(e,t,n,r,o,i,a){var s=e+(t^n^r)+o+a;return(s<<i|s>>>32-i)+t}function f(e,t,n,r,o,i,a){var s=e+(n^(t|~r))+o+a;return(s<<i|s>>>32-i)+t}t.MD5=o._createHelper(u),t.HmacMD5=o._createHmacHelper(u)}(Math),function(){var e=s,t=e.lib,n=t.WordArray,r=t.Hasher,o=e.algo,i=[],a=o.SHA1=r.extend({_doReset:function(){this._hash=new n.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],o=n[1],a=n[2],s=n[3],u=n[4],c=0;c<80;c++){if(c<16)i[c]=0|e[t+c];else{var l=i[c-3]^i[c-8]^i[c-14]^i[c-16];i[c]=l<<1|l>>>31}var d=(r<<5|r>>>27)+u+i[c];d+=c<20?1518500249+(o&a|~o&s):c<40?1859775393+(o^a^s):c<60?(o&a|o&s|a&s)-1894007588:(o^a^s)-899497514,u=s,s=a,a=o<<30|o>>>2,o=r,r=d}n[0]=n[0]+r|0,n[1]=n[1]+o|0,n[2]=n[2]+a|0,n[3]=n[3]+s|0,n[4]=n[4]+u|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;return t[r>>>5]|=128<<24-r%32,t[14+(r+64>>>9<<4)]=Math.floor(n/4294967296),t[15+(r+64>>>9<<4)]=n,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}});e.SHA1=r._createHelper(a),e.HmacSHA1=r._createHmacHelper(a)}(),function(e){var t=s,n=t.lib,r=n.WordArray,o=n.Hasher,i=t.algo,a=[],u=[];!function(){function t(t){for(var n=e.sqrt(t),r=2;r<=n;r++)if(!(t%r))return!1;return!0}function n(e){return 4294967296*(e-(0|e))|0}for(var r=2,o=0;o<64;)t(r)&&(o<8&&(a[o]=n(e.pow(r,.5))),u[o]=n(e.pow(r,1/3)),o++),r++}();var c=[],l=i.SHA256=o.extend({_doReset:function(){this._hash=new r.init(a.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],o=n[1],i=n[2],a=n[3],s=n[4],l=n[5],d=n[6],f=n[7],p=0;p<64;p++){if(p<16)c[p]=0|e[t+p];else{var h=c[p-15],g=(h<<25|h>>>7)^(h<<14|h>>>18)^h>>>3,v=c[p-2],_=(v<<15|v>>>17)^(v<<13|v>>>19)^v>>>10;c[p]=g+c[p-7]+_+c[p-16]}var m=r&o^r&i^o&i,y=(r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22),I=f+((s<<26|s>>>6)^(s<<21|s>>>11)^(s<<7|s>>>25))+(s&l^~s&d)+u[p]+c[p];f=d,d=l,l=s,s=a+I|0,a=i,i=o,o=r,r=I+(y+m)|0}n[0]=n[0]+r|0,n[1]=n[1]+o|0,n[2]=n[2]+i|0,n[3]=n[3]+a|0,n[4]=n[4]+s|0,n[5]=n[5]+l|0,n[6]=n[6]+d|0,n[7]=n[7]+f|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,o=8*t.sigBytes;return n[o>>>5]|=128<<24-o%32,n[14+(o+64>>>9<<4)]=e.floor(r/4294967296),n[15+(o+64>>>9<<4)]=r,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=o._createHelper(l),t.HmacSHA256=o._createHmacHelper(l)}(Math),function(){var e=s,t=e.lib.WordArray,n=e.enc;function r(e){return e<<8&4278255360|e>>>8&16711935}n.Utf16=n.Utf16BE={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],o=0;o<n;o+=2){var i=t[o>>>2]>>>16-o%4*8&65535;r.push(String.fromCharCode(i))}return r.join("")},parse:function(e){for(var n=e.length,r=[],o=0;o<n;o++)r[o>>>1]|=e.charCodeAt(o)<<16-o%2*16;return t.create(r,2*n)}},n.Utf16LE={stringify:function(e){for(var t=e.words,n=e.sigBytes,o=[],i=0;i<n;i+=2){var a=r(t[i>>>2]>>>16-i%4*8&65535);o.push(String.fromCharCode(a))}return o.join("")},parse:function(e){for(var n=e.length,o=[],i=0;i<n;i++)o[i>>>1]|=r(e.charCodeAt(i)<<16-i%2*16);return t.create(o,2*n)}}}(),function(){if("function"==typeof ArrayBuffer){var e=s.lib.WordArray,t=e.init;(e.init=function(e){if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),(e instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array)&&(e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),e instanceof Uint8Array){for(var n=e.byteLength,r=[],o=0;o<n;o++)r[o>>>2]|=e[o]<<24-o%4*8;t.call(this,r,n)}else t.apply(this,arguments)}).prototype=e}}(),
/** @preserve
            (c) 2012 by C��dric Mesnil. All rights reserved.
             Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:
                 - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
                - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
             THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
            */
function(e){var t=s,n=t.lib,r=n.WordArray,o=n.Hasher,i=t.algo,a=r.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),u=r.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),c=r.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),l=r.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),d=r.create([0,1518500249,1859775393,2400959708,2840853838]),f=r.create([1352829926,1548603684,1836072691,2053994217,0]),p=i.RIPEMD160=o.extend({_doReset:function(){this._hash=r.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=0;n<16;n++){var r=t+n,o=e[r];e[r]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8)}var i,s,p,I,M,T,S,E,C,k,b,D=this._hash.words,A=d.words,O=f.words,R=a.words,N=u.words,w=c.words,L=l.words;for(T=i=D[0],S=s=D[1],E=p=D[2],C=I=D[3],k=M=D[4],n=0;n<80;n+=1)b=i+e[t+R[n]]|0,b+=n<16?h(s,p,I)+A[0]:n<32?g(s,p,I)+A[1]:n<48?v(s,p,I)+A[2]:n<64?_(s,p,I)+A[3]:m(s,p,I)+A[4],b=(b=y(b|=0,w[n]))+M|0,i=M,M=I,I=y(p,10),p=s,s=b,b=T+e[t+N[n]]|0,b+=n<16?m(S,E,C)+O[0]:n<32?_(S,E,C)+O[1]:n<48?v(S,E,C)+O[2]:n<64?g(S,E,C)+O[3]:h(S,E,C)+O[4],b=(b=y(b|=0,L[n]))+k|0,T=k,k=C,C=y(E,10),E=S,S=b;b=D[1]+p+C|0,D[1]=D[2]+I+k|0,D[2]=D[3]+M+T|0,D[3]=D[4]+i+S|0,D[4]=D[0]+s+E|0,D[0]=b},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;t[r>>>5]|=128<<24-r%32,t[14+(r+64>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),e.sigBytes=4*(t.length+1),this._process();for(var o=this._hash,i=o.words,a=0;a<5;a++){var s=i[a];i[a]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8)}return o},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}});function h(e,t,n){return e^t^n}function g(e,t,n){return e&t|~e&n}function v(e,t,n){return(e|~t)^n}function _(e,t,n){return e&n|t&~n}function m(e,t,n){return e^(t|~n)}function y(e,t){return e<<t|e>>>32-t}t.RIPEMD160=o._createHelper(p),t.HmacRIPEMD160=o._createHmacHelper(p)}(),function(){var e=s,t=e.lib.Base,n=e.enc.Utf8;e.algo.HMAC=t.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=n.parse(t));var r=e.blockSize,o=4*r;t.sigBytes>o&&(t=e.finalize(t)),t.clamp();for(var i=this._oKey=t.clone(),a=this._iKey=t.clone(),s=i.words,u=a.words,c=0;c<r;c++)s[c]^=1549556828,u[c]^=909522486;i.sigBytes=a.sigBytes=o,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,n=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(n))}})}(),function(){var e=s,t=e.lib,n=t.Base,r=t.WordArray,o=e.algo,i=o.SHA1,a=o.HMAC,u=o.PBKDF2=n.extend({cfg:n.extend({keySize:4,hasher:i,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=this.cfg,o=a.create(n.hasher,e),i=r.create(),s=r.create([1]),u=i.words,c=s.words,l=n.keySize,d=n.iterations;u.length<l;){var f=o.update(t).finalize(s);o.reset();for(var p=f.words,h=p.length,g=f,v=1;v<d;v++){g=o.finalize(g),o.reset();for(var _=g.words,m=0;m<h;m++)p[m]^=_[m]}i.concat(f),c[0]++}return i.sigBytes=4*l,i}});e.PBKDF2=function(e,t,n){return u.create(n).compute(e,t)}}(),function(){var e=s,t=e.lib,n=t.Base,r=t.WordArray,o=e.algo,i=o.MD5,a=o.EvpKDF=n.extend({cfg:n.extend({keySize:4,hasher:i,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n,o=this.cfg,i=o.hasher.create(),a=r.create(),s=a.words,u=o.keySize,c=o.iterations;s.length<u;){n&&i.update(n),n=i.update(e).finalize(t),i.reset();for(var l=1;l<c;l++)n=i.finalize(n),i.reset();a.concat(n)}return a.sigBytes=4*u,a}});e.EvpKDF=function(e,t,n){return a.create(n).compute(e,t)}}(),function(){var e=s,t=e.lib.WordArray,n=e.algo,r=n.SHA256,o=n.SHA224=r.extend({_doReset:function(){this._hash=new t.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var e=r._doFinalize.call(this);return e.sigBytes-=4,e}});e.SHA224=r._createHelper(o),e.HmacSHA224=r._createHmacHelper(o)}(),function(e){var t=s,n=t.lib,r=n.Base,o=n.WordArray,i=t.x64={};i.Word=r.extend({init:function(e,t){this.high=e,this.low=t}}),i.WordArray=r.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:8*e.length},toX32:function(){for(var e=this.words,t=e.length,n=[],r=0;r<t;r++){var i=e[r];n.push(i.high),n.push(i.low)}return o.create(n,this.sigBytes)},clone:function(){for(var e=r.clone.call(this),t=e.words=this.words.slice(0),n=t.length,o=0;o<n;o++)t[o]=t[o].clone();return e}})}(),function(e){var t=s,n=t.lib,r=n.WordArray,o=n.Hasher,i=t.x64.Word,a=t.algo,u=[],c=[],l=[];!function(){for(var e=1,t=0,n=0;n<24;n++){u[e+5*t]=(n+1)*(n+2)/2%64;var r=(2*e+3*t)%5;e=t%5,t=r}for(e=0;e<5;e++)for(t=0;t<5;t++)c[e+5*t]=t+(2*e+3*t)%5*5;for(var o=1,a=0;a<24;a++){for(var s=0,d=0,f=0;f<7;f++){if(1&o){var p=(1<<f)-1;p<32?d^=1<<p:s^=1<<p-32}128&o?o=o<<1^113:o<<=1}l[a]=i.create(s,d)}}();var d=[];!function(){for(var e=0;e<25;e++)d[e]=i.create()}();var f=a.SHA3=o.extend({cfg:o.cfg.extend({outputLength:512}),_doReset:function(){for(var e=this._state=[],t=0;t<25;t++)e[t]=new i.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(e,t){for(var n=this._state,r=this.blockSize/2,o=0;o<r;o++){var i=e[t+2*o],a=e[t+2*o+1];i=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),a=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),(D=n[o]).high^=a,D.low^=i}for(var s=0;s<24;s++){for(var f=0;f<5;f++){for(var p=0,h=0,g=0;g<5;g++)p^=(D=n[f+5*g]).high,h^=D.low;var v=d[f];v.high=p,v.low=h}for(f=0;f<5;f++){var _=d[(f+4)%5],m=d[(f+1)%5],y=m.high,I=m.low;for(p=_.high^(y<<1|I>>>31),h=_.low^(I<<1|y>>>31),g=0;g<5;g++)(D=n[f+5*g]).high^=p,D.low^=h}for(var M=1;M<25;M++){var T=(D=n[M]).high,S=D.low,E=u[M];E<32?(p=T<<E|S>>>32-E,h=S<<E|T>>>32-E):(p=S<<E-32|T>>>64-E,h=T<<E-32|S>>>64-E);var C=d[c[M]];C.high=p,C.low=h}var k=d[0],b=n[0];for(k.high=b.high,k.low=b.low,f=0;f<5;f++)for(g=0;g<5;g++){var D=n[M=f+5*g],A=d[M],O=d[(f+1)%5+5*g],R=d[(f+2)%5+5*g];D.high=A.high^~O.high&R.high,D.low=A.low^~O.low&R.low}D=n[0];var N=l[s];D.high^=N.high,D.low^=N.low}},_doFinalize:function(){var t=this._data,n=t.words,o=(this._nDataBytes,8*t.sigBytes),i=32*this.blockSize;n[o>>>5]|=1<<24-o%32,n[(e.ceil((o+1)/i)*i>>>5)-1]|=128,t.sigBytes=4*n.length,this._process();for(var a=this._state,s=this.cfg.outputLength/8,u=s/8,c=[],l=0;l<u;l++){var d=a[l],f=d.high,p=d.low;f=16711935&(f<<8|f>>>24)|4278255360&(f<<24|f>>>8),p=16711935&(p<<8|p>>>24)|4278255360&(p<<24|p>>>8),c.push(p),c.push(f)}return new r.init(c,s)},clone:function(){for(var e=o.clone.call(this),t=e._state=this._state.slice(0),n=0;n<25;n++)t[n]=t[n].clone();return e}});t.SHA3=o._createHelper(f),t.HmacSHA3=o._createHmacHelper(f)}(Math),function(){var e=s,t=e.lib.Hasher,n=e.x64,r=n.Word,o=n.WordArray,i=e.algo;function a(){return r.create.apply(r,arguments)}var u=[a(1116352408,3609767458),a(1899447441,602891725),a(3049323471,3964484399),a(3921009573,2173295548),a(961987163,4081628472),a(1508970993,3053834265),a(2453635748,2937671579),a(2870763221,3664609560),a(3624381080,2734883394),a(310598401,1164996542),a(607225278,1323610764),a(1426881987,3590304994),a(1925078388,4068182383),a(2162078206,991336113),a(2614888103,633803317),a(3248222580,3479774868),a(3835390401,2666613458),a(4022224774,944711139),a(264347078,2341262773),a(604807628,2007800933),a(770255983,1495990901),a(1249150122,1856431235),a(1555081692,3175218132),a(1996064986,2198950837),a(2554220882,3999719339),a(2821834349,766784016),a(2952996808,2566594879),a(3210313671,3203337956),a(3336571891,1034457026),a(3584528711,2466948901),a(113926993,3758326383),a(338241895,168717936),a(666307205,1188179964),a(773529912,1546045734),a(1294757372,1522805485),a(1396182291,2643833823),a(1695183700,2343527390),a(1986661051,1014477480),a(2177026350,1206759142),a(2456956037,344077627),a(2730485921,1290863460),a(2820302411,3158454273),a(3259730800,3505952657),a(3345764771,106217008),a(3516065817,3606008344),a(3600352804,1432725776),a(4094571909,1467031594),a(275423344,851169720),a(430227734,3100823752),a(506948616,1363258195),a(659060556,3750685593),a(883997877,3785050280),a(958139571,3318307427),a(1322822218,3812723403),a(1537002063,2003034995),a(1747873779,3602036899),a(1955562222,1575990012),a(2024104815,1125592928),a(2227730452,2716904306),a(2361852424,442776044),a(2428436474,593698344),a(2756734187,3733110249),a(3204031479,2999351573),a(3329325298,3815920427),a(3391569614,3928383900),a(3515267271,566280711),a(3940187606,3454069534),a(4118630271,4000239992),a(116418474,1914138554),a(174292421,2731055270),a(289380356,3203993006),a(460393269,320620315),a(685471733,587496836),a(852142971,1086792851),a(1017036298,365543100),a(1126000580,2618297676),a(1288033470,3409855158),a(1501505948,4234509866),a(1607167915,987167468),a(1816402316,1246189591)],c=[];!function(){for(var e=0;e<80;e++)c[e]=a()}();var l=i.SHA512=t.extend({_doReset:function(){this._hash=new o.init([new r.init(1779033703,4089235720),new r.init(3144134277,2227873595),new r.init(1013904242,4271175723),new r.init(2773480762,1595750129),new r.init(1359893119,2917565137),new r.init(2600822924,725511199),new r.init(528734635,4215389547),new r.init(1541459225,327033209)])},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],o=n[1],i=n[2],a=n[3],s=n[4],l=n[5],d=n[6],f=n[7],p=r.high,h=r.low,g=o.high,v=o.low,_=i.high,m=i.low,y=a.high,I=a.low,M=s.high,T=s.low,S=l.high,E=l.low,C=d.high,k=d.low,b=f.high,D=f.low,A=p,O=h,R=g,N=v,w=_,L=m,P=y,U=I,G=M,x=T,F=S,q=E,V=C,B=k,j=b,H=D,K=0;K<80;K++){var W,Y,z=c[K];if(K<16)Y=z.high=0|e[t+2*K],W=z.low=0|e[t+2*K+1];else{var J=c[K-15],X=J.high,$=J.low,Z=(X>>>1|$<<31)^(X>>>8|$<<24)^X>>>7,Q=($>>>1|X<<31)^($>>>8|X<<24)^($>>>7|X<<25),ee=c[K-2],te=ee.high,ne=ee.low,re=(te>>>19|ne<<13)^(te<<3|ne>>>29)^te>>>6,oe=(ne>>>19|te<<13)^(ne<<3|te>>>29)^(ne>>>6|te<<26),ie=c[K-7],ae=ie.high,se=ie.low,ue=c[K-16],ce=ue.high,le=ue.low;Y=(Y=(Y=Z+ae+((W=Q+se)>>>0<Q>>>0?1:0))+re+((W+=oe)>>>0<oe>>>0?1:0))+ce+((W+=le)>>>0<le>>>0?1:0),z.high=Y,z.low=W}var de,fe=G&F^~G&V,pe=x&q^~x&B,he=A&R^A&w^R&w,ge=O&N^O&L^N&L,ve=(A>>>28|O<<4)^(A<<30|O>>>2)^(A<<25|O>>>7),_e=(O>>>28|A<<4)^(O<<30|A>>>2)^(O<<25|A>>>7),me=(G>>>14|x<<18)^(G>>>18|x<<14)^(G<<23|x>>>9),ye=(x>>>14|G<<18)^(x>>>18|G<<14)^(x<<23|G>>>9),Ie=u[K],Me=Ie.high,Te=Ie.low,Se=j+me+((de=H+ye)>>>0<H>>>0?1:0),Ee=_e+ge;j=V,H=B,V=F,B=q,F=G,q=x,G=P+(Se=(Se=(Se=Se+fe+((de+=pe)>>>0<pe>>>0?1:0))+Me+((de+=Te)>>>0<Te>>>0?1:0))+Y+((de+=W)>>>0<W>>>0?1:0))+((x=U+de|0)>>>0<U>>>0?1:0)|0,P=w,U=L,w=R,L=N,R=A,N=O,A=Se+(ve+he+(Ee>>>0<_e>>>0?1:0))+((O=de+Ee|0)>>>0<de>>>0?1:0)|0}h=r.low=h+O,r.high=p+A+(h>>>0<O>>>0?1:0),v=o.low=v+N,o.high=g+R+(v>>>0<N>>>0?1:0),m=i.low=m+L,i.high=_+w+(m>>>0<L>>>0?1:0),I=a.low=I+U,a.high=y+P+(I>>>0<U>>>0?1:0),T=s.low=T+x,s.high=M+G+(T>>>0<x>>>0?1:0),E=l.low=E+q,l.high=S+F+(E>>>0<q>>>0?1:0),k=d.low=k+B,d.high=C+V+(k>>>0<B>>>0?1:0),D=f.low=D+H,f.high=b+j+(D>>>0<H>>>0?1:0)},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;return t[r>>>5]|=128<<24-r%32,t[30+(r+128>>>10<<5)]=Math.floor(n/4294967296),t[31+(r+128>>>10<<5)]=n,e.sigBytes=4*t.length,this._process(),this._hash.toX32()},clone:function(){var e=t.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:32});e.SHA512=t._createHelper(l),e.HmacSHA512=t._createHmacHelper(l)}(),function(){var e=s,t=e.x64,n=t.Word,r=t.WordArray,o=e.algo,i=o.SHA512,a=o.SHA384=i.extend({_doReset:function(){this._hash=new r.init([new n.init(3418070365,3238371032),new n.init(1654270250,914150663),new n.init(2438529370,812702999),new n.init(355462360,4144912697),new n.init(1731405415,4290775857),new n.init(2394180231,1750603025),new n.init(3675008525,1694076839),new n.init(1203062813,3204075428)])},_doFinalize:function(){var e=i._doFinalize.call(this);return e.sigBytes-=16,e}});e.SHA384=i._createHelper(a),e.HmacSHA384=i._createHmacHelper(a)}(),s.lib.Cipher||function(e){var t=s,n=t.lib,r=n.Base,o=n.WordArray,i=n.BufferedBlockAlgorithm,a=t.enc,u=(a.Utf8,a.Base64),c=t.algo.EvpKDF,l=n.Cipher=i.extend({cfg:r.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,n){this.cfg=this.cfg.extend(n),this._xformMode=e,this._key=t,this.reset()},reset:function(){i.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function e(e){return"string"==typeof e?y:_}return function(t){return{encrypt:function(n,r,o){return e(r).encrypt(t,n,r,o)},decrypt:function(n,r,o){return e(r).decrypt(t,n,r,o)}}}}()}),d=(n.StreamCipher=l.extend({_doFinalize:function(){return this._process(!0)},blockSize:1}),t.mode={}),f=n.BlockCipherMode=r.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}}),p=d.CBC=function(){var e=f.extend();function t(e,t,n){var r,o=this._iv;o?(r=o,this._iv=void 0):r=this._prevBlock;for(var i=0;i<n;i++)e[t+i]^=r[i]}return e.Encryptor=e.extend({processBlock:function(e,n){var r=this._cipher,o=r.blockSize;t.call(this,e,n,o),r.encryptBlock(e,n),this._prevBlock=e.slice(n,n+o)}}),e.Decryptor=e.extend({processBlock:function(e,n){var r=this._cipher,o=r.blockSize,i=e.slice(n,n+o);r.decryptBlock(e,n),t.call(this,e,n,o),this._prevBlock=i}}),e}(),h=(t.pad={}).Pkcs7={pad:function(e,t){for(var n=4*t,r=n-e.sigBytes%n,i=r<<24|r<<16|r<<8|r,a=[],s=0;s<r;s+=4)a.push(i);var u=o.create(a,r);e.concat(u)},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},g=(n.BlockCipher=l.extend({cfg:l.cfg.extend({mode:p,padding:h}),reset:function(){var e;l.reset.call(this);var t=this.cfg,n=t.iv,r=t.mode;this._xformMode==this._ENC_XFORM_MODE?e=r.createEncryptor:(e=r.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==e?this._mode.init(this,n&&n.words):(this._mode=e.call(r,this,n&&n.words),this._mode.__creator=e)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e,t=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(t.pad(this._data,this.blockSize),e=this._process(!0)):(e=this._process(!0),t.unpad(e)),e},blockSize:4}),n.CipherParams=r.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}})),v=(t.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext,n=e.salt;return(n?o.create([1398893684,1701076831]).concat(n).concat(t):t).toString(u)},parse:function(e){var t,n=u.parse(e),r=n.words;return 1398893684==r[0]&&1701076831==r[1]&&(t=o.create(r.slice(2,4)),r.splice(0,4),n.sigBytes-=16),g.create({ciphertext:n,salt:t})}},_=n.SerializableCipher=r.extend({cfg:r.extend({format:v}),encrypt:function(e,t,n,r){r=this.cfg.extend(r);var o=e.createEncryptor(n,r),i=o.finalize(t),a=o.cfg;return g.create({ciphertext:i,key:n,iv:a.iv,algorithm:e,mode:a.mode,padding:a.padding,blockSize:e.blockSize,formatter:r.format})},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),e.createDecryptor(n,r).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}}),m=(t.kdf={}).OpenSSL={execute:function(e,t,n,r){r||(r=o.random(8));var i=c.create({keySize:t+n}).compute(e,r),a=o.create(i.words.slice(t),4*n);return i.sigBytes=4*t,g.create({key:i,iv:a,salt:r})}},y=n.PasswordBasedCipher=_.extend({cfg:_.cfg.extend({kdf:m}),encrypt:function(e,t,n,r){var o=(r=this.cfg.extend(r)).kdf.execute(n,e.keySize,e.ivSize);r.iv=o.iv;var i=_.encrypt.call(this,e,t,o.key,r);return i.mixIn(o),i},decrypt:function(e,t,n,r){r=this.cfg.extend(r),t=this._parse(t,r.format);var o=r.kdf.execute(n,e.keySize,e.ivSize,t.salt);return r.iv=o.iv,_.decrypt.call(this,e,t,o.key,r)}})}(),s.mode.CFB=function(){var e=s.lib.BlockCipherMode.extend();function t(e,t,n,r){var o,i=this._iv;i?(o=i.slice(0),this._iv=void 0):o=this._prevBlock,r.encryptBlock(o,0);for(var a=0;a<n;a++)e[t+a]^=o[a]}return e.Encryptor=e.extend({processBlock:function(e,n){var r=this._cipher,o=r.blockSize;t.call(this,e,n,o,r),this._prevBlock=e.slice(n,n+o)}}),e.Decryptor=e.extend({processBlock:function(e,n){var r=this._cipher,o=r.blockSize,i=e.slice(n,n+o);t.call(this,e,n,o,r),this._prevBlock=i}}),e}(),s.mode.ECB=((o=s.lib.BlockCipherMode.extend()).Encryptor=o.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),o.Decryptor=o.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),o),s.pad.AnsiX923={pad:function(e,t){var n=e.sigBytes,r=4*t,o=r-n%r,i=n+o-1;e.clamp(),e.words[i>>>2]|=o<<24-i%4*8,e.sigBytes+=o},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},s.pad.Iso10126={pad:function(e,t){var n=4*t,r=n-e.sigBytes%n;e.concat(s.lib.WordArray.random(r-1)).concat(s.lib.WordArray.create([r<<24],1))},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},s.pad.Iso97971={pad:function(e,t){e.concat(s.lib.WordArray.create([2147483648],1)),s.pad.ZeroPadding.pad(e,t)},unpad:function(e){s.pad.ZeroPadding.unpad(e),e.sigBytes--}},s.mode.OFB=(n=s.lib.BlockCipherMode.extend(),r=n.Encryptor=n.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,o=this._iv,i=this._keystream;o&&(i=this._keystream=o.slice(0),this._iv=void 0),n.encryptBlock(i,0);for(var a=0;a<r;a++)e[t+a]^=i[a]}}),n.Decryptor=r,n),s.pad.NoPadding={pad:function(){},unpad:function(){}},function(e){var t=s,n=t.lib.CipherParams,r=t.enc.Hex;t.format.Hex={stringify:function(e){return e.ciphertext.toString(r)},parse:function(e){var t=r.parse(e);return n.create({ciphertext:t})}}}(),function(){var e=s,t=e.lib.BlockCipher,n=e.algo,r=[],o=[],i=[],a=[],u=[],c=[],l=[],d=[],f=[],p=[];!function(){for(var e=[],t=0;t<256;t++)e[t]=t<128?t<<1:t<<1^283;var n=0,s=0;for(t=0;t<256;t++){var h=s^s<<1^s<<2^s<<3^s<<4;h=h>>>8^255&h^99,r[n]=h,o[h]=n;var g=e[n],v=e[g],_=e[v],m=257*e[h]^16843008*h;i[n]=m<<24|m>>>8,a[n]=m<<16|m>>>16,u[n]=m<<8|m>>>24,c[n]=m,m=16843009*_^65537*v^257*g^16843008*n,l[h]=m<<24|m>>>8,d[h]=m<<16|m>>>16,f[h]=m<<8|m>>>24,p[h]=m,n?(n=g^e[e[e[_^g]]],s^=e[e[s]]):n=s=1}}();var h=[0,1,2,4,8,16,32,64,128,27,54],g=n.AES=t.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var e=this._keyPriorReset=this._key,t=e.words,n=e.sigBytes/4,o=4*((this._nRounds=n+6)+1),i=this._keySchedule=[],a=0;a<o;a++)a<n?i[a]=t[a]:(c=i[a-1],a%n?n>6&&a%n==4&&(c=r[c>>>24]<<24|r[c>>>16&255]<<16|r[c>>>8&255]<<8|r[255&c]):(c=r[(c=c<<8|c>>>24)>>>24]<<24|r[c>>>16&255]<<16|r[c>>>8&255]<<8|r[255&c],c^=h[a/n|0]<<24),i[a]=i[a-n]^c);for(var s=this._invKeySchedule=[],u=0;u<o;u++){if(a=o-u,u%4)var c=i[a];else c=i[a-4];s[u]=u<4||a<=4?c:l[r[c>>>24]]^d[r[c>>>16&255]]^f[r[c>>>8&255]]^p[r[255&c]]}}},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,i,a,u,c,r)},decryptBlock:function(e,t){var n=e[t+1];e[t+1]=e[t+3],e[t+3]=n,this._doCryptBlock(e,t,this._invKeySchedule,l,d,f,p,o),n=e[t+1],e[t+1]=e[t+3],e[t+3]=n},_doCryptBlock:function(e,t,n,r,o,i,a,s){for(var u=this._nRounds,c=e[t]^n[0],l=e[t+1]^n[1],d=e[t+2]^n[2],f=e[t+3]^n[3],p=4,h=1;h<u;h++){var g=r[c>>>24]^o[l>>>16&255]^i[d>>>8&255]^a[255&f]^n[p++],v=r[l>>>24]^o[d>>>16&255]^i[f>>>8&255]^a[255&c]^n[p++],_=r[d>>>24]^o[f>>>16&255]^i[c>>>8&255]^a[255&l]^n[p++],m=r[f>>>24]^o[c>>>16&255]^i[l>>>8&255]^a[255&d]^n[p++];c=g,l=v,d=_,f=m}g=(s[c>>>24]<<24|s[l>>>16&255]<<16|s[d>>>8&255]<<8|s[255&f])^n[p++],v=(s[l>>>24]<<24|s[d>>>16&255]<<16|s[f>>>8&255]<<8|s[255&c])^n[p++],_=(s[d>>>24]<<24|s[f>>>16&255]<<16|s[c>>>8&255]<<8|s[255&l])^n[p++],m=(s[f>>>24]<<24|s[c>>>16&255]<<16|s[l>>>8&255]<<8|s[255&d])^n[p++],e[t]=g,e[t+1]=v,e[t+2]=_,e[t+3]=m},keySize:8});e.AES=t._createHelper(g)}(),function(){var e=s,t=e.lib,n=t.WordArray,r=t.BlockCipher,o=e.algo,i=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],a=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],u=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],c=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],l=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],d=o.DES=r.extend({_doReset:function(){for(var e=this._key.words,t=[],n=0;n<56;n++){var r=i[n]-1;t[n]=e[r>>>5]>>>31-r%32&1}for(var o=this._subKeys=[],s=0;s<16;s++){var c=o[s]=[],l=u[s];for(n=0;n<24;n++)c[n/6|0]|=t[(a[n]-1+l)%28]<<31-n%6,c[4+(n/6|0)]|=t[28+(a[n+24]-1+l)%28]<<31-n%6;for(c[0]=c[0]<<1|c[0]>>>31,n=1;n<7;n++)c[n]=c[n]>>>4*(n-1)+3;c[7]=c[7]<<5|c[7]>>>27}var d=this._invSubKeys=[];for(n=0;n<16;n++)d[n]=o[15-n]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._subKeys)},decryptBlock:function(e,t){this._doCryptBlock(e,t,this._invSubKeys)},_doCryptBlock:function(e,t,n){this._lBlock=e[t],this._rBlock=e[t+1],f.call(this,4,252645135),f.call(this,16,65535),p.call(this,2,858993459),p.call(this,8,16711935),f.call(this,1,1431655765);for(var r=0;r<16;r++){for(var o=n[r],i=this._lBlock,a=this._rBlock,s=0,u=0;u<8;u++)s|=c[u][((a^o[u])&l[u])>>>0];this._lBlock=a,this._rBlock=i^s}var d=this._lBlock;this._lBlock=this._rBlock,this._rBlock=d,f.call(this,1,1431655765),p.call(this,8,16711935),p.call(this,2,858993459),f.call(this,16,65535),f.call(this,4,252645135),e[t]=this._lBlock,e[t+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});function f(e,t){var n=(this._lBlock>>>e^this._rBlock)&t;this._rBlock^=n,this._lBlock^=n<<e}function p(e,t){var n=(this._rBlock>>>e^this._lBlock)&t;this._lBlock^=n,this._rBlock^=n<<e}e.DES=r._createHelper(d);var h=o.TripleDES=r.extend({_doReset:function(){var e=this._key.words;if(2!==e.length&&4!==e.length&&e.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var t=e.slice(0,2),r=e.length<4?e.slice(0,2):e.slice(2,4),o=e.length<6?e.slice(0,2):e.slice(4,6);this._des1=d.createEncryptor(n.create(t)),this._des2=d.createEncryptor(n.create(r)),this._des3=d.createEncryptor(n.create(o))},encryptBlock:function(e,t){this._des1.encryptBlock(e,t),this._des2.decryptBlock(e,t),this._des3.encryptBlock(e,t)},decryptBlock:function(e,t){this._des3.decryptBlock(e,t),this._des2.encryptBlock(e,t),this._des1.decryptBlock(e,t)},keySize:6,ivSize:2,blockSize:2});e.TripleDES=r._createHelper(h)}(),function(){var e=s,t=e.lib.StreamCipher,n=e.algo,r=n.RC4=t.extend({_doReset:function(){for(var e=this._key,t=e.words,n=e.sigBytes,r=this._S=[],o=0;o<256;o++)r[o]=o;o=0;for(var i=0;o<256;o++){var a=o%n,s=t[a>>>2]>>>24-a%4*8&255;i=(i+r[o]+s)%256;var u=r[o];r[o]=r[i],r[i]=u}this._i=this._j=0},_doProcessBlock:function(e,t){e[t]^=o.call(this)},keySize:8,ivSize:0});function o(){for(var e=this._S,t=this._i,n=this._j,r=0,o=0;o<4;o++){n=(n+e[t=(t+1)%256])%256;var i=e[t];e[t]=e[n],e[n]=i,r|=e[(e[t]+e[n])%256]<<24-8*o}return this._i=t,this._j=n,r}e.RC4=t._createHelper(r);var i=n.RC4Drop=r.extend({cfg:r.cfg.extend({drop:192}),_doReset:function(){r._doReset.call(this);for(var e=this.cfg.drop;e>0;e--)o.call(this)}});e.RC4Drop=t._createHelper(i)}(),
/** @preserve
             * Counter block mode compatible with  Dr Brian Gladman fileenc.c
             * derived from CryptoJS.mode.CTR
             * Jan Hruby jhruby.web@gmail.com
             */
s.mode.CTRGladman=function(){var e=s.lib.BlockCipherMode.extend();function t(e){if(255==(e>>24&255)){var t=e>>16&255,n=e>>8&255,r=255&e;255===t?(t=0,255===n?(n=0,255===r?r=0:++r):++n):++t,e=0,e+=t<<16,e+=n<<8,e+=r}else e+=1<<24;return e}var n=e.Encryptor=e.extend({processBlock:function(e,n){var r=this._cipher,o=r.blockSize,i=this._iv,a=this._counter;i&&(a=this._counter=i.slice(0),this._iv=void 0),function(e){0===(e[0]=t(e[0]))&&(e[1]=t(e[1]))}(a);var s=a.slice(0);r.encryptBlock(s,0);for(var u=0;u<o;u++)e[n+u]^=s[u]}});return e.Decryptor=n,e}(),function(){var e=s,t=e.lib.StreamCipher,n=e.algo,r=[],o=[],i=[],a=n.Rabbit=t.extend({_doReset:function(){for(var e=this._key.words,t=this.cfg.iv,n=0;n<4;n++)e[n]=16711935&(e[n]<<8|e[n]>>>24)|4278255360&(e[n]<<24|e[n]>>>8);var r=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],o=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];for(this._b=0,n=0;n<4;n++)u.call(this);for(n=0;n<8;n++)o[n]^=r[n+4&7];if(t){var i=t.words,a=i[0],s=i[1],c=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),l=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),d=c>>>16|4294901760&l,f=l<<16|65535&c;for(o[0]^=c,o[1]^=d,o[2]^=l,o[3]^=f,o[4]^=c,o[5]^=d,o[6]^=l,o[7]^=f,n=0;n<4;n++)u.call(this)}},_doProcessBlock:function(e,t){var n=this._X;u.call(this),r[0]=n[0]^n[5]>>>16^n[3]<<16,r[1]=n[2]^n[7]>>>16^n[5]<<16,r[2]=n[4]^n[1]>>>16^n[7]<<16,r[3]=n[6]^n[3]>>>16^n[1]<<16;for(var o=0;o<4;o++)r[o]=16711935&(r[o]<<8|r[o]>>>24)|4278255360&(r[o]<<24|r[o]>>>8),e[t+o]^=r[o]},blockSize:4,ivSize:2});function u(){for(var e=this._X,t=this._C,n=0;n<8;n++)o[n]=t[n];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<o[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<o[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<o[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<o[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<o[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<o[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<o[6]>>>0?1:0)|0,this._b=t[7]>>>0<o[7]>>>0?1:0,n=0;n<8;n++){var r=e[n]+t[n],a=65535&r,s=r>>>16,u=((a*a>>>17)+a*s>>>15)+s*s,c=((4294901760&r)*r|0)+((65535&r)*r|0);i[n]=u^c}e[0]=i[0]+(i[7]<<16|i[7]>>>16)+(i[6]<<16|i[6]>>>16)|0,e[1]=i[1]+(i[0]<<8|i[0]>>>24)+i[7]|0,e[2]=i[2]+(i[1]<<16|i[1]>>>16)+(i[0]<<16|i[0]>>>16)|0,e[3]=i[3]+(i[2]<<8|i[2]>>>24)+i[1]|0,e[4]=i[4]+(i[3]<<16|i[3]>>>16)+(i[2]<<16|i[2]>>>16)|0,e[5]=i[5]+(i[4]<<8|i[4]>>>24)+i[3]|0,e[6]=i[6]+(i[5]<<16|i[5]>>>16)+(i[4]<<16|i[4]>>>16)|0,e[7]=i[7]+(i[6]<<8|i[6]>>>24)+i[5]|0}e.Rabbit=t._createHelper(a)}(),s.mode.CTR=function(){var e=s.lib.BlockCipherMode.extend(),t=e.Encryptor=e.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,o=this._iv,i=this._counter;o&&(i=this._counter=o.slice(0),this._iv=void 0);var a=i.slice(0);n.encryptBlock(a,0),i[r-1]=i[r-1]+1|0;for(var s=0;s<r;s++)e[t+s]^=a[s]}});return e.Decryptor=t,e}(),function(){var e=s,t=e.lib.StreamCipher,n=e.algo,r=[],o=[],i=[],a=n.RabbitLegacy=t.extend({_doReset:function(){var e=this._key.words,t=this.cfg.iv,n=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],r=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];this._b=0;for(var o=0;o<4;o++)u.call(this);for(o=0;o<8;o++)r[o]^=n[o+4&7];if(t){var i=t.words,a=i[0],s=i[1],c=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),l=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),d=c>>>16|4294901760&l,f=l<<16|65535&c;for(r[0]^=c,r[1]^=d,r[2]^=l,r[3]^=f,r[4]^=c,r[5]^=d,r[6]^=l,r[7]^=f,o=0;o<4;o++)u.call(this)}},_doProcessBlock:function(e,t){var n=this._X;u.call(this),r[0]=n[0]^n[5]>>>16^n[3]<<16,r[1]=n[2]^n[7]>>>16^n[5]<<16,r[2]=n[4]^n[1]>>>16^n[7]<<16,r[3]=n[6]^n[3]>>>16^n[1]<<16;for(var o=0;o<4;o++)r[o]=16711935&(r[o]<<8|r[o]>>>24)|4278255360&(r[o]<<24|r[o]>>>8),e[t+o]^=r[o]},blockSize:4,ivSize:2});function u(){for(var e=this._X,t=this._C,n=0;n<8;n++)o[n]=t[n];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<o[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<o[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<o[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<o[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<o[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<o[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<o[6]>>>0?1:0)|0,this._b=t[7]>>>0<o[7]>>>0?1:0,n=0;n<8;n++){var r=e[n]+t[n],a=65535&r,s=r>>>16,u=((a*a>>>17)+a*s>>>15)+s*s,c=((4294901760&r)*r|0)+((65535&r)*r|0);i[n]=u^c}e[0]=i[0]+(i[7]<<16|i[7]>>>16)+(i[6]<<16|i[6]>>>16)|0,e[1]=i[1]+(i[0]<<8|i[0]>>>24)+i[7]|0,e[2]=i[2]+(i[1]<<16|i[1]>>>16)+(i[0]<<16|i[0]>>>16)|0,e[3]=i[3]+(i[2]<<8|i[2]>>>24)+i[1]|0,e[4]=i[4]+(i[3]<<16|i[3]>>>16)+(i[2]<<16|i[2]>>>16)|0,e[5]=i[5]+(i[4]<<8|i[4]>>>24)+i[3]|0,e[6]=i[6]+(i[5]<<16|i[5]>>>16)+(i[4]<<16|i[4]>>>16)|0,e[7]=i[7]+(i[6]<<8|i[6]>>>24)+i[5]|0}e.RabbitLegacy=t._createHelper(a)}(),s.pad.ZeroPadding={pad:function(e,t){var n=4*t;e.clamp(),e.sigBytes+=n-(e.sigBytes%n||n)},unpad:function(e){var t=e.words,n=e.sigBytes-1;for(n=e.sigBytes-1;n>=0;n--)if(t[n>>>2]>>>24-n%4*8&255){e.sigBytes=n+1;break}}},s)}(t={exports:{}}),t.exports}();return function(){function t(n){e(this,t);var r=n.isArray,o=n.isMap,i=n.isDevMode;this._isArray=r,this._isMap=o,this._isDevMode=i,this._interceptProfanityList=[],this._interceptFilter=null,this._interceptRegExpList=[],this._replacingProfanityMap=new Map,this._replacingFilter=null,this._replacingRegExpMap=new Map,this._key="",this._iv="",this._decryptOptions=void 0,this._n="TIMProfanityFilterPlugin",!0===i&&console.log("".concat(this._n,".VERSION:").concat("1.1.0"))}return n(t,[{key:"onToken",value:function(e){this._key=h.enc.Utf8.parse(e.slice(0,32)),this._iv=this._key,this._decryptOptions={iv:this._iv,mode:h.mode.CBC,padding:h.pad.Pkcs7}}},{key:"onLexiconSliced",value:function(e){if(this._isArray(e)&&0!==e.length){var t,n,r,o=c(e);try{for(o.s();!(r=o.n()).done;){var i=r.value,a=i.filterType,s=i.profanityType,u=i.profanity,l=i.replacement;t=this._getDecryptedString(u),n=this._getDecryptedString(l),1===a?1===s?this._interceptProfanityList.push(t):2===s&&this._interceptRegExpList.push(t):2===a&&(1===s?this._replacingProfanityMap.set(t,n):2===s&&this._replacingRegExpMap.set(t,n))}}catch(p){o.e(p)}finally{o.f()}}}},{key:"_getDecryptedString",value:function(e){var t=h.AES.decrypt(e,this._key,this._decryptOptions);return h.enc.Utf8.stringify(t).toLowerCase()}},{key:"onLexiconCompleted",value:function(e){this.onLexiconSliced(e),this._interceptFilter=new d({input:this._interceptProfanityList,isArray:this._isArray,isMap:this._isMap}),this._replacingFilter=new d({input:this._replacingProfanityMap,isArray:this._isArray,isMap:this._isMap}),!0===this._isDevMode&&(console.log("".concat(this._n," _interceptProfanityList ->"),this._interceptProfanityList),console.log("".concat(this._n," _interceptRegExpList ->"),this._interceptRegExpList),console.log("".concat(this._n," _replacingProfanityMap ->"),this._replacingProfanityMap),console.log("".concat(this._n," _replacingRegExpMap ->"),this._replacingRegExpMap))}},{key:"filter",value:function(e){var t={type:0,modifiedText:e};if("string"!=typeof e)return!0===this._isDevMode&&console.warn("".concat(this._n,".filter invalid params, string required!")),t;if(!0===this._interceptFilter.filter({text:e,replacingEnabled:!1}).isMatched)return t.type=1,t;for(var n=!1,r=0,i=this._interceptRegExpList.length;r<i;r++)if(new RegExp(this._interceptRegExpList[r],"gi").test(e.toLowerCase())){n=!0;break}if(n)return t.type=1,t;var a=this._replacingFilter.filter({text:e,replacingEnabled:!0});!0===a.isMatched&&(t.type=2,t.modifiedText=a.modifiedText);var s,u=t.modifiedText,l=null,d=c(this._replacingRegExpMap);try{for(d.s();!(s=d.n()).done;){var f=o(s.value,2),p=f[0],h=f[1];l=new RegExp(p,"gi"),u=u.replace(l,h)}}catch(g){d.e(g)}finally{d.f()}return u!==e&&(t.type=2,t.modifiedText=u),t}},{key:"reset",value:function(){this._isArray=null,this._isMap=null,this._interceptProfanityList.length=0,this._interceptRegExpList.length=0,this._replacingProfanityMap.clear(),this._replacingRegExpMap.clear(),this._key="",this._iv="",this._decryptOptions={},this._interceptFilter&&this._interceptFilter.reset(),this._replacingFilter&&this._replacingFilter.reset()}}]),t}()}))}).call(this,n("c8ba"))},"0f14":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlYAAAIECAMAAADsPZDRAAAAyVBMVEUAAACiuf/0+P30+P71+P55nf90mP/a5f/Gy//19//0+f70+P6Kqf/1+f+ZtP9mjv+Co//1+P6Hpv+Prf/0+P/1+f+Usf/0+P+et//W4/9tlP/0+P66zv71+P31+P/0+P5Vgf/Y6v7////k8P60yP7d5P+3x/+Lpv/o8v7r8/7h7v7w9v7y9/7b6/7d7P73+P9ki//K1f9ylP9/nf+it//u8v/l6/+Xrv/l8f7f7f6tv//T3P/t9P7Azv/v9f7z+P7n8v7c7P5ahf+WwQEhAAAAH3RSTlMAIYi0w+nxEgYf8OO+fnD72afJqnFQklxULPfTz5FmptxUUQAAFddJREFUeNrs3N1q4lAUhuFNLfhHDgRFSmkXG09MSHKcQkC8/5uaH6cjOCkz0+xV/LLf5xpe1touxQB8gcXTbls8AP+q2O6e/tLUfrYy4H+tNrtF+MC8oCl81rqYhyGvRIUx1vuBUTUzYJzN7cBarg0Y63lJVUhvvaQqpPd83YOLRwPSmIV3hQGpvL6vQC4LSGf1aw1uDEjn5TKsagNSjiteVkhvG77juIC0Hn/sQAOSquch7A1IaxfCgwFpbTkvIL2XEPhBDFLbhMD3gUhtRlYwsoICsoIZWUEBWcGMrKCArGBGVlBAVjAjKyggK5iRFRSQFczICgrICmZkBQVkBTOyggKyghlZQYFwVqe+q9omTlbTVl0v+q8rqlnVZRWzUJWKZWlmVXcTnlK3mk4vLMWsTl3MTHcyLYJZ9eeYnXNvUvSyym5UXXSmRC2rOpOX+p8qpReWWFb1W8zWm1BXWlnlXJVUV1pZZbsBLypTIZVVpq91wXe7UlZ9zJ7KnUEoq1OG96pbZ5G7qFBW2a9AoTWok1UdEWOj8WlQJyuGldC4ksmqzug3C/rjSiarMuKn0gTIZJX5JVTsJqqSFQ/23xRuDCpZ9fED1WGiKuWTqEpWXRx0kHjAfk590P0sqJJVFYccbdKOso8rlazawVllEzc4r1q7fypZNXHAhDfgRR0HNHb/VLJS3QYjVXGA3T/lrCa/A80OZOWIrMjKAVmRlQOyIisHZEVWDsiKrByQFVk5ICuyckBWZOWArMjKAVmRlQOyIisHZEVWDsiKrByQFVk5ICuyckBWZOWArMjKAVmRlQOyIisHZEVWDsiKrByQFVk5ICuyckBWZOWArMjKAVmRlQOyIisHZEVWDnyyOvorbQyy8uWTVfTX2hhk5YusrsgqGbK6IqtkyOqKrL6xc8emDQQADEVHOUIqE48Q8P5buVR1zVnCHLw/w2ulWlglrGphlbCqhVXCqhZWCataWCWsamGVsKqFVcKqFlYJq1pYJaxqYZWwqoVVwqoWVgmrWlglrGphlbCqhVXCqhZWCataG1aPff/HJ2G1zaALq0FYYTUIK6wGYYXVIKywGoQVVoOwwmoQVlgNwgqrQVhhNQgrrAZhhdUgrLAahBVWg7DCahBWWA3CCqtBWGE1CCusBmGF1SCssBqEFVaDsMJqEFZYDcIKq0FYYTUIK6wGYYXVIKywGnSF1d9NOs7DatsFVs+fm/Q8TsNqG1YJq1pYJaxqYZWwqoVVwqoWVgmrWlglrGphlbCqhVXCqhZWCataWCWsamGVsKqFVcKqFlYJq1pYJaxqYZWwqoVVwqoWVgmrWlglrGphlbCqdYXV703C6msZdGE1CCusBmGF1SCssBqEFVaDsMJqEFZYDcIKq0FYYTUIK6wGYYXVIKywGoQVVoOwwmoQVlgNwgqrQVhhNQgrrAZhhdUgrLAahBVWg7DCahBWWA3CCqtBWGE1CCusBmGF1SCssBp0gdXrcZNex2lYbXNElLCqhVXCqhZWCataWCWsamGVsHqzdwe7jcJQGIUfxbLYAMZZYwkR+v4vNbOprJkGjF3/k9vROVJ3RW2kT44xdtItWOVg1S1Y5WDVLVjlYNUtWOVg1S1Y5WDVLVjlYNUtWOVg1S1Y5WDVLVjlYNUtWOVg1S1Y5WDVLVjlYNUtWOVg1S1Y5WDVLVjlYNWtBlbP8YfEEYm3xYEuWAmCFawEwQpWgmAFK0GwgpUgWMFKEKxgJQhWsBIEK1gJghWsBMEKVoJgBStBsIKVIFjBShCsYCUIVrASBCtYCYIVrATBClaCYAUrQbCClSBYwUoQrGAlCFawEgQrWAmCFawEwQpWgn4Oq7CNxzAM8++fY9yC+1aw0vYjWC3TkKL/s5iGaXGtwUqbfVbhSP6sdATXFKy0GWf1nJK/LjWNWbDSZprVskZfLq71sGClzTCrjKo/LFhps8tqjP5+cXRVwUqbVVYh+brS7iqClTajrEZf3+HuByttJlkts28pLe5usNJmkdUefVtxdzeDlTaDrLbom5vcvWClzR6ryX+n0d0KVtrMsRp9TucKVtqssZp8TugKVtqMsdp8Tjm/gpU2W6z26Du0u2Kw0maK1RJ9j+LiSsFKmylWs+9TcqVgpc0Sq9H3anWFYKXNEKvgc+rpFay0GWKV/HUfw7HtIYR9G4for3u462ClzQ6r8drJX7vWw/H4zuoVrLSZYXV5Fzhv7mtbar8bhJU2M6zWi5Fqc6/bPnyu6iXASpsVVheD1fp0Zz2Hxu+Vh5U2K6xWf1Lc3FVbbBquYKXNCKtnPFMV3HV7bJldwUqbEVZTrapciA03g7DSZoRValZ17iq582ClzQar4F+3uXLnu2kuTMJKmw1WR8ujvdxafTmstNlglfyrHk93r+ej9gkOrLSZYLW0vQXmttqlK1hpM8Fq8q+a3f3myu3HsNLWwmqNtY3usqE4WD3i12aX2ytXRGGlrYXV0Ps0TCrOjGLpF1Ld5ApW2kywiqVP6iizGv2rnu4kWGmzwCoUV53KrJa6TaKw0maB1eZf9OFyN1i5R9WcHVbaLLAay/9CmdVQ9Xdhpc0Cq6N8SZnVWLXODittFlgN5bXQMqut6nXASptZVrvL3WEVqlZUYaXNLKvgcndYLbAy1ftZzaXnebD6DFYVrBit7gYr5laCYPWP7wR37gRN9X5Wa491qwlWpno/K1bZbwermmeCRTRlVolngqZ6P6tQ2jHMDobPYFVklSteU2Y1sd/KVgZYpdLp0TKrmd2htqpndTxqm9xlQ/EdLD2+NrtcYC+7sf6LkzdD5SAJK20mWC2+MFyVCrWn5WGlzQSrk1PN6f71nGr+xd4d5LYNA1EYzqY9RYCXgbqQKFJrETBk+/6Xqt0WRYBIjiV7gHnW+9bJ7jc5oAAymghZnR57bavVHQzhRMiqt0e2wWn9fysrXzGyeuh+q3xefze7svIVJKvO5g0Z38mDbuMLKERWuSx11eO2XHV3aEQhssK48bX4/qybjkOKkVUum778tLaoxw3KyleUrDDaojphXp/0ikRUQbLKxZY1Pb7qG715E1eQrNDaLanL+Cx3yW454SZl5StOVqh2Wx27KWfkPHXjzN+uus1WWfkKlNVkn+n10znKar2TfaK3mucoqw2q/aeX5Wcpqw1ysXU2f0lUVr5CZfWk8eqAbykrX7GyQmeP6/A9ZeUrWFZo7VEt7qCsfEXL6uGuTriHsvIVLiu0/msVoKx8xcsKnftcBSgrXwGzwlRsm3LAnZSVr4hZIVfbova4l7LyFTIrYLT1xiPupqx8Bc0K02DrDBNWUFa+omYFtMXuV05HrKGsfMXNCrmxezUZ6ygrX4GzuoZV7Hul6bGWsvIVOisgt4PdNpwy1lNWvoJndTGNy2WdmwmbKCtf8bO66Nt0/ppUantspax8UWR1lafu1KRUa02pGbsp4xHKyhdNVs+lrHwpK2XlQFkpKwfKSlk5UFbKyoGyUlYubEbFy6vKylWxGT1eXG8zCuJjyWqwGQkvLrEu0ixZJdvhdNUY64+JJatx8WbFlzVVm3VCfCxZHWxBqekl1WILGH5JLFkdTf45Ij6WrJBMaEYrnqw6kz86EKDJKheTi8KwB/JkhdHkYgQDnqy0XF2VDAY8WWm5Yjm0AlVWx7Pt3kAxWVFlhYPtHsNRKMCVlbZBki2QLKu9n4lSnIResGWVq+1YJRmswJbVrruqHGcLF3RZIe92H0xEVdFltdu5neN0/S/GrHDY4fnV+QAqhFnhuLcFq4w8w/oVZ1ZAHnf0gbCMTFPVFWtWQO52Mrunji8q3qwu8mFMwwuvWmVI44GxKVBnJXEpKwGUlTBQVgIoK2GgrARQVsJAWQmgrISBshJAWQkDZSWAshIGykoAZSUMlJUAykoYKCsBlJUwUFYCKCthoKwEUFbCQFkJoKyEgbISQFkJA2UlgLISBspKAGUlDJSVAMpKGCgrATyyev8l8lzvb28/P0Se64eykg9lJQx+s0sHNAAAAAiDqrx/SnO4QQa0orTigVaUVjzQitKKB1pRWvFAK0orHmhFacUDrSiteKAVpRUPtKK04oFWlFY80IrSigdaUVrxQCtKK8auHe7ICUJhGL6VLycBfoKCmGjm/m+ri1BylENrbW1t4vNr4rqOju+iy/g/eLN6AW9Wr//B47PyM3aMGfE8ZjmxW0FrjZ1lxr201gF/3b/KKiilAk5ZyQ78jEUiuissIlIoNBEZnKXavZJXAjcS0YJb8CP66/5VVpqINM4YicgClSOiCRJvWr/U3+msvArusOTE6ROyGojIo8vF32yuzWq0Gvd7flbHNWciGiBR1NL4BaezinQYQbGeGNrarJwliugaYz7U65qsXCSKHnd7fFbOHq4uHyKaIZGz0iQxEJzNqmxyNUBhxMHKSXt43FBA10JfokM26h+ArMkqUKJxs8dntRwHp0hEDq27s+LmlTbKY+MmEk27Ia3JarRE1uzM4IKlOrikdPvQc+zdx23HR9zq8VlNebBSFX1ROwFV3ip/eUNWyTjQZtgK/1DHBKbJaqCW8mB86sqmRX8qK7jtXe2MOz09q1A+Furh2+lmFRU3/YGsaliq7KQsgDlmJXcygKtd/WZWXLC3XwgfnpWz+dxezkqqQ1/ISjKmSjzgbV1zqRMGGJvB6phVJMkIhncl72lffz0fc7/3eXhWunwqaK6BTEBxY1ay2epy4j9I+Jzapxmsalb82Li1Pdl881w/K7WXomw+L7fePFw9O6vRHud1RiJa0fHXs4IDvK27xEcoZ/lgpbK0ajmzMESHg5tTAg5H3ratoZ8V/ZQGMNCKGz07q/bPt1xlZPdmJfN8EmCgOvuh86uCDnTKLomonO0cm2+r+u2ssDjc6NFZze29xpqXyC5l5eZhAYp+VtpB5m2tylNiPQAX2ZaErNLPadpd3qJYiuw3s7rdk7PKs0HYqZcWWTpXKjuZlePfDfWzmsmKYbkweuWQRdrYrftx8ajUJlK9CA5pT51iQ9ogXwJll2/ZzZvVQAk4U/++ZcScywoDu7XuZ7XWtRgXViK925Lylsj6/kFTfWU9xrxyPViPk96sJKeyCrRpfm1Gz6WsDJ8IkLOq33dz4xL380xDHqjm/mSjqjvlbK7U5LxKVQFnvVlJzmTlbc2KfkahSK91djYrxJqqlJW8u17Hw3u7gcr6gb6sDi02wT+XhkLuSqjK6Mrg6M1Kprt9FC7Shayu/CcY6gb6WVn+ReQ8TFTYoQRpphoG5rS2XXBkKCk3UAbZJy2JbVXQwj12UEp5fHmzkpzIaqUv9s6sqvqMRDerwC92oWmqfJFjAzK/NWb1iJ0PZau4NIATsuK79GYl+XlW23n6qJyV/m5KC3UrILuW1adG08tq4tMa476p+jxD9EDhhhLQwsuKlNjD5JRTlHyw82Z1iWZTAcwHSakqImdV8AdDZRezGuuVSc6qDFZV5E35wUqzQWaijfX8bRJdZiCKeaJscNgZzWZ5szrtp7fsaz7Tu6z4g6Gyi1lhrdPbclZx/7+/mcGsOYoRByHS/tcW2mBi72EUJanMzsSY6Wc16Qodb1Y7zpL14vNJM/quZjXXUVDMypSlMjfRJAYBM1iNKsWZSsNcIkaNaoGmXlj9rDh0vFl9Y+/cdiQFgQD6KxUSqEcRAROM//9b25MiBJvCVZTZcafPw1zagdbpY1Ncin4/bqHQiiL4Os3L+Bw9UtFK0g81cIIqmSbTq2q6HkkSWxkDMPN11MeIbVvZSa1QnEBCP36qVmABuGVvC+wiMg5rlYJ2XquZfwms2ofpBwa6npdgaFSMqRwCYYf4wIqQ6KnVAv34sVq92GpFL/6KbwTIaNSKomkNvFaVxaRS7FGWeVlj4vUs3gvCWUhoRWJtk3HweMh+Rqtfvd5qq5UTHB4hwWllJccEGzwNHHFaWfbGPq2VzXq2WEhF6OCKIaxTWk2SYJfx5fiPVgRzKzL39ldjhsSpf1ygehitNI1Z8ecmazgufLPxeuL4iZyhxC5vk4945wBDAjtnUz9Iq7FilYZEEbIfhFpBw2n19XWsndvu5RUhkk5ljHAKebS2ARK9tApUUTcepBUWDMUSpUatqBUMjFamsgqq0GqRMtnHaCVfcmZlDIA60nT20kp9tKoyFjkp7VoFMc7AaaUGoQ6cm84jsPJlm+n3rMy/1WqNLXsvHqzVWix8O6aVAQZdnbzR65Fzm/NgpdDqK0Dz8IO0ohPpx3O1suW0f1Ur78ZA3mjr6+/+jFZHz20kxdmyKbmLytSrV9+mlaeOQTceqxVn1btWI6oAsJminulHnnatUvoWX9bT0UtaabhRq96D7E/TatLxO5uXm7TCWWUzFCH7W7nTtW7XyqalLWxZpDvgilaT1/dpZXonNT9MKzsMAYBWJNeSMpV0IjEAbFcgTDsJLs1apcGtWllJtbZrFV5i3qfV/Lv3YOD2gxLSkFUetqBaJDufOm0avrH+zM1arSQ56lrZmaxu1UovdAl3aUV7hHXkWVrRPP8QHA2DbkGRkS+CGjftnqEEGY5WrSxV+dJ3sbpetlmrhRIM9U1a0TTY781qLrTKuuVOwzvpkFTzBOkJ3kc0x2pgcUqrtGsx9R4CtYTRLIOIGgratCJWgGtaGTqluCTaQ0+eplVamDRxf+2ksghEfIKy1YsTNQxNOx3rNfYeZp+lTnA0aRVinTPARa30IDIC9ORxWtG9xuY28wPuWMTo1berFq2sE6k6E5wg3Mp426QVueqpumuN4FrMpHbjW7Ra+Sl+J1kgUWhF2OHAPyZp5QuBTRLt6npKbd3GccqYIMpt50utRrVBllrNWfrEVa1QEFRhV75FKynOAImKVjEPz01QJ2m18pvikWmXtDJhoYfdDBm0mJhbmt4weTMNKf9Q7AM8uVYaEYNSasbuUj1SK9AyxVdVSJ2Zn2eLqrVqZWa1DFV5wKxD1hdNnNdKu3T7tGn1X3+KxO1aUXy0NwlPWtV2SHRp3GaSJ6CK0OcxitXAYX2Zq1xq5fcX/2WbZ320upG6VhD2d1iJWi18V1pd6gpJEZFhx2ssthJsCdknqYFQ+wDLRyuG/RUMu1alRnDghj6NUwZaoTZ0UQh/wYxOQ0aDVlf5aMUxIWL9IOwSN/AxE9yOPRrzasjZfvAbljlfNIh6J7/tg98+/GHPDk4YhoEgis4liQ7GETEI4dOUkBrcf1ExwocUMBeZ/2r4sLvszZEVbLLCDMgKNllhBmQFm6wwA7KCTVaYAVnBJivMgKwwxLN6GMiqUjWQ9ZEWA1mbtBrI6tLrMJD0LWJnR1rVqRlIWnUqbwM5u4bNQE7TUHYDKU9dOscgUo4uiTGIrCZd+OAgZdGfQlf4tWfHKADCQBBFJ0XQYtnAWtl5BM/g/Q9lK0ZRY8r/DjEw/B5CR6RB9DDpzNcF+KO4aik4hGi32aBLc7BYaFMs6dbolmk5+KZkcz1LwHuq7d7nfmggAt/IAAAAAElFTkSuQmCC"},"0f88":function(e,t,n){"use strict";var r=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n("970b")),i=r(n("5bc3")),a=r(n("9523")),s=function(){function e(){(0,o.default)(this,e),(0,a.default)(this,"chatType",void 0),this.chatType=""}return(0,i.default)(e,[{key:"setChatType",value:function(e){this.chatType=e}},{key:"getChatType",value:function(){return this.chatType}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();(0,a.default)(s,"instance",void 0);var u=s.getInstance();t.default=u},1056:function(e,t,n){e.exports=n.p+"static/img/setting.b7c6be32.svg"},1106:function(e){e.exports=JSON.parse('{"uni-load-more.contentdown":"上拉顯示更多","uni-load-more.contentrefresh":"正在加載...","uni-load-more.contentnomore":"沒有更多數據了"}')},"11b0":function(e,t){e.exports=function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},e.exports.__esModule=!0,e.exports["default"]=e.exports},"13aa":function(e,t,n){"use strict";var r=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n("9523")),i=r(n("32ed")),a=r(n("b9f3"));function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){(0,o.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var c=u(u({},i.default),a.default),l=c;t.default=l},"146c":function(e,t,n){"use strict";var r=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n("66fd")),i=r(n("26cb")),a=r(n("6b1b"));o.default.use(i.default);var s=n("755b"),u=s.keys().reduce((function(e,t){var n=t.replace(/^\.\/(.*)\.\w+$/,"$1"),r=s(t);return e[n]=r.default,e}),{}),c=new i.default.Store({state:{},modules:u,getters:a.default});t.default=c},1815:function(e,t,n){"use strict";(function(r,o,i){var a,s,u=n("7037");!function(r,o){"object"==u(t)&&"undefined"!=typeof e?e.exports=o():(a=o,s="function"===typeof a?a.call(t,n,t,e):a,void 0===s||(e.exports=s))}(0,(function(){function e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function t(t){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?e(Object(r),!0).forEach((function(e){l(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):e(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function n(e){return(n="function"==typeof Symbol&&"symbol"==u(Symbol.iterator)?function(e){return u(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":u(e)})(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function h(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function g(e,t,n){return(g=h()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&p(o,n.prototype),o}).apply(null,arguments)}function v(e){var t="function"==typeof Map?new Map:void 0;return(v=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return g(e,arguments,f(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),p(r,e)})(e)}function _(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e,t){if(t&&("object"==u(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return m(e)}function I(e){var t=h();return function(){var n,r=f(e);if(t){var o=f(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return y(this,n)}}function M(e,t){return S(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(f){s=!0,o=f}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||C(e,t)||b()}function T(e){return function(e){if(Array.isArray(e))return k(e)}(e)||E(e)||C(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(e){if(Array.isArray(e))return e}function E(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function C(e,t){if(e){if("string"==typeof e)return k(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?k(e,t):void 0}}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function b(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function D(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=C(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}var A={SDK_READY:"sdkStateReady",SDK_NOT_READY:"sdkStateNotReady",SDK_DESTROY:"sdkDestroy",MESSAGE_RECEIVED:"onMessageReceived",ROOM_CUSTOM_DATA_RECEIVED:"onRoomCustomDataReceived",MESSAGE_MODIFIED:"onMessageModified",MESSAGE_REVOKED:"onMessageRevoked",MESSAGE_READ_BY_PEER:"onMessageReadByPeer",MESSAGE_READ_RECEIPT_RECEIVED:"onMessageReadReceiptReceived",MESSAGE_EXTENSIONS_UPDATED:"onMessageExtensionsUpdated",MESSAGE_EXTENSIONS_DELETED:"onMessageExtensionsDeleted",MESSAGE_REACTIONS_UPDATED:"onMessageReactionsUpdated",CONVERSATION_LIST_UPDATED:"onConversationListUpdated",TOTAL_UNREAD_MESSAGE_COUNT_UPDATED:"onTotalUnreadMessageCountUpdated",CONVERSATION_GROUP_LIST_UPDATED:"onConversationGroupListUpdated",CONVERSATION_IN_GROUP_UPDATED:"onConversationInGroupUpdated",GROUP_LIST_UPDATED:"onGroupListUpdated",GROUP_ATTRIBUTES_UPDATED:"groupAttributesUpdated",GROUP_COUNTER_UPDATED:"onGroupCounterUpdated",TOPIC_CREATED:"onTopicCreated",TOPIC_DELETED:"onTopicDeleted",TOPIC_UPDATED:"onTopicUpdated",PROFILE_UPDATED:"onProfileUpdated",USER_STATUS_UPDATED:"onUserStatusUpdated",BLACKLIST_UPDATED:"blacklistUpdated",FRIEND_LIST_UPDATED:"onFriendListUpdated",FRIEND_GROUP_LIST_UPDATED:"onFriendGroupListUpdated",FRIEND_APPLICATION_LIST_UPDATED:"onFriendApplicationListUpdated",KICKED_OUT:"kickedOut",ERROR:"error",NET_STATE_CHANGE:"netStateChange"},O={MSG_TEXT:"TIMTextElem",MSG_IMAGE:"TIMImageElem",MSG_SOUND:"TIMSoundElem",MSG_AUDIO:"TIMSoundElem",MSG_FILE:"TIMFileElem",MSG_FACE:"TIMFaceElem",MSG_VIDEO:"TIMVideoFileElem",MSG_GEO:"TIMLocationElem",MSG_LOCATION:"TIMLocationElem",MSG_GRP_TIP:"TIMGroupTipElem",MSG_GRP_SYS_NOTICE:"TIMGroupSystemNoticeElem",MSG_CUSTOM:"TIMCustomElem",MSG_MERGER:"TIMRelayElem",MSG_PRIORITY_HIGH:"High",MSG_PRIORITY_NORMAL:"Normal",MSG_PRIORITY_LOW:"Low",MSG_PRIORITY_LOWEST:"Lowest",CONV_C2C:"C2C",CONV_GROUP:"GROUP",CONV_TOPIC:"TOPIC",CONV_SYSTEM:"@TIM#SYSTEM",CONV_AT_ME:1,CONV_AT_ALL:2,CONV_AT_ALL_AT_ME:3,CONV_MARK_TYPE_STAR:1,CONV_MARK_TYPE_UNREAD:2,CONV_MARK_TYPE_FOLD:4,CONV_MARK_TYPE_HIDE:8,GRP_PRIVATE:"Private",GRP_WORK:"Private",GRP_PUBLIC:"Public",GRP_CHATROOM:"ChatRoom",GRP_MEETING:"ChatRoom",GRP_AVCHATROOM:"AVChatRoom",GRP_COMMUNITY:"Community",GRP_MBR_ROLE_OWNER:"Owner",GRP_MBR_ROLE_ADMIN:"Admin",GRP_MBR_ROLE_MEMBER:"Member",GRP_MBR_ROLE_CUSTOM:"Custom",GRP_TIP_MBR_JOIN:1,GRP_TIP_MBR_QUIT:2,GRP_TIP_MBR_KICKED_OUT:3,GRP_TIP_MBR_SET_ADMIN:4,GRP_TIP_MBR_CANCELED_ADMIN:5,GRP_TIP_GRP_PROFILE_UPDATED:6,GRP_TIP_MBR_PROFILE_UPDATED:7,GRP_TIP_BAN_AVCHATROOM_MEMBER:10,GRP_TIP_UNBAN_AVCHATROOM_MEMBER:11,MSG_REMIND_ACPT_AND_NOTE:"AcceptAndNotify",MSG_REMIND_ACPT_NOT_NOTE:"AcceptNotNotify",MSG_REMIND_DISCARD:"Discard",GENDER_UNKNOWN:"Gender_Type_Unknown",GENDER_FEMALE:"Gender_Type_Female",GENDER_MALE:"Gender_Type_Male",KICKED_OUT_MULT_ACCOUNT:"multipleAccount",KICKED_OUT_MULT_DEVICE:"multipleDevice",KICKED_OUT_USERSIG_EXPIRED:"userSigExpired",KICKED_OUT_REST_API:"REST_API_Kick",ALLOW_TYPE_ALLOW_ANY:"AllowType_Type_AllowAny",ALLOW_TYPE_NEED_CONFIRM:"AllowType_Type_NeedConfirm",ALLOW_TYPE_DENY_ANY:"AllowType_Type_DenyAny",FORBID_TYPE_NONE:"AdminForbid_Type_None",FORBID_TYPE_SEND_OUT:"AdminForbid_Type_SendOut",JOIN_OPTIONS_FREE_ACCESS:"FreeAccess",JOIN_OPTIONS_NEED_PERMISSION:"NeedPermission",JOIN_OPTIONS_DISABLE_APPLY:"DisableApply",JOIN_STATUS_SUCCESS:"JoinedSuccess",JOIN_STATUS_ALREADY_IN_GROUP:"AlreadyInGroup",JOIN_STATUS_WAIT_APPROVAL:"WaitAdminApproval",INVITE_OPTIONS_DISABLE_INVITE:"DisableInvite",INVITE_OPTIONS_NEED_PERMISSION:"NeedPermission",INVITE_OPTIONS_FREE_ACCESS:"FreeAccess",GRP_PROFILE_OWNER_ID:"ownerID",GRP_PROFILE_CREATE_TIME:"createTime",GRP_PROFILE_LAST_INFO_TIME:"lastInfoTime",GRP_PROFILE_MEMBER_NUM:"memberNum",GRP_PROFILE_MAX_MEMBER_NUM:"maxMemberNum",GRP_PROFILE_JOIN_OPTION:"joinOption",GRP_PROFILE_INVITE_OPTION:"inviteOption",GRP_PROFILE_INTRODUCTION:"introduction",GRP_PROFILE_NOTIFICATION:"notification",GRP_PROFILE_MUTE_ALL_MBRS:"muteAllMembers",SNS_ADD_TYPE_SINGLE:"Add_Type_Single",SNS_ADD_TYPE_BOTH:"Add_Type_Both",SNS_DELETE_TYPE_SINGLE:"Delete_Type_Single",SNS_DELETE_TYPE_BOTH:"Delete_Type_Both",SNS_APPLICATION_TYPE_BOTH:"Pendency_Type_Both",SNS_APPLICATION_SENT_TO_ME:"Pendency_Type_ComeIn",SNS_APPLICATION_SENT_BY_ME:"Pendency_Type_SendOut",SNS_APPLICATION_AGREE:"Response_Action_Agree",SNS_APPLICATION_AGREE_AND_ADD:"Response_Action_AgreeAndAdd",SNS_CHECK_TYPE_BOTH:"CheckResult_Type_Both",SNS_CHECK_TYPE_SINGLE:"CheckResult_Type_Single",SNS_TYPE_NO_RELATION:"CheckResult_Type_NoRelation",SNS_TYPE_A_WITH_B:"CheckResult_Type_AWithB",SNS_TYPE_B_WITH_A:"CheckResult_Type_BWithA",SNS_TYPE_BOTH_WAY:"CheckResult_Type_BothWay",NET_STATE_CONNECTED:"connected",NET_STATE_CONNECTING:"connecting",NET_STATE_DISCONNECTED:"disconnected",MSG_AT_ALL:"__kImSDK_MesssageAtALL__",READ_ALL_C2C_MSG:"readAllC2CMessage",READ_ALL_GROUP_MSG:"readAllGroupMessage",READ_ALL_MSG:"readAllMessage",USER_STATUS_UNKNOWN:0,USER_STATUS_ONLINE:1,USER_STATUS_OFFLINE:2,USER_STATUS_UNLOGINED:3},R={NEW_INVITATION_RECEIVED:"newInvitationReceived",INVITEE_ACCEPTED:"ts_invitee_accepted",INVITEE_REJECTED:"ts_invitee_rejected",INVITATION_CANCELLED:"ts_invitation_cancelled",INVITATION_TIMEOUT:"ts_invitation_timeout",INVITATION_MODIFIED:"ts_invitation_modified",ACTION_TYPE_UNKNOWN:0,ACTION_TYPE_INVITE:1,ACTION_TYPE_CANCEL_INVITE:2,ACTION_TYPE_ACCEPT_INVITE:3,ACTION_TYPE_REJECT_INVITE:4,ACTION_TYPE_INVITE_TIMEOUT:5},N=function(){function e(){a(this,e),this.cache=[],this.options=null}return c(e,[{key:"use",value:function(e){if("function"!=typeof e)throw"middleware must be a function";return this.cache.push(e),this}},{key:"next",value:function(e){if(this.middlewares&&this.middlewares.length>0)return this.middlewares.shift().call(this,this.options,this.next.bind(this))}},{key:"run",value:function(e){return this.middlewares=this.cache.map((function(e){return e})),this.options=e,this.next()}}]),e}(),w=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;a(this,e),this.high=t,this.low=n}return c(e,[{key:"equal",value:function(e){return null!==e&&this.low===e.low&&this.high===e.high}},{key:"toString",value:function(){var e=Number(this.high).toString(16),t=Number(this.low).toString(16);if(t.length<8)for(var n=8-t.length;n;)t="0"+t,n--;return e+t}}]),e}(),L={TEST:{CHINA:{DEFAULT:"wss://wss-dev.tim.qq.com"},OVERSEA:{DEFAULT:"wss://wss-dev.tim.qq.com"},SINGAPORE:{DEFAULT:"wss://wsssgp-dev.im.qcloud.com"},KOREA:{DEFAULT:"wss://wsskr-dev.im.qcloud.com"},GERMANY:{DEFAULT:"wss://wssger-dev.im.qcloud.com"},IND:{DEFAULT:"wss://wssind-dev.im.qcloud.com"},JPN:{DEFAULT:"wss://wssjpn-dev.im.qcloud.com"},USA:{DEFAULT:"wss://wssusa-dev.im.qcloud.com"},INDONESIA:{DEFAULT:"wss://wssidn-dev.im.qcloud.com"}},PRODUCTION:{CHINA:{DEFAULT:"wss://wss.im.qcloud.com",BACKUP:"wss://wss.tim.qq.com",STAT:"https://events.im.qcloud.com",ANYCAST:"wss://162.14.13.203"},OVERSEA:{DEFAULT:"wss://wss.im.qcloud.com",BACKUP:"wss://wss.my-imcloud.com",STAT:"https://api.my-imcloud.com"},SINGAPORE:{DEFAULT:"wss://wsssgp.im.qcloud.com",BACKUP:"wss://wsssgp.my-imcloud.com",STAT:"https://apisgp.my-imcloud.com",ANYCAST:"wss://162.14.19.159"},KOREA:{DEFAULT:"wss://wsskr.im.qcloud.com",BACKUP:"wss://wsskr.my-imcloud.com",STAT:"https://apikr.my-imcloud.com",ANYCAST:"wss://162.14.13.104"},GERMANY:{DEFAULT:"wss://wssger.im.qcloud.com",BACKUP:"wss://wssger.my-imcloud.com",STAT:"https://apiger.my-imcloud.com",ANYCAST:"wss://162.14.3.17"},IND:{DEFAULT:"wss://wssind.my-imcloud.com",BACKUP:"wss://wssind.im.qcloud.com",STAT:"https://apiind.my-imcloud.com",ANYCAST:"wss://162.14.18.188"},JPN:{DEFAULT:"wss://wssjpn.im.qcloud.com",BACKUP:"wss://wssjpn.my-imcloud.com",STAT:"https://apijpn.my-imcloud.com"},USA:{DEFAULT:"wss://wssusa.im.qcloud.com",BACKUP:"wss://wssusa.my-imcloud.com",STAT:"https://apiusa.my-imcloud.com",ANYCAST:"wss://162.14.10.42"},INDONESIA:{DEFAULT:"wss://wssidn.im.qcloud.com",BACKUP:"wss://wssidn.my-imcloud.com",STAT:"https://apiidn.my-imcloud.com",ANYCAST:"wss://43.129.34.169"}}},P={ANDROID:2,IOS:3,MAC:4,WEB:7,WX_MP:8,QQ_MP:9,TT_MP:10,BAIDU_MP:11,ALI_MP:12,IPAD:13,UNI_NATIVE_APP:15},U="1.7.3",G=537048168,x="CHINA",F={HOST:{CURRENT:{DEFAULT:"wss://wss.im.qcloud.com",STAT:"https://events.im.qcloud.com"},setCurrent:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x;this.CURRENT=L.PRODUCTION[e]}},NAME:{OPEN_IM:"openim",OPEN_IM_MSG_EXT:"openim_msg_ext_http_svc",GROUP:"group_open_http_svc",GROUP_AVCHATROOM:"group_open_avchatroom_http_svc",GROUP_COMMUNITY:"million_group_open_http_svc",GROUP_ATTR:"group_open_attr_http_svc",FRIEND:"sns",PROFILE:"profile",RECENT_CONTACT:"recentcontact",PIC:"openpic",BIG_GROUP_NO_AUTH:"group_open_http_noauth_svc",BIG_GROUP_LONG_POLLING:"group_open_long_polling_http_svc",BIG_GROUP_LONG_POLLING_NO_AUTH:"group_open_long_polling_http_noauth_svc",IM_OPEN_STAT:"imopenstat",WEB_IM:"webim",IM_COS_SIGN:"im_cos_sign_svr",CUSTOM_UPLOAD:"im_cos_msg",HEARTBEAT:"heartbeat",IM_OPEN_PUSH:"im_open_push",IM_OPEN_STATUS:"im_open_status",IM_LONG_MESSAGE:"im_long_msg",IM_CONFIG_MANAGER:"im_sdk_config_mgr",STAT_SERVICE:"StatSvc",OVERLOAD_PUSH:"OverLoadPush",IM_MSG_AUDIT_MGR:"im_msg_audit_mgr",TUIROOM_SVR:"tui_room_svr",IM_OPEN_TRANSLATE:"im_open_translate",IM_OPEN_SPEECH:"im_open_speech",MESSAGE_SEARCH:"message_search"},CHANNEL:{SOCKET:1,XHR:2,AUTO:0},NAME_VERSION:{openim:"v4",group_open_http_svc:"v4",sns:"v4",profile:"v4",recentcontact:"v4",openpic:"v4",group_open_http_noauth_svc:"v4",group_open_long_polling_http_svc:"v4",group_open_long_polling_http_noauth_svc:"v4",imopenstat:"v4",im_cos_sign_svr:"v4",im_cos_msg:"v4",webim:"v4",im_open_push:"v4",im_open_status:"v4"}},q={SEARCH_MSG:new w(0,Math.pow(2,0)).toString(),SEARCH_GRP_SNS:new w(0,Math.pow(2,1)).toString(),AVCHATROOM_HISTORY_MSG:new w(0,Math.pow(2,2)).toString(),GRP_COMMUNITY:new w(0,Math.pow(2,3)).toString(),MSG_TO_SPECIFIED_GRP_MBR:new w(0,Math.pow(2,4)).toString(),AVCHATROOM_MBR_LIST:new w(0,Math.pow(2,6)).toString(),USER_STATUS:new w(0,Math.pow(2,7)).toString(),CONV_MARK:new w(0,Math.pow(2,9)).toString(),CONV_GROUP:new w(0,Math.pow(2,10)).toString(),AVCHATROOM_BAN_MBR:new w(0,Math.pow(2,11)).toString(),MSG_EXT:new w(0,Math.pow(2,13)).toString(),GRP_COUNTER:new w(0,Math.pow(2,15)).toString(),MSG_REACTION:new w(Math.pow(2,16)).toString()},V="group_profile";F.HOST.setCurrent(x);var B="undefined"!=typeof r&&"function"==typeof r.getSystemInfoSync&&Boolean(r.getSystemInfoSync().fontSizeSetting),j=B&&"function"==typeof r.createGamePortal,H="undefined"!=typeof qq&&"function"==typeof qq.getSystemInfoSync&&Boolean(qq.getSystemInfoSync().fontSizeSetting),K="undefined"!=typeof tt&&"function"==typeof tt.getSystemInfoSync&&Boolean(tt.getSystemInfoSync().fontSizeSetting),W="undefined"!=typeof swan&&"function"==typeof swan.getSystemInfoSync&&Boolean(swan.getSystemInfoSync().fontSizeSetting),Y="undefined"!=typeof my&&"function"==typeof my.getSystemInfoSync&&Boolean(my.getSystemInfoSync().fontSizeSetting),z="undefined"!=typeof jd&&"function"==typeof jd.getSystemInfoSync,J="undefined"!=typeof o&&"undefined"==typeof window&&"function"==typeof o.requireNativePlugin,X="undefined"!=typeof o,$=B||H||K||W||Y||J||z,Z=("undefined"!=typeof o||"undefined"!=typeof window)&&!$,Q=H?qq:K?tt:W?swan:Y?my:B?r:J?o:z?jd:{},ee=Z&&window&&window.navigator&&window.navigator.userAgent||"",te=/(micromessenger|webbrowser)/i.test(ee),ne=/AppleWebKit\/([\d.]+)/i.exec(ee);ne&&parseFloat(ne.pop());var re,oe,ie=(re="WEB",te?re="WEB":H?re="QQ_MP":K?re="TT_MP":W?re="BAIDU_MP":Y?re="ALI_MP":B?re="WX_MP":J&&(re="UNI_NATIVE_APP"),P[re]),ae=/iPad/i.test(ee),se=/iPhone/i.test(ee)&&!ae,ue=/iPod/i.test(ee),ce=se||ae||ue,le=(oe=ee.match(/OS (\d+)_/i))&&oe[1]?oe[1]:null,de=/Android/i.test(ee),fe=function(){var e=ee.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!e)return null;var t=e[1]&&parseFloat(e[1]),n=e[2]&&parseFloat(e[2]);return t&&n?parseFloat(e[1]+"."+e[2]):t||null}(),pe=/Edge/i.test(ee),he=!pe&&/Chrome/i.test(ee);!function(){var e=ee.match(/Chrome\/(\d+)/);e&&e[1]&&parseFloat(e[1])}();var ge=/MSIE/.test(ee)||ee.indexOf("Trident")>-1&&ee.indexOf("rv:11.0")>-1,ve=function(){var e=/MSIE\s(\d+)\.\d/.exec(ee),t=e&&parseFloat(e[1]);return!t&&/Trident\/7.0/i.test(ee)&&/rv:11.0/.test(ee)&&(t=11),t}(),_e=/Safari/i.test(ee)&&!he&&!de&&!pe;!function(){var e=ee.match(/TBS\/(\d+)/i);e&&e[1]&&e[1]}();var me,ye,Ie=/Windows/i.test(ee),Me=/MAC OS X/i.test(ee),Te=Z&&"undefined"!=typeof Worker&&!ge,Se=de||ce,Ee=Z&&void 0!==window.tencent_cloud_im_csig_flutter_for_web_25F_cy,Ce=function(){if("undefined"==typeof window)return!1;var e=window.navigator.standalone;return!(!ce||e||_e)}();me="undefined"!=typeof console?console:"undefined"!=typeof i&&i.console?i.console:"undefined"!=typeof window&&window.console?window.console:{};for(var ke=function(){},be=["assert","clear","count","debug","dir","dirxml","error","group","groupCollapsed","groupEnd","info","log","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],De=be.length;De--;)ye=be[De],console[ye]||(me[ye]=ke);var Ae=me,Oe=0,Re=function(){return(new Date).getTime()+Oe},Ne=function(){Oe=0},we=function(){return Math.floor(Re()/1e3)},Le=0;function Pe(){return Kt()?"%c Chat %c":"Chat"}function Ue(){var e,t=((e=new Date).setTime(Re()),e);return t.toLocaleTimeString("en-US",{hour12:!1})+"."+function(e){var t;switch(e.toString().length){case 1:t="00"+e;break;case 2:t="0"+e;break;default:t=e}return t}(t.getMilliseconds())}var Ge={arguments2String:function(e){var t="";if(1===e.length)t=e[0];else for(var n=0,r=e.length;n<r;n++)st(e[n])?ct(e[n])?t+=ht(e[n]):t+=JSON.stringify(e[n]):t+=e[n],t+=" ";return t},_exec:function(e,t){Kt()?Ae[e](Pe(),"background:#0abf5b; padding:1px; border-radius:3px; color: #fff","background:transparent",Ue(),t):Ae[e]("".concat(Pe()," ").concat(Ue()," ").concat(t))},d:function(){if(Le<=-1){var e=this.arguments2String(arguments);this._exec("debug",e)}},l:function(){if(Le<=0){var e=this.arguments2String(arguments);this._exec("log",e)}},log:function(){if(Le<=0){var e=this.arguments2String(arguments);this._exec("log",e)}},i:function(){if(Le<=1){var e=this.arguments2String(arguments);this._exec("info",e)}},w:function(){if(Le<=2){var e=this.arguments2String(arguments);this._exec("warn",e)}},e:function(){if(Le<=3){var e=this.arguments2String(arguments);this._exec("error",e)}},setLevel:function(e){e<4&&this._exec("log","set level from "+Le+" to "+e),Le=e},getLevel:function(){return Le}},xe={JPG:1,JPEG:1,GIF:2,PNG:3,BMP:4,UNKNOWN:255},Fe={NICK:"Tag_Profile_IM_Nick",GENDER:"Tag_Profile_IM_Gender",BIRTHDAY:"Tag_Profile_IM_BirthDay",LOCATION:"Tag_Profile_IM_Location",SELFSIGNATURE:"Tag_Profile_IM_SelfSignature",ALLOWTYPE:"Tag_Profile_IM_AllowType",LANGUAGE:"Tag_Profile_IM_Language",AVATAR:"Tag_Profile_IM_Image",MESSAGESETTINGS:"Tag_Profile_IM_MsgSettings",ADMINFORBIDTYPE:"Tag_Profile_IM_AdminForbidType",LEVEL:"Tag_Profile_IM_Level",ROLE:"Tag_Profile_IM_Role"},qe="Tag_SNS_IM_Group",Ve="Tag_SNS_IM_Remark",Be="Tag_SNS_IM_AddSource",je="Tag_SNS_IM_AddWording",He="Tag_SNS_IM_AddTime",Ke={UNKNOWN:"Gender_Type_Unknown",FEMALE:"Gender_Type_Female",MALE:"Gender_Type_Male"},We={NONE:"AdminForbid_Type_None",SEND_OUT:"AdminForbid_Type_SendOut"},Ye={NEED_CONFIRM:"AllowType_Type_NeedConfirm",ALLOW_ANY:"AllowType_Type_AllowAny",DENY_ANY:"AllowType_Type_DenyAny"},ze="JoinedSuccess",Je="WaitAdminApproval",Xe="@TOPIC#_",$e=["url"],Ze=function(e){return"map"===dt(e)},Qe=function(e){return"file"===dt(e)},et=function(e){return null!==e&&("number"==typeof e&&!isNaN(e-0)||"object"===n(e)&&e.constructor===Number)},nt=function(e){return"string"==typeof e},rt=function(e){return null!==e&&"object"===n(e)},ot=function(e){if("object"!==n(e)||null===e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;for(var r=t;null!==Object.getPrototypeOf(r);)r=Object.getPrototypeOf(r);return t===r},it=function(e){return"function"==typeof Array.isArray?Array.isArray(e):"array"===dt(e)},at=function(e){return void 0===e},st=function(e){return it(e)||rt(e)},ut=function(e){return"function"==typeof e},ct=function(e){return e instanceof Error},lt=function(e){return"filelist"===dt(e)},dt=function(e){return Object.prototype.toString.call(e).match(/^\[object (.*)\]$/)[1].toLowerCase()},ft=function(e){if("string"!=typeof e)return!1;var t=e[0];return!/[^a-zA-Z0-9]/.test(t)};Date.now||(Date.now=function(){return(new Date).getTime()});var pt=function e(t,n,r,o){if(!st(t)||!st(n))return 0;for(var i,a=0,s=Object.keys(n),u=0,c=s.length;u<c;u++)if(i=s[u],!(at(n[i])||r&&r.includes(i)))if(st(t[i])&&st(n[i]))a+=e(t[i],n[i],r,o);else{if(o&&o.includes(n[i]))continue;t[i]!==n[i]&&(t[i]=n[i],a+=1)}return a},ht=function(e){return JSON.stringify(e,["message","code"])},gt=function(e){if(0===e.length)return 0;for(var t=0,n=0,r="undefined"!=typeof document&&void 0!==document.characterSet?document.characterSet:"UTF-8";void 0!==e[t];)n+=e[t++].charCodeAt[t]<=255?1:!1===r?3:2;return n},vt=function(e){var t=e||99999999;return Math.round(Math.random()*t)},_t="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",mt=_t.length,yt=function(e,t){for(var n in e)if(e[n]===t)return!0;return!1},It={},Mt=function(e){return-1===e.indexOf("http://")||-1===e.indexOf("https://")?"https://"+e:e.replace(/https|http/,"https")},Tt=function e(t){if(0===Object.getOwnPropertyNames(t).length)return Object.create(null);var r=Array.isArray(t)?[]:Object.create(null),o="";for(var i in t)null!==t[i]?void 0!==t[i]?(o=n(t[i]),["string","number","function","boolean"].indexOf(o)>=0?r[i]=t[i]:r[i]=e(t[i])):r[i]=void 0:r[i]=null;return r};function St(e,t){if(!it(e)||!it(t))return!1;var n=!1;return t.forEach((function(t){var r=t.key,o=t.value,i=e.find((function(e){return e.key===r}));i?i.value!==o&&(i.value=o,n=!0):(e.push({key:r,value:o}),n=!0)})),n}var Et=function(e){return e===O.GRP_AVCHATROOM},Ct=function(e){var t=e.type,n=e.groupID;return t===O.GRP_COMMUNITY||"".concat(n).startsWith("@TGS#_")&&!"".concat(n).includes(Xe)},kt=function(e){return"".concat(e).startsWith("@TGS#_")&&"".concat(e).includes(Xe)},bt=function(e){return nt(e)&&e.slice(0,3)===O.CONV_C2C},Dt=function(e){return nt(e)&&e.slice(0,5)===O.CONV_GROUP},At=function(e){return nt(e)&&e===O.CONV_SYSTEM};function Ot(e,t){var n={};return Object.keys(e).forEach((function(r){n[r]=t(e[r],r)})),n}function Rt(e){return $?new Promise((function(t,n){Q.getImageInfo({src:e,success:function(e){t({width:e.width,height:e.height})},fail:function(){t({width:0,height:0})}})})):ge&&9===ve?Promise.resolve({width:0,height:0}):new Promise((function(t,n){var r=new Image;r.onload=function(){t({width:this.width,height:this.height}),r=null},r.onerror=function(){t({width:0,height:0}),r=null},r.src=e}))}function Nt(){function e(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return"".concat(e()+e()).concat(e()).concat(e()).concat(e()).concat(e()).concat(e()).concat(e())}function wt(){var e="unknown";if(Me&&(e="mac"),Ie&&(e="windows"),ce&&(e="ios"),de&&(e="android"),$)try{var t=Q.getSystemInfoSync().platform;void 0!==t&&(e=t)}catch(n){}return e}function Lt(e,t){e=e.split("."),t=t.split(".");for(var n=Math.max(e.length,t.length);e.length<n;)e.push("0");for(;t.length<n;)t.push("0");for(var r=0;r<n;r++){var o=parseInt(e[r]),i=parseInt(t[r]);if(o>i)return 1;if(o<i)return-1}return 0}function Pt(e){var t=e.originUrl,n=void 0===t?void 0:t,r=e.originWidth,o=e.originHeight,i=e.min,a=void 0===i?198:i,s=parseInt(r),u=parseInt(o),c={url:void 0,width:0,height:0};if((s<=u?s:u)<=a)c.url=n,c.width=s,c.height=u;else{u<=s?(c.width=Math.ceil(s*a/u),c.height=a):(c.width=a,c.height=Math.ceil(u*a/s));var l=n&&n.indexOf("?")>-1?"".concat(n,"&"):"".concat(n,"?");c.url="".concat(l,198===a?"imageView2/3/w/198/h/198":"imageView2/3/w/720/h/720")}return at(n)?(c.url,_(c,$e)):c}function Ut(e){var t=e[2];e[2]=e[1],e[1]=t;for(var n=0;n<e.length;n++)e[n].setType(n)}function Gt(e){var t=e.servcmd;return t.slice(t.indexOf(".")+1)}function xt(e,t){return Math.round(Number(e)*Math.pow(10,t))/Math.pow(10,t)}function Ft(e,t){return e.includes(t)}function qt(e,t){return e.includes(t)}function Vt(e){return e.split(Xe)[0]}var Bt=function(e,t,n){if(at(t))return"";switch(e){case O.MSG_TEXT:return t.text;case O.MSG_IMAGE:return n?"[Image]":"[图片]";case O.MSG_LOCATION:return n?"[Location]":"[位置]";case O.MSG_AUDIO:return n?"[Voice]":"[语音]";case O.MSG_VIDEO:return n?"[Video]":"[视频]";case O.MSG_FILE:return n?"[File]":"[文件]";case O.MSG_CUSTOM:return n?"[Custom Messages]":"[自定义消息]";case O.MSG_GRP_TIP:return n?"[Group Notification]":"[群提示消息]";case O.MSG_GRP_SYS_NOTICE:return n?"[Group System Message]":"[群系统通知]";case O.MSG_FACE:return n?"[Animated Sticker]":"[动画表情]";case O.MSG_MERGER:return n?"[Chat Record]":"[聊天记录]";default:return""}};function jt(e){return e===O.MSG_TEXT||e===O.MSG_CUSTOM||e===O.MSG_LOCATION||e===O.MSG_FACE}function Ht(e){var t=[];if(!nt(e))return t;var n=e.length;if(0===n)return t;for(var r=n-1;r>=0;r--)"1"===e[r]&&t.push(Math.pow(2,n-r-1));return t}function Kt(){return!ge&&!$}function Wt(e){return"the length of userIDList cannot exceed ".concat(e)}function Yt(e,t){if(e){var n=e;return t&&(e.startsWith("http://")?n=e.replace(/^http:\/\/[^/]+/,t):e.startsWith("https://")&&(n=e.replace(/^https:\/\/[^/]+/,t))),n}}function zt(e){if(it(e)&&0!==e.length){var t=0;return e.forEach((function(e){t+=e})),t.toFixed(0)}}function Jt(e){if(it(e)&&0!==e.length){var t=0;return e.forEach((function(e){t+=e})),(t/e.length).toFixed(0)}}function Xt(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=Date.now();return t?n?"".concat(r-e," ms"):"".concat(Math.round((r-e)/1e3)," s"):n?r-e:Math.round((r-e)/1e3)}function $t(e){var t=!1;return e&&e>1&&(t=!0),t}var Zt=Object.prototype.hasOwnProperty;function Qt(e){if(null==e)return!0;if("boolean"==typeof e)return!1;if("number"==typeof e)return 0===e;if("string"==typeof e)return 0===e.length;if("function"==typeof e)return 0===e.length;if(Array.isArray(e))return 0===e.length;if(e instanceof Error)return""===e.message;if(ot(e)){for(var t in e)if(Zt.call(e,t))return!1;return!0}return!(!Ze(e)&&(n=e,"set"!==dt(n))&&!Qe(e))&&0===e.size;var n}function en(e,t,n){if(void 0===t)return!0;var r=!0;if(ot(t))Object.keys(t).forEach((function(o){var i=1===e.length?e[0][o]:void 0;r=!!tn(i,t[o],n,o)&&r}));else if(it(t))for(var o=0;o<t.length;o++)r=!!tn(e[o],t[o],n,t[o].name)&&r;if(r)return r;throw new Error("Params validate failed.")}function tn(e,t,n,r){if(void 0===t)return!0;var o=!0;if(t.required&&Qt(e)&&(Ge.e("[".concat(n,'] Missing required params: "').concat(r,'".')),o=!1),!Qt(e)){var i=dt(e),a=t.type.toLowerCase();i!==a&&("asyncfunction"===i&&"function"===a||(Ge.e("[".concat(n,'] Invalid params: type check failed for "').concat(r,'". Expected ').concat(t.type,".")),o=!1))}return t.validator&&!t.validator(e,n,r)&&(Ge.e("[".concat(n,'] Invalid params: custom validator check failed for "').concat(r,'".')),o=!1),o}var nn,rn={UNSEND:"unSend",SUCCESS:"success",FAIL:"fail"},on={NOT_START:"notStart",PENDING:"pending",RESOLVED:"resolved",REJECTED:"rejected"},an=function(e){if(!e)return!1;if(bt(e)||Dt(e)||At(e))return!0;var t=Pn("InvalidConversationID",e);return t&&Ge.w(t),!1},sn=function(e){""!==e.desc&&""!==Pn("API_REFER")&&Ge.w("[".concat(e.api,"] | ").concat(e.paramName," | ").concat(e.desc,", ").concat(Pn("API_REFER")).concat(e.api))},un=function(){return Pn("StringRequiredLog")},cn=function(e){return Pn("NonEmptyStringRequiredLog",e)},ln=function(){return Pn("NumberRequiredLog")},dn=function(){return Pn("UndefinedNotAllowedLog")},fn=function(){return Pn("FileRequiredLog")},pn=function(){return Pn("FunctionRequiredLog")},hn=function(){return Pn("ArrayRequiredLog")},gn=function(){return Pn("NonEmptyArrayLog")},vn=function(){return Pn("CallbackMissingLog")},_n=function(){return Pn("PositiveIntegerRequiredLog")},mn=function(e,t){return Pn("StringNotLongerThanLog",e,t)},yn=function(e,t){return Pn("NumberLessThanLog",e,t)},In=function(e,t){return Pn("NumberGreaterOrEqualLog",e,t)},Mn=function(e){return Pn("KeyValueStringRequiredLog",e)},Tn=function(){return Pn("PlainObjectRequiredLog")},Sn=function(){return Pn("NonEmptyContentRequiredLog")},En=function(){return Pn("FileNotSelectedLog")},Cn=function(){return Pn("MessageInstanceRequiredLog")},kn=function(){return Pn("NonAnonymousFunctionLog")},bn=function(){return Pn("MessageExtensionNotAvailableLog")},Dn=function(){return Pn("MessageReactionRequiredLog")},An=function(e,t){return Pn("MaximumArrayLengthLog",e,t)},On={type:"String",required:!0},Rn={type:"Array",required:!0},Nn={type:"Object",required:!0},wn={type:"Boolean",required:!0},Ln={type:"number",required:!0},Pn=null,Un={hookGetAPITips:function(e){Pn=e},login:{userID:On,userSig:On},addToBlacklist:{userIDList:Rn},removeFromBlacklist:{userIDList:Rn},on:[{name:"eventName",type:"String",validator:function(e,t,n){return"string"==typeof e&&0!==e.length||(sn({api:t,paramName:n,desc:cn(n)}),!1)}},{name:"handler",type:"Function",validator:function(e,t,n){return"function"!=typeof e?(sn({api:t,paramName:n,desc:pn()}),!1):(""===e.name&&sn({api:t,paramName:n,desc:kn()}),!0)}}],once:[{name:"eventName",type:"String",validator:function(e,t,n){return"string"==typeof e&&0!==e.length||(sn({api:t,paramName:n,desc:cn(n)}),!1)}},{name:"handler",type:"Function",validator:function(e,t,n){return"function"!=typeof e?(sn({api:t,paramName:n,desc:pn()}),!1):(""===e.name&&sn({api:t,paramName:n,desc:kn()}),!0)}}],off:[{name:"eventName",type:"String",validator:function(e,t,n){return"string"==typeof e&&0!==e.length||(sn({api:t,paramName:n,desc:cn(n)}),!1)}},{name:"handler",type:"Function",validator:function(e,t,n){return"function"!=typeof e?(sn({api:t,paramName:n,desc:pn()}),!1):(""===e.name&&sn({api:t,paramName:n,desc:kn()}),!0)}}],sendMessage:[t({name:"message"},Nn)],setMessageExtensions:[t(t({name:"message"},Nn),{},{validator:function(e,t,n){return e.status===rn.SUCCESS&&!0===e.isSupportExtension||(sn({api:t,paramName:n,desc:bn()}),!1)}}),t({name:"extensions"},Rn)],getMessageExtensions:[t(t({name:"message"},Nn),{},{validator:function(e,t,n){return e.status===rn.SUCCESS&&!0===e.isSupportExtension||(sn({api:t,paramName:n,desc:bn()}),!1)}})],deleteMessageExtensions:[t(t({name:"message"},Nn),{},{validator:function(e,t,n){return e.status===rn.SUCCESS&&!0===e.isSupportExtension||(sn({api:t,paramName:n,desc:bn()}),!1)}})],addMessageReaction:[t(t({name:"message"},Nn),{},{validator:function(e,t,n){return e.status===rn.SUCCESS||(sn({api:t,paramName:n,desc:Dn()}),!1)}}),t({name:"reactionID"},On)],removeMessageReaction:[t(t({name:"message"},Nn),{},{validator:function(e,t,n){return e.status===rn.SUCCESS||(sn({api:t,paramName:n,desc:Dn()}),!1)}}),t({name:"reactionID"},On)],getMessageReactions:{messageList:t({},Rn)},getAllUserListOfMessageReaction:{message:t(t({},Nn),{},{validator:function(e,t,n){return e.status===rn.SUCCESS||(sn({api:t,paramName:n,desc:Dn()}),!1)}}),reactionID:t({},On),nextSeq:{type:"Number"},count:{type:"Number"}},getMessageList:{conversationID:t(t({},On),{},{validator:function(e){return an(e)}}),nextReqMessageID:{type:"String"},count:{type:"Number",validator:function(e,t,n){return!(!at(e)&&!/^[1-9][0-9]*$/.test(e))||(sn({api:t,paramName:n,desc:_n()}),!1)}}},getMessageListHopping:{conversationID:t(t({},On),{},{validator:function(e){return an(e)}}),sequence:{type:"Number"},time:{type:"Number"},direction:{type:"Number",validator:function(e,t,n){return!(!at(e)&&0!==e&&1!==e)||(sn({api:t,paramName:n,desc:Pn("0Or1RequiredLog")}),!1)}},count:{type:"Number",validator:function(e,t,n){return!(!at(e)&&!/^[1-9][0-9]*$/.test(e))||(sn({api:t,paramName:n,desc:_n}),!1)}}},setMessageRead:{conversationID:t(t({},On),{},{validator:function(e){return an(e)}})},setAllMessageRead:{scope:{type:"String",required:!1,validator:function(e,t,n){return!e||-1!==[O.READ_ALL_C2C_MSG,O.READ_ALL_GROUP_MSG,O.READ_ALL_MSG].indexOf(e)||(sn({api:t,paramName:n,desc:Pn("ValidScopeRequired")}),!1)}}},getConversationProfile:[t(t({name:"conversationID"},On),{},{validator:function(e){return an(e)}})],clearHistoryMessage:[t(t({name:"conversationID"},On),{},{validator:function(e){return an(e)}})],pinConversation:{conversationID:t(t({},On),{},{validator:function(e){return an(e)}}),isPinned:t({},wn)},setConversationDraft:{conversationID:t(t({},On),{},{validator:function(e){return an(e)}}),draftText:{type:"String",validator:function(e,t,n){return!!nt(e)||(sn({api:t,paramName:n,desc:un()}),!1)}}},setConversationCustomData:{conversationIDList:t({},Rn),customData:{type:"String",validator:function(e,t,n){return nt(e)?!(e.length>256)||(sn({api:t,paramName:n,desc:mn(n,256)}),!1):(sn({api:t,paramName:n,desc:un()}),!1)}}},markConversation:{conversationIDList:t({},Rn),markType:{type:"number",validator:function(e,t,n){return et(e)?e<=0?(sn({api:t,paramName:n,desc:(r=n,0,Pn("NumberGreaterThanLog",r,0))}),!1):!(e>=Math.pow(2,64))||(sn({api:t,paramName:n,desc:yn(n,"Math.pow(2,64)")}),!1):(sn({api:t,paramName:n,desc:ln()}),!1);var r}},enableMark:t({},wn)},createConversationGroup:{conversationIDList:t({},Rn),groupName:t(t({},On),{},{validator:function(e,t,n){return!!e&&(!(e.length>32)||(sn({api:t,paramName:n,desc:mn(n,32)}),!1))}})},deleteConversationGroup:[t({name:"groupName"},On)],renameConversationGroup:{oldName:t({},On),newName:t(t({},On),{},{validator:function(e,t,n){return!!e&&(!(e.length>32)||(sn({api:t,paramName:n,desc:mn(n,32)}),!1))}})},addConversationsToGroup:{conversationIDList:t({},Rn),groupName:t({},On)},deleteConversationsFromGroup:{conversationIDList:t({},Rn),groupName:t({},On)},getGroupList:{groupProfileFilter:{type:"Array"}},getGroupProfile:{groupID:On,groupCustomFieldFilter:{type:"Array"},memberCustomFieldFilter:{type:"Array"}},getGroupProfileAdvance:{groupIDList:Rn},createGroup:{name:On},joinGroup:{groupID:On,type:{type:"String"},applyMessage:{type:"String"}},quitGroup:[t({name:"groupID"},On)],handleApplication:{message:Nn,handleAction:On,handleMessage:{type:"String"}},changeGroupOwner:{groupID:On,newOwnerID:On},updateGroupProfile:{groupID:On,muteAllMembers:{type:"Boolean"}},dismissGroup:[t({name:"groupID"},On)],searchGroupByID:[t({name:"groupID"},On)],getGroupOnlineMemberCount:[t({name:"groupID"},On)],initGroupAttributes:{groupID:On,groupAttributes:t(t({},Nn),{},{validator:function(e,t,n){var r=!0;return Object.keys(e).forEach((function(o){if(!nt(e[o]))return sn({api:t,paramName:n,desc:Mn("value")}),r=!1})),r}})},setGroupAttributes:{groupID:On,groupAttributes:t(t({},Nn),{},{validator:function(e,t,n){var r=!0;return Object.keys(e).forEach((function(o){if(!nt(e[o]))return sn({api:t,paramName:n,desc:Mn("value")}),r=!1})),r}})},deleteGroupAttributes:{groupID:On,keyList:{type:"Array",validator:function(e,t,n){if(at(e)||!it(e))return sn({api:t,paramName:n,desc:hn()}),!1;if(!Qt(e)){var r=!0;return e.forEach((function(e){if(!nt(e))return sn({api:t,paramName:n,desc:Pn("StringArrayRequiredLog")}),r=!1})),r}return!0}}},getGroupAttributes:{groupID:On,keyList:{type:"Array",validator:function(e,t,n){if(at(e)||!it(e))return sn({api:t,paramName:n,desc:hn()}),!1;if(!Qt(e)){var r=!0;return e.forEach((function(e){if(!nt(e))return sn({api:t,paramName:n,desc:Mn("key")}),r=!1})),r}return!0}}},setGroupCounters:{groupID:On,counters:Nn},increaseGroupCounter:{groupID:On,key:On,value:Ln},decreaseGroupCounter:{groupID:On,key:On,value:Ln},getGroupCounters:{groupID:On},getGroupMemberList:{groupID:On,count:{type:"Number"}},getGroupMemberProfile:{groupID:On,userIDList:Rn,memberCustomFieldFilter:{type:"Array"}},addGroupMember:{groupID:On,userIDList:Rn},setGroupMemberRole:{groupID:On,userID:On,role:On},setGroupMemberMuteTime:{groupID:On,userID:On,muteTime:{type:"Number",validator:function(e){return e>=0}}},setGroupMemberNameCard:{groupID:On,userID:{type:"String"},nameCard:{type:"String",validator:function(e,t,n){return nt(e)?(e.length,!0):(sn({api:t,paramName:n,desc:un()}),!1)}}},setGroupMemberCustomField:{groupID:On,userID:{type:"String"},memberCustomField:Rn},deleteGroupMember:{groupID:On},markGroupMemberList:{groupID:On,markType:{type:"number",validator:function(e,t,n){return et(e)?!(e<1e3)||(sn({api:t,paramName:n,desc:In(n,1e3)}),!1):(sn({api:t,paramName:n,desc:ln()}),!1)}},userIDList:t({},Rn),enableMark:t({},wn)},createTextMessage:{to:On,conversationType:On,payload:t(t({},Nn),{},{validator:function(e,t,n){return ot(e)?nt(e.text)?0!==e.text.length||(sn({api:t,paramName:"payload.text",desc:Sn()}),!1):(sn({api:t,paramName:"payload.text",desc:un()}),!1):(sn({api:t,paramName:n,desc:Tn()}),!1)}})},createTextAtMessage:{to:On,conversationType:On,payload:t(t({},Nn),{},{validator:function(e,t,n){return ot(e)?nt(e.text)?0===e.text.length?(sn({api:t,paramName:"payload.text",desc:Sn()}),!1):!(e.atUserList&&!it(e.atUserList))||(sn({api:t,paramName:"payload.atUserList",desc:hn()}),!1):(sn({api:t,paramName:"payload.text",desc:un()}),!1):(sn({api:t,paramName:n,desc:Tn()}),!1)}})},createCustomMessage:{to:On,conversationType:On,payload:t(t({},Nn),{},{validator:function(e,t,n){return ot(e)?e.data&&!nt(e.data)?(sn({api:t,paramName:"payload.data",desc:un()}),!1):e.description&&!nt(e.description)?(sn({api:t,paramName:"payload.description",desc:un()}),!1):!(e.extension&&!nt(e.extension))||(sn({api:t,paramName:"payload.extension",desc:un()}),!1):(sn({api:t,paramName:"payload",desc:Tn()}),!1)}})},createImageMessage:{to:On,conversationType:On,payload:t(t({},Nn),{},{validator:function(e,t,n){if(!ot(e))return sn({api:t,paramName:n,desc:Tn()}),!1;if(at(e.file))return sn({api:t,paramName:"payload.file",desc:dn()}),!1;if(Z){if(!(e.file instanceof HTMLInputElement||Qe(e.file)))return ot(e.file)&&"undefined"!=typeof o?0!==e.file.tempFilePaths.length&&0!==e.file.tempFiles.length||(sn({api:t,paramName:"payload.file",desc:En()}),!1):(sn({api:t,paramName:"payload.file",desc:fn()}),!1);if(e.file instanceof HTMLInputElement&&0===e.file.files.length)return sn({api:t,paramName:"payload.file",desc:En()}),!1}return!0},onProgress:{type:"Function",required:!1,validator:function(e,t,n){return at(e)&&sn({api:t,paramName:n,desc:vn()}),!0}}})},createAudioMessage:{to:On,conversationType:On,payload:t(t({},Nn),{},{validator:function(e,t,n){return!!ot(e)||(sn({api:t,paramName:n,desc:Tn()}),!1)}}),onProgress:{type:"Function",required:!1,validator:function(e,t,n){return at(e)&&sn({api:t,paramName:n,desc:vn()}),!0}}},createVideoMessage:{to:On,conversationType:On,payload:t(t({},Nn),{},{validator:function(e,t,n){if(!ot(e))return sn({api:t,paramName:n,desc:Tn()}),!1;if(at(e.file))return sn({api:t,paramName:"payload.file",desc:dn()}),!1;if(Z){if(!(e.file instanceof HTMLInputElement||Qe(e.file)))return ot(e.file)&&"undefined"!=typeof o?!!Qe(e.file.tempFile)||(sn({api:t,paramName:"payload.file",desc:En()}),!1):(sn({api:t,paramName:"payload.file",desc:fn()}),!1);if(e.file instanceof HTMLInputElement&&0===e.file.files.length)return sn({api:t,paramName:"payload.file",desc:En()}),!1}return!0}}),onProgress:{type:"Function",required:!1,validator:function(e,t,n){return at(e)&&sn({api:t,paramName:n,desc:vn()}),!0}}},createFaceMessage:{to:On,conversationType:On,payload:t(t({},Nn),{},{validator:function(e,t,n){return ot(e)?et(e.index)?!!nt(e.data)||(sn({api:t,paramName:"payload.data",desc:un()}),!1):(sn({api:t,paramName:"payload.index",desc:ln()}),!1):(sn({api:t,paramName:n,desc:Tn()}),!1)}})},createFileMessage:{to:On,conversationType:On,payload:t(t({},Nn),{},{validator:function(e,t,n){if(!ot(e))return sn({api:t,paramName:n,desc:Tn()}),!1;if(at(e.file))return sn({api:t,paramName:"payload.file",desc:dn()}),!1;if(Z){if(!(e.file instanceof HTMLInputElement||Qe(e.file)))return ot(e.file)&&"undefined"!=typeof o?0!==e.file.tempFilePaths.length&&0!==e.file.tempFiles.length||(sn({api:t,paramName:"payload.file",desc:En()}),!1):(sn({api:t,paramName:"payload.file",desc:fn()}),!1);if(e.file instanceof HTMLInputElement&&0===e.file.files.length)return sn({api:t,paramName:"payload.file",desc:En()}),!1}return!0}}),onProgress:{type:"Function",required:!1,validator:function(e,t,n){return at(e)&&sn({api:t,paramName:n,desc:vn()}),!0}}},createLocationMessage:{to:On,conversationType:On,payload:t(t({},Nn),{},{validator:function(e,t,n){return ot(e)?nt(e.description)?et(e.longitude)?!!et(e.latitude)||(sn({api:t,paramName:"payload.latitude",desc:ln()}),!1):(sn({api:t,paramName:"payload.longitude",desc:ln()}),!1):(sn({api:t,paramName:"payload.description",desc:un()}),!1):(sn({api:t,paramName:n,desc:Tn()}),!1)}})},createMergerMessage:{to:On,conversationType:On,payload:t(t({},Nn),{},{validator:function(e,t,n){if(Qt(e.messageList))return sn({api:t,paramName:"payload.messageList",desc:gn()}),!1;if(Qt(e.compatibleText))return sn({api:t,paramName:"payload.compatibleText",desc:cn("compatibleText")}),!1;var r=!1;return e.messageList.forEach((function(e){e.status===rn.FAIL&&(r=!0)})),!r||(sn({api:t,paramName:"payload.messageList",desc:Pn("MergeFailedMessageLog")}),!1)}})},revokeMessage:[t(t({name:"message"},Nn),{},{validator:function(e,t,n){return Qt(e)?(sn({api:t,paramName:n,desc:Cn()}),!1):e.conversationType===O.CONV_SYSTEM?(sn({api:t,paramName:n,desc:Pn("MessageCanBeRevokedDesc")}),!1):!0!==e.isRevoked||(sn({api:t,paramName:n,desc:Pn("MessageRevokedLog")}),!1)}})],deleteMessage:[t(t({name:"messageList"},Rn),{},{validator:function(e,t,n){return!Qt(e)||(sn({api:t,paramName:n,desc:gn()}),!1)}})],translateText:{sourceTextList:Rn,sourceLanguage:On,targetLanguage:On},convertVoiceToText:{message:t(t({},Nn),{},{validator:function(e,t,n){return Qt(e)?(sn({api:t,paramName:n,desc:Cn()}),!1):e.type===O.MSG_AUDIO&&e.status===rn.SUCCESS||(sn({api:t,paramName:n,desc:Pn("AudioMessageRequiredLog")}),!1)}})},modifyMessage:[t(t({name:"message"},Nn),{},{validator:function(e,t,n){return Qt(e)?(sn({api:t,paramName:n,desc:Cn()}),!1):e.conversationType===O.CONV_SYSTEM?(sn({api:t,paramName:n,desc:Pn("MessageCanBeModifiedLog")}),!1):!0!==e._onlineOnlyFlag||(sn({api:t,paramName:n,desc:Pn("OnlineMessageNotSupportLog")}),!1)}})],searchCloudMessages:{keywordList:{type:"Array",required:!1,validator:function(e,t,n){return!e||(it(e)?0===e.length?(sn({api:t,paramName:n,desc:gn()}),!1):!(e.length>5)||(sn({api:t,paramName:n,desc:An(n,5)}),!1):(sn({api:t,paramName:n,desc:hn()}),!1))}},keywordListMatchType:{type:"String",required:!1,validator:function(e,t,n){return!e||"or"===e||"and"===e||sn({api:t,paramName:n,desc:"".concat(e," is invalid match type")})}},senderUserIDList:{type:"Array",required:!1,validator:function(e,t,n){return!e||(it(e)?(0===e.length&&sn({api:t,paramName:n,desc:gn()}),!(e.length>5)||(sn({api:t,paramName:n,desc:An(n,5)}),!1)):(sn({api:t,paramName:n,desc:hn()}),!1))}},messageTypeList:{type:"Array",required:!1,validator:function(e,t,n){if(!e)return!0;if(!it(e))return sn({api:t,paramName:n,desc:hn()}),!1;0===e.length&&sn({api:t,paramName:n,desc:gn()});var r,o=[O.MSG_TEXT,O.MSG_IMAGE,O.MSG_AUDIO,O.MSG_FILE,O.MSG_VIDEO,O.MSG_LOCATION,O.MSG_CUSTOM,O.MSG_MERGER];return!(e.filter((function(e){return-1===o.indexOf(e)})).length>0)||(sn({api:t,paramName:n,desc:(r=n,Pn("ContainsUnsupportedMessageTypeLog",r))}),!1)}},conversationID:{type:"String",required:!1,validator:function(e){return!e||an(e)}},timePosition:{type:"number",required:!1,validator:function(e,t,n){return!e||!(e<0)||(sn({api:t,paramName:n,desc:In(n,0)}),!1)}},timePeriod:{type:"number",required:!1,validator:function(e,t,n){return!e||!(e<0)||(sn({api:t,paramName:n,desc:In(n,0)}),!1)}},cursor:{type:"String",required:!1}},getUserProfile:{userIDList:{type:"Array",validator:function(e,t,n){return it(e)?(0===e.length&&sn({api:t,paramName:n,desc:gn()}),!0):(sn({api:t,paramName:n,desc:hn()}),!1)}}},updateMyProfile:{profileCustomField:{type:"Array",validator:function(e,t,n){return!!at(e)||!!it(e)||(sn({api:t,paramName:n,desc:hn()}),!1)}}},setSelfStatus:{customStatus:{type:"String",validator:function(e,t,n){return!!nt(e)||(sn({api:t,paramName:n,desc:un()}),!1)}}},getUserStatus:{userIDList:{type:"Array",validator:function(e,t,n){return it(e)?0!==e.length||(sn({api:t,paramName:n,desc:gn()}),!1):(sn({api:t,paramName:n,desc:hn()}),!1)}}},subscribeUserStatus:{userIDList:{type:"Array",validator:function(e,t,n){return it(e)?0!==e.length||(sn({api:t,paramName:n,desc:gn()}),!1):(sn({api:t,paramName:n,desc:hn()}),!1)}}},unsubscribeUserStatus:{userIDList:{type:"Array",validator:function(e,t,n){return!e||!!it(e)||(sn({api:t,paramName:n,desc:hn()}),!1)}}},addFriend:{to:On,source:{type:"String",required:!0,validator:function(e,t,n){return!!e&&(e.startsWith("AddSource_Type_")?!(e.replace("AddSource_Type_","").length>8)||(sn({api:t,paramName:n,desc:mn("keyword",8)}),!1):(sn({api:t,paramName:n,desc:Pn("SourcePrefixLog")}),!1))}},remark:{type:"String",required:!1,validator:function(e,t,n){return!(nt(e)&&e.length>96)||(sn({api:t,paramName:n,desc:mn(n,96)}),!1)}}},deleteFriend:{userIDList:Rn},checkFriend:{userIDList:Rn},getFriendProfile:{userIDList:Rn},updateFriend:{userID:On,remark:{type:"String",required:!1,validator:function(e,t,n){return!(nt(e)&&e.length>96)||(sn({api:t,paramName:n,desc:mn(n,96)}),!1)}},friendCustomField:{type:"Array",required:!1,validator:function(e,t,n){if(e){if(!it(e))return sn({api:t,paramName:n,desc:hn()}),!1;var r=!0;return e.forEach((function(e){return nt(e.key)&&-1!==e.key.indexOf("Tag_SNS_Custom")?nt(e.value)?e.key.replace("Tag_SNS_Custom_","").length>8?(sn({api:t,paramName:n,desc:mn("keyword",8)}),r=!1):void 0:(sn({api:t,paramName:n,desc:Mn("value")}),r=!1):(sn({api:t,paramName:n,desc:Pn("FriendCustomFieldPrefixLog")}),r=!1)})),r}return!0}}},acceptFriendApplication:{userID:On},refuseFriendApplication:{userID:On},deleteFriendApplication:{userID:On},createFriendGroup:{name:On},deleteFriendGroup:{name:On},addToFriendGroup:{name:On,userIDList:Rn},removeFromFriendGroup:{name:On,userIDList:Rn},renameFriendGroup:{oldName:On,newName:On},sendMessageReadReceipt:[{name:"messageList",type:"Array",validator:function(e,t,n){return it(e)?0!==e.length||(sn({api:t,paramName:n,desc:gn()}),!1):(sn({api:t,paramName:n,desc:hn()}),!1)}}],getMessageReadReceiptList:[{name:"messageList",type:"Array",validator:function(e,t,n){return it(e)?0!==e.length||(sn({api:t,paramName:n,desc:gn()}),!1):(sn({api:t,paramName:n,desc:hn()}),!1)}}],createTopicInCommunity:{groupID:On,topicName:On},deleteTopicFromCommunity:{groupID:On,topicIDList:{type:"Array",validator:function(e,t,n){return!e||!!it(e)||(sn({api:t,paramName:n,desc:hn()}),!1)}}},updateTopicProfile:{groupID:On,topicID:On},getTopicList:{groupID:On,topicIDList:{type:"Array",validator:function(e,t,n){return!e||!!it(e)||(sn({api:t,paramName:n,desc:hn()}),!1)}}},addSignalingListener:[{name:"eventName",type:"String",validator:function(e,t,n){return"string"==typeof e&&0!==e.length||(sn({api:t,paramName:n,desc:cn(n)}),!1)}},{name:"handler",type:"Function",validator:function(e,t,n){return"function"!=typeof e?(sn({api:t,paramName:n,desc:pn()}),!1):(""===e.name&&sn({api:t,paramName:n,desc:kn()}),!0)}}],removeSignalingListener:[{name:"eventName",type:"String",validator:function(e,t,n){return"string"==typeof e&&0!==e.length||(sn({api:t,paramName:n,desc:cn(n)}),!1)}},{name:"handler",type:"Function",validator:function(e,t,n){return"function"!=typeof e?(sn({api:t,paramName:n,desc:pn()}),!1):(""===e.name&&sn({api:t,paramName:n,desc:kn()}),!0)}}],invite:{userID:On},inviteSync:[t(t({},Nn),{},{validator:function(e,t,n){return ot(e)?!!nt(e.userID)||(sn({api:t,paramName:"options.userID",desc:un()}),!1):(sn({api:t,paramName:"options",desc:Tn()}),!1)}}),{name:"successCb",type:"Function",required:!1,validator:function(e,t,n){return at(e)&&sn({api:t,paramName:n,desc:pn()}),!0}},{name:"errorCb",type:"Function",required:!1,validator:function(e,t,n){return at(e)&&sn({api:t,paramName:n,desc:pn()}),!0}}],inviteInGroup:{groupID:On,inviteeList:Rn},inviteInGroupSync:[t(t({},Nn),{},{validator:function(e,t,n){return ot(e)?nt(e.groupID)?!!it(e.inviteeList)||(sn({api:t,paramName:"options.inviteeList",desc:hn()}),!1):(sn({api:t,paramName:"options.groupID",desc:un()}),!1):(sn({api:t,paramName:"options",desc:Tn()}),!1)}}),{name:"successCb",type:"Function",required:!1,validator:function(e,t,n){return at(e)&&sn({api:t,paramName:n,desc:pn()}),!0}},{name:"errorCb",type:"Function",required:!1,validator:function(e,t,n){return at(e)&&sn({api:t,paramName:n,desc:pn()}),!0}}],accept:{inviteID:On},reject:{inviteID:On},getSignalingInfo:[t(t({name:"message"},Nn),{},{validator:function(e,t,n){return!Qt(e)||(sn({api:t,paramName:n,desc:Cn()}),!1)}})],modifyInvitation:{inviteID:On,data:On}},Gn={login:1,logout:1,getLoginUser:1,on:1,once:1,off:1,setLogLevel:1,registerPlugin:1,destroy:1,isReady:1,createTextMessage:1,createTextAtMessage:1,createImageMessage:1,createAudioMessage:1,createVideoMessage:1,createCustomMessage:1,createFaceMessage:1,createFileMessage:1,createLocationMessage:1,createMergerMessage:1,downloadMergerMessage:1,createForwardMessage:1,sendMessage:1,resendMessage:1,revokeMessage:1,deleteMessage:1,translateText:1,convertVoiceToText:1,modifyMessage:1,searchCloudMessages:1,sendMessageReadReceipt:1,getGroupMessageReadMemberList:1,getMessageReadReceiptList:1,setMessageExtensions:1,getMessageExtensions:1,deleteMessageExtensions:1,addMessageReaction:1,removeMessageReaction:1,getMessageReactions:1,getAllUserListOfMessageReaction:1,getMessageList:1,findMessage:1,getMessageListHopping:1,setMessageRead:1,setAllMessageRead:1,getConversationList:1,getConversationProfile:1,deleteConversation:1,setConversationDraft:1,pinConversation:1,getTotalUnreadMessageCount:1,setConversationCustomData:1,markConversation:1,createConversationGroup:1,getConversationGroupList:1,deleteConversationGroup:1,renameConversationGroup:1,addConversationsToGroup:1,deleteConversationsFromGroup:1,clearHistoryMessage:1,getGroupList:1,getGroupProfile:1,createGroup:1,joinGroup:1,updateGroupProfile:1,quitGroup:1,dismissGroup:1,changeGroupOwner:1,searchGroupByID:1,setMessageRemindType:1,getGroupApplicationList:1,handleGroupApplication:1,initGroupAttributes:1,setGroupAttributes:1,deleteGroupAttributes:1,getGroupAttributes:1,setGroupCounters:1,increaseGroupCounter:1,decreaseGroupCounter:1,getGroupCounters:1,getJoinedCommunityList:1,createTopicInCommunity:1,deleteTopicFromCommunity:1,updateTopicProfile:1,getTopicList:1,getGroupMemberProfile:1,getGroupMemberList:1,addGroupMember:1,deleteGroupMember:1,setGroupMemberNameCard:1,setGroupMemberMuteTime:1,setGroupMemberRole:1,setGroupMemberCustomField:1,getGroupOnlineMemberCount:1,markGroupMemberList:1,getMyProfile:1,getUserProfile:1,updateMyProfile:1,setSelfStatus:1,getUserStatus:1,subscribeUserStatus:1,unsubscribeUserStatus:1,getBlacklist:1,addToBlacklist:1,removeFromBlacklist:1,getFriendList:1,addFriend:1,deleteFriend:1,checkFriend:1,updateFriend:1,getFriendProfile:1,getFriendApplicationList:1,refuseFriendApplication:1,deleteFriendApplication:1,acceptFriendApplication:1,setFriendApplicationRead:1,getFriendGroupList:1,createFriendGroup:1,renameFriendGroup:1,deleteFriendGroup:1,addToFriendGroup:1,removeFromFriendGroup:1,callExperimentalAPI:1,addSignalingListener:1,removeSignalingListener:1,invite:1,inviteSync:1,inviteInGroup:1,inviteInGroupSync:1,cancel:1,accept:1,reject:1,getSignalingInfo:1,modifyInvitation:1},xn=function(e){return{code:0,data:e||{}}},Fn=function(e){d(n,e);var t=I(n);function n(e){var r;a(this,n),r=t.call(this);var o=e.code,i=e.message,s=e.data;return r.code=o,r.message=i||r._getErrorMessage(r.code),r.data=s||{},r}return c(n)}(v(Error)),qn={NO_SDKAPPID:2e3,NO_ACCOUNT_TYPE:2001,NO_IDENTIFIER:2002,NO_USERSIG:2003,NO_TINYID:2022,NO_A2KEY:2023,USER_NOT_LOGGED_IN:2024,REPEAT_LOGIN:2025,COS_UNDETECTED:2040,COS_GET_SIG_FAIL:2041,MSG_SEND_FAIL:2100,MSG_SEND_FAIL_NOT_IN_AVCHATROOM:2101,MSG_INSTANCE_REQUIRED:2105,MSG_INVALID_CONV_TYPE:2106,MSG_F_IS_EMPTY:2108,MSG_ONPROGRESS_FUNCTION_ERROR:2109,MSG_REVOKE_FAIL:2110,MSG_DELETE_FAIL:2111,MSG_UNREAD_ALL_FAIL:2112,READ_RECEIPT_MSG_LIST_EMPTY:2114,MSG_SEND_GRP_WITH_TOPIC_FAIL:2115,CANNOT_DELETE_GRP_SYSTEM_NOTICE:2116,TRANSLATE_TEXT_FAIL:2117,VOICE_TO_TEXT_FAIL:2118,UNSUPPORTED_VOICE_FORMAT:2119,MSG_I_SELECT_F_FIRST:2251,MSG_I_TYPES_LIMIT:2252,MSG_I_SIZE_LIMIT:2253,MSG_A_UPLOAD_FAIL:2300,MSG_A_SIZE_LIMIT:2301,MSG_V_UPLOAD_FAIL:2350,MSG_V_SIZE_LIMIT:2351,MSG_V_TYPES_LIMIT:2352,MSG_F_UPLOAD_FAIL:2400,MSG_F_SELECT_F_FIRST:2401,MSG_F_SIZE_LIMIT:2402,MSG_F_URL_IS_EMPTY:2403,MSG_MERGER_TYPE_INVALID:2450,MSG_MERGER_KEY_INVALID:2451,MSG_MERGER_DOWNLOAD_FAIL:2452,MSG_FORWARD_TYPE_INVALID:2453,MSG_FORWARD_INVALID_ELEMENTS:2454,MSG_MODIFY_CONFLICT:2480,MSG_MODIFY_DISABLED_IN_AVCHATROOM:2481,CONV_NOT_FOUND:2500,USER_OR_GRP_NOT_FOUND:2501,CONV_UN_RECORDED_TYPE:2502,INVALID_CONV_ID:2503,ILLEGAL_GRP_TYPE:2600,CANNOT_JOIN_WORK:2601,ILLEGAL_GRP_ID:2602,CANNOT_FIND_GRP:2603,CANNOT_CHANGE_OWNER_IN_AVCHATROOM:2620,CANNOT_CHANGE_OWNER_TO_SELF:2621,CANNOT_DISMISS_WORK:2622,MEMBER_NOT_IN_GRP:2623,JOIN_GRP_FAIL:2660,CANNOT_ADD_MEMBER_IN_AVCHATROOM:2661,CANNOT_JOIN_NON_AVCHATROOM_WITHOUT_LOGIN:2662,NOT_OWNER:2681,CANNOT_SET_MEMBER_ROLE_IN_WORK_AND_AVCHATROOM:2682,INVALID_MEMBER_ROLE:2683,CANNOT_SET_SELF_MEMBER_ROLE:2684,CANNOT_MUTE_SELF:2685,BAN_DURATION_INVALID:2686,OPERATION_NOT_SUPPORTED_IN_AVCHATROOM:2687,NOT_MY_FRIEND:2700,ALREADY_MY_FRIEND:2701,FRIEND_GRP_EXISTED:2710,FRIEND_GRP_NOT_EXIST:2711,FRIEND_APPLICATION_NOT_EXIST:2716,UPDATE_PROFILE_INVALID_PARAM:2721,UPDATE_PROFILE_NO_KEY:2722,CANNOT_ADD_SELF_TO_BLACKLIST:2742,NETWORK_ERROR:2800,NETWORK_TIMEOUT:2801,NO_NETWORK:2805,UNCAUGHT_ERROR:2903,INVALID_OPERATION:2905,INVALID_TRTC_CMD:2995,OVER_FREQUENCY_LIMIT:2996,CANNOT_FIND_PROTOCOL:2997,CANNOT_FIND_MODULE:2998,SDK_IS_NOT_READY:2999,LOGGING_IN:3e3,LOGIN_FAILED:3001,KICKED_OUT_MULT_DEVICE:3002,KICKED_OUT_MULT_ACCOUNT:3003,KICKED_OUT_USERSIG_EXPIRED:3004,LOGGED_OUT:3005,KICKED_OUT_REST_API:3006,ILLEGAL_TOPIC_ID:3021,CANNOT_USE_COMMERCIAL_ABILITY:3122,PROFANITY_FOUND:3123,OPTIONS_IS_EMPTY:3153,MSG_A2KEY_EXPIRED:20002,ACCOUNT_A2KEY_EXPIRED:70001,HELLO_ANSWER_KICKED_OUT:1002,OPEN_SERVICE_OVERLOAD_ERROR:60022,SIGNALING_INVALID_INVITE_ID:8010,SIGNALING_NO_PERMISSION:8011,SIGNALING_ALREADY_EXISTS:8012,INVALID_CANCEL_MESSAGE:8020,MSG_SEARCH_CURSOR_INVALID:27002,MSG_SEARCH_CURSOR_EXPIRED:27003},Vn=null,Bn=function(e){return Promise.resolve(xn(e))},jn=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e instanceof Fn)return t&&null!==Vn&&Vn.emit(A.ERROR,e),Promise.reject(e);if(e instanceof Error){var n=new Fn({code:qn.UNCAUGHT_ERROR});return t&&null!==Vn&&Vn.emit(A.ERROR,n),Promise.reject(n)}if(at(e)||at(e.code))return Promise.reject(new Fn({code:qn.UNCAUGHT_ERROR}));var r=new Fn(e);return t&&null!==Vn&&Vn.emit(A.ERROR,r),Promise.reject(r)},Hn=function(){function e(t){a(this,e),this._m=t,this._n=""}return c(e,[{key:"isLoggedIn",value:function(){return this._m.getModule(12).isLoggedIn()}},{key:"isOversea",value:function(){return this._m.getModule(12).isOversea()}},{key:"isPrivateNetWork",value:function(){return this._m.getModule(12).isPrivateNetWork()}},{key:"getFileDownloadProxy",value:function(){return this._m.getModule(12).getFileDownloadProxy()}},{key:"getMyUserID",value:function(){return this._m.getModule(12).getUserID()}},{key:"getMyTinyID",value:function(){return this._m.getModule(12).getTinyID()}},{key:"getSDKAppID",value:function(){return this._m.getModule(12).getSDKAppID()}},{key:"isIntl",value:function(){return this._m.getModule(12).isIntl()}},{key:"isUsingChatCore",value:function(){return this._m.getModule(12).isUsingChatCore()}},{key:"isDevMode",value:function(){return this._m.getModule(12).isDevMode()}},{key:"getModule",value:function(e){return this._m.getModule(e)}},{key:"getPlatform",value:function(){return ie}},{key:"getNetworkType",value:function(){return this._m.getModule(15).getNetworkType()}},{key:"probeNetwork",value:function(e){return this._m.getModule(15).probe(e)}},{key:"getCloudConfig",value:function(e){return this._m.getModule(23).getCloudConfig(e)}},{key:"emitOuterEvent",value:function(e,t){this._m.getOuterEmitterInstance().emit(e,t)}},{key:"emitInnerEvent",value:function(e,t){this._m.getInnerEmitterInstance().emit(e,t)}},{key:"getInnerEmitterInstance",value:function(){return this._m.getInnerEmitterInstance()}},{key:"generateTjgID",value:function(e){return this._m.getModule(12).getTinyID()+"-"+e.random}},{key:"filterModifiedMessage",value:function(e){if(!Qt(e)){var t=e.filter((function(e){return!0===e.isModified}));t.length>0&&this.emitOuterEvent(A.MESSAGE_MODIFIED,t)}}},{key:"filterUnmodifiedMessage",value:function(e){return Qt(e)?[]:e.filter((function(e){return!1===e.isModified}))}},{key:"request",value:function(e){return this._m.getModule(20).request(e)}},{key:"canIUse",value:function(e){return this._m.getModule(27).canIUse(e)}},{key:"getErrorMessage",value:function(e,t,n){return this._m.getErrorMessage(e,t,n)}},{key:"outputWarning",value:function(e,t,n){var r=this.getErrorMessage(e,t,n);r&&Ge.w(r)}},{key:"cannotUseCommercialAbility",value:function(e){var t=qn.CANNOT_USE_COMMERCIAL_ABILITY;return jn({code:t,message:this.getErrorMessage(t,e)})}}]),e}(),Kn={LOGIN:"wslogin",LOGOUT:"wslogout",HELLO:"wshello",KICK_OTHER:"KickOther",SYNC_UNREAD_MESSAGE:"getmsg",SEND_C2C_MESSAGE:"sendmsg",SEND_GROUP_MESSAGE:"send_group_msg",GET_USER_PROFILE:"portrait_get_all",UPDATE_MY_PROFILE:"portrait_set",GET_BLACKLIST:"black_list_get",ADD_TO_BLACKLIST:"black_list_add",REMOVE_FROM_BLACKLIST:"black_list_delete",GET_FRIEND_LIST:"friend_get",GET_FRIEND_PROFILE:"friend_get_specified",CHECK_FRIEND:"friend_check",DELETE_FRIEND:"friend_delete",ADD_FRIEND:"friend_add",UPDATE_FRIEND:"friend_update",RESPOND_FRIEND_APPLICATION:"friend_response",GET_FRIEND_APPLICATION_LIST:"pendency_get",DELETE_FRIEND_APPLICATION:"pendency_delete",REFUSE_FRIEND_APPLICATION:"pendency_refuse",REPORT_FRIEND_APPLICATION:"pendency_report",GET_FRIEND_GROUP_LIST:"group_get",CREATE_FRIEND_GROUP:"group_add",DELETE_FRIEND_GROUP:"group_delete",UPDATE_FRIEND_GROUP:"group_update",REVOKE_C2C_MESSAGE:"msgwithdraw",SET_C2C_MESSAGE_READ:"msgreaded",SET_C2C_PEER_MUTE_NOTIFICATIONS:"set_c2c_peer_mute_notifications",GET_C2C_PEER_MUTE_NOTIFICATIONS:"get_c2c_peer_mute_notifications",GET_C2C_ROAMING_MESSAGE:"getroammsg",GET_C2C_PEER_READ_TIME:"get_peer_read_time",DELETE_C2C_MESSAGE:"delete_c2c_msg_ramble",MODIFY_C2C_MESSAGE:"modify_c2c_msg",MODIFY_C2C_MESSAGE_EXTENSIONS:"set_key_values",GET_C2C_MESSAGE_EXTENSIONS:"get_key_values",ADD_C2C_MSG_REACTION:"reaction_add",REMOVE_C2C_MSG_REACTION:"reaction_del",GET_C2C_MSG_REACTIONS:"reaction_multi_stat",GET_C2C_MSG_REACTION_USER_LIST:"reaction_iterate",PAGING_GET_CONVERSATION_LIST:"page_get",DELETE_CONVERSATION:"batch_delete",CLEAR_HISTORY_MESSAGE:"clear_msg",PIN_CONVERSATION:"top",DELETE_GROUP_AT_TIPS:"deletemsg",SET_CONVERSATION_CUSTOM_DATA:"set_conv_custom_data",MARK_CONVERSATION:"mark_contact",CREATE_CONVERSATION_GROUP:"create_contact_group",DELETE_CONVERSATION_GROUP:"del_contact_group",RENAME_CONVERSATION_GROUP:"update_contact_group",ADD_CONVERSATIONS_TO_GROUP:"add_conv_to_group",DELETE_CONVERSATIONS_FROM_GROUP:"del_conv_from_group",GET_CONVERSATION_GROUP_LIST:"get_contact_group",GET_GROUP_LIST:"get_joined_group_list",GET_GROUP_PROFILE:"get_group_self_member_info",CREATE_GROUP:"create_group",DISMISS_GROUP:"destroy_group",UPDATE_GROUP_PROFILE:"modify_group_base_info",APPLY_JOIN_GROUP:"apply_join_group",APPLY_JOIN_GROUP_NOAUTH:"apply_join_group_noauth",QUIT_GROUP:"quit_group",SEARCH_GROUP:"get_group_public_info",CHANGE_GROUP_OWNER:"change_group_owner",HANDLE_GROUP_APPLICATION:"handle_apply_join_group",HANDLE_INVITE_JOIN_GROUP:"handle_invite_join_permission_group",HANDLE_GROUP_INVITATION:"handle_invite_join_group",REVOKE_GROUP_MESSAGE:"group_msg_recall",SET_GROUP_MESSAGE_READ:"msg_read_report",SET_ALL_MESSAGE_READ:"read_all_unread_msg",GET_GROUP_ROAMING_MESSAGE:"group_msg_get",GET_READ_RECEIPT:"get_group_msg_receipt",SEND_READ_RECEIPT:"group_msg_receipt",SEND_C2C_READ_RECEIPT:"c2c_msg_read_receipt",GET_READ_RECEIPT_DETAIL:"get_group_msg_receipt_detail",GET_GROUP_PENDENCY:"get_pendency",DELETE_GROUP_SYSTEM_NOTICE:"deletemsg",AVCHATROOM_POLLING:"get_msg",AVCHATROOM_NOAUTH_POLLING:"get_msg_noauth",GET_ONLINE_MEMBER_NUM:"get_online_member_num",DELETE_GROUP_MESSAGE:"delete_group_ramble_msg_by_seq",MODIFY_GROUP_MESSAGE:"modify_group_msg",SET_GROUP_ATTRIBUTES:"set_group_attr",MODIFY_GROUP_ATTRIBUTES:"modify_group_attr",DELETE_GROUP_ATTRIBUTES:"delete_group_attr",CLEAR_GROUP_ATTRIBUTES:"clear_group_attr",GET_GROUP_ATTRIBUTES:"get_group_attr",MODIFY_GROUP_MESSAGE_EXTENSIONS:"group_set_key_values",GET_GROUP_MESSAGE_EXTENSIONS:"group_get_key_values",GET_GROUP_NOTIFY:"batch_get_group_notify",UPDATE_GROUP_COUNTER:"update_group_counter",GET_GROUP_COUNTER:"get_group_counter",ADD_GRP_MSG_REACTION:"group_reaction_add",REMOVE_GRP_MSG_REACTION:"group_reaction_del",GET_GRP_MSG_REACTIONS:"group_reaction_multi_stat",GET_GRP_MSG_REACTION_USER_LIST:"group_reaction_iterate",GET_GROUP_MEMBER_LIST:"get_group_member_info",GET_AVCHATROOM_MEMBER_LIST:"get_members",GET_GROUP_MEMBER_PROFILE:"get_specified_group_member_info",ADD_GROUP_MEMBER:"add_group_member",DELETE_GROUP_MEMBER:"delete_group_member",BAN_AVCHATROOM_MEMBER:"ban_group_member",MODIFY_GROUP_MEMBER_INFO:"modify_group_member_info",MARK_AVCHATROOM_MEMBER_INFO:"modify_user_info",COS_SIGN:"cos",COS_PRE_SIG:"pre_sig",SIMPLE_COS_PRE_SIG:"simple_sig",GET_IMAGE_INFO:"get_imageinfo",GET_IP:"get_final_ip",VIDEO_COVER:"video_cover",SSO_STAT:"tim_web_report_v2",PING:"alive",MESSAGE_PUSH:"msg_push",MESSAGE_CLOUD_SEARCH:"query",MULTI_MESSAGE_PUSH:"multi_msg_push_ws",MESSAGE_PUSH_ACK:"ws_msg_push_ack",STATUS_FORCE_OFFLINE:"stat_forceoffline",UPLOAD_MERGER_MESSAGE:"save_relay_json_msg",DOWNLOAD_MERGER_MESSAGE:"get_relay_json_msg",FETCH_CLOUD_CONTROL_CONFIG:"fetch_config",PUSHED_CLOUD_CONTROL_CONFIG:"push_configv2",FETCH_COMMERCIAL_CONFIG:"fetch_imsdk_purchase_bitsv2",PUSHED_COMMERCIAL_CONFIG:"push_imsdk_purchase_bitsv2",OVERLOAD_NOTIFY:"notify2",CREATE_TOPIC:"create_topic",DELETE_TOPIC:"destroy_topic",UPDATE_TOPIC_PROFILE:"modify_topic",GET_TOPIC_LIST:"get_topic",SET_SELF_STATUS:"ws_set_custom_status",GET_USER_STATUS:"ws_get_user_status",SUBSCRIBE_USER_STATUS:"ws_status_subscribe",UNSUBSCRIBE_USER_STATUS:"ws_status_unsubscribe",STAT_BACKGROUND:"ws_stat_background",STAT_FOREGROUND:"ws_stat_foreground",SET_TOKEN:"ws_stat_settoken",GET_PROFANITY_LIST:"get_local_words",TRANSLATE_TEXT:"ws_batch_trans_text",VOICE_TO_TEXT:"ws_sentence_recognition"},Wn="networkRTT",Yn="messageE2EDelay",zn="sendMessageC2C",Jn="sendMessageGroup",Xn="sendMessageGroupAV",$n="sendMessageRichMedia",Zn="cosUpload",Qn="messageReceivedGroup",er="messageReceivedGroupAVPush",tr="messageReceivedGroupAVPull",nr=(l(nn={},Wn,2),l(nn,Yn,3),l(nn,zn,4),l(nn,Jn,5),l(nn,Xn,6),l(nn,$n,7),l(nn,Qn,8),l(nn,er,9),l(nn,tr,10),l(nn,Zn,11),nn),rr={info:4,warning:5,error:6},or={wifi:1,"2g":2,"3g":3,"4g":4,"5g":5,unknown:6,none:7,online:8},ir={login:4},ar=function(){function e(t){a(this,e),this._n="SSOLogData",this.eventType=ir[t]||0,this.timestamp=0,this.networkType=8,this.code=0,this.message="",this.moreMessage="",this.extension=t,this.costTime=0,this.duplicate=!1,this.level=4,this.uiPlatform=void 0,this._sentFlag=!1,this._startts=Re()}return c(e,[{key:"updateTimeStamp",value:function(){this.timestamp=Re()}},{key:"start",value:function(e){return this._startts=e,this}},{key:"end",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this._sentFlag){var n=Re();0===this.costTime&&(this.costTime=n-this._startts),this.setMoreMessage("startts:".concat(this._startts," endts:").concat(n)),t?(this._sentFlag=!0,this._eventStatModule&&this._eventStatModule.pushIn(this)):setTimeout((function(){e._sentFlag=!0,e._eventStatModule&&e._eventStatModule.pushIn(e)}),0)}}},{key:"setError",value:function(e,t,n){if(!(e instanceof Error))return Ge.w("".concat(this._n,".setError value not instanceof Error, please check!")),this;if(this._sentFlag)return this;if(this.setNetworkType(n),t)e.code&&this.setCode(e.code),e.message&&this.setMoreMessage(e.message);else{var r=qn.NO_NETWORK;this.setCode(r)}return this.setLevel("error"),this}},{key:"setCode",value:function(e){return at(e)||this._sentFlag||("ECONNABORTED"===e&&(this.code=103),et(e)?this.code=e:Ge.w("".concat(this._n,".setCode value not a number, please check!"),e,n(e))),this}},{key:"setMessage",value:function(e){return at(e)||this._sentFlag||(et(e)&&(this.message=e.toString()),nt(e)&&(this.message=e)),this}},{key:"setCostTime",value:function(e){return this.costTime=e,this}},{key:"setLevel",value:function(e){return at(e)||this._sentFlag||(this.level=rr[e]),this}},{key:"setMoreMessage",value:function(e){return Qt(this.moreMessage)?this.moreMessage="".concat(e):this.moreMessage+=" ".concat(e),this}},{key:"setNetworkType",value:function(e){if(at(e))Ge.w("".concat(this._n,".setNetworkType value is undefined, please check!"));else{var t=or[e.toLowerCase()];at(t)||(this.networkType=t)}return this}},{key:"getStartTs",value:function(){return this._startts}},{key:"setUIPlatform",value:function(e){this.uiPlatform=e}},{key:"setExtension",value:function(e){return this.extension=e,this}},{key:"setEventType",value:function(e){return this.eventType=e,this}}],[{key:"bindEventStatModule",value:function(t){e.prototype._eventStatModule=t}}]),e}(),sr=function(){function e(t){a(this,e),this.type=O.MSG_TEXT,this.content={text:t.text||""}}return c(e,[{key:"setText",value:function(e){this.content.text=e}},{key:"sendable",value:function(){return 0!==this.content.text.length}}]),e}(),ur=function(){function e(t,n){a(this,e),this._imageMemoryURL="",this._fileDownloadProxy=n,$?this.createImageDataASURLInWXMiniApp(t.file):this.createImageDataASURLInWeb(t.file),this._initImageInfoModel(),this.type=O.MSG_IMAGE,this._percent=0,this.content={imageFormat:t.imageFormat||xe.UNKNOWN,uuid:t.uuid,imageInfoArray:[]},this.initImageInfoArray(t.imageInfoArray),this._autoFixUrl()}return c(e,[{key:"_initImageInfoModel",value:function(){var e=this;this._ImageInfoModel=function(t){this.instanceID=vt(9999999),this.sizeType=t.type||0,this.type=0,this.size=t.size||0,this.width=t.width||0,this.height=t.height||0,this.imageUrl=t.imageUrl||t.url||"",this.url=Yt(t.url||e._imageMemoryURL,e._fileDownloadProxy)},this._ImageInfoModel.prototype={setSizeType:function(e){this.sizeType=e},setType:function(e){this.type=e},setImageUrl:function(e){e&&(this.imageUrl=e)},getImageUrl:function(){return this.imageUrl}}}},{key:"initImageInfoArray",value:function(e){for(var t=0,n=null,r=null;t<=2;)r=at(e)||at(e[t])?{type:0,size:0,width:0,height:0,url:""}:e[t],(n=new this._ImageInfoModel(r)).setSizeType(t+1),n.setType(t),this.addImageInfo(n),t++;this.updateAccessSideImageInfoArray()}},{key:"updateImageInfoArray",value:function(e){for(var t,n=this.content.imageInfoArray.length,r=0;r<n;r++)t=this.content.imageInfoArray[r],e[r].size&&(t.size=e[r].size),e[r].url&&t.setImageUrl(e[r].url),e[r].width&&(t.width=e[r].width),e[r].height&&(t.height=e[r].height)}},{key:"_autoFixUrl",value:function(){for(var e=this.content.imageInfoArray.length,t="",n="",r=["http","https"],o=null,i=0;i<e;i++)this.content.imageInfoArray[i].url&&""!==(o=this.content.imageInfoArray[i]).imageUrl&&(n=o.imageUrl.slice(0,o.imageUrl.indexOf("://")+1),t=o.imageUrl.slice(o.imageUrl.indexOf("://")+1),r.indexOf(n)<0&&(n="https:"),this.content.imageInfoArray[i].setImageUrl([n,t].join("")))}},{key:"updatePercent",value:function(e){this._percent=e,this._percent>1&&(this._percent=1)}},{key:"updateImageFormat",value:function(e){this.content.imageFormat=xe[e.toUpperCase()]||xe.UNKNOWN}},{key:"createImageDataASURLInWeb",value:function(e){void 0!==e&&e.files.length>0&&(this._imageMemoryURL=window.URL.createObjectURL(e.files[0]))}},{key:"createImageDataASURLInWXMiniApp",value:function(e){e&&e.url&&(this._imageMemoryURL=e.url)}},{key:"replaceImageInfo",value:function(e,t){this.content.imageInfoArray[t]instanceof this._ImageInfoModel||(this.content.imageInfoArray[t]=e)}},{key:"addImageInfo",value:function(e){this.content.imageInfoArray.length>=3||this.content.imageInfoArray.push(e)}},{key:"updateAccessSideImageInfoArray",value:function(){var e=this.content.imageInfoArray,t=e[0],n=t.width,r=void 0===n?0:n,o=t.height,i=void 0===o?0:o;0!==r&&0!==i&&(Ut(e),Object.assign(e[2],Pt({originWidth:r,originHeight:i,min:720})))}},{key:"sendable",value:function(){return 0!==this.content.imageInfoArray.length&&""!==this.content.imageInfoArray[0].imageUrl&&0!==this.content.imageInfoArray[0].size}}]),e}(),cr=function(){function e(t){a(this,e),this.type=O.MSG_FACE,this.content=t||null}return c(e,[{key:"sendable",value:function(){return null!==this.content}}]),e}(),lr=function(){function e(t,n){a(this,e),this.type=O.MSG_AUDIO,this._percent=0,this.content={downloadFlag:2,second:t.second,size:t.size,url:Yt(t.url,n),remoteAudioUrl:t.url||"",uuid:t.uuid}}return c(e,[{key:"updatePercent",value:function(e){this._percent=e,this._percent>1&&(this._percent=1)}},{key:"updateAudioUrl",value:function(e){this.content.remoteAudioUrl=e}},{key:"sendable",value:function(){return""!==this.content.remoteAudioUrl}}]),e}(),dr={from:!0,groupID:!0,groupName:!0,to:!0},fr=function(){function e(t){a(this,e),this.type=O.MSG_GRP_TIP,this.content={},this._initContent(t)}return c(e,[{key:"_initContent",value:function(e){var t=this;Object.keys(e).forEach((function(n){switch(n){case"remarkInfo":break;case"groupProfile":t.content.groupProfile={},t._initGroupProfile(e[n]);break;case"operatorInfo":break;case"memberInfoList":case"msgMemberInfo":t._updateMemberList(e[n]);break;case"memberExtraInfo":case"onlineMemberInfo":break;case"memberNum":t.content[n]=e[n],t.content.memberCount=e[n];break;case"newGroupProfile":t.content.newGroupProfile={},t._initNewGroupProfile(e[n]);break;default:t.content[n]=e[n]}})),this.content.userIDList||(this.content.userIDList=[this.content.operatorID])}},{key:"_initGroupProfile",value:function(e){for(var t=Object.keys(e),n=0;n<t.length;n++){var r=t[n];dr[r]&&(this.content.groupProfile[r]=e[r])}}},{key:"_updateMemberList",value:function(e){Qt(this.content.memberList)?this.content.memberList=e:this.content.memberList.forEach((function(t){e.forEach((function(e){t.userID===e.userID&&Object.assign(t,e)}))}))}},{key:"_initNewGroupProfile",value:function(e){for(var t=Object.keys(e),n=0;n<t.length;n++){var r=t[n];this.content.newGroupProfile[r]="muteAllMembers"!==r?e[r]:1===e[r]}}}]),e}(),pr={from:!0,groupID:!0,groupName:!0,to:!0},hr=function(){function e(t){a(this,e),this.type=O.MSG_GRP_SYS_NOTICE,this.content={},this._initContent(t)}return c(e,[{key:"_initContent",value:function(e){var t=this;Object.keys(e).forEach((function(n){switch(n){case"memberInfoList":break;case"remarkInfo":t.content.handleMessage=e[n];break;case"groupProfile":t.content.groupProfile={},t._initGroupProfile(e[n]);break;default:t.content[n]=e[n]}}))}},{key:"_initGroupProfile",value:function(e){for(var t=Object.keys(e),n=0;n<t.length;n++){var r=t[n];pr[r]&&("groupName"===r?this.content.groupProfile.name=e[r]:this.content.groupProfile[r]=e[r])}}}]),e}(),gr=function(){function e(t,n){a(this,e),this.type=O.MSG_FILE,this._percent=0;var r=this._getFileInfo(t);this.content={downloadFlag:2,fileUrl:Yt(t.url||t.fileUrl,n)||"",uuid:t.uuid,fileName:r.name||"",fileSize:r.size||0}}return c(e,[{key:"_getFileInfo",value:function(e){if(!at(e.fileName)&&!at(e.fileSize))return{size:e.fileSize,name:e.fileName};var t=e.file.files[0];if(J){if(t.path&&-1!==t.path.indexOf(".")){var n=t.path.slice(t.path.lastIndexOf(".")+1).toLowerCase();t.type=n,t.name||(t.name="".concat(vt(999999),".").concat(n))}t.name||(t.type="",t.name=t.path.slice(t.path.lastIndexOf("/")+1).toLowerCase()),t.suffix&&(t.type=t.suffix),t.url||(t.url=t.path)}return{size:t.size,name:t.name}}},{key:"updatePercent",value:function(e){this._percent=e,this._percent>1&&(this._percent=1)}},{key:"updateFileUrl",value:function(e){this.content.fileUrl=e}},{key:"sendable",value:function(){return""!==this.content.fileUrl&&""!==this.content.fileName&&0!==this.content.fileSize}}]),e}(),vr=function(){function e(t){a(this,e),this.type=O.MSG_CUSTOM,this.content={data:t.data||"",description:t.description||"",extension:t.extension||""}}return c(e,[{key:"setData",value:function(e){return this.content.data=e,this}},{key:"setDescription",value:function(e){return this.content.description=e,this}},{key:"setExtension",value:function(e){return this.content.extension=e,this}},{key:"sendable",value:function(){return 0!==this.content.data.length||0!==this.content.description.length||0!==this.content.extension.length}}]),e}(),_r=function(){function e(t,n){a(this,e),this.type=O.MSG_VIDEO,this._percent=0,this.content={remoteVideoUrl:t.remoteVideoUrl||t.videoUrl||"",videoFormat:t.videoFormat,videoSecond:parseInt(t.videoSecond,10),videoSize:t.videoSize,videoUrl:Yt(t.videoUrl,n),videoDownloadFlag:2,videoUUID:t.videoUUID,thumbUUID:t.thumbUUID,thumbFormat:t.thumbFormat,thumbWidth:t.thumbWidth,snapshotWidth:t.thumbWidth,thumbHeight:t.thumbHeight,snapshotHeight:t.thumbHeight,thumbSize:t.thumbSize,snapshotSize:t.thumbSize,thumbDownloadFlag:2,thumbUrl:Yt(t.thumbUrl,n),snapshotUrl:Yt(t.thumbUrl,n)}}return c(e,[{key:"updatePercent",value:function(e){this._percent=e,this._percent>1&&(this._percent=1)}},{key:"updateVideoUrl",value:function(e){e&&(this.content.remoteVideoUrl=e)}},{key:"updateSnapshotInfo",value:function(e){var t=e.snapshotUrl,n=e.snapshotWidth,r=e.snapshotHeight;Qt(t)||(this.content.thumbUrl=this.content.snapshotUrl=t),Qt(n)||(this.content.thumbWidth=this.content.snapshotWidth=Number(n)),Qt(r)||(this.content.thumbHeight=this.content.snapshotHeight=Number(r))}},{key:"sendable",value:function(){return""!==this.content.remoteVideoUrl}}]),e}(),mr=function(){function e(t){a(this,e),this.type=O.MSG_LOCATION;var n=t.description,r=t.longitude,o=t.latitude;this.content={description:n,longitude:r,latitude:o}}return c(e,[{key:"sendable",value:function(){return!0}}]),e}(),yr=function(){function e(t,n){if(a(this,e),this.from=t.from,this.messageSender=t.from,this.time=t.time,this.messageSequence=t.sequence,this.clientSequence=t.clientSequence||t.sequence,this.messageRandom=t.random,this.cloudCustomData=t.cloudCustomData||"",this.clientTime=t.clientTime||void 0,t.ID)this.ID=t.ID||"",this.nick=t.nick||"",this.avatar=t.avatar||"",t.messageBody?this.messageBody=JSON.parse(JSON.stringify(t.messageBody)):this.messageBody=[{type:t.type,payload:t.payload}],t.conversationType?t.conversationType.startsWith(O.CONV_C2C)?this.receiverUserID=t.to:t.conversationType.startsWith(O.CONV_GROUP)&&(this.receiverGroupID=t.to):t.receiverGroupID?this.receiverGroupID=t.receiverGroupID:t.receiverUserID&&(this.receiverUserID=t.receiverUserID),this.messageReceiver=t.to||t.messageReceiver;else{this.nick=t.nick||"",this.avatar=t.avatar||"",this.messageBody=[];var r=t.elements[0].type,o=t.elements[0].content;this._patchRichMediaPayload(r,o),this._updateRichMediaDownloadUrl(r,o,n),r===O.MSG_MERGER?this.messageBody.push({type:r,payload:new Ir(o).content}):this.messageBody.push({type:r,payload:o}),t.groupID&&(this.receiverGroupID=t.groupID,this.messageReceiver=t.groupID),t.to&&(this.receiverUserID=t.to,this.messageReceiver=t.to),this.ID="".concat(t.tinyID,"-").concat(t.clientTime,"-").concat(t.random)}}return c(e,[{key:"_patchRichMediaPayload",value:function(e,t){e===O.MSG_IMAGE?t.imageInfoArray.forEach((function(e){!e.imageUrl&&e.url&&(e.imageUrl=e.url,e.sizeType=e.type,1===e.type?e.type=0:3===e.type&&(e.type=1))})):e===O.MSG_VIDEO?!t.remoteVideoUrl&&t.videoUrl&&(t.remoteVideoUrl=t.videoUrl):e===O.MSG_AUDIO?!t.remoteAudioUrl&&t.url&&(t.remoteAudioUrl=t.url):e===O.MSG_FILE&&!t.fileUrl&&t.url&&(t.fileUrl=t.url,t.url=void 0)}},{key:"_updateRichMediaDownloadUrl",value:function(e,t,n){n&&(e===O.MSG_IMAGE?t.imageInfoArray.forEach((function(e){e.url=Yt(e.url,n)})):e===O.MSG_VIDEO?(t.videoUrl=Yt(t.videoUrl,n),t.snapshotUrl=Yt(t.thumbUrl,n),t.snapshotHeight=t.thumbHeight,t.snapshotWidth=t.thumbWidth):e===O.MSG_AUDIO?t.url=Yt(t.url,n):e===O.MSG_FILE&&(t.fileUrl=Yt(t.fileUrl,n)))}}]),e}(),Ir=function(){function e(t,n){if(a(this,e),this.type=O.MSG_MERGER,this.content={downloadKey:"",pbDownloadKey:"",messageList:[],title:"",abstractList:[],compatibleText:"",version:0,layersOverLimit:!1},t.downloadKey){var r=t.downloadKey,o=t.pbDownloadKey,i=t.title,s=t.abstractList,u=t.compatibleText,c=t.version;this.content.downloadKey=r,this.content.pbDownloadKey=o,this.content.title=i,this.content.abstractList=s,this.content.compatibleText=u,this.content.version=c||0}else if(Qt(t.messageList))1===t.layersOverLimit&&(this.content.layersOverLimit=!0);else{var l=t.messageList,d=t.title,f=t.abstractList,p=t.compatibleText,h=t.version,g=[];l.forEach((function(e){if(!Qt(e)){var t=new yr(e,n);g.push(t)}})),this.content.messageList=g,this.content.title=d,this.content.abstractList=f,this.content.compatibleText=p,this.content.version=h||0}}return c(e,[{key:"sendable",value:function(){return!Qt(this.content.messageList)||!Qt(this.content.downloadKey)}}]),e}(),Mr={1:O.MSG_PRIORITY_HIGH,2:O.MSG_PRIORITY_NORMAL,3:O.MSG_PRIORITY_LOW,4:O.MSG_PRIORITY_LOWEST},Tr=function(){function e(t){a(this,e),this.ID="",this.conversationID=t.conversationID||null,this.conversationType=t.conversationType||O.CONV_C2C,this.conversationSubType=t.conversationSubType,this.time=t.time||Math.ceil(Date.now()/1e3),this.sequence=t.sequence||0,this.clientSequence=t.clientSequence||t.sequence||0,this.random=t.random||0===t.random?t.random:vt(),this.priority=this._computePriority(t.priority),this.nick=t.nick||"",this.avatar=t.avatar||"",this.isPeerRead=!1,this.nameCard="",this.hasRiskContent=$t(t.checkResult),this._elements=[],this.isPlaceMessage=t.isPlaceMessage||0,this.isRevoked=2===t.isPlaceMessage||8===t.msgFlagBits,this.from=t.from||null,this.to=t.to||null,this.flow="",this.isSystemMessage=t.isSystemMessage||!1,this.protocol=t.protocol||"JSON",this.isResend=!1,this.isRead=!1,this.status=t.status||rn.SUCCESS,this._onlineOnlyFlag=!1,this._groupAtInfoList=[],this._relayFlag=!1,this.atUserList=[],this.cloudCustomData=t.cloudCustomData||"",this.isDeleted=!1,this.isModified=!1,this._isExcludedFromUnreadCount=!(!t.messageControlInfo||1!==t.messageControlInfo.excludedFromUnreadCount),this._isExcludedFromLastMessage=!(!t.messageControlInfo||1!==t.messageControlInfo.excludedFromLastMessage),this.clientTime=t.clientTime||we()||0,this.senderTinyID=t.senderTinyID||t.tinyID||"",this.readReceiptInfo=t.readReceiptInfo||{readCount:void 0,unreadCount:void 0,isPeerRead:void 0},this.needReadReceipt=!0===t.needReadReceipt||1===t.needReadReceipt,this.version=t.messageVersion||0,this.isBroadcastMessage=t.isBroadcastMessage||!1,this._receiverList=t.receiverList||void 0,this.isSupportExtension=!0===t.isSupportExtension||1===t.isSupportExtension,this.revoker=t.revokerInfo&&t.revokerInfo.revoker||"",this.revokerInfo=t.revokerInfo||{userID:"",nick:"",avatar:""},this.revokeReason=t.revokeReason||"",this.reInitialize(t.currentUser),this.extractGroupInfo(t.groupProfile||null),this.handleGroupAtInfo(t),this.initC2CReadReceiptInfo(t.readReceiptSentByPeer)}return c(e,[{key:"elements",get:function(){return this._elements}},{key:"getElements",value:function(){return this._elements}},{key:"extractGroupInfo",value:function(e){if(null!==e){nt(e.nick)&&(this.nick=e.nick),nt(e.avatar)&&(this.avatar=e.avatar);var t=e.messageFromAccountExtraInformation;ot(t)&&nt(t.nameCard)&&(this.nameCard=t.nameCard)}}},{key:"handleGroupAtInfo",value:function(e){var t=this;e.payload&&e.payload.atUserList&&e.payload.atUserList.forEach((function(e){e!==O.MSG_AT_ALL?(t._groupAtInfoList.push({groupAtAllFlag:0,groupAtUserID:e}),t.atUserList.push(e)):(t._groupAtInfoList.push({groupAtAllFlag:1}),t.atUserList.push(O.MSG_AT_ALL))})),it(e.groupAtInfo)&&e.groupAtInfo.forEach((function(e){0===e.groupAtAllFlag?t.atUserList.push(e.groupAtUserID):1===e.groupAtAllFlag&&t.atUserList.push(O.MSG_AT_ALL)}))}},{key:"getGroupAtInfoList",value:function(){return this._groupAtInfoList}},{key:"_initProxy",value:function(){this._elements[0]&&(this.payload=this._elements[0].content,this.type=this._elements[0].type)}},{key:"reInitialize",value:function(e){e&&(this.status=this.from?rn.SUCCESS:rn.UNSEND,!this.from&&(this.from=e)),this._initFlow(e),this._initSequence(e),this._concatConversationID(e),this.generateMessageID()}},{key:"isSendable",value:function(){return 0!==this._elements.length&&(!0===this._relayFlag||"function"==typeof this._elements[0].sendable&&this._elements[0].sendable())}},{key:"_initTo",value:function(e){this.conversationType===O.CONV_GROUP&&(this.to=e.groupID)}},{key:"_initSequence",value:function(e){0===this.clientSequence&&e&&(this.clientSequence=function(e){if(!e)return!1;if(void 0===It[e]){var t=new Date,n="3".concat(t.getHours()).slice(-2),r="0".concat(t.getMinutes()).slice(-2),o="0".concat(t.getSeconds()).slice(-2);It[e]=parseInt([n,r,o,"0001"].join("")),n=null,r=null,o=null,Ge.l("autoIncrementIndex start index:".concat(It[e]))}return It[e]++}(e)),0===this.sequence&&this.conversationType===O.CONV_C2C&&(this.sequence=this.clientSequence)}},{key:"generateMessageID",value:function(){this.from===O.CONV_SYSTEM&&(this.senderTinyID="144115198244471703"),this.ID="".concat(this.senderTinyID,"-").concat(this.clientTime,"-").concat(this.random)}},{key:"_initFlow",value:function(e){""!==e&&(e===this.from?(this.flow="out",this.isRead=!0):this.flow="in")}},{key:"_concatConversationID",value:function(e){var t=this.to,n="",r=this.conversationType;r!==O.CONV_SYSTEM?(n=r===O.CONV_C2C?e===this.from?t:this.from:this.to,this.conversationID=n?"".concat(r).concat(n):null):this.conversationID=O.CONV_SYSTEM}},{key:"isElement",value:function(e){return e instanceof sr||e instanceof ur||e instanceof cr||e instanceof lr||e instanceof gr||e instanceof _r||e instanceof fr||e instanceof hr||e instanceof vr||e instanceof mr||e instanceof Ir}},{key:"setElement",value:function(e,t){var n=this;if(this.isElement(e))return this._elements=[e],void this._initProxy();var r=function(e){if(e.type&&e.content)switch(e.type){case O.MSG_TEXT:n.setTextElement(e.content);break;case O.MSG_IMAGE:n.setImageElement(e.content,t);break;case O.MSG_AUDIO:n.setAudioElement(e.content,t);break;case O.MSG_FILE:n.setFileElement(e.content,t);break;case O.MSG_VIDEO:n.setVideoElement(e.content,t);break;case O.MSG_CUSTOM:n.setCustomElement(e.content);break;case O.MSG_LOCATION:n.setLocationElement(e.content);break;case O.MSG_GRP_TIP:n.setGroupTipElement(e.content);break;case O.MSG_GRP_SYS_NOTICE:n.setGroupSystemNoticeElement(e.content);break;case O.MSG_FACE:n.setFaceElement(e.content);break;case O.MSG_MERGER:n.setMergerElement(e.content,t)}};if(it(e))for(var o=0;o<e.length;o++)r(e[o]);else r(e);this._initProxy()}},{key:"clearElement",value:function(){this._elements.length=0}},{key:"setTextElement",value:function(e){var t="string"==typeof e?e:e.text,n=new sr({text:t});this._elements.push(n)}},{key:"setImageElement",value:function(e,t){var n=new ur(e,t);this._elements.push(n)}},{key:"setAudioElement",value:function(e,t){var n=new lr(e,t);this._elements.push(n)}},{key:"setFileElement",value:function(e,t){var n=new gr(e,t);this._elements.push(n)}},{key:"setVideoElement",value:function(e,t){var n=new _r(e,t);this._elements.push(n)}},{key:"setLocationElement",value:function(e){var t=new mr(e);this._elements.push(t)}},{key:"setCustomElement",value:function(e){var t=new vr(e);this._elements.push(t)}},{key:"setGroupTipElement",value:function(e){var t={},n=e.operationType;if(Qt(e.memberInfoList)?e.operatorInfo&&(t=e.operatorInfo):n!==O.GRP_TIP_MBR_JOIN&&n!==O.GRP_TIP_MBR_KICKED_OUT&&n!==O.GRP_TIP_MBR_SET_ADMIN&&n!==O.GRP_TIP_MBR_CANCELED_ADMIN||(t=e.memberInfoList[0]),!Qt(e.memberExtraInfo)){var r=e.memberExtraInfo.reason;e.msgMemberInfo.forEach((function(e){e.reason=r}))}var o=t,i=o.nick,a=o.avatar;nt(i)&&(this.nick=i),nt(a)&&(this.avatar=a);var s=new fr(e);this._elements.push(s)}},{key:"setGroupSystemNoticeElement",value:function(e){var t=new hr(e);this._elements.push(t)}},{key:"setFaceElement",value:function(e){var t=new cr(e);this._elements.push(t)}},{key:"setMergerElement",value:function(e,t){var n=new Ir(e,t);this._elements.push(n)}},{key:"setIsRead",value:function(e){this.isRead=e}},{key:"setRelayFlag",value:function(e){this._relayFlag=e}},{key:"_computePriority",value:function(e){if(at(e))return O.MSG_PRIORITY_NORMAL;if(nt(e)&&-1!==Object.values(Mr).indexOf(e))return e;if(et(e)){var t=""+e;if(-1!==Object.keys(Mr).indexOf(t))return Mr[t]}return O.MSG_PRIORITY_NORMAL}},{key:"setNickAndAvatar",value:function(e){var t=e.nick,n=e.avatar;nt(t)&&(this.nick=t),nt(n)&&(this.avatar=n)}},{key:"setNameCard",value:function(e){nt(e)&&(this.nameCard=e)}},{key:"initC2CReadReceiptInfo",value:function(e){this.conversationType===O.CONV_C2C&&!0===this.needReadReceipt&&(this.readReceiptInfo.isPeerRead=1===e)}}]),e}(),Sr=function(e){d(r,e);var n=I(r);function r(e){var t;return a(this,r),(t=n.call(this,e))._n="C2CModule",t._messageFromUnreadDBMap=new Map,t._noticeFromUnreadDBList=[],t}return c(r,[{key:"onNewC2CMessage",value:function(e){var t=e.dataList,n=e.isInstantMessage,r=e.C2CRemainingUnreadList,o=e.C2CPairUnreadList,i=e.isSyncingEnded;Ge.d("".concat(this._n,".onNewC2CMessage count:").concat(t.length," isInstantMessage:").concat(n));var a=this._newC2CMessageStoredAndSummary({dataList:t,C2CRemainingUnreadList:r,C2CPairUnreadList:o,isInstantMessage:n}),s=a.conversationOptionsList,u=a.messageList,c=a.isUnreadC2CMessage;this.filterModifiedMessage(u),this.getModule(11).onNewMessage({conversationOptionsList:s,isInstantMessage:n,isUnreadC2CMessage:c,isSyncingEnded:i});var l=this.filterUnmodifiedMessage(u);n&&l.length>0&&this.emitOuterEvent(A.MESSAGE_RECEIVED,l),u.length=0}},{key:"_newC2CMessageStoredAndSummary",value:function(e){for(var t=e.dataList,n=e.C2CRemainingUnreadList,r=e.C2CPairUnreadList,o=e.isInstantMessage,i=null,a=[],s=[],u={},c=this.getModule(26),l=!1,d=this.getModule(11),f=this.getModule(4),p=this.getFileDownloadProxy(),h=0,g=t.length;h<g;h++)if(this._isC2CNotice(t[h]))this._noticeFromUnreadDBList.push(t[h].eventArray[0].c2CNotifyMsgArray[0]);else{var v=t[h];v.currentUser=this.getMyUserID(),v.conversationType=O.CONV_C2C,v.isSystemMessage=!!v.isSystemMessage,(at(v.nick)||at(v.avatar))&&(l=!0,Ge.d("".concat(this._n,"._newC2CMessageStoredAndSummary nick or avatar missing!"))),(i=new Tr(v)).setElement(v.elements,p),i.setNickAndAvatar({nick:v.nick,avatar:v.avatar});var _=i.conversationID;if(o){if(1===this._messageFromUnreadDBMap.get(i.ID))continue;var m=!1;if(i.from!==this.getMyUserID()){var y=d.getLatestMessageSentByPeer(_);if(y){var I=y.nick,M=y.avatar;l?i.setNickAndAvatar({nick:I,avatar:M}):I===i.nick&&M===i.avatar||(m=!0)}}else{var T=d.getLatestMessageSentByMe(_);if(T){var S=T.nick,E=T.avatar;S===i.nick&&E===i.avatar||(d.modifyMessageSentByMe({conversationID:_,latestNick:i.nick,latestAvatar:i.avatar}),f.mockOnNickAvatarModified(i.nick,i.avatar))}}var C=1===t[h].isModified;if(d.isMessageSentByCurrentInstance(i)?i.isModified=C:C=!1,0===v.msgLifeTime)i._onlineOnlyFlag=!0,d.isMessageSentByCurrentInstance(i)||s.push(i);else{if(!d.pushIntoMessageList(s,i,C))continue;m&&(d.modifyMessageSentByPeer({conversationID:_,latestNick:i.nick,latestAvatar:i.avatar}),d.updateUserProfileSpecifiedKey({conversationID:_,nick:i.nick,avatar:i.avatar}))}o&&i.clientTime>0&&c.addMessageDelay(i.clientTime)}else this._messageFromUnreadDBMap.set(i.ID,1);if(0!==v.msgLifeTime){if(!1===i._onlineOnlyFlag){var k=d.getLastMessageTime(_);if(et(k)&&i.time<k)continue;if(at(u[_])){var b=0;"in"===i.flow&&(i._isExcludedFromUnreadCount||(b=1)),u[_]=a.push({conversationID:_,unreadCount:b,type:i.conversationType,subType:i.conversationSubType,lastMessage:i._isExcludedFromLastMessage?"":i})-1}else{var D=u[_];a[D].type=i.conversationType,a[D].subType=i.conversationSubType,a[D].lastMessage=i._isExcludedFromLastMessage?"":i,"in"===i.flow&&(i._isExcludedFromUnreadCount||a[D].unreadCount++)}}}else i._onlineOnlyFlag=!0}this._handleRevokedNoticeFromUnreadDB();var A=!1;if(it(r))for(var R=function(e,t){if(r[e].unreadCount>0){A=!0;var n=a.find((function(t){return t.conversationID==="C2C".concat(r[e].from)}));n?n.unreadCount=r[e].unreadCount:a.push({conversationID:"C2C".concat(r[e].from),unreadCount:r[e].unreadCount,type:O.CONV_C2C})}},N=0,w=r.length;N<w;N++)R(N);if(it(n))for(var L=function(e,t){a.find((function(t){return t.conversationID==="C2C".concat(n[e].from)}))||a.push({conversationID:"C2C".concat(n[e].from),type:O.CONV_C2C,lastMsgTime:n[e].lastMsgTime})},P=0,U=n.length;P<U;P++)L(P);return{conversationOptionsList:a,messageList:s,isUnreadC2CMessage:A}}},{key:"_isC2CNotice",value:function(e){var t=e.eventArray;return!(!it(t)||10!==t[0].event)}},{key:"_handleRevokedNoticeFromUnreadDB",value:function(){var e=this._noticeFromUnreadDBList.length;if(0!==e){Ge.l("".concat(this._n,"._handleRevokedNoticeFromUnreadDB count:").concat(e));var t=[];this._noticeFromUnreadDBList.forEach((function(e){e.hasOwnProperty("c2cMessageRevokedNotify")&&t.push(e)})),this.onC2CMessageRevoked({dataList:t}),this._noticeFromUnreadDBList.length=0,t.length=0}}},{key:"onC2CMessageRevoked",value:function(e){var t=this,n=this.getModule(11),r=[],o=null;e.dataList.forEach((function(e){if(e.c2cMessageRevokedNotify){var i=e.c2cMessageRevokedNotify.revokedInfos;at(i)||i.forEach((function(e){var i=t.getMyUserID()===e.from?"".concat(O.CONV_C2C).concat(e.to):"".concat(O.CONV_C2C).concat(e.from);o=n.revoke(i,e.sequence,e.random);var a,s=e.revokerInfo&&e.revokerInfo.revoker,u=e.revokerInfo&&e.revokerInfo.reason||"";o?a=o:(a={conversationID:i,sequence:e.sequence},e.tinyID&&e.clientTime&&e.random&&(a.ID="".concat(e.tinyID,"-").concat(e.clientTime,"-").concat(e.random)),e.time&&(a.time=e.time)),a&&(a.revoker=s,a.revokeReason=u,a.revokerInfo={userID:s,nick:"",avatar:""},r.push(a))}))}})),0!==r.length&&(n.onMessageRevoked(r),Ge.l("".concat(this._n,".onC2CMessageRevoked count:").concat(r.length)),n.updateRevokerInfo(r).then((function(e){t.emitOuterEvent(A.MESSAGE_REVOKED,e)})))}},{key:"onC2CMessageReadReceipt",value:function(e){var t=this;e.dataList.forEach((function(e){if(!Qt(e.c2cMessageReadReceipt)){var n=e.c2cMessageReadReceipt.to;e.c2cMessageReadReceipt.uinPairReadArray.forEach((function(e){var r=e.peerReadTime;Ge.d("".concat(t._n,"._onC2CMessageReadReceipt to:").concat(n," peerReadTime:").concat(r));var o="".concat(O.CONV_C2C).concat(n),i=t.getModule(11);i.recordPeerReadTime(o,r),i.updateMessageIsPeerReadProperty(o,r)}))}}))}},{key:"onC2CMessageReadNotice",value:function(e){var t=this;e.dataList.forEach((function(e){if(!Qt(e.c2cMessageReadNotice)){var n=t.getModule(11);e.c2cMessageReadNotice.uinPairReadArray.forEach((function(e){var r=e.from,o=e.peerReadTime;Ge.d("".concat(t._n,".onC2CMessageReadNotice from:").concat(r," lastReadTime:").concat(o));var i="".concat(O.CONV_C2C).concat(r);n.updateIsReadAfterReadReport({conversationID:i,lastMessageTime:o}),n.updateUnreadCount(i)}))}}))}},{key:"onC2CMessageModified",value:function(e){Ge.d("".concat(this._n,".onC2CMessageModified options:"),JSON.stringify(e));var n=this.getModule(11);e.dataList.forEach((function(e){n.onMessageModified(t(t({},e),{},{conversationType:O.CONV_C2C}))}))}},{key:"onReadReceiptList",value:function(e){Ge.d("".concat(this._n,".onReadReceiptList options:"),JSON.stringify(e));var t=e.dataList,n=t.userID,r=t.readReceiptList;this.getModule(11).updateReadReceiptInfo({userID:n,readReceiptList:r})}},{key:"sendMessage",value:function(e,t){var n=this._createC2CMessagePack(e,t);return this.request(n)}},{key:"_createC2CMessagePack",value:function(e,t){var n=null;t&&(t.offlinePushInfo&&(n=t.offlinePushInfo),!0===t.onlineUserOnly&&(n?n.disablePush=!0:n={disablePush:!0}));var r="";nt(e.cloudCustomData)&&e.cloudCustomData.length>0&&(r=e.cloudCustomData);var o=[];if(ot(t)&&ot(t.messageControlInfo)){var i=t.messageControlInfo,a=i.excludedFromUnreadCount,s=i.excludedFromLastMessage,u=i.excludedFromContentModeration;!0===a&&o.push("NoUnread"),!0===s&&o.push("NoLastMsg"),!0===u&&o.push("NoMsgCheck")}var c=this.isOnlineMessage(e,t)?0:void 0;return{protocolName:Kn.SEND_C2C_MESSAGE,tjgID:this.generateTjgID(e),requestData:{fromAccount:this.getMyUserID(),toAccount:e.to,msgBody:e.getElements(),cloudCustomData:r,msgSeq:e.sequence,msgRandom:e.random,msgLifeTime:c,nick:e.nick,avatar:e.avatar,offlinePushInfo:n?{pushFlag:!0===n.disablePush?1:0,title:n.title||"",desc:n.description||"",ext:n.extension||"",apnsInfo:{badgeMode:!0===n.ignoreIOSBadge?1:0,isVoipPush:this._isVoipPush(n)},androidInfo:{OPPOChannelID:n.androidOPPOChannelID||""}}:void 0,messageControlInfo:0!==c?o:void 0,clientTime:e.clientTime,needReadReceipt:!0===e.needReadReceipt?1:0,isSupportExtension:!0===e.isSupportExtension?1:0,isRelayMessage:!0===e._relayFlag?1:0}}}},{key:"_isVoipPush",value:function(e){var t=void 0;return at(e.disableVoipPush)||(t=!1===e.disableVoipPush?1:0),t}},{key:"isOnlineMessage",value:function(e,t){return!(!t||!0!==t.onlineUserOnly)}},{key:"revokeMessage",value:function(e){return this.request({protocolName:Kn.REVOKE_C2C_MESSAGE,requestData:{msgInfo:{fromAccount:e.from,toAccount:e.to,msgSeq:e.sequence,msgRandom:e.random,msgTimeStamp:e.time}}})}},{key:"deleteMessage",value:function(e){var t=e.to,n=e.keyList;return Ge.l("".concat(this._n,".deleteMessage toAccount:").concat(t," count:").concat(n.length)),this.request({protocolName:Kn.DELETE_C2C_MESSAGE,requestData:{fromAccount:this.getMyUserID(),to:t,keyList:n}})}},{key:"modifyRemoteMessage",value:function(e){var t=e.from,n=e.to,r=e.version,o=void 0===r?0:r,i=e.sequence,a=e.random,s=e.time,u=e.payload,c=e.type,l=e.cloudCustomData,d=void 0;return jt(c)&&(d=[]).push({type:c,content:u}),this.request({protocolName:Kn.MODIFY_C2C_MESSAGE,requestData:{from:t,to:n,version:o,sequence:i,random:a,time:s,elements:d,cloudCustomData:l}})}},{key:"setMessageRead",value:function(e){var t=this,n=e.conversationID,r=e.lastMessageTime,o="".concat(this._n,".setMessageRead");Ge.l("".concat(o," conversationID:").concat(n," lastMessageTime:").concat(r)),et(r)||this.outputWarning("DoNotModifyLastTime");var i=new ar("setC2CMessageRead");return i.setMessage("conversationID:".concat(n," lastMessageTime:").concat(r)),this.request({protocolName:Kn.SET_C2C_MESSAGE_READ,requestData:{C2CMsgReaded:{cookie:"",C2CMsgReadedItem:[{toAccount:n.replace("C2C",""),lastMessageTime:r,receipt:1}]}}}).then((function(){i.setNetworkType(t.getNetworkType()).end(),Ge.l("".concat(o," ok"));var e=t.getModule(11);return e.updateIsReadAfterReadReport({conversationID:n,lastMessageTime:r}),e.updateUnreadCount(n),xn()})).catch((function(e){return t.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];i.setError(e,r,o).end()})),Ge.l("".concat(o," failed. error:"),e),jn(e)}))}},{key:"getRoamingMessage",value:function(e){var t=this,n="".concat(this._n,".getRoamingMessage"),r=e.peerAccount,o=e.conversationID,i=e.count,a=e.lastMessageTime,s=e.messageKey,u="peerAccount:".concat(r," count:").concat(i||15," lastMessageTime:").concat(a||0," messageKey:").concat(s);Ge.l("".concat(n," ").concat(u));var c=new ar("getC2CRoamingMessages");return this.request({protocolName:Kn.GET_C2C_ROAMING_MESSAGE,requestData:{peerAccount:r,count:i||15,lastMessageTime:a||0,messageKey:s}}).then((function(e){var r=e.data,i=r.complete,a=r.messageList,s=r.messageKey,l=r.lastMessageTime;at(a)?Ge.l("".concat(n," ok. complete:").concat(i," but messageList is undefined!")):Ge.l("".concat(n," ok. complete:").concat(i," count:").concat(a.length)),c.setNetworkType(t.getNetworkType()).setMessage("".concat(u," complete:").concat(i," length:").concat(a.length)).end();var d=t.getModule(11);1===i&&d.setCompleted(o);var f=d.onRoamingMessage(a,o);d.modifyMessageList(o),d.updateIsRead(o),d.updateRoamingMessageKeyAndTime(o,s,l);var p=d.getPeerReadTime(o);if(Ge.l("".concat(n," update isPeerRead property. conversationID:").concat(o," peerReadTime:").concat(p)),p)d.updateMessageIsPeerReadProperty(o,p);else{var h=o.replace(O.CONV_C2C,"");t.getRemotePeerReadTime([h]).then((function(){d.updateMessageIsPeerReadProperty(o,d.getPeerReadTime(o))}))}var g="";if(f.length>0)g=f[0].ID;else{var v=d.getLocalOldestMessage(o);v&&(g=v.ID)}return Ge.l("".concat(n," nextReqID:").concat(g," stored message count:").concat(f.length)),{nextReqID:g,storedMessageList:f}})).catch((function(e){return t.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];c.setMessage(u).setError(e,r,o).end()})),Ge.w("".concat(n," failed. error:"),e),jn(e)}))}},{key:"getRoamingMessagesHopping",value:function(e){var t=this,n="".concat(this._n,".getRoamingMessagesHopping"),r=e.peerAccount,o=e.time,i=void 0===o?0:o,a=e.count,s=e.direction,u="".concat(O.CONV_C2C).concat(r),c="peerAccount:".concat(r," count:").concat(a," time:").concat(i," direction:").concat(s);Ge.l("".concat(n," ").concat(c));var l=new ar("getC2CRoamingMessagesHopping");return this.request({protocolName:Kn.GET_C2C_ROAMING_MESSAGE,requestData:{peerAccount:r,count:a+1,lastMessageTime:i,direction:s}}).then((function(e){var r=e.data,o=r.complete,i=r.messageList,a=void 0===i?[]:i,d=r.lastMessageTime;Ge.l("".concat(n," ok. complete:").concat(o," count:").concat(a.length)),l.setNetworkType(t.getNetworkType()).setMessage("".concat(c," complete:").concat(o," length:").concat(a.length)).end(),1!==o&&(1===s?a.pop():a.shift());var f=t.getModule(11).onRoamingMessage(a,u,!1);t._modifyMessageList(u,f);var p=t._computeResult({complete:o,lastMessageTime:d,resultList:f});return xn(p)})).catch((function(e){return t.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];l.setMessage(c).setError(e,r,o).end()})),Ge.w("".concat(n," failed. error:"),e),jn(e)}))}},{key:"_computeResult",value:function(e){var t=e.complete,n=void 0===t?0:t,r=e.lastMessageTime,o=e.resultList,i={messageList:T(void 0===o?[]:o),isCompleted:!1,nextMessageTime:""};return 1===n?(i.isCompleted=!0,i):(i.nextMessageTime=r,i)}},{key:"_modifyMessageList",value:function(e,t){var n=this.getModule(11).getLocalConversation(e);if(n)for(var r=n.userProfile.nick,o=n.userProfile.avatar,i=this.getModule(4).getNickAndAvatarByUserID(this.getMyUserID()),a=i.nick,s=i.avatar,u=t.length-1;u>=0;u--){var c=t[u];"in"===c.flow&&(c.nick!==r&&c.setNickAndAvatar({nick:r}),c.avatar!==o&&c.setNickAndAvatar({avatar:o})),"out"===c.flow&&(c.nick!==a&&c.setNickAndAvatar({nick:a}),c.avatar!==s&&c.setNickAndAvatar({avatar:s}))}}},{key:"getRemotePeerReadTime",value:function(e){var t=this,n="".concat(this._n,".getRemotePeerReadTime");if(Qt(e))return Ge.w("".concat(n," userIDList is empty!")),Promise.resolve();var r=new ar("getPeerReadTime");return Ge.l("".concat(n," userIDList:").concat(e)),this.request({protocolName:Kn.GET_C2C_PEER_READ_TIME,requestData:{userIDList:e}}).then((function(o){var i=o.data.peerReadTimeList;Ge.l("".concat(n," ok. peerReadTimeList:").concat(i));for(var a="",s=t.getModule(11),u=0;u<e.length;u++)a+="".concat(e[u],"-").concat(i[u]," "),i[u]>0&&s.recordPeerReadTime("C2C".concat(e[u]),i[u]);r.setNetworkType(t.getNetworkType()).setMessage(a).end()})).catch((function(e){t.probeNetwork().then((function(t){var n=M(t,2),o=n[0],i=n[1];r.setError(e,o,i).end()})),Ge.w("".concat(n," failed. error:"),e)}))}},{key:"sendReadReceipt",value:function(e){var t=this,n=e[0].conversationID.replace(O.CONV_C2C,""),r=new ar("sendC2CReadReceipt");r.setMessage("peerAccount:".concat(n));var o=this.getMyUserID(),i=e.filter((function(e){return e.from!==o&&!0===e.needReadReceipt})).map((function(e){return{fromAccount:e.from,toAccount:e.to,sequence:e.sequence,random:e.random,time:e.time,clientTime:e.clientTime}}));if(0===i.length)return jn({code:qn.READ_RECEIPT_MSG_LIST_EMPTY});var a="".concat(this._n,".sendReadReceipt");return Ge.l("".concat(a,". peerAccount:").concat(n," messageInfoList length:").concat(i.length)),this.request({protocolName:Kn.SEND_C2C_READ_RECEIPT,requestData:{peerAccount:n,messageInfoList:i}}).then((function(e){return r.end(),Ge.l("".concat(a," ok")),xn()})).catch((function(e){return t.probeNetwork().then((function(t){var n=M(t,2),o=n[0],i=n[1];r.setError(e,o,i).end()})),Ge.w("".concat(a," failed. error:"),e),jn(e)}))}},{key:"getReadReceiptList",value:function(e){var t="".concat(this._n,".getReadReceiptList"),n=this.getMyUserID(),r=e.filter((function(e){return e.from===n&&!0===e.needReadReceipt}));return Ge.l("".concat(t," userID:").concat(n," messageList length:").concat(r.length)),Bn({messageList:r})}},{key:"getMessageExtensions",value:function(e,t){return Ge.l("".concat(this._n,".getMessageExtensions startSequence:").concat(t)),this.request({protocolName:Kn.GET_C2C_MESSAGE_EXTENSIONS,requestData:{from:e.from,to:e.to,messageKey:this.getMessageKey(e),startSequence:t}})}},{key:"modifyMessageExtensions",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Ge.l("".concat(this._n,".modifyMessageExtensions operateType:").concat(n)),this.request({protocolName:Kn.MODIFY_C2C_MESSAGE_EXTENSIONS,requestData:{from:e.from,to:e.to,messageKey:this.getMessageKey(e),extensionList:t,operateType:n}})}},{key:"getMessageKey",value:function(e){var t=e.clientSequence,n=e.random,r=e.time;return"".concat(t,"_").concat(n,"_").concat(r)}},{key:"reset",value:function(){Ge.l("".concat(this._n,".reset")),this._messageFromUnreadDBMap.clear(),this._noticeFromUnreadDBList.length=0}}]),r}(Hn),Er=function(){function e(){a(this,e),this.list=new Map,this._n="MessageListHandler",this._latestMessageSentByPeerMap=new Map,this._latestMessageSentByMeMap=new Map}return c(e,[{key:"getLocalOldestMessageByConversationID",value:function(e){if(!e)return null;if(!this.list.has(e))return null;var t=this.list.get(e).values();return t?t.next().value:null}},{key:"pushIn",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.conversationID,r=!0;this.list.has(n)||this.list.set(n,new Map);var o=this._getUniqueIDOfMessage(e),i=this.list.get(n).has(o);if(i){var a=this.list.get(n).get(o);if(!t||!0===a.isModified)return!1}return this.list.get(n).set(o,e),this._setLatestMessageSentByPeer(n,e),this._setLatestMessageSentByMe(n,e),r}},{key:"unshift",value:function(e,t){var n;if(it(e)?e.length>0&&(n=e[0].conversationID,this._unshiftMultipleMessages(e,t)):(n=e.conversationID,this._unshiftSingleMessage(e,t)),n){var r=Array.from(this.list.get(n).values()),o=r.length;if(0===o)return;for(var i=o-1;i>=0;i--)if("out"===r[i].flow){this._setLatestMessageSentByMe(n,r[i]);break}if(n.startsWith(O.CONV_C2C))for(var a=o-1;a>=0;a--)if("in"===r[a].flow){this._setLatestMessageSentByPeer(n,r[a]);break}}}},{key:"_unshiftSingleMessage",value:function(e,t){var n=e.conversationID,r=this._getUniqueIDOfMessage(e);if(!this.list.has(n))return this.list.set(n,new Map),this.list.get(n).set(r,e),void t.push(e);var o=this.list.get(n),i=Array.from(o);o.has(r)||(i.unshift([r,e]),this.list.set(n,new Map(i)),t.push(e))}},{key:"_unshiftMultipleMessages",value:function(e,t){for(var n=e.length,r=[],o=e[0].conversationID,i=this.list.get(o),a=this.list.has(o)?Array.from(i):[],s=0;s<n;s++){var u=this._getUniqueIDOfMessage(e[s]);i&&i.has(u)||(r.push([u,e[s]]),t.push(e[s]))}this.list.set(o,new Map(r.concat(a)))}},{key:"remove",value:function(e){var t=e.conversationID,n=this._getUniqueIDOfMessage(e);this.list.has(t)&&this.list.get(t).delete(n)}},{key:"revoke",value:function(e,t,n){if(Ge.d("revoke message",e,t,n),this.list.has(e)){var r,o=D(this.list.get(e));try{for(o.s();!(r=o.n()).done;){var i=M(r.value,2)[1];if(i.sequence===t&&(at(n)||i.random===n))return i.isRevoked||(i.isRevoked=!0),i}}catch(l){o.e(l)}finally{o.f()}}return null}},{key:"removeByConversationID",value:function(e){var t=this.list.has(e);Ge.l("".concat(this._n,".removeByConversationID conversationID:").concat(e," has:").concat(t)),t&&(this.list.delete(e),this._latestMessageSentByPeerMap.delete(e),this._latestMessageSentByMeMap.delete(e))}},{key:"findMessage",value:function(e){var t,n=null,r=D(this.list);try{for(r.s();!(t=r.n()).done;)for(var o=T(M(t.value,2)[1].values()),i=o.length,a=0;a<i;a++)if(o[a].ID===e){n=o[a];break}}catch(d){r.e(d)}finally{r.f()}return n}},{key:"updateMessageIsPeerReadProperty",value:function(e,t){var n=[];if(this.list.has(e)){var r,o=D(this.list.get(e));try{for(o.s();!(r=o.n()).done;){var i=M(r.value,2)[1];i.time<=t&&!i.isPeerRead&&"out"===i.flow&&(i.isPeerRead=!0,n.push(i))}}catch(l){o.e(l)}finally{o.f()}Ge.l("".concat(this._n,".updateMessageIsPeerReadProperty conversationID:").concat(e," peerReadTime:").concat(t," count:").concat(n.length))}return n}},{key:"updateMessageIsModifiedProperty",value:function(e){var t=e.conversationID;if(this.list.has(t)){var n=this._getUniqueIDOfMessage(e),r=this.list.get(t).get(n);r&&(r.isModified=!0)}}},{key:"hasLocalMessageList",value:function(e){return this.list.has(e)}},{key:"getLocalMessageList",value:function(e){return this.hasLocalMessageList(e)?T(this.list.get(e).values()):[]}},{key:"hasLocalMessage",value:function(e,t){for(var n=!1,r=this.getLocalMessageList(e),o=r.length,i=0;i<o;i++)r[i].ID===t&&(n=!0);return n}},{key:"getLocalMessage",value:function(e,t){for(var n=null,r=this.getLocalMessageList(e),o=r.length,i=0;i<o;i++)if(r[i].ID===t){n=r[i];break}return n}},{key:"getLocalLastMessage",value:function(e){var t=this.getLocalMessageList(e);return t[t.length-1]}},{key:"getLocalOldestMessage",value:function(e){return this.getLocalMessageList(e)[0]}},{key:"_setLatestMessageSentByPeer",value:function(e,t){e.startsWith(O.CONV_C2C)&&"in"===t.flow&&this._latestMessageSentByPeerMap.set(e,t)}},{key:"_setLatestMessageSentByMe",value:function(e,t){"out"===t.flow&&this._latestMessageSentByMeMap.set(e,t)}},{key:"getLatestMessageSentByPeer",value:function(e){return this._latestMessageSentByPeerMap.get(e)}},{key:"getLatestMessageSentByMe",value:function(e){return this._latestMessageSentByMeMap.get(e)}},{key:"modifyMessageSentByPeer",value:function(e){var t=e.conversationID,n=e.latestNick,r=e.latestAvatar,o=this.list.get(t);if(!Qt(o)){var i=Array.from(o.values()),a=i.length;if(0!==a){for(var s=null,u=0,c=!1,l=a-1;l>=0;l--)"in"===i[l].flow&&((s=i[l]).nick!==n&&(s.setNickAndAvatar({nick:n}),c=!0),s.avatar!==r&&(s.setNickAndAvatar({avatar:r}),c=!0),c&&(u+=1));Ge.l("".concat(this._n,".modifyMessageSentByPeer conversationID:").concat(t," count:").concat(u))}}}},{key:"modifyMessageSentByMe",value:function(e){var t=e.conversationID,n=e.latestNick,r=e.latestAvatar,o=this.list.get(t);if(!Qt(o)){var i=Array.from(o.values()),a=i.length;if(0!==a){for(var s=null,u=0,c=!1,l=a-1;l>=0;l--)"out"===i[l].flow&&((s=i[l]).nick!==n&&(s.setNickAndAvatar({nick:n}),c=!0),s.avatar!==r&&(s.setNickAndAvatar({avatar:r}),c=!0),c&&(u+=1));Ge.l("".concat(this._n,".modifyMessageSentByMe conversationID:").concat(t," count:").concat(u))}}}},{key:"getTopicConversationIDList",value:function(e){return T(this.list.keys()).filter((function(t){return t.startsWith("".concat(O.CONV_GROUP).concat(e))}))}},{key:"traversal",value:function(){if(0!==this.list.size&&-1===Ge.getLevel()){console.group("conversationID-messageCount");var e,t=D(this.list);try{for(t.s();!(e=t.n()).done;){var n=M(e.value,2),r=n[0],o=n[1];console.log("".concat(r,"-").concat(o.size))}}catch(c){t.e(c)}finally{t.f()}console.groupEnd()}}},{key:"onMessageModified",value:function(e,t){if(!this.list.has(e))return{isUpdated:!1,message:null};var n="".concat(this._n,".onMessageModified"),r=this._getUniqueIDOfMessage(t),o=this.list.get(e).has(r);if(Ge.l("".concat(n," conversationID:").concat(e," uniqueID:").concat(r," has:").concat(o)),o){var i=this.list.get(e).get(r),a=t.messageVersion,s=t.elements,u=t.cloudCustomData,c=t.checkResult;return Ge.l("".concat(n," localVersion:").concat(i.version," remoteVersion:").concat(a)),i.version<a?(i.version=a,i._elements=JSON.parse(JSON.stringify(s)),i.payload=JSON.parse(JSON.stringify(s[0].content)),i.type=s[0].type,i.cloudCustomData=u,i.isModified=!0,i.hasRiskContent=$t(c),{isUpdated:!0,message:i}):{isUpdated:!1,message:i}}return{isUpdated:!1,message:null}}},{key:"_getUniqueIDOfMessage",value:function(e){var t=e.from,n=e.to,r=e.random,o=e.sequence,i=e.time;return"".concat(t,"-").concat(n,"-").concat(r,"-").concat(o,"-").concat(i)}},{key:"reset",value:function(){this.list.clear(),this._latestMessageSentByPeerMap.clear(),this._latestMessageSentByMeMap.clear()}}]),e}(),Cr={A2KEY_AND_TINYID_UPDATED:"_inner".concat(1),CLOUD_CONFIG_UPDATED:"_inner".concat(2),PROFILE_UPDATED:"_inner".concat(3),CONV_SYNC_COMPLETED:"_inner".concat(4),C2C_UNREAD_HANDLE_COMPLETED:"_inner".concat(5)};function kr(e){this.mixin(e)}kr.mixin=function(e){var t=e.prototype||e;t._isReady=!1,t.ready=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e)return this._isReady?void(t?e.call(this):setTimeout(e,1)):(this._readyQueue=this._readyQueue||[],void this._readyQueue.push(e))},t.triggerReady=function(){var e=this;this._isReady=!0,setTimeout((function(){var t=e._readyQueue;e._readyQueue=[],t&&t.length>0&&t.forEach((function(e){e.call(this)}),e)}),1)},t.resetReady=function(){this._isReady=!1,this._readyQueue=[]},t.isReady=function(){return this._isReady}};var br=["jpg","jpeg","gif","png","bmp","image","webp"],Dr=["mp4","quicktime","mov"],Ar=function(){function e(t){var n=this;a(this,e),Qt(t)||(this.userID=t.userID||"",this.nick=t.nick||"",this.gender=t.gender||"",this.birthday=t.birthday||0,this.location=t.location||"",this.selfSignature=t.selfSignature||"",this.allowType=t.allowType||O.ALLOW_TYPE_ALLOW_ANY,this.language=t.language||0,this.avatar=t.avatar||"",this.messageSettings=t.messageSettings||0,this.adminForbidType=t.adminForbidType||O.FORBID_TYPE_NONE,this.level=t.level||0,this.role=t.role||0,this.lastUpdatedTime=0,this.profileCustomField=[],Qt(t.profileCustomField)||t.profileCustomField.forEach((function(e){n.profileCustomField.push({key:e.key,value:e.value})})))}return c(e,[{key:"validate",value:function(e){var t=!0,n="";if(Qt(e))return{valid:!1,tips:"empty options"};if(e.profileCustomField)for(var r=e.profileCustomField.length,o=null,i=0;i<r;i++){if(o=e.profileCustomField[i],!nt(o.key)||-1===o.key.indexOf("Tag_Profile_Custom"))return{valid:!1,tips:"The prefix of keys of the custom profile key-value pairs (which is profileCustomField) must be Tag_Profile_Custom"};if(!nt(o.value))return{valid:!1,tips:"The type of values of the custom profile key-value pairs (which is profileCustomField) must be String"}}for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if("profileCustomField"===a)continue;if(Qt(e[a])&&!nt(e[a])&&!et(e[a])){n="key:"+a+", invalid value:"+e[a],t=!1;continue}switch(a){case"nick":nt(e[a])||(n="nick must be a string",t=!1),gt(e[a])>500&&(n="nick name limited: must less than or equal to ".concat(500," bytes, current size: ").concat(gt(e[a])," bytes"),t=!1);break;case"gender":yt(Ke,e.gender)||(n="key:gender, invalid value:"+e.gender,t=!1);break;case"birthday":et(e.birthday)||(n="birthday must be a number",t=!1);break;case"location":nt(e.location)||(n="location must be a string",t=!1);break;case"selfSignature":nt(e.selfSignature)||(n="selfSignature must be a string",t=!1);break;case"allowType":yt(Ye,e.allowType)||(n="key:allowType, invalid value:"+e.allowType,t=!1);break;case"language":et(e.language)||(n="language must be a number",t=!1);break;case"avatar":nt(e.avatar)||(n="avatar must be a string",t=!1);break;case"messageSettings":0!==e.messageSettings&&1!==e.messageSettings&&(n="messageSettings must be 0 or 1",t=!1);break;case"adminForbidType":yt(We,e.adminForbidType)||(n="key:adminForbidType, invalid value:"+e.adminForbidType,t=!1);break;case"level":et(e.level)||(n="level must be a number",t=!1);break;case"role":et(e.role)||(n="role must be a number",t=!1);break;default:n="unknown key:"+a+"  "+e[a],t=!1}}return{valid:t,tips:n}}}]),e}(),Or=c((function e(t){a(this,e),this.value=t,this.next=null})),Rr=function(){function e(t){a(this,e),this.MAX_LENGTH=t,this.pTail=null,this.pNodeToDel=null,this.map=new Map}return c(e,[{key:"set",value:function(e){var t=new Or(e);if(this.map.size<this.MAX_LENGTH)null===this.pTail?(this.pTail=t,this.pNodeToDel=t):(this.pTail.next=t,this.pTail=t),this.map.set(e,1);else{var n=this.pNodeToDel;this.pNodeToDel=this.pNodeToDel.next,this.map.delete(n.value),n.next=null,n=null,this.pTail.next=t,this.pTail=t,this.map.set(e,1)}}},{key:"has",value:function(e){return this.map.has(e)}},{key:"delete",value:function(e){this.has(e)&&this.map.delete(e)}},{key:"tail",value:function(){return this.pTail}},{key:"size",value:function(){return this.map.size}},{key:"data",value:function(){return Array.from(this.map.keys())}},{key:"reset",value:function(){for(var e;null!==this.pNodeToDel;)e=this.pNodeToDel,this.pNodeToDel=this.pNodeToDel.next,e.next=null,e=null;this.pTail=null,this.map.clear()}}]),e}(),Nr=["groupID","name","avatar","type","introduction","notification","ownerID","selfInfo","createTime","infoSequence","lastInfoTime","lastMessage","nextMessageSeq","memberNum","maxMemberNum","memberList","joinOption","groupCustomField","muteAllMembers","isSupportTopic","inviteOption","_lastRevokedTime"],wr=function(){function e(t){a(this,e),this.groupID="",this.name="",this.avatar="",this.type="",this.introduction="",this.notification="",this.ownerID="",this.createTime="",this.infoSequence="",this.lastInfoTime="",this.selfInfo={messageRemindType:"",joinTime:"",nameCard:"",role:"",userID:"",memberCustomField:void 0,readedSequence:0,excludedUnreadSequenceList:void 0},this.lastMessage={lastTime:"",lastSequence:"",fromAccount:"",messageForShow:""},this.nextMessageSeq="",this.memberNum="",this.memberCount="",this.maxMemberNum="",this.maxMemberCount="",this.joinOption="",this.inviteOption="",this.groupCustomField=[],this.muteAllMembers=!1,this.isSupportTopic=!1,this._lastRevokedTime=0,this._initGroup(t)}return c(e,[{key:"memberNum",get:function(){return this.memberCount},set:function(e){}},{key:"maxMemberNum",get:function(){return this.maxMemberCount},set:function(e){}},{key:"_initGroup",value:function(e){for(var t in e)Nr.indexOf(t)<0||("selfInfo"!==t?("memberNum"===t&&(this.memberCount=e[t]),"maxMemberNum"===t&&(this.maxMemberCount=e[t]),"isSupportTopic"!==t?this[t]=e[t]:this.isSupportTopic=1===e[t]):this.updateSelfInfo(e[t]))}},{key:"updateGroup",value:function(e){var t=this;e.appid=void 0,e.grossTopicNextMsgSeq=void 0,e.selfInfo&&(e.selfInfo.grossTopicReadSeq=void 0);var n=JSON.parse(JSON.stringify(e));n.lastMsgTime&&(this.lastMessage.lastTime=n.lastMsgTime),at(n.muteAllMembers)||("On"===n.muteAllMembers?n.muteAllMembers=!0:n.muteAllMembers=!1),n.groupCustomField&&St(this.groupCustomField,n.groupCustomField),at(n.memberNum)||(this.memberCount=n.memberNum),at(n.maxMemberNum)||(this.maxMemberCount=n.maxMemberNum),at(n.isSupportTopic)||(this.isSupportTopic=et(n.isSupportTopic)?1===n.isSupportTopic:n.isSupportTopic),pt(this,n,["members","errorCode","lastMsgTime","groupCustomField","memberNum","maxMemberNum","isSupportTopic"]),it(n.members)&&n.members.length>0&&n.members.forEach((function(e){e.userID===t.selfInfo.userID&&pt(t.selfInfo,e,["sequence"])}))}},{key:"updateSelfInfo",value:function(e){var n={nameCard:e.nameCard,joinTime:e.joinTime,role:e.role,messageRemindType:e.messageRemindType,readedSequence:e.readedSequence,excludedUnreadSequenceList:e.excludedUnreadSequenceList};pt(this.selfInfo,t({},n),[],["",null,void 0,0,NaN])}},{key:"setSelfNameCard",value:function(e){this.selfInfo.nameCard=e}}]),e}(),Lr=function(e,n,r){return at(e)?{lastTime:0,lastSequence:0,fromAccount:"",messageForShow:"",payload:null,type:"",isRevoked:!1,cloudCustomData:"",onlineOnlyFlag:!1,nick:"",nameCard:"",version:0,isPeerRead:!1,revoker:null}:r&&e.ID||e instanceof Tr?{lastTime:e.time||0,lastSequence:e.sequence||0,fromAccount:e.from||"",messageForShow:Bt(e.type,e.payload,n),payload:e.payload||null,type:e.type||null,isRevoked:e.isRevoked||!1,cloudCustomData:e.cloudCustomData||"",onlineOnlyFlag:e._onlineOnlyFlag||!1,nick:e.nick||"",nameCard:e.nameCard||"",version:e.version||0,isPeerRead:e.isPeerRead||!1,revoker:e.revoker||null}:t(t({},e),{},{messageForShow:Bt(e.type,e.payload,n)})},Pr=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];a(this,e),this.conversationID=t.conversationID||"",this.unreadCount=t.unreadCount||0,this.type=t.type||"",this.lastMessage=Lr(t.lastMessage,n,r),t.lastMsgTime&&(this.lastMessage.lastTime=t.lastMsgTime),this._isInfoCompleted=!1,this.peerReadTime=t.peerReadTime||0,this.groupAtInfoList=[],this.remark="",this.isPinned=t.isPinned||!1,this.messageRemindType=t.messageRemindType,this.markList=t.markList||[],this.customData=t.customData||"",this.conversationGroupList=t.conversationGroupList||[],this.draftText=t.draftText||"",this._initProfile(t),this.subType=this.groupProfile?this.groupProfile.type:""}return c(e,[{key:"toAccount",get:function(){return this.conversationID.startsWith(O.CONV_C2C)?this.conversationID.replace(O.CONV_C2C,""):this.conversationID.startsWith(O.CONV_GROUP)?this.conversationID.replace(O.CONV_GROUP,""):""}},{key:"_initProfile",value:function(e){var t=this;Object.keys(e).forEach((function(n){switch(n){case"userProfile":t.userProfile=e.userProfile;break;case"groupProfile":t.groupProfile=e.groupProfile}})),at(this.userProfile)&&this.type===O.CONV_C2C?this.userProfile=new Ar({userID:e.conversationID.replace("C2C","")}):at(this.groupProfile)&&this.type===O.CONV_GROUP&&(this.groupProfile=new wr({groupID:e.conversationID.replace("GROUP","")}))}},{key:"updateUnreadCount",value:function(e){var t=e.nextUnreadCount,n=e.isFromGetConversations,r=e.isUnreadC2CMessage;at(t)||(Et(this.subType)?this.unreadCount=0:n&&this.type===O.CONV_GROUP||n&&this.type===O.CONV_TOPIC||r&&this.type===O.CONV_C2C?this.unreadCount=t:this.unreadCount=this.unreadCount+t)}},{key:"updateLastMessage",value:function(e){this.lastMessage=Lr(e)}},{key:"updateGroupAtInfoList",value:function(e){if(!this._isNeedMergeGroupAtInfo(e)){var t=function(e){return S(e)||E(e)||C(e)||b()}(e.groupAtType).slice(0);-1!==t.indexOf(O.CONV_AT_ME)&&-1!==t.indexOf(O.CONV_AT_ALL)&&(t=[O.CONV_AT_ALL_AT_ME]);var n={from:e.from,groupID:e.groupID,topicID:e.topicID,messageSequence:e.sequence,atTypeArray:t,__random:e.__random,__sequence:e.__sequence};this.groupAtInfoList.push(n)}}},{key:"_isNeedMergeGroupAtInfo",value:function(e){var t=e.groupID,n=e.sequence;if(!Ct({groupID:t}))return!1;var r=!1;return this.groupAtInfoList.forEach((function(t){t.messageSequence===n&&(t.atTypeArray.indexOf(O.CONV_AT_ME)>-1&&e.groupAtType.indexOf(O.CONV_AT_ALL)>-1&&(t.atTypeArray=[O.CONV_AT_ALL_AT_ME]),t.atTypeArray.indexOf(O.CONV_AT_ALL)>-1&&e.groupAtType.indexOf(O.CONV_AT_ME)>-1&&(t.atTypeArray=[O.CONV_AT_ALL_AT_ME],t.__random=e.__random,t.__sequence=e.__sequence),r=!0)})),r}},{key:"clearGroupAtInfoList",value:function(){this.groupAtInfoList.length=0}},{key:"reduceUnreadCount",value:function(){return this.unreadCount>=1&&(this.unreadCount-=1,!0)}},{key:"isLastMessageRevoked",value:function(e){var t=e.sequence,n=e.time;return this.type===O.CONV_C2C&&t===this.lastMessage.lastSequence&&n===this.lastMessage.lastTime||this.type===O.CONV_GROUP&&t===this.lastMessage.lastSequence}},{key:"setLastMessageRevoked",value:function(e){this.lastMessage.isRevoked=e}},{key:"setLastMessageRevoker",value:function(e){this.lastMessage.revoker=e}},{key:"setDraftText",value:function(e){this.draftText=e}}]),e}(),Ur=function(){function e(t){a(this,e),this._conversationModule=t,this._n="MessageRemindHandler"}return c(e,[{key:"getC2CMessageRemindType",value:function(e){var t=this,n="".concat(this._n,".getC2CMessageRemindType");return this._conversationModule.request({protocolName:Kn.GET_C2C_PEER_MUTE_NOTIFICATIONS,requestData:{toAccount:this._conversationModule.getMyUserID(),userIDList:e}}).then((function(r){Ge.l("".concat(n," ok. userIDList:").concat(e));var o=r.data.muteFlagList;t._conversationModule.onC2CMessageRemindTypeFetched(o)})).catch((function(e){Ge.e("".concat(n," failed. error:"),e)}))}},{key:"set",value:function(e){return e.groupID?this._setGroupMessageRemindType(e):it(e.userIDList)?this._setC2CMessageRemindType(e):void 0}},{key:"_setGroupMessageRemindType",value:function(e){var t=this,n="".concat(this._n,"._setGroupMessageRemindType"),r=e.groupID,o=e.messageRemindType,i="groupID:".concat(r," messageRemindType:").concat(o),a=new ar("setMessageRemindType");a.setMessage(i);var s=this._getModule(7);return s?s.modifyGroupMemberInfo({groupID:r,messageRemindType:o,userID:this._conversationModule.getMyUserID()}).then((function(){a.setNetworkType(t._conversationModule.getNetworkType()).end(),Ge.l("".concat(n," ok. ").concat(i));var r=t.onGroupMessageRemindTypeUpdated(e);return t._conversationModule.emitTotalUnreadMessageCountUpdate(),xn(r)})).catch((function(e){return t._conversationModule.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];a.setError(e,r,o).end()})),Ge.e("".concat(n," failed. error:"),e),jn(e)})):jn({code:qn.CANNOT_FIND_MODULE})}},{key:"onGroupMessageRemindTypeUpdated",value:function(e){var t=e.groupID,n=e.messageRemindType;Ge.l("".concat(this._n,".onGroupMessageRemindTypeUpdated groupID:").concat(t," messageRemindType:").concat(n));var r=this._getModule(7).getLocalGroupProfile(t);if(r&&(r.selfInfo.messageRemindType=n),kt(t)){var o=t,i=Vt(o),a=this._getModule(10).getLocalTopic(i,o);return a&&(a.updateSelfInfo({messageRemindType:n}),this._conversationModule.emitOuterEvent(A.TOPIC_UPDATED,{groupID:i,topic:a})),{topic:a}}return this._conversationModule.patchMessageRemindType({ID:t,isC2CConversation:!1,messageRemindType:n})&&this._emitConversationUpdate(),{group:r}}},{key:"_setC2CMessageRemindType",value:function(e){var t=this,n="".concat(this._n,"._setC2CMessageRemindType"),r=e.userIDList,o=e.messageRemindType,i=r.slice(0,30),a=0;o===O.MSG_REMIND_DISCARD?a=1:o===O.MSG_REMIND_ACPT_NOT_NOTE&&(a=2);var s="userIDList:".concat(i," messageRemindType:").concat(o),u=new ar("setMessageRemindType");return u.setMessage(s),this._conversationModule.request({protocolName:Kn.SET_C2C_PEER_MUTE_NOTIFICATIONS,requestData:{userIDList:i,muteFlag:a}}).then((function(e){u.setNetworkType(t._conversationModule.getNetworkType()).end();var r=e.data.errorList,a=[],c=[];it(r)&&r.forEach((function(e){a.push(e.userID),c.push({userID:e.userID,code:e.errorCode})}));var l=i.filter((function(e){return-1===a.indexOf(e)}));Ge.l("".concat(n," ok. ").concat(s," successUserIDList:").concat(l," failureUserIDList:").concat(JSON.stringify(c)));var d=0;return l.forEach((function(e){t._conversationModule.patchMessageRemindType({ID:e,isC2CConversation:!0,messageRemindType:o})&&(d+=1)})),d>=1&&t._emitConversationUpdate(),i.length=a.length=0,t._conversationModule.emitTotalUnreadMessageCountUpdate(),Bn({successUserIDList:l.map((function(e){return{userID:e}})),failureUserIDList:c})})).catch((function(e){return t._conversationModule.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];u.setError(e,r,o).end()})),Ge.e("".concat(n," failed. error:"),e),jn(e)}))}},{key:"_getModule",value:function(e){return this._conversationModule.getModule(e)}},{key:"_emitConversationUpdate",value:function(){this._conversationModule.emitConversationUpdate(!0,!1)}},{key:"reset",value:function(){Ge.l("".concat(this._n,".reset"))}}]),e}(),Gr=function(){function e(t){a(this,e),this._conversationModule=t,this._n="ConvGroupHandler",this._convGroupMap=new Map,this._startIndex=0,this._pagingStatus=on.NOT_START}return c(e,[{key:"setConvCustomData",value:function(e){var t=this,n="".concat(this._n,".").concat("setConvCustomData"),r=e.conversationIDList,o=e.customData;Ge.l("".concat(n," options:"),e);var i=new ar("setConvCustomData");i.setMessage(JSON.stringify(e));var a={fromAccount:this._getMyUserID(),itemList:[]},s=[],u=[];return r.forEach((function(e){if(!t._hasLocalConversation(e))return t._onConversationNotFound(u,e),!0;if(!bt(e)&&!Dt(e))return t._onConversationIDInvalid(u,e),!0;var n={operationType:2,contactItem:void 0,customMark:o};bt(e)?n.contactItem={type:1,toAccount:e.replace(O.CONV_C2C,"")}:Dt(e)&&(n.contactItem={type:2,groupID:e.replace(O.CONV_GROUP,"")}),a.itemList.push(n)})),u.length===r.length?Bn({successConversationIDList:s,failureConversationIDList:u}):this._conversationModule.request({protocolName:Kn.SET_CONVERSATION_CUSTOM_DATA,requestData:a}).then((function(e){i.setNetworkType(t._conversationModule.getNetworkType()).end(),Ge.l("".concat(n," ok"));var r=e.data.resultItem;if(it(r)){var a,c,l=!1;r.forEach((function(e){a=t._concatConversationID(e.contactItem),0===e.resultCode?(s.push(a),(c=t._getLocalConversation(a))&&c.customData!==o&&(c.customData=o,l=!0)):u.push({conversationID:a,code:e.resultCode,message:e.resultInfo})})),!0===l&&t._emitConversationUpdate()}return xn({successConversationIDList:s,failureConversationIDList:u})})).catch((function(e){return t._conversationModule.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];i.setError(e,r,o).end()})),Ge.e("".concat(n," failed. error:"),e),jn(e)}))}},{key:"markConversation",value:function(e){var t=this;if(!this._conversationModule.canIUse(q.CONV_MARK))return this._conversationModule.cannotUseCommercialAbility("markConversation");var n="".concat(this._n,".").concat("markConversation"),r=e.conversationIDList,o=e.markType,i=e.enableMark;Ge.l("".concat(n," options:"),e);var a=new ar("markConversation");a.setMessage(JSON.stringify(e));var s=void 0,u=void 0,c=this._getFlagBit(o);!0===i?u=[c]:s=[c];var l={fromAccount:this._getMyUserID(),itemList:[]},d=[],f=[];return r.forEach((function(e){if(!t._hasLocalConversation(e))return t._onConversationNotFound(f,e),!0;if(!bt(e)&&!Dt(e))return t._onConversationIDInvalid(f,e),!0;var n={operationType:1,contactItem:void 0,clearMark:s,setMark:u};bt(e)?n.contactItem={type:1,toAccount:e.replace(O.CONV_C2C,"")}:Dt(e)&&(n.contactItem={type:2,groupID:e.replace(O.CONV_GROUP,"")}),l.itemList.push(n)})),f.length===r.length?Bn({successConversationIDList:d,failureConversationIDList:f}):this._conversationModule.request({protocolName:Kn.MARK_CONVERSATION,requestData:l}).then((function(e){a.setNetworkType(t._conversationModule.getNetworkType()).end(),Ge.l("".concat(n," ok"));var r=e.data.resultItem;if(it(r)){var s,u,c=!1;r.forEach((function(e){if(s=t._concatConversationID(e.contactItem),0===e.resultCode){if(d.push(s),u=t._getLocalConversation(s)){var n=u.markList.indexOf(o);!0===i?-1===n&&(u.markList.push(o),c=!0):-1!==n&&(u.markList.splice(n,1),c=!0)}}else f.push({conversationID:s,code:e.resultCode,message:e.resultInfo})})),!0===c&&t._emitConversationUpdate()}return xn({successConversationIDList:d,failureConversationIDList:f})})).catch((function(e){return t._conversationModule.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];a.setError(e,r,o).end()})),Ge.e("".concat(n," failed. error:"),e),jn(e)}))}},{key:"getLocalConvGroupList",value:function(){var e=this;return Ge.l("".concat(this._n,".getLocalConvGroupList pagingStatus:").concat(this._pagingStatus)),this._pagingStatus===on.REJECTED?this.getRemoteConvGroupList().then((function(){return xn(T(e._convGroupMap.values()))})):Bn(T(this._convGroupMap.values()))}},{key:"getRemoteConvGroupList",value:function(){var e=this,t="".concat(this._n,".getRemoteConvGroupList");return this._pagingStatus=on.PENDING,this._conversationModule.request({protocolName:Kn.GET_CONVERSATION_GROUP_LIST,requestData:{fromAccount:this._getMyUserID(),startIndex:this._startIndex,startTime:we()}}).then((function(n){var r,o,i=n.data,a=i.completeFlag,s=i.contactItem,u=i.nextStartIndex,c=void 0===u?0:u,l=i.groupItem;if(e._startIndex=c,Ge.l("".concat(t," completeFlag:").concat(a," nextStartIndex:").concat(c)),it(l)&&l.forEach((function(t){var n=t.convGroupID,r=t.groupName;e._convGroupMap.set(n,r)})),it(s)&&s.forEach((function(t){var n=t.standardMark,i=t.customData,a=t.convGroupIDList;if(r=e._concatConversationID(t),(o=e._getLocalConversation(r))&&(o.markList=Ht(n),o.customData=i||"",it(a))){var s=[];a.forEach((function(t){e._convGroupMap.has(t)&&s.push(e._convGroupMap.get(t))})),o.conversationGroupList=[].concat(s),s.length=0}})),0===a)return e.getRemoteConvGroupList();1===a&&(e._pagingStatus=on.RESOLVED,e._emitConversationUpdate(),e._emitConvGroupListUpdate())})).catch((function(n){e._pagingStatus=on.REJECTED,Ge.w("".concat(t," failed. error:"),n)}))}},{key:"createConvGroup",value:function(e){var t=this,n="createConversationGroup";if(!this._conversationModule.canIUse(q.CONV_GROUP))return this._conversationModule.cannotUseCommercialAbility(n);var r="".concat(this._n,".").concat(n);Ge.l("".concat(r," options:"),e);var o=new ar(n);o.setMessage(JSON.stringify(e));var i=e.groupName,a=e.conversationIDList,s={fromAccount:this._getMyUserID(),itemList:[{groupName:i,contactItem:[]}]},u=[],c=[];return a.forEach((function(e){return t._hasLocalConversation(e)?bt(e)||Dt(e)?void(bt(e)?s.itemList[0].contactItem.push({type:1,toAccount:e.replace(O.CONV_C2C,"")}):Dt(e)&&s.itemList[0].contactItem.push({type:2,groupID:e.replace(O.CONV_GROUP,"")})):(t._onConversationIDInvalid(c,e),!0):(t._onConversationNotFound(c,e),!0)})),c.length===a.length?Bn({successConversationIDList:u,failureConversationIDList:c}):this._conversationModule.request({protocolName:Kn.CREATE_CONVERSATION_GROUP,requestData:s}).then((function(e){o.setNetworkType(t._conversationModule.getNetworkType()).end(),Ge.l("".concat(r," ok"));var n=e.data.groupResultItem[0],a=n.groupItem,s=n.resultItem;if(ot(a)&&(t._convGroupMap.set(a.convGroupID,a.groupName),t._emitConvGroupListUpdate()),it(s)){var l,d,f=!1;s.forEach((function(e){l=t._concatConversationID(e.contactItem),0===e.resultCode?(u.push(l),(d=t._getLocalConversation(l))&&-1===d.conversationGroupList.indexOf(i)&&(d.conversationGroupList.push(i),f=!0)):c.push({conversationID:l,code:e.resultCode,message:e.resultInfo})})),!0===f&&(t._emitConversationUpdate(),t._emitConvGroupListUpdate())}return xn({successConversationIDList:u,failureConversationIDList:c})})).catch((function(e){return t._conversationModule.probeNetwork().then((function(t){var n=M(t,2),r=n[0],i=n[1];o.setError(e,r,i).end()})),Ge.e("".concat(r," failed. error:"),e),jn(e)}))}},{key:"deleteConvGroup",value:function(e){var t=this,n="deleteConversationGroup";if(!this._conversationModule.canIUse(q.CONV_GROUP))return this._conversationModule.cannotUseCommercialAbility(n);var r="".concat(this._n,".").concat(n);Ge.l("".concat(r," groupName:").concat(e));var o=new ar(n);return o.setMessage(e),this._conversationModule.request({protocolName:Kn.DELETE_CONVERSATION_GROUP,requestData:{fromAccount:this._getMyUserID(),groupName:[e]}}).then((function(n){o.setNetworkType(t._conversationModule.getNetworkType()).end(),Ge.l("".concat(r," ok"));var i=n.data.groupItem;if(it(i)){var a=!1;i.forEach((function(e){t._convGroupMap.has(e.convGroupID)&&(t._convGroupMap.delete(e.convGroupID),a=!0)})),!0===a&&t._emitConvGroupListUpdate()}t._eraseFromConversationGroupList([e])})).catch((function(e){return t._conversationModule.probeNetwork().then((function(t){var n=M(t,2),r=n[0],i=n[1];o.setError(e,r,i).end()})),Ge.e("".concat(r," failed. error:"),e),jn(e)}))}},{key:"renameConvGroup",value:function(e){var t=this,n="renameConversationGroup";if(!this._conversationModule.canIUse(q.CONV_GROUP))return this._conversationModule.cannotUseCommercialAbility(n);var r="".concat(this._n,".").concat(n);Ge.l("".concat(r," options:"),e);var o=new ar(n);o.setMessage(JSON.stringify(e));var i=e.oldName,a=e.newName;return this._conversationModule.request({protocolName:Kn.RENAME_CONVERSATION_GROUP,requestData:{fromAccount:this._getMyUserID(),updateType:1,updateGroup:{updateGroupType:1,oldName:i,newName:a}}}).then((function(e){o.setNetworkType(t._conversationModule.getNetworkType()).end(),Ge.l("".concat(r," ok"));var n=e.data.updateGroupResult.convGroupID;t._convGroupMap.set(n,a),t._emitConvGroupListUpdate();var s,u,c=t._conversationModule.getLocalConversationList(),l=!1;c.forEach((function(e){s=e.conversationGroupList,-1!==(u=s.indexOf(i))&&(s.splice(u,1,a),l=!0)})),!0===l&&t._emitConversationUpdate()})).catch((function(e){return t._conversationModule.probeNetwork().then((function(t){var n=M(t,2),r=n[0],i=n[1];o.setError(e,r,i).end()})),Ge.e("".concat(r," failed. error:"),e),jn(e)}))}},{key:"addConvsToGroup",value:function(e){var t=this,n="addConversationsToGroup";if(!this._conversationModule.canIUse(q.CONV_GROUP))return this._conversationModule.cannotUseCommercialAbility(n);var r="".concat(this._n,".").concat(n);Ge.l("".concat(r," options:"),e);var o=new ar(n);o.setMessage(JSON.stringify(e));var i=e.conversationIDList,a=e.groupName,s={fromAccount:this._getMyUserID(),updateType:1,updateGroup:{updateGroupType:2,groupName:a,updateItem:[]}},u=[],c=[];return i.forEach((function(e){return t._hasLocalConversation(e)?bt(e)||Dt(e)?void(bt(e)?s.updateGroup.updateItem.push({operationType:1,contactItem:{type:1,toAccount:e.replace(O.CONV_C2C,"")}}):Dt(e)&&s.updateGroup.updateItem.push({operationType:1,contactItem:{type:2,groupID:e.replace(O.CONV_GROUP,"")}})):(t._onConversationIDInvalid(c,e),!0):(t._onConversationNotFound(c,e),!0)})),c.length===i.length?Bn({successConversationIDList:u,failureConversationIDList:c}):this._conversationModule.request({protocolName:Kn.ADD_CONVERSATIONS_TO_GROUP,requestData:s}).then((function(e){o.setNetworkType(t._conversationModule.getNetworkType()).end(),Ge.l("".concat(r," ok"));var n=e.data.updateGroupResult.contactResultItem;if(it(n)){var i,s,l=!1;n.forEach((function(e){i=t._concatConversationID(e.contactItem),0===e.resultCode?(s=t._getLocalConversation(i))&&-1===s.conversationGroupList.indexOf(a)&&(s.conversationGroupList.push(a),u.push(i),l=!0):c.push({conversationID:i,code:e.resultCode,message:e.resultInfo})})),!0===l&&(t._emitConversationUpdate(),t._emitConvInGroupUpdate(a))}return xn({successConversationIDList:u,failureConversationIDList:c})})).catch((function(e){return t._conversationModule.probeNetwork().then((function(t){var n=M(t,2),r=n[0],i=n[1];o.setError(e,r,i).end()})),Ge.e("".concat(r," failed. error:"),e),jn(e)}))}},{key:"deleteConvsFromGroup",value:function(e){var t=this,n="deleteConversationsFromGroup";if(!this._conversationModule.canIUse(q.CONV_GROUP))return this._conversationModule.cannotUseCommercialAbility(n);var r="".concat(this._n,".").concat(n);Ge.l("".concat(r," options:"),e);var o=new ar(n);o.setMessage(JSON.stringify(e));var i=e.conversationIDList,a=e.groupName,s={fromAccount:this._getMyUserID(),updateType:1,updateGroup:{updateGroupType:2,groupName:a,updateItem:[]}},u=[],c=[];return i.forEach((function(e){return t._hasLocalConversation(e)?bt(e)||Dt(e)?void(bt(e)?s.updateGroup.updateItem.push({operationType:2,contactItem:{type:1,toAccount:e.replace(O.CONV_C2C,"")}}):Dt(e)&&s.updateGroup.updateItem.push({operationType:2,contactItem:{type:2,groupID:e.replace(O.CONV_GROUP,"")}})):(t._onConversationIDInvalid(c,e),!0):(t._onConversationNotFound(c,e),!0)})),c.length===i.length?Bn({successConversationIDList:u,failureConversationIDList:c}):this._conversationModule.request({protocolName:Kn.DELETE_CONVERSATIONS_FROM_GROUP,requestData:s}).then((function(e){o.setNetworkType(t._conversationModule.getNetworkType()).end(),Ge.l("".concat(r," ok"));var n=e.data.updateGroupResult.contactResultItem;if(it(n)){var i,s,l=!1;n.forEach((function(e){if(i=t._concatConversationID(e.contactItem),0===e.resultCode){if(s=t._getLocalConversation(i)){var n=s.conversationGroupList.indexOf(a);-1!==n&&(s.conversationGroupList.splice(n,1),u.push(i),l=!0)}}else c.push({conversationID:i,code:e.resultCode,message:e.resultInfo})})),!0===l&&(t._emitConversationUpdate(),t._emitConvInGroupUpdate(a))}return xn({successConversationIDList:u,failureConversationIDList:c})})).catch((function(e){return t._conversationModule.probeNetwork().then((function(t){var n=M(t,2),r=n[0],i=n[1];o.setError(e,r,i).end()})),Ge.e("".concat(r," failed. error:"),e),jn(e)}))}},{key:"onConvMarkUpdated",value:function(e){var t=this;if(!Qt(e)){var n,r;Ge.d("".concat(this._n,".onConvMarkUpdated markItemList:"),e);var o=!1;e.forEach((function(e){var i=e.recentContactItem,a=e.optType,s=e.standardMark,u=e.customMark;n=t._concatConversationID(i),(r=t._getLocalConversation(n))&&(1===a?o=t._diffStandardMark(r,s):2===a?o=t._diffCustomMark(r,u):3===a&&(o=t._diffStandardMark(r,s)||t._diffCustomMark(r,u)))})),!0===o&&this._emitConversationUpdate()}}},{key:"_diffStandardMark",value:function(e,t){var n=Ht(t),r=!1;return!0!==function(e,t){if(e===t)return!0;if(!e||!t)return!1;if(e.length!==t.length)return!1;for(var n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0}(e.markList,n)&&(e.markList=n,r=!0),r}},{key:"_diffCustomMark",value:function(e,t){var n=!1;return e.customData!==t&&void 0!==t&&(e.customData=t,n=!0),n}},{key:"onConvGroupCreated",value:function(e){var t=this;Ge.d("".concat(this._n,".onConvGroupCreated resultList:"),e);var n=!1,r=!1;it(e)&&(e.forEach((function(e){var o=e.msgGroupItem,i=o.groupID,a=o.groupName;t._convGroupMap.get(i)!==a&&(t._convGroupMap.set(i,a),r=!0);var s,u,c=e.msgRecentContactItem;it(c)&&c.forEach((function(e){s=t._concatConversationID(e),(u=t._getLocalConversation(s))&&-1===u.conversationGroupList.indexOf(a)&&(u.conversationGroupList.push(a),n=!0)}))})),!0===n&&this._emitConversationUpdate(),!0===r&&this._emitConvGroupListUpdate())}},{key:"onConvGroupDeleted",value:function(e){var t=this;Ge.d("".concat(this._n,".onConvGroupDeleted groupItemList:"),e);var n=[];if(it(e)){var r=!1;e.forEach((function(e){var o=e.groupID,i=e.groupName;t._convGroupMap.has(o)&&(t._convGroupMap.delete(o),r=!0,n.push(i))})),!0===r&&this._emitConvGroupListUpdate()}this._eraseFromConversationGroupList(n)}},{key:"_eraseFromConversationGroupList",value:function(e){Qt(e)||(this._conversationModule.getLocalConversationList().forEach((function(t){t.conversationGroupList=t.conversationGroupList.filter((function(t){return!e.includes(t)}))})),this._emitConversationUpdate())}},{key:"onConvGroupNameUpdated",value:function(e){Ge.d("".concat(this._n,".onConvGroupNameUpdated options:"),e);var t=e.groupID,n=e.groupName,r=e.oldGroupName;if(this._convGroupMap.get(t)!==n){this._convGroupMap.set(t,n),this._emitConvGroupListUpdate();var o,i,a=this._conversationModule.getLocalConversationList(),s=!1;a.forEach((function(e){o=e.conversationGroupList,-1!==(i=o.indexOf(r))&&(o.splice(i,1,n),s=!0)})),!0===s&&this._emitConversationUpdate()}}},{key:"onConvInGroupUpdated",value:function(e){var t=this;Ge.d("".concat(this._n,".onConvInGroupUpdated options:"),e);var n=e.oldGroupName,r=e.recentContactUpdateGroupItem;if(it(r)){var o,i,a,s=!1;r.forEach((function(e){var r=e.contactOptType,u=e.recentContactItem;o=t._concatConversationID(u),(i=t._getLocalConversation(o))&&(a=i.conversationGroupList.indexOf(n),1===r?-1===a&&(i.conversationGroupList.push(n),s=!0):2===r&&-1!==a&&(i.conversationGroupList.splice(a,1),s=!0))})),!0===s&&(this._emitConversationUpdate(),this._emitConvInGroupUpdate(n))}}},{key:"onConvAddedToOrDeletedFromGroup",value:function(e){var t=this;Ge.d("".concat(this._n,".onConvAddedToOrDeletedFromGroup options:"),e);var n=e.msgRecentContactItem,r=e.msgRecentContactUpdateContactItem,o=this._concatConversationID(n),i=this._getLocalConversation(o);if(i&&it(r)){var a,s=!1;r.forEach((function(e){var n=e.groupOptType,r=e.recentContactGroupItem.groupName;a=i.conversationGroupList.indexOf(r),1===n?-1===a&&(i.conversationGroupList.push(r),s=!0):2===n&&-1!==a&&(i.conversationGroupList.splice(a,1),s=!0),!0===s&&t._emitConvInGroupUpdate(r)})),!0===s&&this._emitConversationUpdate()}}},{key:"onConvGroupListSynced",value:function(e){var t=this;it(e)&&0!==e.length&&(Ge.l("".concat(this._n,".onConvGroupListSynced groupItemList:"),e),e.forEach((function(e){t._convGroupMap.set(e.convGroupID,e.groupName)})))}},{key:"getConvGroupListByID",value:function(e){var t=this;if(!Qt(e)){var n=[];return e.forEach((function(e){t._convGroupMap.has(e)&&n.push(t._convGroupMap.get(e))})),n}}},{key:"_onConversationNotFound",value:function(e,t){e.push({conversationID:t,code:qn.CONV_NOT_FOUND,message:this._conversationModule.getErrorMessage(qn.CONV_NOT_FOUND)})}},{key:"_onConversationIDInvalid",value:function(e,t){e.push({conversationID:t,code:qn.INVALID_CONV_ID,message:this._conversationModule.getErrorMessage(qn.INVALID_CONV_ID)})}},{key:"_getFlagBit",value:function(e){for(var t=e.toString(2),n=t.length,r=n-1;r>=0;r--)if("1"===t[r])return n-r-1}},{key:"_concatConversationID",value:function(e){var t,n=e.type,r=e.to,o=e.groupID,i=e.userID;return 1===n?at(i)?at(r)||(t="".concat(O.CONV_C2C).concat(r)):t="".concat(O.CONV_C2C).concat(i):2===n&&(t="".concat(O.CONV_GROUP).concat(o)),t}},{key:"_getMyUserID",value:function(){return this._conversationModule.getMyUserID()}},{key:"_insertConversationGroup",value:function(e,t){var n=this._getLocalConversation(e);if(n){var r=n.conversationGroupList;-1===r.indexOf(t)&&r.push(t)}}},{key:"_getLocalConversation",value:function(e){return this._conversationModule.getLocalConversation(e)}},{key:"_hasLocalConversation",value:function(e){return this._conversationModule.hasLocalConversation(e)}},{key:"_emitConversationUpdate",value:function(){this._conversationModule.emitConversationUpdate(!0,!1)}},{key:"_emitConvGroupListUpdate",value:function(){this._conversationModule.emitOuterEvent(A.CONVERSATION_GROUP_LIST_UPDATED,T(this._convGroupMap.values()))}},{key:"_emitConvInGroupUpdate",value:function(e){var t={groupName:e,conversationList:[]},n=this._conversationModule.getLocalConversationList();t.conversationList=n.filter((function(t){return t.conversationGroupList.includes(e)})),this._conversationModule.emitOuterEvent(A.CONVERSATION_IN_GROUP_UPDATED,t)}},{key:"reset",value:function(){Ge.l("".concat(this._n,".reset")),this._convGroupMap.clear(),this._startIndex=0,this._pagingStatus=on.NOT_START}}]),e}(),xr=function(e){d(r,e);var n=I(r);function r(e){var t;return a(this,r),(t=n.call(this,e))._n="ConversationModule",kr.mixin(m(t)),t._messageListHandler=new Er,t._messageRemindHandler=new Ur(m(t)),t._convGroupHandler=new Gr(m(t)),t.singlyLinkedList=new Rr(100),t._pagingStatus=on.NOT_START,t._pagingTimeStamp=0,t._pagingStartIndex=0,t._pagingPinnedTimeStamp=0,t._pagingPinnedStartIndex=0,t._pagingConvIDMap=new Map,t._convIDFromUnreadDBMap=new Map,t._conversationMap=new Map,t._tmpGroupList=[],t._tmpGroupAtTipsList=[],t._peerReadTimeMap=new Map,t._completedMap=new Map,t._roamingMessageKeyAndTimeMap=new Map,t._roamingMessageSequenceMap=new Map,t._remoteGroupReadSequenceMap=new Map,t._convTotalUnreadCount=0,t._pagingGetCostList=[],t._initListeners(),t}return c(r,[{key:"_initListeners",value:function(){var e=this.getInnerEmitterInstance();e.on(Cr.A2KEY_AND_TINYID_UPDATED,this._init,this),e.on(Cr.PROFILE_UPDATED,this._onProfileUpdated,this)}},{key:"onCheckTimer",value:function(e){e%60==0&&this._messageListHandler.traversal()}},{key:"_init",value:function(){var e=this;Ge.l("".concat(this._n,"._init"));var t=this.getModule(13).getItem("conversationMap"),n=this.isIntl(),r=this.isUsingChatCore();if(t){for(var o=t.length,i=0;i<o;i++){var a=t[i];if(a){if(this._isNonExistentAccount(a.conversationID))continue;if(a.groupProfile){var s=a.groupProfile.type;if(Et(s))continue}}this._conversationMap.set(a.conversationID,new Pr(t[i],n,r))}this.emitConversationUpdate(!0,!1)}this.ready((function(){e._tmpGroupList.length>0&&(e.updateConversationGroupProfile(e._tmpGroupList),e._tmpGroupList.length=0)})),this.syncConversationList()}},{key:"_isNonExistentAccount",value:function(e){var t;return e.startsWith(O.CONV_C2C)&&(t=e.replace(O.CONV_C2C,"")),"@TLS#ERROR"===t||"@TLS#NOT_FOUND"===t}},{key:"onMessageSent",value:function(e){this._onSendOrReceiveMessage({conversationOptionsList:e.conversationOptionsList,isInstantMessage:!0})}},{key:"onNewMessage",value:function(e){this._onSendOrReceiveMessage(e)}},{key:"_onSendOrReceiveMessage",value:function(e){var t=this,n=e.conversationOptionsList,r=e.isInstantMessage,o=void 0===r||r,i=e.isUnreadC2CMessage,a=void 0!==i&&i,s=e.updateUnreadCount,u=void 0===s||s,c=e.isSyncingEnded,l=void 0!==c&&c;this._isReady?0!==n.length?(!0===o&&this._checkNewConversation(n),this._updateLocalConversationList({conversationOptionsList:n,isInstantMessage:o,isUnreadC2CMessage:a,isFromGetConversations:!1,updateUnreadCount:u}),o||(this._convIDFromUnreadDBMap=new Map([].concat(T(this._convIDFromUnreadDBMap),T(n.map((function(e){return[e.conversationID,1]}))))),this._diffAndDeleteConversation(),l&&this.emitInnerEvent(Cr.C2C_UNREAD_HANDLE_COMPLETED)),n.filter((function(e){return e.type===O.CONV_TOPIC})).length>0||this.emitConversationUpdate()):l&&this.emitInnerEvent(Cr.C2C_UNREAD_HANDLE_COMPLETED):this.ready((function(){t._onSendOrReceiveMessage(e)}))}},{key:"updateConversationGroupProfile",value:function(e){var t=this;if(!it(e)||0!==e.length)if(0!==this._conversationMap.size){var n=!1;e.forEach((function(e){var r="GROUP".concat(e.groupID);if(t._conversationMap.has(r)){n=!0;var o=t._conversationMap.get(r);o.groupProfile=JSON.parse(JSON.stringify(e)),o.lastMessage.lastSequence<e.nextMessageSeq&&(o.lastMessage.lastSequence=e.nextMessageSeq-1),o.subType||(o.subType=e.type)}})),n&&this.emitConversationUpdate(!0,!1)}else this._tmpGroupList=e}},{key:"_updateConversationUserProfile",value:function(e){var t=this;e.data.forEach((function(e){var n="C2C".concat(e.userID);t._conversationMap.has(n)&&(t._conversationMap.get(n).userProfile=e)})),this.emitConversationUpdate(!0,!1)}},{key:"onMessageRevoked",value:function(e){var t=this;if(0!==e.length){var n=null,r=!1,o=[];e.forEach((function(e){(n=t._conversationMap.get(e.conversationID))&&(n.type===O.CONV_TOPIC?o.push(e):(n.reduceUnreadCount()&&(r=!0),n.isLastMessageRevoked({sequence:e.sequence,time:e.time})&&(n.setLastMessageRevoked(!0),n.setLastMessageRevoker(e.revoker),r=!0)))})),this.getModule(10).onMessageRevoked(o),r&&(this.emitConversationUpdate(!0,!1),this.emitTotalUnreadMessageCountUpdate())}}},{key:"updateRevokerInfo",value:function(e){for(var t=new Set,n=0;n<e.length;n++){var r=e[n].revoker;t.add(r)}var o=T(t),i=this.getModule(4);return new Promise((function(t){i.getUserProfile({userIDList:o}).then((function(n){var r=n.data;if(!it(r)||0===r.length)return t(e);var o,i={},a=D(r);try{for(a.s();!(o=a.n()).done;){var s=o.value,u=s.userID,c=s.nick,l=s.avatar;i[u]={nick:c,avatar:l}}}catch(g){a.e(g)}finally{a.f()}e.forEach((function(e){var t=e.revoker;i[t]&&(e.revokerInfo.nick=i[t].nick||"",e.revokerInfo.avatar=i[t].avatar||"")})),t(e)})).catch((function(){t(e)}))}))}},{key:"isLastMessageRevoked",value:function(e){var t=!1,n=e.conversationID,r=e.sequence,o=e.time,i=this._conversationMap.get(n);return i&&(t=i.type===O.CONV_TOPIC?this.getModule(10).isLastMessageRevoked({topicID:n.replace(O.CONV_GROUP,""),sequence:r}):i.isLastMessageRevoked({sequence:r,time:o})),Ge.l("".concat(this._n,".isLastMessageRevoked options:").concat(JSON.stringify(e)," ret:").concat(t)),t}},{key:"onMessageDeleted",value:function(e){var t=this;if(0!==e.length){var n=null;e.forEach((function(e){(n=t._messageListHandler.getLocalMessage(e.conversationID,e.ID))&&(n.isDeleted=!0),e!==n&&(e.isDeleted=!0)}));for(var r=e[0].conversationID,o=this._messageListHandler.getLocalMessageList(r),i={},a=o.length-1;a>=0;a--)if(!o[a].isDeleted){i=o[a];break}var s=this._conversationMap.get(r);if(s){var u=!1;s.lastMessage.lastSequence===i.sequence&&s.lastMessage.lastTime===i.time||(Qt(i)&&(i=void 0),s.updateLastMessage(i),s.type!==O.CONV_TOPIC&&(u=!0),Ge.l("".concat(this._n,".onMessageDeleted. update conversationID:").concat(r," with lastMessage:"),s.lastMessage)),r.startsWith(O.CONV_C2C)&&this.updateUnreadCount(r),u&&this.emitConversationUpdate(!0,!1)}}}},{key:"onMessageModified",value:function(e){var t="".concat(this._n,".onMessageModified"),n=e.conversationType,r=e.from,o=e.to,i=e.time,a=e.sequence,s=e.elements,u=e.cloudCustomData,c=e.messageVersion,l=this.getMyUserID(),d="".concat(n).concat(o);o===l&&n===O.CONV_C2C&&(d="".concat(n).concat(r));var f=this._messageListHandler.onMessageModified(d,e),p=f.isUpdated,h=f.message;!0===p&&this.emitOuterEvent(A.MESSAGE_MODIFIED,[h]);var g=this._isTopicConversation(d);if(null===h?Ge.l("".concat(t," message is null! options:").concat(JSON.stringify(e),"}")):Ge.l("".concat(t," isUpdated:").concat(p," isTopicMessage:").concat(g," from:").concat(r," to:").concat(o," sequence:").concat(h.sequence," time:").concat(h.time)),g)this.getModule(10).onMessageModified(e);else{var v=this._conversationMap.get(d);if(v){var _=v.lastMessage;_&&_.lastTime===i&&_.lastSequence===a&&_.version!==c&&(Ge.l("".concat(t," conversationID:").concat(d," lastMessage updated")),_.type=s[0].type,_.payload=s[0].content,_.messageForShow=Bt(_.type,_.payload,this.isIntl()),_.cloudCustomData=u,_.version=c,this.emitConversationUpdate(!0,!1))}}return h}},{key:"onNewGroupAtTips",value:function(e){var n=this,r=e.dataList,o=null;r.forEach((function(e){e.groupAtTips?o=e.groupAtTips:e.elements?o=t(t({},e.elements),{},{sync:!0}):e.groupAtType&&(o=t(t({},e),{},{sync:!0})),o.__random=e.random,o.__sequence=e.clientSequence,n._tmpGroupAtTipsList.push(o)})),Ge.d("".concat(this._n,".onNewGroupAtTips isReady:").concat(this._isReady),this._tmpGroupAtTipsList),this._isReady&&this._handleGroupAtTipsList()}},{key:"_handleGroupAtTipsList",value:function(){var e=this;if(0!==this._tmpGroupAtTipsList.length){var t=!1;this._tmpGroupAtTipsList.forEach((function(n){var r=n.groupID,o=n.from,i=n.topicID,a=void 0===i?void 0:i,s=n.sync,u=void 0!==s&&s;if(o!==e.getMyUserID())if(at(a)){var c=e._conversationMap.get("".concat(O.CONV_GROUP).concat(r));c&&(c.updateGroupAtInfoList(n),t=!0)}else{var l=e._conversationMap.get("".concat(O.CONV_GROUP).concat(a));if(l){l.updateGroupAtInfoList(n);var d=e.getModule(10),f=l.groupAtInfoList;d.onConversationProxy({topicID:a,groupAtInfoList:f})}Qt(l)&&u&&(e.updateTopicConversation([{conversationID:"".concat(O.CONV_GROUP).concat(a),type:O.CONV_TOPIC}]),e._conversationMap.get("".concat(O.CONV_GROUP).concat(a)).updateGroupAtInfoList(n))}})),t&&this.emitConversationUpdate(!0,!1),this._tmpGroupAtTipsList.length=0}}},{key:"_checkNewConversation",value:function(e){var t=this,n=[],r=[];e.forEach((function(e){t._conversationMap.has(e.conversationID)||(e.type===O.CONV_C2C?n.push(e.conversationID.replace(O.CONV_C2C,"")):e.type===O.CONV_GROUP&&r.push(e.conversationID.replace(O.CONV_GROUP,"")))})),n.length>0&&(this._onNewC2CConversation(n),n=null),r.length>0&&(this._onNewGroupConversation(r),r=null)}},{key:"_onNewC2CConversation",value:function(e){this.getModule(6).getRemotePeerReadTime(e),this._messageRemindHandler.getC2CMessageRemindType(e)}},{key:"_onNewGroupConversation",value:function(e){var t=this.getModule(7);t&&t.getMessageRemindType(e)}},{key:"_setStorageConversationList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.getLocalConversationList(),n=t.filter((function(e){return e.type===O.CONV_C2C||e.type===O.CONV_GROUP&&e.lastMessage.type!==O.MSG_GRP_TIP})).slice(0,20).map((function(e){return{conversationID:e.conversationID,type:e.type,subType:e.subType,lastMessage:e.lastMessage,groupProfile:e.groupProfile,userProfile:e.userProfile}})),r=this.getModule(13);r.setItem("conversationMap",n,e)}},{key:"emitConversationUpdate",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.getLocalConversationList();if(t){var r=this.getModule(7);r&&r.updateGroupLastMessage(n)}e&&this.emitOuterEvent(A.CONVERSATION_LIST_UPDATED)}},{key:"getLocalConversationList",value:function(){return T(this._conversationMap.values()).filter((function(e){return e.type!==O.CONV_TOPIC}))}},{key:"getLocalConversation",value:function(e){return this._conversationMap.get(e)}},{key:"hasLocalConversation",value:function(e){return this._conversationMap.has(e)}},{key:"getLocalOldestMessage",value:function(e){return this._messageListHandler.getLocalOldestMessage(e)}},{key:"syncConversationList",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n="syncConversationList",r=new ar(n);return this._pagingStatus===on.NOT_START&&this._conversationMap.clear(),this._pagingGetConversationList(t).then((function(t){var o=Jt(e._pagingGetCostList),i=zt(e._pagingGetCostList);e._pagingGetCostList.length=0,e._pagingStatus=on.RESOLVED,e._diffAndDeleteConversation(),e.emitConversationUpdate(!0,!1),e._setStorageConversationList(),e._handleC2CPeerReadTime(),e.emitInnerEvent(Cr.CONV_SYNC_COMPLETED);var a="count:".concat(e._conversationMap.size," sum:").concat(i," avg:").concat(o);return Ge.l("".concat(e._n,".").concat(n,". ").concat(a)),r.setMessage(a).setNetworkType(e.getNetworkType()).end(),t})).catch((function(t){return e._pagingStatus=on.REJECTED,r.setMessage(e._pagingTimeStamp),e.probeNetwork().then((function(e){var n=M(e,2),o=n[0],i=n[1];r.setError(t,o,i).end()})),jn(t)}))}},{key:"_diffAndDeleteConversation",value:function(){var e=this;if(this._isSyncCompleted()){var t=[];this._conversationMap.forEach((function(n,r){!e._pagingConvIDMap.has(r)&&e._convIDFromUnreadDBMap.has(r)&&(e._conversationMap.delete(r),t.push(r))})),Ge.l("".concat(this._n,"._diffAndDeleteConversation list:").concat(t)),t=null}}},{key:"_pagingGetConversationList",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n="".concat(this._n,"._pagingGetConversationList");Ge.l("".concat(n," incrementalPullFlag:").concat(t," timeStamp:").concat(this._pagingTimeStamp," startIndex:").concat(this._pagingStartIndex)+" pinnedTimeStamp:".concat(this._pagingPinnedTimeStamp," pinnedStartIndex:").concat(this._pagingPinnedStartIndex));var r=Date.now();return this._pagingStatus=on.PENDING,this.request({protocolName:Kn.PAGING_GET_CONVERSATION_LIST,requestData:{fromAccount:this.getMyUserID(),timeStamp:t?this._pagingTimeStamp:0,startIndex:t?this._pagingStartIndex:0,pinnedTimeStamp:t?this._pagingPinnedTimeStamp:0,pinnedStartIndex:t?this._pagingPinnedStartIndex:0,orderType:1}}).then((function(t){var o=t.data,i=o.completeFlag,a=o.conversations,s=void 0===a?[]:a,u=o.timeStamp,c=o.startIndex,l=o.pinnedTimeStamp,d=o.pinnedStartIndex,f=o.groupItem;if(e._pagingGetCostList.push(Xt(r,!1)),Ge.l("".concat(n," ok. completeFlag:").concat(i," count:").concat(s.length," cost:").concat(Xt(r))),e._convGroupHandler.onConvGroupListSynced(f),s.length>0){var p=e._getConversationOptions(s);e._pagingConvIDMap=new Map([].concat(T(e._pagingConvIDMap),T(p.map((function(e){return[e.conversationID,1]}))))),e._updateLocalConversationList({conversationOptionsList:p,isFromGetConversations:!0,updateUnreadCount:!0}),e.isLoggedIn()&&e.emitConversationUpdate()}if(!e._isReady){if(!e.isLoggedIn())return Bn();e.triggerReady()}return e._pagingTimeStamp=u,e._pagingStartIndex=c,e._pagingPinnedTimeStamp=l,e._pagingPinnedStartIndex=d,1!==i?e._pagingGetConversationList():(e._handleGroupAtTipsList(),e._convGroupHandler.getRemoteConvGroupList(),Bn())})).catch((function(t){throw e.isLoggedIn()&&(e._isReady||(Ge.w("".concat(n," failed. error:"),t),e.triggerReady())),t}))}},{key:"_updateLocalConversationList",value:function(e){var t,n=e.isFromGetConversations,r=e.isInstantMessage,o=Date.now();t=this._getTmpConversationListMapping(e),this._conversationMap=new Map(this._sortConversationList([].concat(T(t.toBeUpdatedConversationList),T(this._conversationMap)))),n||(this._updateUserOrGroupProfile(t.newConversationList),r&&this.emitTotalUnreadMessageCountUpdate()),Ge.l("".concat(this._n,"._updateLocalConversationList cost:").concat(Xt(o)))}},{key:"_getTmpConversationListMapping",value:function(e){for(var t=e.conversationOptionsList,n=e.isFromGetConversations,r=e.isInstantMessage,o=e.isUnreadC2CMessage,i=void 0!==o&&o,a=e.updateUnreadCount,s=[],u=[],c=this.getModule(7),l=this.getModule(8),d=this.isIntl(),f=this.isUsingChatCore(),p=0,h=t.length;p<h;p++){var g=new Pr(t[p],d,f),v=g.conversationID;if(!this._isNonExistentAccount(v))if(this._conversationMap.has(v)){var _=this._conversationMap.get(v),m=["unreadCount","allowType","adminForbidType","payload"];!1===r?m.push("lastMessage"):m.push("isPinned");var y=t[p].lastMessage,I=!at(y);I||t[p].type===O.CONV_TOPIC||this._onLastMessageNotExist(t[p]),at(r)&&I&&null===_.lastMessage.payload&&(_.lastMessage.payload=y.payload),Qt(_.lastMessage.revoker)||(_.lastMessage.revoker=null),pt(_,g,m,[null,void 0,"",0,NaN]),!0===a&&_.updateUnreadCount({nextUnreadCount:g.unreadCount,isFromGetConversations:n,isUnreadC2CMessage:i}),r&&I&&(y.payload&&(_.lastMessage.payload=y.payload),_.type===O.CONV_GROUP&&(_.lastMessage.nameCard=y.nameCard,_.lastMessage.nick=y.nick)),I&&_.lastMessage.cloudCustomData!==y.cloudCustomData&&(_.lastMessage.cloudCustomData=y.cloudCustomData||""),this._conversationMap.delete(v),s.push([v,_])}else{if(g.type===O.CONV_GROUP&&c){var M=g.groupProfile.groupID,T=c.getLocalGroupProfile(M);T&&(g.groupProfile=T,!0===a&&g.updateUnreadCount({nextUnreadCount:0}))}else if(g.type===O.CONV_C2C){var S=v.replace(O.CONV_C2C,"");l&&l.isMyFriend(S)&&(g.remark=l.getFriendRemark(S))}u.push(g),s.push([v,g])}}for(var E=this.getModule(10),C=s.length,k=0;k<C;k++)if(s[k][1].type===O.CONV_TOPIC){var b=s[k][1],D=b.conversationID,A=b.unreadCount,R=b.groupAtInfoList;E.onConversationProxy({topicID:D.replace(O.CONV_GROUP,""),unreadCount:A,groupAtInfoList:Qt(R)?void 0:R})}return{toBeUpdatedConversationList:s,newConversationList:u}}},{key:"_onLastMessageNotExist",value:function(e){new ar("lastMessageNotExist").setMessage(JSON.stringify(e)).setNetworkType(this.getNetworkType()).end()}},{key:"_sortConversationList",value:function(e){var t=[],n=[],r=[],o=[];return e.forEach((function(e){!0===e[1].isPinned?Qt(e[1].lastMessage.lastTime)?n.push(e):t.push(e):Qt(e[1].lastMessage.lastTime)?o.push(e):r.push(e)})),t.sort((function(e,t){return t[1].lastMessage.lastTime-e[1].lastMessage.lastTime})).concat(n).concat(r.sort((function(e,t){return t[1].lastMessage.lastTime-e[1].lastMessage.lastTime}))).concat(o)}},{key:"_sortConversationListAndEmitEvent",value:function(){this._conversationMap=new Map(this._sortConversationList(T(this._conversationMap))),this.emitConversationUpdate(!0,!1)}},{key:"_updateUserOrGroupProfile",value:function(e){var t=this;if(0!==e.length){var n=[],r=[],o=this.getModule(4),i=this.getModule(7);e.forEach((function(e){if(e.type===O.CONV_C2C)n.push(e.toAccount);else if(e.type===O.CONV_GROUP){var t=e.toAccount;i.hasLocalGroup(t)?e.groupProfile=i.getLocalGroupProfile(t):r.push(t)}})),Ge.l("".concat(this._n,"._updateUserOrGroupProfile c2cUserIDList:").concat(n," groupIDList:").concat(r)),n.length>0&&o.getUserProfile({userIDList:n}).then((function(e){var n=e.data;it(n)?n.forEach((function(e){t._doUpdateUserProfile("C2C".concat(e.userID),e)})):t._doUpdateUserProfile("C2C".concat(n.userID),n)})),r.length>0&&i.getGroupProfileAdvance({groupIDList:r,responseFilter:{groupBaseInfoFilter:["Type","Name","FaceUrl"]}}).then((function(e){e.data.successGroupList.forEach((function(e){var n="GROUP".concat(e.groupID);if(t._conversationMap.has(n)){var r=t._conversationMap.get(n);pt(r.groupProfile,e,[],[null,void 0,"",0,NaN]),!r.subType&&e.type&&(r.subType=e.type)}}))}))}}},{key:"_doUpdateUserProfile",value:function(e,t){this.hasLocalConversation(e)&&(this.getLocalConversation(e).userProfile=t)}},{key:"_getConversationOptions",value:function(e){var n=this,r=[],o=e.filter((function(e){var t=e.type,r=e.userID;return 1===t&&!n._isNonExistentAccount(r)||2===t})),i=this.getMyUserID(),a=o.map((function(e){if(at(e.lastMsg)&&(e.lastMsg={elements:[]}),1===e.type){var o={userID:e.userID,nick:e.peerNick,avatar:e.peerAvatar};return r.push(o),{conversationID:"C2C".concat(e.userID),type:"C2C",lastMessage:{lastTime:e.time,lastSequence:e.sequence,fromAccount:e.lastC2CMsgFromAccount,type:e.lastMsg.elements[0]?e.lastMsg.elements[0].type:null,payload:e.lastMsg.elements[0]?n._amendLayersOverLimitProperty(e.lastMsg.elements[0].content):null,cloudCustomData:e.lastMsg.cloudCustomData||"",isRevoked:8===e.lastMessageFlag,onlineOnlyFlag:!1,nick:"",nameCard:"",version:0,isPeerRead:e.lastC2CMsgFromAccount===i&&e.time<=e.c2cPeerReadTime,revoker:e.lastMsg.revokerInfo?e.lastMsg.revokerInfo.revoker:null},userProfile:new Ar(o),peerReadTime:e.c2cPeerReadTime,isPinned:1===e.isPinned,customData:e.customMark||"",markList:Ht(e.standardMark),conversationGroupList:n._convGroupHandler.getConvGroupListByID(e.contactGroupId),remark:e.friendRemark||"",messageRemindType:n._transMessageRemindType(e.messageRemindType)}}return{conversationID:"GROUP".concat(e.groupID),type:"GROUP",lastMessage:t(t({lastTime:e.time,lastSequence:e.sequence,fromAccount:e.msgGroupFromAccount},n._patchTypeAndPayload(e)),{},{cloudCustomData:e.lastMsg.cloudCustomData||"",isRevoked:2===e.lastMessageFlag,onlineOnlyFlag:!1,nick:e.senderNick||"",nameCard:e.senderNameCard||"",revoker:e.lastMsg.revokerInfo?e.lastMsg.revokerInfo.revoker:null}),groupProfile:new wr({groupID:e.groupID,name:e.groupNick,avatar:e.groupImage,type:e.groupType,nextMessageSeq:e.nextMessageSeq}),unreadCount:n._computeGroupUnreadCount(e),peerReadTime:0,isPinned:1===e.isPinned,version:0,customData:e.customMark||"",markList:Ht(e.standardMark),conversationGroupList:n._convGroupHandler.getConvGroupListByID(e.contactGroupId),messageRemindType:n._transMessageRemindType(e.messageRemindType)}}));return r.length>0&&this.getModule(4).onConversationsProfileUpdated(r),a}},{key:"_transMessageRemindType",value:function(e){var t="";return 0===e?t=O.MSG_REMIND_ACPT_AND_NOTE:1===e?t=O.MSG_REMIND_DISCARD:2===e&&(t=O.MSG_REMIND_ACPT_NOT_NOTE),t}},{key:"_computeGroupUnreadCount",value:function(e){var t=e.unreadCount,n=void 0===t?0:t,r=e.noUnreadCount,o=n-(void 0===r?0:r);return o>0?o:0}},{key:"_patchTypeAndPayload",value:function(e){var n=e.lastMsg,r=n.event,o=void 0===r?void 0:r,i=n.elements,a=void 0===i?[]:i,s=n.groupTips,u=void 0===s?{}:s;if(!at(o)&&!Qt(u)){var c=new Tr(u);c.setElement({type:O.MSG_GRP_TIP,content:t(t({},u.elements),{},{groupProfile:u.groupProfile})});var l=JSON.parse(JSON.stringify(c.payload));return c=null,{type:O.MSG_GRP_TIP,payload:l}}return{type:a[0]?a[0].type:null,payload:a[0]?this._amendLayersOverLimitProperty(a[0].content):null}}},{key:"_amendLayersOverLimitProperty",value:function(e){var t=e.layersOverLimit;return 0===t?e.layersOverLimit=!1:1===t&&(e.layersOverLimit=!0),e}},{key:"getLocalMessageList",value:function(e){return this._messageListHandler.getLocalMessageList(e)}},{key:"deleteLocalMessage",value:function(e){e instanceof Tr&&this._messageListHandler.remove(e)}},{key:"onConversationDeleted",value:function(e){if(it(e)){var t=e.map((function(e){var t=e.type,n=e.userID,r=e.groupID;return 1===t?"".concat(O.CONV_C2C).concat(n):2===t?"".concat(O.CONV_GROUP).concat(r):void 0}));Ge.l("".concat(this._n,".onConversationDeleted conversationIDList:").concat(t)),this.deleteLocalConversationList(t)}}},{key:"onConversationPinned",value:function(e){var t=this;if(it(e)){var n=!1;e.forEach((function(e){var r,o=e.type,i=e.userID,a=e.groupID;1===o?r=t.getLocalConversation("".concat(O.CONV_C2C).concat(i)):2===o&&(r=t.getLocalConversation("".concat(O.CONV_GROUP).concat(a))),r&&(Ge.l("".concat(t._n,".onConversationPinned conversationID:").concat(r.conversationID," isPinned:").concat(r.isPinned)),r.isPinned||(r.isPinned=!0,n=!0))})),n&&this._sortConversationListAndEmitEvent()}}},{key:"onConversationUnpinned",value:function(e){var t=this;if(it(e)){var n=!1;e.forEach((function(e){var r,o=e.type,i=e.userID,a=e.groupID;1===o?r=t.getLocalConversation("".concat(O.CONV_C2C).concat(i)):2===o&&(r=t.getLocalConversation("".concat(O.CONV_GROUP).concat(a))),r&&(Ge.l("".concat(t._n,".onConversationUnpinned conversationID:").concat(r.conversationID," isPinned:").concat(r.isPinned)),r.isPinned&&(r.isPinned=!1,n=!0))})),n&&this._sortConversationListAndEmitEvent()}}},{key:"getMessageList",value:function(e){var t=this,n=e.conversationID,r=e.nextReqMessageID,o=e.count,i="".concat(this._n,".getMessageList"),a=this.getLocalConversation(n),s="";if(a&&a.groupProfile&&(s=a.groupProfile.type),Et(s))return Ge.l("".concat(i," not available in avchatroom. conversationID:").concat(n)),Bn({messageList:[],nextReqMessageID:"",isCompleted:!0});(at(o)||o>15)&&(o=15),!r&&this._isNotInCommunity(n)&&(this._messageListHandler.removeByConversationID(n),this._completedMap.delete(n),this._roamingMessageSequenceMap.delete(n));var u=this._computeRemainingCount({conversationID:n,nextReqMessageID:r}),c=this._completedMap.has(n);if(Ge.l("".concat(i," conversationID:").concat(n," nextReqMessageID:").concat(r)+" remainingCount:".concat(u," count:").concat(o," isCompleted:").concat(c)),this._needGetHistory({conversationID:n,remainingCount:u,count:o}))return this.getHistoryMessages({conversationID:n,nextReqMessageID:r,count:20}).then((function(e){var r=e.nextReqID,o=e.storedMessageList,a=t._completedMap.has(n),s=o;u>0&&(s=t._messageListHandler.getLocalMessageList(n).slice(0,o.length+u));var c={nextReqMessageID:a?"":r,messageList:s,isCompleted:a},l=c.messageList.filter((function(e){return e.isRevoked}))||[],d=s.map((function(e){return e.sequence}));return Ge.l("".concat(i," ret.nextReqMessageID:").concat(c.nextReqMessageID," ret.isCompleted:").concat(c.isCompleted," ret.length:").concat(s.length," sequenceList:").concat(d)),it(l)&&0!==l.length?t.updateRevokerInfo(l).then((function(e){return e.forEach((function(e){var t=e.revokerInfo;c.messageList=c.messageList.map((function(n){return n.ID===e.ID&&t&&(n.revokeReason=t.reason||"",n.revokerInfo={userID:t.revoker||n.revoker,nick:t.nick,avatar:t.avatar}),n}))})),xn(c)})):xn(c)}));this.modifyMessageList(n);var l=this._getMessageListFromMemory({conversationID:n,nextReqMessageID:r,count:o});return Bn(l)}},{key:"_getMessageListFromMemory",value:function(e){var t=e.conversationID,n=e.nextReqMessageID,r=e.count,o="".concat(this._n,"._getMessageListFromMemory"),i=this._messageListHandler.getLocalMessageList(t),a=i.length,s=0,u={isCompleted:!1,nextReqMessageID:"",messageList:[]};return n?(s=i.findIndex((function(e){return e.ID===n})))>r?(u.messageList=i.slice(s-r,s),u.nextReqMessageID=i[s-r].ID):(u.messageList=i.slice(0,s),u.isCompleted=!0):a>r?(s=a-r,u.messageList=i.slice(s,a),u.nextReqMessageID=i[s].ID):(u.messageList=i.slice(0,a),u.isCompleted=!0),Ge.l("".concat(o," conversationID:").concat(t)+" ret.nextReqMessageID:".concat(u.nextReqMessageID," ret.isCompleted:").concat(u.isCompleted," ret.length:").concat(u.messageList.length)),u}},{key:"getMessageListHopping",value:function(e){var t=e.conversationID,n=e.sequence,r=e.time,o=e.count,i=e.direction,a=void 0===i?0:i;if((at(o)||o>15)&&(o=15),t.startsWith(O.CONV_C2C)){var s=this.getModule(6),u=t.replace(O.CONV_C2C,"");return s.getRoamingMessagesHopping({peerAccount:u,time:r,count:o,direction:a})}if(t.startsWith(O.CONV_GROUP)){var c=this.getModule(7),l=t.replace(O.CONV_GROUP,"");return c.getRoamingMessagesHopping({groupID:l,sequence:n,count:o,direction:a})}}},{key:"_computeRemainingCount",value:function(e){var t=e.conversationID,n=e.nextReqMessageID,r=this._messageListHandler.getLocalMessageList(t),o=r.length;if(!n)return o;var i=0;return bt(t)?i=r.findIndex((function(e){return e.ID===n})):Dt(t)&&(i=-1!==n.indexOf("-")?r.findIndex((function(e){return e.ID===n})):r.findIndex((function(e){return e.sequence===n}))),-1===i&&(i=0),i}},{key:"_getMessageListSize",value:function(e){return this._messageListHandler.getLocalMessageList(e).length}},{key:"_needGetHistory",value:function(e){var t=e.conversationID,n=e.remainingCount,r=e.count,o=this.getLocalConversation(t),i="";if(o&&o.groupProfile&&(i=o.groupProfile.type),At(t)||Et(i))return!1;var a=!1,s="".concat(this._n,"._needGetHistory conversationID:").concat(t);if(Dt(t)){var u=this._isPagingGetGroupListCompleted(),c=this._getLocalGroupCount(),l=this._hasLocalGroup(t),d=this._isTopicConversation(t);if(Ge.l("".concat(s," isGroupListCompleted:").concat(u," localGroupCount:").concat(c)+" isGroupInList:".concat(l," isTopic:").concat(d)),u&&c<=500&&!l&&!d)return a}return a=n<=r&&!this._completedMap.has(t),Ge.l("".concat(s," ret:").concat(a)),a}},{key:"_isTopicConversation",value:function(e){var t=e.replace(O.CONV_GROUP,"");return kt(t)}},{key:"getHistoryMessages",value:function(e){var t=e.conversationID,n=e.count;if(t===O.CONV_SYSTEM)return Bn();var r=15;n>20&&(r=20);var o=null;if(bt(t)){var i=this._roamingMessageKeyAndTimeMap.has(t);return(o=this.getModule(6))?o.getRoamingMessage({conversationID:t,peerAccount:t.replace(O.CONV_C2C,""),count:r,lastMessageTime:i?this._roamingMessageKeyAndTimeMap.get(t).lastMessageTime:0,messageKey:i?this._roamingMessageKeyAndTimeMap.get(t).messageKey:""}):jn({code:qn.CANNOT_FIND_MODULE})}if(Dt(t)){if(!(o=this.getModule(7)))return jn({code:qn.CANNOT_FIND_MODULE});var a=t.replace(O.CONV_GROUP,""),s=null;this._conversationMap.has(t)&&!kt(a)&&(s=this._conversationMap.get(t).lastMessage);var u=0;s&&(u=s.lastSequence);var c=this._roamingMessageSequenceMap.get(t);return o.getRoamingMessage({conversationID:t,groupID:a,count:r,sequence:c||u})}return Bn()}},{key:"patchConversationLastMessage",value:function(e){var t=this.getLocalConversation(e);if(t){var n=t.lastMessage,r=n.messageForShow,o=n.payload;if(Qt(r)||Qt(o)){var i=this._messageListHandler.getLocalMessageList(e);if(0===i.length)return;var a=i[i.length-1];Ge.l("".concat(this._n,".patchConversationLastMessage conversationID:").concat(e," payload:"),a.payload),t.updateLastMessage(a)}}}},{key:"onRoamingMessage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=n.startsWith(O.CONV_C2C)?O.CONV_C2C:O.CONV_GROUP,i=null,a=[],s=[],u=0,c=e.length,l=null,d=o===O.CONV_GROUP,f=this.getFileDownloadProxy(),p=function(){u=d?e.length-1:0,c=d?0:e.length},h=function(){d?--u:++u},g=function(){return d?u>=c:u<c};for(p();g();h())if(d&&1===e[u].sequence&&r&&this.setCompleted(n),1!==e[u].isPlaceMessage)if((i=new Tr(e[u])).to=e[u].to,o!==O.CONV_GROUP||at(e[u].topicID)||(i.to=e[u].topicID),i.isSystemMessage=!!e[u].isSystemMessage,i.conversationType=o,l=4===e[u].event?{type:O.MSG_GRP_TIP,content:t(t({},e[u].elements),{},{groupProfile:e[u].groupProfile})}:e[u].elements,d||i.setNickAndAvatar({nick:e[u].nick,avatar:e[u].avatar}),Qt(l)){var v=new ar("emptyMessageBody");v.setMessage("from:".concat(i.from," to:").concat(i.to," sequence:").concat(i.sequence," event:").concat(e[u].event)),v.setNetworkType(this.getNetworkType()).setLevel("warning").end()}else i.setElement(l,f),i.reInitialize(this.getMyUserID()),a.push(i);return p=h=g=null,r?(this._messageListHandler.unshift(a,s),a=null,s):(s=null,a)}},{key:"findMessage",value:function(e){return this._messageListHandler.findMessage(e)}},{key:"_isNotInCommunity",value:function(e){var t=!1;if(e.startsWith(O.CONV_GROUP)&&this._isTopicConversation(e)){var n=Vt(e.replace(O.CONV_GROUP,""));this.getModule(7).hasLocalGroup(n)||(t=!0)}return t}},{key:"deleteTopicRoamingMessageInfo",value:function(e){var t=this;Ct({groupID:e})&&this._messageListHandler.getTopicConversationIDList(e).forEach((function(e){t._completedMap.delete(e),t._roamingMessageSequenceMap.delete(e)}))}},{key:"deleteGroupRoamingMessageInfo",value:function(e){var t="".concat(O.CONV_GROUP).concat(e);this._completedMap.delete(t),this._roamingMessageSequenceMap.delete(t)}},{key:"setMessageRead",value:function(e){var t=e.conversationID,n=this.getLocalConversation(t);if(Ge.l("".concat(this._n,".setMessageRead conversationID:").concat(t," unreadCount:").concat(n?n.unreadCount:0)),!n)return Bn();if(n.type!==O.CONV_GROUP&&n.type!==O.CONV_TOPIC||Qt(n.groupAtInfoList)||this.deleteGroupAtTips(t),0===n.unreadCount)return Bn();if(n.type===O.CONV_GROUP&&!this._hasLocalGroup(t))return 0!==n.unreadCount&&(n.unreadCount=0,this.emitConversationUpdate(!0,!1)),Bn();var r=this._messageListHandler.getLocalLastMessage(t),o=n.lastMessage.lastTime;r&&o<r.time&&(o=r.time);var i=n.lastMessage.lastSequence;if(r&&i<r.sequence&&(i=r.sequence),n.type===O.CONV_TOPIC&&at(r)){var a=this.getModule(10),s=t.replace(O.CONV_GROUP,""),u=Vt(s),c=a.getLocalTopic(u,s);c&&(i=c.nextMessageSeq-1)}var l=null;switch(n.type){case O.CONV_C2C:return(l=this.getModule(6))?l.setMessageRead({conversationID:t,lastMessageTime:o}):jn({code:qn.CANNOT_FIND_MODULE});case O.CONV_GROUP:case O.CONV_TOPIC:return(l=this.getModule(7))?l.setMessageRead({conversationID:t,lastMessageSeq:i}):jn({code:qn.CANNOT_FIND_MODULE});case O.CONV_SYSTEM:return n.unreadCount=0,this.emitConversationUpdate(!0,!1),Bn();default:return Bn()}}},{key:"setAllMessageRead",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n="setAllMessageRead",r="".concat(this._n,".").concat(n);t.scope||(t.scope=O.READ_ALL_MSG),Ge.l("".concat(r," options:"),t);var o=this._createSetAllMessageReadPack(t);if(0===o.readAllC2CMessage&&0===o.groupMessageReadInfoList.length)return Bn();var i=new ar(n);return this.request({protocolName:Kn.SET_ALL_MESSAGE_READ,requestData:o}).then((function(n){var r=n.data,o=e._handleAllMessageRead(r);return i.setMessage("scope:".concat(t.scope," failureGroups:").concat(JSON.stringify(o))).setNetworkType(e.getNetworkType()).end(),Bn()})).catch((function(t){return e.probeNetwork().then((function(e){var n=M(e,2),r=n[0],o=n[1];i.setError(t,r,o).end()})),Ge.w("".concat(r," failed. error:"),t),jn({code:t&&t.code?t.code:qn.MSG_UNREAD_ALL_FAIL,message:t&&t.message?t.message:void 0})}))}},{key:"setConversationCustomData",value:function(e){return this._convGroupHandler.setConvCustomData(e)}},{key:"markConversation",value:function(e){return this._convGroupHandler.markConversation(e)}},{key:"getConversationGroupList",value:function(){return this._convGroupHandler.getLocalConvGroupList()}},{key:"createConversationGroup",value:function(e){return this._convGroupHandler.createConvGroup(e)}},{key:"deleteConversationGroup",value:function(e){return this._convGroupHandler.deleteConvGroup(e)}},{key:"renameConversationGroup",value:function(e){return this._convGroupHandler.renameConvGroup(e)}},{key:"addConversationsToGroup",value:function(e){return this._convGroupHandler.addConvsToGroup(e)}},{key:"deleteConversationsFromGroup",value:function(e){return this._convGroupHandler.deleteConvsFromGroup(e)}},{key:"onConversationMarkUpdated",value:function(e){this._convGroupHandler.onConvMarkUpdated(e)}},{key:"onConversationGroupCreated",value:function(e){this._convGroupHandler.onConvGroupCreated(e)}},{key:"onConversationGroupDeleted",value:function(e){this._convGroupHandler.onConvGroupDeleted(e)}},{key:"onConversationGroupNameUpdated",value:function(e){this._convGroupHandler.onConvGroupNameUpdated(e)}},{key:"onConversationInGroupUpdated",value:function(e){this._convGroupHandler.onConvInGroupUpdated(e)}},{key:"onConversationAddedToOrDeletedFromGroup",value:function(e){this._convGroupHandler.onConvAddedToOrDeletedFromGroup(e)}},{key:"_getConversationLastMessageSequence",value:function(e){var t=this._messageListHandler.getLocalLastMessage(e.conversationID),n=e.lastMessage.lastSequence;return t&&n<t.sequence&&(n=t.sequence),n}},{key:"_getConversationLastMessageTime",value:function(e){var t=this._messageListHandler.getLocalLastMessage(e.conversationID),n=e.lastMessage.lastTime;return t&&n<t.time&&(n=t.time),n}},{key:"_createSetAllMessageReadPack",value:function(e){var t,n={readAllC2CMessage:0,groupMessageReadInfoList:[]},r=e.scope,o=D(this._conversationMap);try{for(o.s();!(t=o.n()).done;){var i=M(t.value,2)[1];if(i.unreadCount>0)if(i.type===O.CONV_C2C&&0===n.readAllC2CMessage){if(r===O.READ_ALL_MSG)n.readAllC2CMessage=1;else if(r===O.READ_ALL_C2C_MSG){n.readAllC2CMessage=1;break}}else if(i.type===O.CONV_GROUP&&(r===O.READ_ALL_GROUP_MSG||r===O.READ_ALL_MSG)){var a=this._getConversationLastMessageSequence(i);n.groupMessageReadInfoList.push({groupID:i.groupProfile.groupID,messageSequence:a})}}}catch(d){o.e(d)}finally{o.f()}return n}},{key:"onPushedAllMessageRead",value:function(e){this._handleAllMessageRead(e)}},{key:"_handleAllMessageRead",value:function(e){var t=e.groupMessageReadInfoList,n=e.readAllC2CMessage,r=this._parseGroupReadInfo(t);return this._updateAllConversationUnreadCount({readAllC2CMessage:n})>=1&&(this.emitConversationUpdate(!0,!1),this.emitTotalUnreadMessageCountUpdate()),r}},{key:"_parseGroupReadInfo",value:function(e){var t=[];if(e&&e.length)for(var n=0,r=e.length;n<r;n++){var o=e[n],i=o.groupID,a=o.sequence,s=o.retCode,u=o.lastMessageSeq;at(s)?this._remoteGroupReadSequenceMap.set(i,u):(this._remoteGroupReadSequenceMap.set(i,a),0!==s&&t.push("".concat(i,"-").concat(a,"-").concat(s)))}return t}},{key:"_updateAllConversationUnreadCount",value:function(e){var t,n=e.readAllC2CMessage,r=0,o=D(this._conversationMap);try{for(o.s();!(t=o.n()).done;){var i=M(t.value,2),a=i[0],s=i[1];if(s.unreadCount>=1){if(1===n&&s.type===O.CONV_C2C){var u=this._getConversationLastMessageTime(s);this.updateIsReadAfterReadReport({conversationID:a,lastMessageTime:u})}else if(s.type===O.CONV_GROUP){var c=a.replace(O.CONV_GROUP,"");if(this._remoteGroupReadSequenceMap.has(c)){var l=this._remoteGroupReadSequenceMap.get(c),d=this._getConversationLastMessageSequence(s);this.updateIsReadAfterReadReport({conversationID:a,remoteReadSequence:l}),d>=l&&this._remoteGroupReadSequenceMap.delete(c)}}this.updateUnreadCount(a,!1)&&(r+=1)}}}catch(v){o.e(v)}finally{o.f()}return r}},{key:"isRemoteRead",value:function(e){var t=e.conversationID,n=e.sequence,r=t.replace(O.CONV_GROUP,""),o=!1;if(this._remoteGroupReadSequenceMap.has(r)){var i=this._remoteGroupReadSequenceMap.get(r);n<=i&&(o=!0,Ge.l("".concat(this._n,".isRemoteRead conversationID:").concat(t," messageSequence:").concat(n," remoteReadSequence:").concat(i))),n>=i+10&&this._remoteGroupReadSequenceMap.delete(r)}return o}},{key:"updateIsReadAfterReadReport",value:function(e){var t=e.conversationID,n=e.lastMessageSeq,r=e.lastMessageTime,o=this._messageListHandler.getLocalMessageList(t);if(0!==o.length)for(var i,a=o.length-1;a>=0;a--)if(i=o[a],!(r&&i.time>r||n&&i.sequence>n)){if("in"===i.flow&&i.isRead)break;i.setIsRead(!0)}}},{key:"updateUnreadCount",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!1,r=this.getLocalConversation(e),o=this._messageListHandler.getLocalMessageList(e);if(r){var i=r.unreadCount,a=o.filter((function(e){return!e.isRead&&!e._onlineOnlyFlag&&!e.isDeleted})).length;if(i!==a&&(r.unreadCount=a,n=!0,Ge.l("".concat(this._n,".updateUnreadCount from ").concat(i," to ").concat(a,", conversationID:").concat(e)),!0===t&&(this.emitConversationUpdate(!0,!1),this.emitTotalUnreadMessageCountUpdate())),n&&r.type===O.CONV_TOPIC){var s=r.unreadCount,u=this.getModule(10),c=e.replace(O.CONV_GROUP,"");u.onConversationProxy({topicID:c,unreadCount:s})}return n}}},{key:"clearGroupAtInfoList",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.getLocalConversation(e);if(n&&n.groupAtInfoList.length>0){if(n.clearGroupAtInfoList(),Ge.l("".concat(this._n,".clearGroupAtInfoList conversationID:").concat(e)),n.type===O.CONV_TOPIC){var r=n.groupAtInfoList,o=this.getModule(10),i=e.replace(O.CONV_GROUP,"");o.onConversationProxy({topicID:i,groupAtInfoList:r})}!0===t&&this.emitConversationUpdate(!0,!1)}}},{key:"updateReadReceiptInfo",value:function(e){var t=this,n=e.userID,r=void 0===n?void 0:n,o=e.groupID,i=void 0===o?void 0:o,a=e.readReceiptList;if(!Qt(a)){var s=[];if(at(r)){if(!at(i)){var u="".concat(O.CONV_GROUP).concat(i);a.forEach((function(e){var n=e.tinyID,r=e.clientTime,o=e.random,a=e.readCount,c=e.unreadCount,l="".concat(n,"-").concat(r,"-").concat(o),d=t._messageListHandler.getLocalMessage(u,l),f={groupID:i,messageID:l,readCount:0,unreadCount:0};d&&(et(a)&&(d.readReceiptInfo.readCount=a,f.readCount=a),et(c)&&(d.readReceiptInfo.unreadCount=c,f.unreadCount=c),s.push(f))}))}}else{var c="".concat(O.CONV_C2C).concat(r);a.forEach((function(e){var n=e.tinyID,o=e.clientTime,i=e.random,a="".concat(n,"-").concat(o,"-").concat(i),u=t._messageListHandler.getLocalMessage(c,a);if(u){u.readReceiptInfo.isPeerRead=!0;var l={userID:r,messageID:a,isPeerRead:!0};s.push(l)}}))}s.length>0&&this.emitOuterEvent(A.MESSAGE_READ_RECEIPT_RECEIVED,s)}}},{key:"updateIsRead",value:function(e){var t=this.getLocalConversation(e),n=this.getLocalMessageList(e);if(t&&0!==n.length&&!At(t.type)){for(var r=[],o=0,i=n.length;o<i;o++)"in"!==n[o].flow?"out"!==n[o].flow||n[o].isRead||n[o].setIsRead(!0):r.push(n[o]);var a=0;if(t.type===O.CONV_C2C){var s=r.slice(-t.unreadCount).filter((function(e){return e.isRevoked})).length;a=r.length-t.unreadCount-s}else a=r.length-t.unreadCount;for(var u=0;u<a&&!r[u].isRead;u++)r[u].setIsRead(!0)}}},{key:"deleteGroupAtTips",value:function(e){var t=this,n="".concat(this._n,".deleteGroupAtTips");Ge.l("".concat(n));var r=this._conversationMap.get(e);if(!r)return Promise.resolve();var o=r.groupAtInfoList;if(0===o.length)return Promise.resolve();var i=void 0;e.startsWith(O.CONV_GROUP)&&(i=e.replace(O.CONV_GROUP,""));var a=T(o);if((Ct({groupID:i})||kt(i))&&0===(a=o.filter((function(e){return!e.atTypeArray.includes(O.CONV_AT_ALL)}))).length)return this.clearGroupAtInfoList(e,!1),Promise.resolve();var s=this.getMyUserID();return this.request({protocolName:Kn.DELETE_GROUP_AT_TIPS,requestData:{messageListToDelete:a.map((function(e){return{from:e.from,to:s,messageSeq:e.__sequence,messageRandom:e.__random,groupID:at(e.topicID)?e.groupID:e.topicID}}))}}).then((function(){return Ge.l("".concat(n," ok. count:").concat(o.length)),t.clearGroupAtInfoList(e,!1),Promise.resolve()})).catch((function(e){return Ge.e("".concat(n," failed. error:"),e),jn(e)}))}},{key:"appendToMessageList",value:function(e){return this._messageListHandler.pushIn(e)}},{key:"setMessageRandom",value:function(e){this.singlyLinkedList.set(e.random)}},{key:"deleteMessageRandom",value:function(e){this.singlyLinkedList.delete(e.random)}},{key:"pushIntoMessageList",value:function(e,t,n){return!(!this._messageListHandler.pushIn(t,n)||this._isMessageFromCurrentInstance(t)&&!n)&&(e.push(t),!0)}},{key:"_isMessageFromCurrentInstance",value:function(e){return this.singlyLinkedList.has(e.random)}},{key:"revoke",value:function(e,t,n){return this._messageListHandler.revoke(e,t,n)}},{key:"getPeerReadTime",value:function(e){return this._peerReadTimeMap.get(e)}},{key:"recordPeerReadTime",value:function(e,t){this._peerReadTimeMap.has(e)?this._peerReadTimeMap.get(e)<t&&this._peerReadTimeMap.set(e,t):this._peerReadTimeMap.set(e,t)}},{key:"updateMessageIsPeerReadProperty",value:function(e,t){if(e.startsWith(O.CONV_C2C)&&t>0){var n=this._messageListHandler.updateMessageIsPeerReadProperty(e,t);if(n.length>0&&this.emitOuterEvent(A.MESSAGE_READ_BY_PEER,n),this._conversationMap.has(e)){var r=this._conversationMap.get(e).lastMessage;Qt(r)||r.fromAccount===this.getMyUserID()&&r.lastTime<=t&&!r.isPeerRead&&(r.isPeerRead=!0,this.emitConversationUpdate(!0,!1))}}}},{key:"updateMessageIsModifiedProperty",value:function(e){this._messageListHandler.updateMessageIsModifiedProperty(e)}},{key:"setCompleted",value:function(e){Ge.l("".concat(this._n,".setCompleted. conversationID:").concat(e)),this._completedMap.set(e,!0)}},{key:"updateRoamingMessageKeyAndTime",value:function(e,t,n){this._roamingMessageKeyAndTimeMap.set(e,{messageKey:t,lastMessageTime:n})}},{key:"updateRoamingMessageSequence",value:function(e,t){this._roamingMessageSequenceMap.set(e,t)}},{key:"getConversationList",value:function(e){var t=this,n="".concat(this._n,".").concat("getConversationList"),r="pagingStatus:".concat(this._pagingStatus,", local conversation count:").concat(this._conversationMap.size,", options:").concat(e);if(Ge.l("".concat(n,". ").concat(r)),this._pagingStatus===on.REJECTED){var o=new ar("getConversationList");return o.setMessage(r),this.syncConversationList().then((function(){o.setNetworkType(t.getNetworkType()).end();var n=t._getConversationList(e);return xn({conversationList:n,isSyncCompleted:t._isSyncCompleted()})})).catch((function(e){return t.probeNetwork().then((function(t){var n=M(t,2),r=n[0],i=n[1];o.setError(e,r,i).end()})),Ge.e("".concat(n," failed. error:"),e),jn(e)}))}var i=this._getConversationList(e);return Ge.l("".concat(n,". returned conversation count:").concat(i.length)),Bn({conversationList:i,isSyncCompleted:this._isSyncCompleted()})}},{key:"_getConversationList",value:function(e){if(at(e))return this.getLocalConversationList();if(it(e))return 0===e.length?[]:this.getLocalConversationList().filter((function(t){return e.includes(t.conversationID)}));if(ot(e)){var t=e.type,n=e.markType,r=e.groupName;return this.getLocalConversationList().filter((function(e){return(t!==O.CONV_C2C&&t!==O.CONV_GROUP||e.type===t)&&(!nt(r)||e.conversationGroupList.includes(r))&&(!et(n)||e.markList.includes(n))}))}return[]}},{key:"_handleC2CPeerReadTime",value:function(){var e,t=D(this._conversationMap);try{for(t.s();!(e=t.n()).done;){var n=M(e.value,2),r=n[0],o=n[1];o.type===O.CONV_C2C&&(Ge.d("".concat(this._n,"._handleC2CPeerReadTime conversationID:").concat(r," peerReadTime:").concat(o.peerReadTime)),this.recordPeerReadTime(r,o.peerReadTime))}}catch(c){t.e(c)}finally{t.f()}}},{key:"_isPagingGetGroupListCompleted",value:function(){var e=this.getModule(7);return!e||e.isPagingGetCompleted()}},{key:"_getLocalGroupCount",value:function(){var e=this.getModule(7);return e?e.getLocalGroupList().length:0}},{key:"_hasLocalGroup",value:function(e){var t=this.getModule(7);return!!t&&t.hasLocalGroup(e.replace(O.CONV_GROUP,""))}},{key:"getConversationProfile",value:function(e){var t,n=this;if((t=this._conversationMap.has(e)?this._conversationMap.get(e):new Pr({conversationID:e,type:e.slice(0,3)===O.CONV_C2C?O.CONV_C2C:O.CONV_GROUP},this.isIntl(),this.isUsingChatCore()))._isInfoCompleted||t.type===O.CONV_SYSTEM)return Bn({conversation:t});if(Dt(e)&&!this._hasLocalGroup(e))return Bn({conversation:t});var r="".concat(this._n,".").concat("getConversationProfile"),o=new ar("getConversationProfile");return Ge.l("".concat(r,". conversationID:").concat(e," remark:").concat(t.remark," lastMessage:"),t.lastMessage),this._updateUserOrGroupProfileCompletely(t).then((function(i){o.setNetworkType(n.getNetworkType()).setMessage("conversationID:".concat(e," unreadCount:").concat(i.data.conversation.unreadCount)).end();var a=n.getModule(8);if(a&&t.type===O.CONV_C2C){var s=e.replace(O.CONV_C2C,"");if(a.isMyFriend(s)){var u=a.getFriendRemark(s);t.remark!==u&&(t.remark=u,Ge.l("".concat(r,". conversationID:").concat(e," patch remark:").concat(t.remark)))}}return Ge.l("".concat(r," ok. conversationID:").concat(e)),i})).catch((function(t){return n.probeNetwork().then((function(n){var r=M(n,2),i=r[0],a=r[1];o.setError(t,i,a).setMessage("conversationID:".concat(e)).end()})),Ge.e("".concat(r," failed. error:"),t),jn(t)}))}},{key:"_updateUserOrGroupProfileCompletely",value:function(e){var t=this;return e.type===O.CONV_C2C?this.getModule(4).getUserProfile({userIDList:[e.toAccount]}).then((function(n){var r=n.data;return 0===r.length?jn(new Fn({code:qn.USER_OR_GRP_NOT_FOUND})):(e.userProfile=r[0],e._isInfoCompleted=!0,t._unshiftConversation(e),Bn({conversation:e}))})):this.getModule(7).getGroupProfile({groupID:e.toAccount}).then((function(n){return e.groupProfile=n.data.group,e._isInfoCompleted=!0,t._unshiftConversation(e),Bn({conversation:e})}))}},{key:"_unshiftConversation",value:function(e){e instanceof Pr&&!this._conversationMap.has(e.conversationID)&&(this._conversationMap=new Map([[e.conversationID,e]].concat(T(this._conversationMap))),this._setStorageConversationList(),this.emitConversationUpdate(!0,!1))}},{key:"_onProfileUpdated",value:function(e){var t=this;e.data.forEach((function(e){var n=e.userID;if(n===t.getMyUserID())t._onMyProfileModified({latestNick:e.nick,latestAvatar:e.avatar});else{var r=t._conversationMap.get("".concat(O.CONV_C2C).concat(n));r&&(r.userProfile=e)}}))}},{key:"_isSyncCompleted",value:function(){return this._pagingStatus===on.RESOLVED}},{key:"_errorLog",value:function(e,t,n,r){var o=new Error("Params validate failed."),i="".concat(this.getErrorMessage("API_REFER")).concat(e);throw Ge.w("[".concat(e,"] | ").concat(t," | ").concat(this.getErrorMessage(n,r),", ").concat(i)),Ge.e("[".concat(e,"] Invalid ").concat(t,": type check failed for ").concat(t,".")),o}},{key:"_isValidConversationID",value:function(e){return bt(e)||Dt(e)||At(e)}},{key:"deleteConversation",value:function(e){var t=this,n="deleteConversation";return nt(e)||rt(e)||this._errorLog(n,"options","StringOrObjectRequiredLog"),nt(e)?(this._isValidConversationID(e)||this._errorLog(n,"options","InvalidConversationID",e),Ge.l("".concat(this._n,".").concat(n," conversationID:").concat(e)),this.deleteConversationList({conversationIDList:[e],flag:1})):(it(e.conversationIDList)||this._errorLog(n,"conversationIDList","ArrayRequiredLog"),0===e.conversationIDList.length&&this._errorLog(n,"conversationIDList","NonEmptyArrayLog"),e.conversationIDList.forEach((function(e){t._isValidConversationID(e)||t._errorLog(n,"conversationIDList","InvalidConversationID",e)})),"clearHistoryMessage"in e&&"boolean"!=typeof e.clearHistoryMessage&&this._errorLog(n,"clearHistoryMessage","BooleanRequiredLog"),e.conversationIDList.length>100&&(e.conversationIDList=e.conversationIDList.slice(0,100)),this.deleteConversationList(e))}},{key:"deleteConversationList",value:function(e){var t=this,n=e.conversationIDList,r=void 0===n?[]:n,o=e.clearHistoryMessage,i=void 0===o||o,a=e.flag,s=void 0===a?0:a,u="".concat(this._n,".").concat("deleteConversationList");Ge.l("".concat(u," conversationIDList.length:").concat(r.length," clearHistoryMessage:").concat(i));var c=new ar("deleteConversationList");return c.setMessage("conversationIDList:".concat(r)),Promise.all([this.rmLocalOnlyConversationList(r),this.rmLocalAndRemoteConversationList(r,i)]).then((function(e){c.setNetworkType(t.getNetworkType()).end();var n=[].concat(T(e[0]),T(e[1]));return 0===n.length?jn(new Fn({code:qn.CONV_NOT_FOUND})):(Ge.l("".concat(u," ok")),Bn(1===s?{conversationID:n[0]}:{conversationIDList:n}))})).catch((function(e){return t.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];c.setError(e,r,o).end()})),Ge.e("".concat(u," failed. error:"),e),jn(e)}))}},{key:"rmLocalOnlyConversationList",value:function(e){var t=this;return e.filter((function(e){if(!t._conversationMap.has(e))return!1;var n=t.getLocalConversation(e).type;return n!==O.CONV_GROUP||t._hasLocalGroup(e)?n===O.CONV_SYSTEM&&(t.getModule(7).deleteGroupSystemNotice({messageList:t._messageListHandler.getLocalMessageList(e)}),t.deleteLocalConversation(e),!0):(t.deleteLocalConversation(e),!0)}))}},{key:"rmLocalAndRemoteConversationList",value:function(e,t){var n=this,r={fromAccount:this.getMyUserID(),conversationList:[],clearHistoryMessage:t?1:0};return e.forEach((function(e){if(n._conversationMap.has(e)){var t=n.getLocalConversation(e).type;t===O.CONV_C2C?r.conversationList.push({toAccount:e.replace(t,""),type:1}):t===O.CONV_GROUP&&n._hasLocalGroup(e)&&r.conversationList.push({toGroupID:e.replace(t,""),type:2})}})),0===r.conversationList.length?[]:this.request({protocolName:Kn.DELETE_CONVERSATION,requestData:r}).then((function(e){var t=[];return e.data.resultList.length>0&&e.data.resultList.map((function(e){if(0===e.code){var n=1===e.type?"".concat(O.CONV_C2C).concat(e.to):"".concat(O.CONV_GROUP).concat(e.groupID);t.push(n)}})),n.deleteLocalConversationList(t),t}))}},{key:"setConversationDraft",value:function(e){var t=e.conversationID,n=e.draftText,r="".concat(this._n,".").concat("setConversationDraft");if(Ge.l("".concat(r," conversationID:").concat(t," draftText:").concat(n)),!this._conversationMap.has(t))return jn({code:qn.CONV_NOT_FOUND});var o=this._conversationMap.get(t);return o.setDraftText(n),Bn({code:0,conversation:o})}},{key:"clearHistoryMessage",value:function(e){var t=this,n={fromAccount:this.getMyUserID(),toAccount:void 0,type:void 0,toGroupID:void 0};if(!this._conversationMap.has(e))return jn({code:qn.CONV_NOT_FOUND});var r=this._conversationMap.get(e).type;if(r===O.CONV_C2C)n.type=1,n.toAccount=e.replace(O.CONV_C2C,"");else{if(r!==O.CONV_GROUP)return r===O.CONV_SYSTEM?(this.getModule(7).deleteGroupSystemNotice({messageList:this._messageListHandler.getLocalMessageList(e)}),Bn({conversationID:e})):jn({code:qn.CONV_UN_RECORDED_TYPE});n.type=2,n.toGroupID=e.replace(O.CONV_GROUP,"")}var o="".concat(this._n,".").concat("clearHistoryMessage"),i=new ar("clearHistoryMessage");return i.setMessage("conversationID:".concat(e)),Ge.l("".concat(o,". conversationID:").concat(e)),this.setMessageRead({conversationID:e}).then((function(){return t.request({protocolName:Kn.CLEAR_HISTORY_MESSAGE,requestData:n})})).then((function(){i.setNetworkType(t.getNetworkType()).end(),Ge.l("".concat(o," ok")),t._messageListHandler.removeByConversationID(e),t.setCompleted(e);var n=t.getLocalConversation(e);return n&&(n.updateLastMessage(),t._sortConversationListAndEmitEvent()),Bn({conversationID:e})})).catch((function(e){return t.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];i.setError(e,r,o).end()})),Ge.e("".concat(o," failed. error:"),e),jn(e)}))}},{key:"pinConversation",value:function(e){var t=this,n=e.conversationID,r=e.isPinned;if(!this._conversationMap.has(n))return jn({code:qn.CONV_NOT_FOUND});var o=this.getLocalConversation(n);if(o.isPinned===r)return Bn({conversationID:n});var i="".concat(this._n,".").concat("pinConversation"),a=new ar("pinConversation");a.setMessage("conversationID:".concat(n," isPinned:").concat(r)),Ge.l("".concat(i,". conversationID:").concat(n," isPinned:").concat(r));var s=null;return bt(n)?s={type:1,toAccount:n.replace(O.CONV_C2C,"")}:Dt(n)&&(s={type:2,groupID:n.replace(O.CONV_GROUP,"")}),this.request({protocolName:Kn.PIN_CONVERSATION,requestData:{fromAccount:this.getMyUserID(),operationType:!0===r?1:2,itemList:[s]}}).then((function(){return a.setNetworkType(t.getNetworkType()).end(),Ge.l("".concat(i," ok")),o.isPinned!==r&&(o.isPinned=r,t._sortConversationListAndEmitEvent()),xn({conversationID:n})})).catch((function(e){return t.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];a.setError(e,r,o).end()})),Ge.e("".concat(i," failed. error:"),e),jn(e)}))}},{key:"setMessageRemindType",value:function(e){return this._messageRemindHandler.set(e)}},{key:"patchMessageRemindType",value:function(e){var t=e.ID,n=e.isC2CConversation,r=e.messageRemindType,o=!1,i=this.getLocalConversation(n?"".concat(O.CONV_C2C).concat(t):"".concat(O.CONV_GROUP).concat(t));return i&&i.messageRemindType!==r&&(i.messageRemindType=r,o=!0),Ge.d("".concat(this._n,".patchMessageRemindType options:"),e,"ret:".concat(o)),o}},{key:"onC2CMessageRemindTypeFetched",value:function(e){var t=this;if(it(e)&&e.length>0){var n=0;e.forEach((function(e){var r=e.userID,o=e.muteFlag,i=t._transMessageRemindType(o);!0===t.patchMessageRemindType({ID:r,isC2CConversation:!0,messageRemindType:i})&&(n+=1)})),Ge.l("".concat(this._n,".onC2CMessageRemindTypeFetched updateCount:").concat(n)),n>=1&&this.emitConversationUpdate(!0,!1)}}},{key:"onC2CMessageRemindTypeSynced",value:function(e){var t=this,n="".concat(this._n,".onC2CMessageRemindTypeSynced");Ge.d(n,e),e.dataList.forEach((function(e){if(!Qt(e.muteNotificationsSync)){var r=e.muteNotificationsSync,o=r.to,i=r.muteFlag,a=t._transMessageRemindType(i),s=0;t.patchMessageRemindType({ID:o,isC2CConversation:!0,messageRemindType:a})&&(s+=1),Ge.l("".concat(n," updateCount:").concat(s)),s>=1&&t.emitConversationUpdate(!0,!1)}}))}},{key:"onGroupMessageRemindTypeUpdated",value:function(e){Ge.d("".concat(this._n,".onGroupMessageRemindTypeUpdated options:"),e),this._messageRemindHandler.onGroupMessageRemindTypeUpdated(e)}},{key:"deleteLocalConversation",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this._conversationMap.has(e);if(Ge.d("".concat(this._n,".deleteLocalConversation conversationID:").concat(e," has:").concat(n)),n&&(this._conversationMap.delete(e),this._roamingMessageKeyAndTimeMap.has(e)&&this._roamingMessageKeyAndTimeMap.delete(e),this._roamingMessageSequenceMap.has(e)&&this._roamingMessageSequenceMap.delete(e),this._setStorageConversationList(),this._messageListHandler.removeByConversationID(e),this._completedMap.delete(e),t)){var r=!this._isTopicConversation(e);this.emitConversationUpdate(r,!1)}}},{key:"deleteLocalConversationList",value:function(e){var t=this,n=0,r=!1;e.forEach((function(e){t._conversationMap.has(e)&&(n+=t._conversationMap.get(e).unreadCount||0,t.deleteLocalConversation(e,!1),r=!0)})),Ge.l("".concat(this._n,".deleteLocalConversationList conversationIDList.length:").concat(e.length," isConvIDExisted:").concat(r)),r&&(this.emitConversationUpdate(!0,!1),n>0&&this.emitTotalUnreadMessageCountUpdate())}},{key:"isMessageSentByCurrentInstance",value:function(e){return!(!this._messageListHandler.hasLocalMessage(e.conversationID,e.ID)&&!this.singlyLinkedList.has(e.random))}},{key:"modifyMessageList",value:function(e){if(e.startsWith(O.CONV_C2C)&&this._conversationMap.has(e)){var t=this._conversationMap.get(e),n=Date.now();this._messageListHandler.modifyMessageSentByPeer({conversationID:e,latestNick:t.userProfile.nick,latestAvatar:t.userProfile.avatar});var r=this.getModule(4).getNickAndAvatarByUserID(this.getMyUserID());this._messageListHandler.modifyMessageSentByMe({conversationID:e,latestNick:r.nick,latestAvatar:r.avatar}),Ge.l("".concat(this._n,".modifyMessageList conversationID:").concat(e," cost:").concat(Xt(n)))}}},{key:"updateUserProfileSpecifiedKey",value:function(e){Ge.l("".concat(this._n,".updateUserProfileSpecifiedKey options:"),e);var t=e.conversationID,n=e.nick,r=e.avatar;if(this._conversationMap.has(t)){var o=this._conversationMap.get(t).userProfile;nt(n)&&o.nick!==n&&(o.nick=n),nt(r)&&o.avatar!==r&&(o.avatar=r),this.emitConversationUpdate(!0,!1)}}},{key:"_onMyProfileModified",value:function(e){var n=this,r=this.getLocalConversationList(),o=Date.now();r.forEach((function(r){n.modifyMessageSentByMe(t({conversationID:r.conversationID},e))})),Ge.l("".concat(this._n,"._onMyProfileModified. modify all messages sent by me, cost:").concat(Xt(o)))}},{key:"modifyMessageSentByMe",value:function(e){this._messageListHandler.modifyMessageSentByMe(e)}},{key:"getLatestMessageSentByMe",value:function(e){return this._messageListHandler.getLatestMessageSentByMe(e)}},{key:"modifyMessageSentByPeer",value:function(e){this._messageListHandler.modifyMessageSentByPeer(e)}},{key:"getLatestMessageSentByPeer",value:function(e){return this._messageListHandler.getLatestMessageSentByPeer(e)}},{key:"pushIntoNoticeResult",value:function(e,t){return!(!this._messageListHandler.pushIn(t)||this.singlyLinkedList.has(t.random))&&(e.push(t),!0)}},{key:"getLocalLastMessage",value:function(e){return this._messageListHandler.getLocalLastMessage(e)}},{key:"checkAndPatchRemark",value:function(){var e=this.getModule(8);if(0!==this._conversationMap.size&&e){var t=T(this._conversationMap.values()).filter((function(e){return e.type===O.CONV_C2C}));if(0!==t.length){var n=0;t.forEach((function(t){var r=t.conversationID.replace(O.CONV_C2C,"");if(e.isMyFriend(r)){var o=e.getFriendRemark(r);t.remark!==o&&(t.remark=o,n+=1)}})),Ge.l("".concat(this._n,".checkAndPatchRemark. c2c conversation count:").concat(t.length,", patched count:").concat(n))}}}},{key:"updateTopicConversation",value:function(e){this._updateLocalConversationList({conversationOptionsList:e,isFromGetConversations:!0,updateUnreadCount:!0})}},{key:"sendReadReceipt",value:function(e){var t=e[0],n=null;return t.conversationType===O.CONV_C2C?n=this._m.getModule(6):t.conversationType===O.CONV_GROUP&&(n=this._m.getModule(7)),n?n.sendReadReceipt(e):jn({code:qn.CANNOT_FIND_MODULE})}},{key:"getReadReceiptList",value:function(e){var t=e[0],n=null;return t.conversationType===O.CONV_C2C?n=this._m.getModule(6):t.conversationType===O.CONV_GROUP&&(n=this._m.getModule(7)),n?n.getReadReceiptList(e):jn({code:qn.CANNOT_FIND_MODULE})}},{key:"getLastMessageTime",value:function(e){var t=this.getLocalConversation(e);return t?t.lastMessage.lastTime:0}},{key:"getTotalUnreadMessageCount",value:function(){var e=this.getLocalConversationList(),t=0;return e.forEach((function(e){e.type!==O.CONV_SYSTEM&&(""!==e.messageRemindType&&e.messageRemindType!==O.MSG_REMIND_ACPT_AND_NOTE||(t+=e.unreadCount))})),t}},{key:"emitTotalUnreadMessageCountUpdate",value:function(){var e=this.getTotalUnreadMessageCount();this._convTotalUnreadCount!==e&&(Ge.l("".concat(this._n,".emitTotalUnreadMessageCountUpdate from ").concat(this._convTotalUnreadCount," to ").concat(e)),this._convTotalUnreadCount=e,this.emitOuterEvent(A.TOTAL_UNREAD_MESSAGE_COUNT_UPDATED))}},{key:"reset",value:function(){Ge.l("".concat(this._n,".reset")),this._setStorageConversationList(!0),this._pagingStatus=on.NOT_START,this._messageListHandler.reset(),this._messageRemindHandler.reset(),this._roamingMessageKeyAndTimeMap.clear(),this._roamingMessageSequenceMap.clear(),this.singlyLinkedList.reset(),this._peerReadTimeMap.clear(),this._completedMap.clear(),this._conversationMap.clear(),this._pagingTimeStamp=0,this._pagingStartIndex=0,this._pagingPinnedTimeStamp=0,this._pagingPinnedStartIndex=0,this._remoteGroupReadSequenceMap.clear(),this._convTotalUnreadCount=0,this._pagingGetCostList.length=0,this._pagingConvIDMap.clear(),this._convIDFromUnreadDBMap.clear(),this._pagingGetCostList.length=0,this.resetReady()}}]),r}(Hn),Fr=function(){function e(t){a(this,e),this._groupModule=t,this._n="GroupTipsHandler",this._cachedGroupTipsMap=new Map,this._checkCountMap=new Map,this.MAX_CHECK_COUNT=4,this._getTopicPendingMap=new Map}return c(e,[{key:"onCheckTimer",value:function(e){e%1==0&&this._cachedGroupTipsMap.size>0&&this._checkCachedGroupTips()}},{key:"_checkCachedGroupTips",value:function(){var e=this;this._cachedGroupTipsMap.forEach((function(t,n){var r=e._checkCountMap.get(n),o=e._groupModule.hasLocalGroup(n);Ge.l("".concat(e._n,"._checkCachedGroupTips groupID:").concat(n," hasLocalGroup:").concat(o," checkCount:").concat(r)),o?(e._notifyCachedGroupTips(n),e._checkCountMap.delete(n),e._groupModule.deleteUnjoinedAVChatRoom(n)):r>=e.MAX_CHECK_COUNT?(e._deleteCachedGroupTips(n),e._checkCountMap.delete(n)):(r++,e._checkCountMap.set(n,r))}))}},{key:"onNewGroupTips",value:function(e){Ge.d("".concat(this._n,".onReceiveGroupTips count:").concat(e.dataList.length));var t=this.newGroupTipsStoredAndSummary(e),n=t.eventDataList,r=t.result,o=t.AVChatRoomMessageList;o.length>0&&this._groupModule.onAVChatRoomMessage(o),n.length>0&&(this._groupModule.updateNextMessageSeq(n),this._groupModule.getModule(11).onNewMessage({conversationOptionsList:n,isInstantMessage:!0})),r.length>0&&(this._groupModule.emitOuterEvent(A.MESSAGE_RECEIVED,r),this.handleMessageList(r))}},{key:"newGroupTipsStoredAndSummary",value:function(e){for(var n=this,r=e.event,o=e.dataList,i=null,a=[],s=[],u={},c=[],l=function(e,l){var d=Tt(o[e]);if(6===r){if(n._groupModule.isGroupAttributesUpdatedNotice(d))return"continue";if(n._groupModule.isGroupCountersNotice(d))return"continue"}var f=d.groupProfile,p=f.groupID,h=f.communityType,g=void 0===h?0:h,v=f.topicID,_=void 0===v?void 0:v,m=f.invisible,y=void 0,I=n._groupModule.isMessageFromTopic(g,_);if(I){y=O.CONV_TOPIC,d.to=_;var M=n._groupModule.getModule(10);M.hasLocalTopic(p,_)||n._getTopicPendingMap.has(_)||(n._getTopicPendingMap.set(_,1),M.getTopicList({groupID:p,topicIDList:[_]}).finally((function(){n._getTopicPendingMap.delete(_)})))}var T=n._groupModule.hasLocalGroup(p);if(!T&&n._groupModule.isUnjoinedAVChatRoom(p))return"continue";if(!T&&!I)return n._cacheGroupTipsAndProbe({groupID:p,event:r,item:d}),"continue";if(n._groupModule.isMessageFromOrToAVChatroom(p))return d.event=r,c.push(d),"continue";if(d.currentUser=n._groupModule.getMyUserID(),d.conversationType=O.CONV_GROUP,(i=new Tr(d)).setElement({type:O.MSG_GRP_TIP,content:t(t({},d.elements),{},{groupProfile:d.groupProfile})}),i.isSystemMessage=!1,1===m)return n._qualityStat(i),"continue";var S=n._groupModule.getModule(11),E=i,C=E.conversationID,k=E.sequence;if(6===r)i._onlineOnlyFlag=!0,s.push(i);else if(!S.pushIntoNoticeResult(s,i))return"continue";if(n._groupModule.isMessageFromCommunityOfTopic(g,_))return"continue";if(6===r&&S.getLocalConversation(C))return"continue";6!==r&&n._qualityStat(i);var b=S.isRemoteRead({conversationID:C,sequence:k});if(at(u[C])){var D=0;"in"===i.flow&&(i._isExcludedFromUnreadCount||i._onlineOnlyFlag||b||(D=1)),u[C]=a.push({conversationID:C,unreadCount:D,type:at(y)?i.conversationType:y,subType:i.conversationSubType,lastMessage:i._isExcludedFromLastMessage?"":i})-1}else{var A=u[C];a[A].type=i.conversationType,a[A].subType=i.conversationSubType,a[A].lastMessage=i._isExcludedFromLastMessage?"":i,"in"===i.flow&&(i._isExcludedFromUnreadCount||i._onlineOnlyFlag||b||a[A].unreadCount++)}},d=0,f=o.length;d<f;d++)l(d);return{eventDataList:a,result:s,AVChatRoomMessageList:c}}},{key:"_qualityStat",value:function(e){this._groupModule.getModule(26).addMessageSequence({key:Qn,message:e})}},{key:"handleMessageList",value:function(e){var t=this;e.forEach((function(e){switch(e.payload.operationType){case 1:t._onNewMemberComeIn(e);break;case 2:t._onMemberQuit(e);break;case 3:t._onMemberKickedOut(e);break;case 4:t._onMemberSetAdmin(e);break;case 5:t._onMemberCancelledAdmin(e);break;case 6:t._onGroupProfileModified(e);break;case 7:t._onMemberInfoModified(e);break;case 8:t._onTopicProfileUpdated(e);break;default:Ge.w("".concat(t._n,".handleMessageList unknown operationType:").concat(e.payload.operationType))}}))}},{key:"_onNewMemberComeIn",value:function(e){var t=e.payload,n=t.memberNum,r=t.groupProfile.groupID,o=this._groupModule.getLocalGroupProfile(r);o&&et(n)&&o.memberCount!==n&&(o.memberCount=n,this._updateConversationGroupProfile(o))}},{key:"_onMemberQuit",value:function(e){var t=e.payload,n=t.memberNum,r=t.groupProfile.groupID,o=this._groupModule.getLocalGroupProfile(r);o&&et(n)&&o.memberCount!==n&&(o.memberCount=n,this._updateConversationGroupProfile(o)),this._groupModule.getGroupMemberHandler().deleteLocalGroupMembers(r,e.payload.userIDList)}},{key:"_onMemberKickedOut",value:function(e){var t=e.payload,n=t.memberNum,r=t.groupProfile.groupID,o=this._groupModule.getLocalGroupProfile(r);o&&et(n)&&o.memberCount!==n&&(o.memberCount=n,this._updateConversationGroupProfile(o)),this._groupModule.getGroupMemberHandler().deleteLocalGroupMembers(r,e.payload.userIDList)}},{key:"_updateConversationGroupProfile",value:function(e){this._groupModule.getModule(11).updateConversationGroupProfile([e])}},{key:"_onMemberSetAdmin",value:function(e){var t=e.payload.groupProfile.groupID,n=e.payload.userIDList,r=this._groupModule.getGroupMemberHandler();n.forEach((function(e){var n=r.getLocalGroupMemberInfo(t,e);n&&n.updateRole(O.GRP_MBR_ROLE_ADMIN)}))}},{key:"_onMemberCancelledAdmin",value:function(e){var t=e.payload.groupProfile.groupID,n=e.payload.userIDList,r=this._groupModule.getGroupMemberHandler();n.forEach((function(e){var n=r.getLocalGroupMemberInfo(t,e);n&&n.updateRole(O.GRP_MBR_ROLE_MEMBER)}))}},{key:"_onGroupProfileModified",value:function(e){var t=this,n=e.payload,r=n.newGroupProfile,o=n.groupProfile.groupID,i=this._groupModule.getLocalGroupProfile(o);Object.keys(r).forEach((function(e){switch(e){case"ownerID":t._ownerChanged(i,r);break;case"groupName":i.name=r[e];break;default:i[e]=r[e]}}));var a=!i.isSupportTopic;this._groupModule.emitGroupListUpdate(!0,a)}},{key:"_ownerChanged",value:function(e,t){var n=e.groupID,r=this._groupModule.getLocalGroupProfile(n),o=this._groupModule.getMyUserID();if(o===t.ownerID){r.updateGroup({selfInfo:{role:O.GRP_MBR_ROLE_OWNER}});var i=this._groupModule.getGroupMemberHandler(),a=i.getLocalGroupMemberInfo(n,o),s=this._groupModule.getLocalGroupProfile(n).ownerID,u=i.getLocalGroupMemberInfo(n,s);a&&a.updateRole(O.GRP_MBR_ROLE_OWNER),u&&u.updateRole(O.GRP_MBR_ROLE_MEMBER)}}},{key:"_onMemberInfoModified",value:function(e){var t=e.to,n=e.payload,r=n.groupProfile,o=n.memberList,i=r.groupID;kt(t)&&this._updateTopicMuteTime(e);var a=this._groupModule.getGroupMemberHandler();o.forEach((function(e){var t=a.getLocalGroupMemberInfo(i,e.userID);t&&et(e.muteTime)&&t.updateMuteUntil(e.muteTime)}))}},{key:"_updateTopicMuteTime",value:function(e){var t=e.to,n=e.payload,r=n.groupProfile,o=n.memberList,i=void 0===o?[]:o,a=this._groupModule.getModule(10),s=r.groupID,u=a.getLocalTopic(s,t);if(u){for(var c=!1,l=0;l<i.length;l++){var d=i[l];if(d.userID===this._groupModule.getMyUserID()&&d.muteTime>=0){u.updateSelfInfo({muteTime:d.muteTime}),c=!0;break}}c&&this._groupModule.emitOuterEvent(A.TOPIC_UPDATED,{groupID:s,topic:u})}}},{key:"_onTopicProfileUpdated",value:function(e){var n=e.payload,r=n.groupProfile.groupID,o=n.newTopicInfo;this._groupModule.getModule(10).onTopicProfileUpdated(t({groupID:r,topicID:e.to},o))}},{key:"_cacheGroupTips",value:function(e,t){this._cachedGroupTipsMap.has(e)||this._cachedGroupTipsMap.set(e,[]),this._cachedGroupTipsMap.get(e).push(t)}},{key:"_deleteCachedGroupTips",value:function(e){this._cachedGroupTipsMap.has(e)&&this._cachedGroupTipsMap.delete(e)}},{key:"_notifyCachedGroupTips",value:function(e){var t=this,n=this._cachedGroupTipsMap.get(e)||[];n.forEach((function(e){t.onNewGroupTips(e)})),this._deleteCachedGroupTips(e),Ge.l("".concat(this._n,"._notifyCachedGroupTips groupID:").concat(e," count:").concat(n.length))}},{key:"_cacheGroupTipsAndProbe",value:function(e){var t=this,n=e.groupID,r=e.event,o=e.item;this._cacheGroupTips(n,{event:r,dataList:[o]}),this._groupModule.getGroupSimplifiedInfo(n).then((function(e){e.type===O.GRP_AVCHATROOM?t._groupModule.hasLocalGroup(n)?t._notifyCachedGroupTips(n):t._groupModule.setUnjoinedAVChatRoom(n):(t._groupModule.updateGroupMap([e]),t._notifyCachedGroupTips(n))})),this._checkCountMap.has(n)||this._checkCountMap.set(n,0),Ge.l("".concat(this._n,"._cacheGroupTipsAndProbe groupID:").concat(n))}},{key:"reset",value:function(){this._cachedGroupTipsMap.clear(),this._checkCountMap.clear(),this._getTopicPendingMap.clear()}}]),e}(),qr=function(){function e(t){a(this,e),this._groupModule=t,this._n="CommonGroupHandler",this.tempConversationList=null,this._cachedGroupMessageMap=new Map,this._checkCountMap=new Map,this.MAX_CHECK_COUNT=4,this.PAGING_GRP_COUNT_LIMIT=200,this._getTopicPendingMap=new Map,this._pagingStatus=on.NOT_START,this._pagingGetCostList=[],t.getInnerEmitterInstance().on(Cr.A2KEY_AND_TINYID_UPDATED,this.syncGroupList,this)}return c(e,[{key:"onCheckTimer",value:function(e){e%1==0&&this._cachedGroupMessageMap.size>0&&this._checkCachedGroupMessage()}},{key:"_checkCachedGroupMessage",value:function(){var e=this;this._cachedGroupMessageMap.forEach((function(t,n){var r=e._checkCountMap.get(n),o=e._groupModule.hasLocalGroup(n);Ge.l("".concat(e._n,"._checkCachedGroupMessage groupID:").concat(n," hasLocalGroup:").concat(o," checkCount:").concat(r)),o?(e._notifyCachedGroupMessage(n),e._checkCountMap.delete(n),e._groupModule.deleteUnjoinedAVChatRoom(n)):r>=e.MAX_CHECK_COUNT?(e._deleteCachedGroupMessage(n),e._checkCountMap.delete(n)):(r++,e._checkCountMap.set(n,r))}))}},{key:"handleUpdateGroupLastMessage",value:function(e){var n="".concat(this._n,".handleUpdateGroupLastMessage");if(0!==this._groupModule.getGroupMap().size){for(var r,o,i,a,s,u=!1,c=0,l=e.length;c<l;c++)(r=e[c]).type===O.CONV_GROUP&&0!==r.lastMessage.lastSequence&&null!==r.lastMessage.payload&&(o=r.conversationID.split(/^GROUP/)[1],(i=this._groupModule.getLocalGroupProfile(o))&&(a=i.lastMessage,s=r.lastMessage,JSON.stringify(a)!==JSON.stringify(s)&&(i.lastMessage=t({},r.lastMessage),u=!0)));Ge.l("".concat(n," conversation count:").concat(e.length,", local group count:").concat(this._groupModule.getLocalGroupList().length," isGroupListUpdated:").concat(u)),u&&(this._groupModule.sortLocalGroupList(),this._groupModule.emitGroupListUpdate(!0,!1))}else this.tempConversationList=e}},{key:"onNewGroupMessage",value:function(e){Ge.d("".concat(this._n,".onNewGroupMessage count:").concat(e.dataList.length));var t=this._newGroupMessageStoredAndSummary(e),n=t.conversationOptionsList,r=t.messageList,o=t.AVChatRoomMessageList;o.length>0&&this._groupModule.onAVChatRoomMessage(o),this._groupModule.filterModifiedMessage(r),n.length>0&&(this._groupModule.updateNextMessageSeq(n),this._groupModule.getModule(11).onNewMessage({conversationOptionsList:n,isInstantMessage:e.isInstantMessage||!0,updateUnreadCount:e.updateUnreadCount||!0}));var i=this._groupModule.filterUnmodifiedMessage(r);i.length>0&&this._groupModule.emitOuterEvent(A.MESSAGE_RECEIVED,i),r.length=0}},{key:"_newGroupMessageStoredAndSummary",value:function(e){var t=this,n=e.dataList,r=e.event,o=e.isInstantMessage,i=null,a=[],s=[],u=[],c={},l=this._groupModule.getFileDownloadProxy(),d=n.length;d>1&&n.sort((function(e,t){return e.sequence-t.sequence}));for(var f=this._groupModule.getModule(11),p=this._groupModule.getModule(4),h=function(e){var d=Tt(n[e]),h=d.groupProfile,g=h.groupID,v=h.communityType,_=void 0===v?0:v,m=h.topicID,y=void 0===m?void 0:m,I=h.invisible,M=void 0,T=t._groupModule.isMessageFromTopic(_,y);if(T){M=O.CONV_TOPIC,d.to=y;var S=t._groupModule.getModule(10);S.hasLocalTopic(g,y)||t._getTopicPendingMap.has(y)||(t._getTopicPendingMap.set(y,1),S.getTopicList({groupID:g,topicIDList:[y]}).finally((function(){t._getTopicPendingMap.delete(y)})))}var E=t._groupModule.hasLocalGroup(g);if(!E&&t._groupModule.isUnjoinedAVChatRoom(g))return"continue";if(!E&&!T)return t._cacheGroupMessageAndProbe({groupID:g,event:r,item:d}),"continue";if(t._groupModule.isMessageFromOrToAVChatroom(g))return d.event=r,u.push(d),"continue";if(d.currentUser=t._groupModule.getMyUserID(),d.conversationType=O.CONV_GROUP,d.isSystemMessage=!!d.isSystemMessage,(i=new Tr(d)).setElement(d.elements,l),1===I)return t._qualityStat(o,i),"continue";var C=1===n[e].isModified;if(f.isMessageSentByCurrentInstance(i)?i.isModified=C:C=!1,1===d.onlineOnlyFlag)i._onlineOnlyFlag=!0,f.isMessageSentByCurrentInstance(i)||s.push(i);else{if(t._groupModule.isMessageFromCommunityOfTopic(_,y))return s.push(i),"continue";if(i.from===t._groupModule.getMyUserID()){var k=f.getLatestMessageSentByMe(i.conversationID);if(k){var b=k.nick,D=k.avatar;b===i.nick&&D===i.avatar||(f.modifyMessageSentByMe({conversationID:R,latestNick:i.nick,latestAvatar:i.avatar}),p.mockOnNickAvatarModified(i.nick,i.avatar))}}if(!f.pushIntoMessageList(s,i,C))return"continue";t._qualityStat(o,i);var A=i,R=A.conversationID,N=A.sequence,w=f.isRemoteRead({conversationID:R,sequence:N});if(at(c[R])){var L=0;"in"===i.flow&&(i._isExcludedFromUnreadCount||w||(L=1)),c[R]=a.push({conversationID:R,unreadCount:L,type:at(M)?i.conversationType:M,subType:i.conversationSubType,lastMessage:i._isExcludedFromLastMessage?"":i})-1}else{var P=c[R];a[P].type=at(M)?i.conversationType:M,a[P].subType=i.conversationSubType,a[P].lastMessage=i._isExcludedFromLastMessage?"":i,"in"===i.flow&&(i._isExcludedFromUnreadCount||w||a[P].unreadCount++)}}},g=0;g<d;g++)h(g);return{conversationOptionsList:a,messageList:s,AVChatRoomMessageList:u}}},{key:"_qualityStat",value:function(e,t){var n=this._groupModule.getModule(26);n.addMessageSequence({key:Qn,message:t}),e&&t.clientTime>0&&n.addMessageDelay(t.clientTime)}},{key:"onGroupMessageRevoked",value:function(e){var t=this,n=this._groupModule.getModule(11),r=[];e.dataList.forEach((function(e){var t=e.elements.revokedInfos,o=e.revokerInfo;at(t)||t.forEach((function(e){var t,i=Qt(e.topicID)?"GROUP".concat(e.groupID):"GROUP".concat(e.topicID),a=n.getLocalConversation(i),s=e.revokerInfo&&e.revokerInfo.revoker||o&&o.revoker,u=o&&o.reason||"";if(Et(a.type))t={conversationID:i,sequence:e.sequence,ID:"".concat(e.tinyID,"-").concat(e.clientTime,"-").concat(e.random)};else{var c=n.revoke(i,e.sequence,e.random);c?t=c:(t={conversationID:i,sequence:e.sequence},e.tinyID&&e.clientTime&&e.random&&(t.ID="".concat(e.tinyID,"-").concat(e.clientTime,"-").concat(e.random)),e.time&&(t.time=e.time))}t&&(t.revoker=s,t.revokeReason=u,t.revokerInfo={userID:s,nick:"",avatar:""},r.push(t))}))})),0!==r.length&&(n.onMessageRevoked(r),n.updateRevokerInfo(r).then((function(e){t._groupModule.emitOuterEvent(A.MESSAGE_REVOKED,e)})))}},{key:"_groupListTreeShaking",value:function(e){for(var t=new Map(T(this._groupModule.getGroupMap())),n=0,r=e.length;n<r;n++)t.delete(e[n].groupID);this._groupModule.hasJoinedAVChatRoom()&&this._groupModule.getJoinedAVChatRoom().forEach((function(e){t.delete(e)})),this._groupModule.getGroupMap().forEach((function(e,n){e.isSupportTopic&&t.delete(n)}));for(var o=T(t.keys()),i=0,a=o.length;i<a;i++)this._groupModule.deleteGroup(o[i])}},{key:"syncGroupList",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._pagingStatus===on.NOT_START&&this._groupModule.clearGroupMap();var n=["Type","Name","FaceUrl","NextMsgSeq","LastMsgTime","AtInfoList","LastRecallTime"],r=this.PAGING_GRP_COUNT_LIMIT,o=0,i=[];if(!0===t)return this._pagingGetGroupListWithTopic({limit:r,offset:o,groupBaseInfoFilter:n,groupList:i});var a="syncGroupList",s="".concat(this._n,".").concat(a),u=new ar(a);return this._pagingGetGroupList({limit:r,offset:o,groupBaseInfoFilter:n,groupList:i}).then((function(){var t=Jt(e._pagingGetCostList),n=zt(e._pagingGetCostList);e._pagingGetCostList.length=0,e._pagingStatus=on.RESOLVED,e._groupListTreeShaking(i),e._groupModule.updateGroupMap(i);var r=e._groupModule.getLocalGroupList().length,o="count:".concat(r," sum:").concat(n," avg:").concat(t);return Ge.l("".concat(s," ok. ").concat(o)),u.setNetworkType(e._groupModule.getNetworkType()).setMessage(o).end(),e.tempConversationList&&(e.handleUpdateGroupLastMessage(e.tempConversationList),e.tempConversationList=null),e._groupModule.emitGroupListUpdate(!0,!0),xn({groupList:e._groupModule.getLocalGroupList()})})).catch((function(t){return e._pagingStatus=on.REJECTED,e._groupModule.probeNetwork().then((function(e){var n=M(e,2),r=n[0],o=n[1];u.setError(t,r,o).end()})),Ge.e("".concat(s," failed. error:"),t),jn(t)}))}},{key:"getGroupList",value:function(){var e=this,t="".concat(this._n,".").concat("getGroupList");if(Ge.l("".concat(t," pagingStatus:").concat(this._pagingStatus)),this._pagingStatus===on.REJECTED||this._pagingStatus===on.NOT_START)return this.syncGroupList().then((function(){var t=e._groupModule.getLocalGroupList();return xn({groupList:t,isSyncCompleted:e.isPagingGetCompleted()})})).catch((function(e){return Ge.e("".concat(t," failed. error:"),e),jn(e)}));var n=this._groupModule.getLocalGroupList();return Ge.l("".concat(t,". returned group count:").concat(n.length)),Bn({groupList:n,isSyncCompleted:this.isPagingGetCompleted()})}},{key:"isPagingGetCompleted",value:function(){return this._pagingStatus===on.RESOLVED}},{key:"_pagingGetGroupList",value:function(e){var t=this,n="".concat(this._n,".").concat("_pagingGetGroupList"),r=e.isCommunityRelay,o=void 0!==r&&r,i=e.limit,a=e.offset,s=e.groupBaseInfoFilter,u=e.groupList,c=Date.now();return this._groupModule.request({protocolName:Kn.GET_GROUP_LIST,requestData:{type:o?O.GRP_COMMUNITY:void 0,memberAccount:this._groupModule.getMyUserID(),limit:i,offset:a,responseFilter:{groupBaseInfoFilter:s,selfInfoFilter:["Role","JoinTime","MsgFlag","MsgSeq"]}}}).then((function(e){var r=e.data,l=r.groups,d=void 0===l?[]:l,f=r.totalCount;u.push.apply(u,T(d)),t._handleGroupAtInfoWithoutTopic(o,d);var p=a+i,h=!(f>p),g="offset:".concat(a," limit:").concat(i," totalCount:").concat(f," isCompleted:").concat(h," ")+"currentCount:".concat(u.length," isCommunityRelay:").concat(o);return t._pagingGetCostList.push(Xt(c,!1)),Ge.l("".concat(n," ok. ").concat(g," cost:").concat(Xt(c))),o||h?!o&&h?(Ge.l("".concat(n," start to get community list")),a=0,t._pagingGetGroupList({limit:i,offset:a,groupBaseInfoFilter:s,groupList:u,isCommunityRelay:!0})):o&&!h?(a=p,t._pagingGetGroupList({limit:i,offset:a,groupBaseInfoFilter:s,groupList:u,isCommunityRelay:!0})):xn({groupList:u}):(a=p,t._pagingGetGroupList({limit:i,offset:a,groupBaseInfoFilter:s,groupList:u}))})).catch((function(e){return 10018===e.code?(Ge.w("".concat(t.logPrefix," response size exceeds the limit, request count:").concat(i)),i=50,t._pagingGetGroupList({limit:i,offset:a,groupBaseInfoFilter:s,groupList:u,isCommunityRelay:o})):o?(11e3===e.code&&Ge.l("".concat(n," ok. community unavailable")),Bn({groupList:u})):jn(e)}))}},{key:"_pagingGetGroupListWithTopic",value:function(e){var t=this,n="".concat(this._n,"._pagingGetGroupListWithTopic"),r=e.limit,o=e.offset,i=e.groupBaseInfoFilter,a=e.groupList,s=Date.now();return this._groupModule.request({protocolName:Kn.GET_GROUP_LIST,requestData:{type:O.GRP_COMMUNITY,memberAccount:this._groupModule.getMyUserID(),limit:r,offset:o,responseFilter:{groupBaseInfoFilter:i,selfInfoFilter:["Role","JoinTime","MsgFlag","MsgSeq"]},isSupportTopic:1}}).then((function(e){var u=e.data,c=u.groups,l=void 0===c?[]:c,d=u.totalCount;a.push.apply(a,T(l));var f=o+r,p=!(d>f);if(Ge.l("".concat(n," ok. offset:").concat(o," limit:").concat(r," totalCount:").concat(d," isCompleted:").concat(p," currentCount:").concat(a.length," cost:").concat(Xt(s))),!p)return o=f,t._pagingGetGroupListWithTopic({limit:r,offset:o,groupBaseInfoFilter:i,groupList:a});t._groupModule.updateGroupMap(a),t._groupModule.emitGroupListUpdate(!0,!1);var h=t._groupModule.getLocalGroupList().filter((function(e){return!0===e.isSupportTopic}));return xn({groupList:h})})).catch((function(e){return 10018===e.code?(Ge.w("".concat(t.logPrefix," response size exceeds the limit, request count:").concat(r)),r=50,t._pagingGetGroupListWithTopic({limit:r,offset:o,groupBaseInfoFilter:i,groupList:a})):jn(e)}))}},{key:"_cacheGroupMessage",value:function(e,t){this._cachedGroupMessageMap.has(e)||this._cachedGroupMessageMap.set(e,[]),this._cachedGroupMessageMap.get(e).push(t)}},{key:"_deleteCachedGroupMessage",value:function(e){this._cachedGroupMessageMap.has(e)&&this._cachedGroupMessageMap.delete(e)}},{key:"_notifyCachedGroupMessage",value:function(e){var t=this,n=this._cachedGroupMessageMap.get(e)||[];n.forEach((function(e){t.onNewGroupMessage(e)})),this._deleteCachedGroupMessage(e),Ge.l("".concat(this._n,"._notifyCachedGroupMessage groupID:").concat(e," count:").concat(n.length))}},{key:"_cacheGroupMessageAndProbe",value:function(e){var t=this,n=e.groupID,r=e.event,o=e.item;this._cacheGroupMessage(n,{event:r,dataList:[o]}),this._groupModule.getGroupSimplifiedInfo(n).then((function(e){e.type===O.GRP_AVCHATROOM?t._groupModule.hasLocalGroup(n)?t._notifyCachedGroupMessage(n):t._groupModule.setUnjoinedAVChatRoom(n):(t._groupModule.updateGroupMap([e]),t._notifyCachedGroupMessage(n))})),this._checkCountMap.has(n)||this._checkCountMap.set(n,0),Ge.l("".concat(this._n,"._cacheGroupMessageAndProbe groupID:").concat(n))}},{key:"_handleGroupAtInfoWithoutTopic",value:function(e,n){var r=this;e&&0!==n.length&&n.forEach((function(e){var n=e.groupID,o=e.groupAtInfoList,i=[];at(o)||(o.forEach((function(e){i.push(t(t({},e),{},{groupID:n}))})),r._groupModule.getModule(11).onNewGroupAtTips({dataList:i}))}))}},{key:"setPagingGroupCount",value:function(e){at(e)||(this.PAGING_GRP_COUNT_LIMIT=parseInt(e,10))}},{key:"reset",value:function(){this.PAGING_GRP_COUNT_LIMIT=200,this._cachedGroupMessageMap.clear(),this._checkCountMap.clear(),this._getTopicPendingMap.clear(),this._pagingStatus=on.NOT_START,this._pagingGetCostList=[]}}]),e}(),Vr=function(){function e(t){a(this,e),this._groupModule=t,this._n="GroupAttributesHandler",this._groupAttributesMap=new Map,this._groupAttributesCopy={},this.CACHE_EXPIRE_TIME=3e4,this._groupModule.getInnerEmitterInstance().on(Cr.CLOUD_CONFIG_UPDATED,this._onCloudConfigUpdated,this)}return c(e,[{key:"_onCloudConfigUpdated",value:function(){var e=this._groupModule.getCloudConfig("grp_attr_cache_time");at(e)||(this.CACHE_EXPIRE_TIME=Number(e))}},{key:"updateLocalMainSequenceOnReconnected",value:function(){this._groupAttributesMap.forEach((function(e){e.localMainSequence=0}))}},{key:"isGroupAttributesUpdatedNotice",value:function(e){var t=e.to,n=e.elements.newGroupProfile,r=!at(n)&&!Qt(n.groupAttributeOption);return r&&this._onGroupAttributesUpdated({groupID:t,groupAttributeOption:n.groupAttributeOption}),r}},{key:"_onGroupAttributesUpdated",value:function(e){var t=this,n=e.groupID,r=e.groupAttributeOption,o=r.mainSequence,i=r.isWithChangedAttributeInfo,a=r.groupAttributeList,s=void 0===a?[]:a,u=r.operationType;if(Ge.l("".concat(this._n,".onGroupAttributesUpdated. ")+"groupID:".concat(n," isWithChangedAttributeInfo:").concat(i," operationType:").concat(u)),!at(u)){this._groupAttributesCopy=this._getCachedAttributes({groupID:n});var c=o-this._getLocalGroupAttributes(n).localMainSequence;if(0!==c){if(1===i&&1===c)return this._refreshCachedGroupAttributes({groupID:n,remoteMainSequence:o,groupAttributeList:s,operationType:u}),void this._emitGroupAttributesUpdated(n);if(this._hasLocalGroupAttributes(n)){var l=this._getLocalGroupAttributes(n).avChatRoomKey;this._getGroupAttributes({groupID:n,avChatRoomKey:l}).then((function(){t._emitGroupAttributesUpdated(n)}))}}}}},{key:"initGroupAttributesCache",value:function(e){var t=e.groupID,n=e.avChatRoomKey,r=void 0===n?void 0:n;this._groupAttributesMap.set(t,{lastUpdateTime:0,localMainSequence:0,remoteMainSequence:0,attributes:new Map,avChatRoomKey:r}),Ge.l("".concat(this._n,".initGroupAttributesCache groupID:").concat(t," avChatRoomKey:").concat(r))}},{key:"initGroupAttributes",value:function(e){var t=this,n=e.groupID,r=e.groupAttributes,o=this._getLocalGroupAttributes(n),i=o.remoteMainSequence,a=o.avChatRoomKey,s=new ar("initGroupAttributes");return s.setMessage("groupID:".concat(n," avChatRoomKey:").concat(a," mainSequence:").concat(i)),this._groupModule.request({protocolName:Kn.SET_GROUP_ATTRIBUTES,requestData:{groupID:n,avChatRoomKey:a,mainSequence:i,groupAttributeList:this._transformGroupAttributes(r)}}).then((function(e){Ge.l("".concat(t._n,".").concat("initGroupAttributes"," ok. groupID:").concat(n));var o=e.data,i=o.mainSequence,a=T(o.groupAttributeList);return a.forEach((function(e){e.value=r[e.key]})),t._groupAttributesCopy=t._getCachedAttributes({groupID:n}),t._refreshCachedGroupAttributes({groupID:n,remoteMainSequence:i,groupAttributeList:a,operationType:1}),t._emitGroupAttributesUpdated(n),s.setNetworkType(t._groupModule.getNetworkType()).end(),xn({groupAttributes:r})})).catch((function(e){return t._groupModule.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];s.setError(e,r,o).end()})),jn(e)}))}},{key:"setGroupAttributes",value:function(e){var t=this,n="".concat(this._n,".").concat("setGroupAttributes"),r=e.groupID,o=e.groupAttributes,i=this._getLocalGroupAttributes(r),a=i.remoteMainSequence,s=i.avChatRoomKey,u=i.attributes,c=this._transformGroupAttributes(o);c.forEach((function(e){var t=e.key;e.sequence=0,u.has(t)&&(e.sequence=u.get(t).sequence)}));var l=new ar("setGroupAttributes");return l.setMessage("groupID:".concat(r," groupAttributes:").concat(JSON.stringify(o))),Ge.l("".concat(n,". groupID:").concat(r," mainSequence:").concat(a)),this._groupModule.request({protocolName:Kn.MODIFY_GROUP_ATTRIBUTES,requestData:{groupID:r,avChatRoomKey:s,mainSequence:a,groupAttributeList:c}}).then((function(e){Ge.l("".concat(n," ok."));var i=e.data,a=i.mainSequence,s=T(i.groupAttributeList);return s.forEach((function(e){e.value=o[e.key]})),t._groupAttributesCopy=t._getCachedAttributes({groupID:r}),t._refreshCachedGroupAttributes({groupID:r,remoteMainSequence:a,groupAttributeList:s,operationType:2}),t._emitGroupAttributesUpdated(r),l.setNetworkType(t._groupModule.getNetworkType()).end(),xn({groupAttributes:o})})).catch((function(e){return t._groupModule.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];l.setError(e,r,o).end()})),jn(e)}))}},{key:"deleteGroupAttributes",value:function(e){var t=this,n=e.groupID,r=e.keyList,o=void 0===r?[]:r,i=this._getLocalGroupAttributes(n),a=i.remoteMainSequence,s=i.avChatRoomKey,u=i.attributes,c=T(u.keys()),l=Kn.CLEAR_GROUP_ATTRIBUTES,d=3,f={groupID:n,avChatRoomKey:s,mainSequence:a},p=[];o.length>0&&(c=[],l=Kn.DELETE_GROUP_ATTRIBUTES,d=4,o.forEach((function(e){var t=0;u.has(e)&&(t=u.get(e).sequence,c.push(e)),p.push({key:e,sequence:t})})),f.groupAttributeList=p);var h=new ar("deleteGroupAttributes");return h.setMessage("groupID:".concat(n," mainSequence:").concat(a," keyList:").concat(o," protocolName:").concat(l)),this._groupModule.request({protocolName:l,requestData:f}).then((function(e){Ge.l("".concat(t._n,".").concat("deleteGroupAttributes"," ok. groupID:").concat(n));var r=e.data.mainSequence;return t._groupAttributesCopy=t._getCachedAttributes({groupID:n}),t._refreshCachedGroupAttributes({groupID:n,remoteMainSequence:r,groupAttributeList:p,operationType:d}),t._emitGroupAttributesUpdated(n),h.setNetworkType(t._groupModule.getNetworkType()).end(),xn({keyList:c})})).catch((function(e){return t._groupModule.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];h.setError(e,r,o).end()})),jn(e)}))}},{key:"getGroupAttributes",value:function(e){var t=this,n="".concat(this._n,".").concat("getGroupAttributes"),r=e.groupID,o=this._getLocalGroupAttributes(r),i=o.avChatRoomKey,a=o.lastUpdateTime,s=o.localMainSequence,u=o.remoteMainSequence,c=new ar("getGroupAttributes");if(c.setMessage("groupID:".concat(r," localMainSequence:").concat(s," remoteMainSequence:").concat(u," keyList:").concat(e.keyList)),Date.now()-a>=this.CACHE_EXPIRE_TIME||s<u)return this._getGroupAttributes({groupID:r,avChatRoomKey:i}).then((function(o){c.setMoreMessage("get attributes from remote. count:".concat(o.length)).setNetworkType(t._groupModule.getNetworkType()).end(),Ge.l("".concat(n," from remote. groupID:").concat(r));var i=t._getCachedAttributes(e);return xn({groupAttributes:i})})).catch((function(e){return t._groupModule.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];c.setError(e,r,o).end()})),jn(e)}));c.setMoreMessage("get attributes from cache").setNetworkType(this._groupModule.getNetworkType()).end(),Ge.l("".concat(n," from cache. groupID:").concat(r));var l=this._getCachedAttributes(e);return Bn({groupAttributes:l})}},{key:"_getGroupAttributes",value:function(e){var n=this,r=0;return at(e.avChatRoomKey)||(r=1),this._groupModule.request({protocolName:Kn.GET_GROUP_ATTRIBUTES,requestData:t(t({},e),{},{groupType:r})}).then((function(t){Ge.l("".concat(n._n,"._getGroupAttributes ok. groupID:").concat(e.groupID));var r=t.data,o=r.mainSequence,i=r.groupAttributeList,a=T(i);return at(o)||n._refreshCachedGroupAttributes({groupID:e.groupID,remoteMainSequence:o,groupAttributeList:a,operationType:5}),i})).catch((function(e){return jn(e)}))}},{key:"_refreshCachedGroupAttributes",value:function(e){var t=e.groupID,n=e.remoteMainSequence,r=e.groupAttributeList,o=e.operationType;if(this._hasLocalGroupAttributes(t)){var i=this._getLocalGroupAttributes(t),a=i.localMainSequence;if(5===o||n-a==1)i.remoteMainSequence=n,i.localMainSequence=n,i.lastUpdateTime=Date.now(),this._updateCachedAttributes({groupAttributes:i,groupAttributeList:r,operationType:o});else{if(a===n)return;i.remoteMainSequence=n}this._groupAttributesMap.set(t,i);var s="operationType:".concat(o," localMainSequence:").concat(a," remoteMainSequence:").concat(n);Ge.l("".concat(this._n,"._refreshCachedGroupAttributes. ").concat(s))}}},{key:"_getCachedAttributes",value:function(e){var t=e.groupID,n=e.keyList,r=void 0===n?[]:n,o={};if(this._hasLocalGroupAttributes(t)){var i=this._getLocalGroupAttributes(t).attributes;if(r.length>0)r.forEach((function(e){i.has(e)&&(o[e]=i.get(e).value)}));else{var a,s=D(i.keys());try{for(s.s();!(a=s.n()).done;){var u=a.value;o[u]=i.get(u).value}}catch(p){s.e(p)}finally{s.f()}}}return o}},{key:"_updateCachedAttributes",value:function(e){var t=e.groupAttributes,n=e.groupAttributeList,r=e.operationType;3!==r?4!==r?(1===r&&t.attributes.clear(),n.forEach((function(e){var n=e.key,r=e.value,o=e.sequence;t.attributes.set(n,{value:r,sequence:o})}))):n.forEach((function(e){t.attributes.delete(e.key)})):t.attributes.clear()}},{key:"_hasLocalGroupAttributes",value:function(e){return this._groupAttributesMap.has(e)}},{key:"_getLocalGroupAttributes",value:function(e){return this._hasLocalGroupAttributes(e)||this.initGroupAttributesCache({groupID:e}),this._groupAttributesMap.get(e)}},{key:"_transformGroupAttributes",value:function(e){var t=[];return Object.keys(e).forEach((function(n){t.push({key:n,value:e[n]})})),t}},{key:"_emitGroupAttributesUpdated",value:function(e){var t=this._getCachedAttributes({groupID:e}),n=this._computeAttrChangedInfo(t),r=n.updatedKeyList,o=n.deletedKeyList;Ge.l("".concat(this._n,"._emitGroupAttributesUpdated update:").concat(r.length,", delete:").concat(o.length)),0===r.length&&0===o.length||this._groupModule.emitOuterEvent(A.GROUP_ATTRIBUTES_UPDATED,{groupID:e,groupAttributes:t,updatedKeyList:r,deletedKeyList:o})}},{key:"_computeAttrChangedInfo",value:function(e){var t=this,n=[],r=[];return Object.keys(e).forEach((function(r){e[r]!==t._groupAttributesCopy[r]&&n.push(r)})),Object.keys(this._groupAttributesCopy).forEach((function(t){at(e[t])&&r.push(t)})),this._groupAttributesCopy={},{updatedKeyList:n,deletedKeyList:r}}},{key:"deleteLocalGroupAttributes",value:function(e){this._hasLocalGroupAttributes(e)&&this._groupAttributesMap.delete(e)}},{key:"reset",value:function(){this._groupAttributesMap.clear(),this._groupAttributesCopy={},this.CACHE_EXPIRE_TIME=3e4}}]),e}(),Br=function(){function e(t){a(this,e),this._groupModule=t,this._n="GroupCountersHandler",this._groupCountersMap=new Map,this.EXPIRE_TIME=3e4,this._groupModule.getInnerEmitterInstance().on(Cr.CLOUD_CONFIG_UPDATED,this._onCloudConfigUpdated,this)}return c(e,[{key:"_onCloudConfigUpdated",value:function(){var e=this._groupModule.getCloudConfig("grp_counter_expire_time");at(e)||(this.EXPIRE_TIME=Number(e))}},{key:"isGroupCountersNotice",value:function(e){var t=e.to,n=e.elements.groupCounterInfo,r=!1;return Qt(n)||(this._onGroupCountersUpdated({groupID:t,groupCounterInfo:n}),r=!0),r}},{key:"_onGroupCountersUpdated",value:function(e){var t=this,n=e.groupID;e.groupCounterInfo.forEach((function(e){var r=e.type,o=e.groupCounterSeq,i=e.counterList,a=void 0===i?[]:i;0!==r&&2!==r||(t._updateLocalGroupCounters({groupID:n,groupCounterSeq:o,counterList:a}),a.forEach((function(e){t._groupModule.emitOuterEvent(A.GROUP_COUNTER_UPDATED,{groupID:n,key:e.key,value:e.value})}))),1===r&&t._deleteLocalGroupCounters({groupID:n,groupCounterSeq:o,counterList:a})})),Ge.l("".concat(this._n,"._onGroupCountersUpdated groupID:").concat(n))}},{key:"initGroupCountersCache",value:function(e){var t=e.groupID,n=e.avChatRoomKey;this._groupCountersMap.set(t,{lastUpdateTime:0,groupCounterSeq:0,counters:new Map,avChatRoomKey:n}),Ge.l("".concat(this._n,".initGroupCountersCache groupID:").concat(t," avChatRoomKey:").concat(n))}},{key:"setGroupCounters",value:function(e){var t=this;if(!this._groupModule.canIUse(q.GRP_COUNTER))return this._groupModule.cannotUseCommercialAbility("setGroupCounters");var n="".concat(this._n,".").concat("setGroupCounters"),r=e.groupID,o=e.counters,i=this._convertObjectToList(o),a=this._getLocalGroupCounters(r).avChatRoomKey,s="groupID:".concat(r," count:").concat(i.length),u=new ar("setGroupCounters");return u.setMessage("".concat(s)),Ge.l("".concat(n,". ").concat(s)),this._updateGroupCounters({groupID:r,counterList:i,avChatRoomKey:a,mode:"Set"}).then((function(e){return u.end(),Ge.l("".concat(n," ok.")),xn({counters:e})})).catch((function(e){return t._groupModule.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];u.setError(e,r,o).end()})),Ge.e("".concat(n," failed. error:"),e),jn(e)}))}},{key:"increaseGroupCounter",value:function(e){var t=this,n="increaseGroupCounter";if(!this._groupModule.canIUse(q.GRP_COUNTER))return this._groupModule.cannotUseCommercialAbility(n);var r="".concat(this._n,".").concat(n),o=e.groupID,i=e.key,a=e.value,s=this._getLocalGroupCounters(o).avChatRoomKey,u="groupID:".concat(o," key:").concat(i," value:").concat(a),c=new ar(n);c.setMessage("".concat(u)),Ge.l("".concat(r,". ").concat(u));var l=[{key:i,value:a}];return this._updateGroupCounters({groupID:o,counterList:l,avChatRoomKey:s,mode:"Increase"}).then((function(e){return c.end(),Ge.l("".concat(r," ok.")),xn({counters:e})})).catch((function(e){return t._groupModule.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];c.setError(e,r,o).end()})),Ge.e("".concat(r," failed. error:"),e),jn(e)}))}},{key:"decreaseGroupCounter",value:function(e){var t=this,n="decreaseGroupCounter";if(!this._groupModule.canIUse(q.GRP_COUNTER))return this._groupModule.cannotUseCommercialAbility(n);var r="".concat(this._n,".").concat(n),o=e.groupID,i=e.key,a=e.value,s=this._getLocalGroupCounters(o).avChatRoomKey,u="groupID:".concat(o," key:").concat(i," value:").concat(a),c=new ar(n);c.setMessage("".concat(u)),Ge.l("".concat(r,". ").concat(u));var l=[{key:i,value:a}];return this._updateGroupCounters({groupID:o,counterList:l,avChatRoomKey:s,mode:"Decrease"}).then((function(e){return c.end(),Ge.l("".concat(r," ok.")),xn({counters:e})})).catch((function(e){return t._groupModule.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];c.setError(e,r,o).end()})),Ge.e("".concat(r," failed. error:"),e),jn(e)}))}},{key:"getGroupCounters",value:function(e){var t=this;if(!this._groupModule.canIUse(q.GRP_COUNTER))return this._groupModule.cannotUseCommercialAbility("getGroupCounters");var n="".concat(this._n,".").concat("getGroupCounters"),r=e.groupID,o=e.keyList,i=void 0===o?[]:o,a=this._getLocalGroupCounters(r),s=a.avChatRoomKey,u=a.lastUpdateTime,c=new ar("getGroupCounters");if(c.setMessage("groupID:".concat(r)),Date.now()-u>=this.EXPIRE_TIME)return this._getRemoteGroupCounters({groupID:r,avChatRoomKey:s}).then((function(e){c.setMoreMessage("from remote. count:".concat(e.length)).end(),Ge.l("".concat(n," from remote. groupID:").concat(r));var o=t._getLocalCounters(r,i);return xn({counters:o})})).catch((function(e){return t._groupModule.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];c.setError(e,r,o).end()})),jn(e)}));c.setMoreMessage("from cache").end(),Ge.l("".concat(n," from cache. groupID:").concat(r));var l=this._getLocalCounters(r,i);return Bn({counters:l})}},{key:"_getRemoteGroupCounters",value:function(e){var n=this;return this._groupModule.request({protocolName:Kn.GET_GROUP_COUNTER,requestData:t({},e)}).then((function(t){var r=t.data,o=r.counterList,i=void 0===o?[]:o,a=r.groupCounterSeq;return n._updateLocalGroupCounters({groupID:e.groupID,counterList:i,groupCounterSeq:a}),Ge.l("".concat(n._n,"._getRemoteGroupCounters ok. groupID:").concat(e.groupID)),i})).catch((function(e){return jn(e)}))}},{key:"_convertObjectToList",value:function(e){var t=[];return Object.keys(e).forEach((function(n){t.push({key:n,value:e[n]})})),t}},{key:"_updateGroupCounters",value:function(e){var n="".concat(this._n,"._updateGroupCounters"),r=e.groupID,o=e.avChatRoomKey,i=e.mode;return Ge.l("".concat(n,". groupID:").concat(r," avChatRoomKey:").concat(o," mode:").concat(i)),this._groupModule.request({protocolName:Kn.UPDATE_GROUP_COUNTER,requestData:t({},e)}).then((function(e){Ge.l("".concat(n," ok."));var t=e.data.counterList,r={};return(void 0===t?[]:t).forEach((function(e){var t=e.key,n=e.value;r[t]=n})),r})).catch((function(e){return jn(e)}))}},{key:"_hasLocalGroupCounters",value:function(e){return this._groupCountersMap.has(e)}},{key:"_getLocalGroupCounters",value:function(e){return this._hasLocalGroupCounters(e)||this.initGroupCountersCache({groupID:e}),this._groupCountersMap.get(e)}},{key:"_updateLocalGroupCounters",value:function(e){var t=e.groupID,n=e.counterList,r=void 0===n?[]:n,o=e.groupCounterSeq;if(this._hasLocalGroupCounters(t)){var i=this._getLocalGroupCounters(t),a=i.counters,s=i.avChatRoomKey,u=i.groupCounterSeq;if(o>0&&o<u)return;r.forEach((function(e){var t=e.key,n=e.value;a.set(t,n)})),this._groupCountersMap.set(t,{lastUpdateTime:Date.now(),groupCounterSeq:o,counters:a,avChatRoomKey:s})}}},{key:"_deleteLocalGroupCounters",value:function(e){var t=e.groupID,n=e.counterList,r=void 0===n?[]:n,o=e.groupCounterSeq;if(this._hasLocalGroupCounters(t)){var i=this._getLocalGroupCounters(t),a=i.counters,s=i.avChatRoomKey;r.forEach((function(e){a.delete(e.key)})),this._groupCountersMap.set(t,{lastUpdateTime:Date.now(),groupCounterSeq:o,counters:a,avChatRoomKey:s})}}},{key:"_getLocalCounters",value:function(e,t){var n={};if(!this._hasLocalGroupCounters(e))return n;var r=this._getLocalGroupCounters(e).counters;if(t.length>0)t.forEach((function(e){r.has(e)&&(n[e]=r.get(e))}));else{var o,i=D(r.keys());try{for(i.s();!(o=i.n()).done;){var a=o.value;n[a]=r.get(a)}}catch(d){i.e(d)}finally{i.f()}}return n}},{key:"reset",value:function(){this._groupCountersMap.clear(),this.EXPIRE_TIME=3e4}}]),e}(),jr=function(){function e(t){a(this,e);var n=t.manager,r=t.groupID,o=t.onInit,i=t.onSuccess,s=t.onFail;this._n="Polling",this._manager=n,this._groupModule=n._groupModule,this._onInit=o,this._onSuccess=i,this._onFail=s,this._groupID=r,this._timeoutID=-1,this._isRunning=!1,this._protocolName=Kn.AVCHATROOM_POLLING}return c(e,[{key:"start",value:function(){var e=this._groupModule.isLoggedIn();e||(this._protocolName=Kn.AVCHATROOM_NOAUTH_POLLING),Ge.l("".concat(this._n,".start pollingInterval:").concat(this._manager.getPollingInterval()," isLoggedIn:").concat(e)),this._isRunning=!0,this._request()}},{key:"isRunning",value:function(){return this._isRunning}},{key:"_request",value:function(){var e=this,t=this._onInit(this._groupID);this._groupModule.request({protocolName:this._protocolName,requestData:t}).then((function(t){e._onSuccess(e._groupID,t),e.isRunning()&&(clearTimeout(e._timeoutID),e._timeoutID=setTimeout(e._request.bind(e),e._manager.getPollingInterval()))})).catch((function(t){e._onFail(e._groupID,t),e.isRunning()&&(clearTimeout(e._timeoutID),e._timeoutID=setTimeout(e._request.bind(e),e._manager.MAX_POLLING_INTERVAL))}))}},{key:"stop",value:function(){Ge.l("".concat(this._n,".stop")),this._timeoutID>0&&(clearTimeout(this._timeoutID),this._timeoutID=-1),this._isRunning=!1}},{key:"getPollingTimerID",value:function(){return this._timeoutID}}]),e}(),Hr={3:!0,4:!0,5:!0,6:!0,17:!0,20:!0,21:!0},Kr=function(){function e(t){a(this,e),this._groupModule=t,this._n="AVChatRoomHandler",this._joinedGroupMap=new Map,this._pollingRequestInfoMap=new Map,this._pollingInstanceMap=new Map,this.sequencesLinkedList=new Rr(200),this.messageIDLinkedList=new Rr(100),this._reportMessageStackedCount=0,this._onlineMemberCountMap=new Map,this.DEFAULT_EXPIRE_TIME=60,this.DEFAULT_POLLING_INTERVAL=300,this.MAX_POLLING_INTERVAL=2e3,this._pollingInterval=this.DEFAULT_POLLING_INTERVAL,this.DEFAULT_POLLING_NO_MESSAGE_COUNT=20,this.DEFAULT_POLLING_INTERVAL_PLUS=2e3,this._pollingNoMessageCount=0,this._startBroadcastSeq=1,this._broadcastMessageIDMap=new Map,this.DEFAULT_POLLING_SIMPLIFIED_MSG=0}return c(e,[{key:"hasJoinedAVChatRoom",value:function(){return this._joinedGroupMap.size>0}},{key:"checkJoinedAVChatRoomByID",value:function(e){return this._joinedGroupMap.has(e)}},{key:"getJoinedAVChatRoom",value:function(){return this._joinedGroupMap.size>0?T(this._joinedGroupMap.keys()):[]}},{key:"_updateRequestData",value:function(e){var n=this._pollingRequestInfoMap.get(e);return e===T(this._pollingInstanceMap.keys())[0]?t(t({},n),{},{startBroadcastSeq:this._startBroadcastSeq,simplifiedMessage:this.DEFAULT_POLLING_SIMPLIFIED_MSG}):t(t({},n),{},{simplifiedMessage:this.DEFAULT_POLLING_SIMPLIFIED_MSG})}},{key:"_handleSuccess",value:function(e,t){var n=t.data,r=n.key,o=n.nextSeq,i=n.rspMsgList,a=n.errorCode,s=n.nextBroadcastSeq,u=n.broadcastMessageList;if(0!==a){var c=this._pollingRequestInfoMap.get(e),l=new ar("longPollingAVError"),d=c?"".concat(c.key,"-").concat(c.startSeq):"requestInfo is undefined";l.setMessage("".concat(e,"-").concat(d,"-").concat(t.errorInfo)).setCode(t.errorCode).setNetworkType(this._groupModule.getNetworkType()).end(!0)}else{if(!this.checkJoinedAVChatRoomByID(e))return;nt(r)&&et(o)&&this._pollingRequestInfoMap.set(e,{key:r,startSeq:o}),et(s)&&s>this._startBroadcastSeq&&(this._startBroadcastSeq=s),it(i)&&i.length>0?(i.forEach((function(e){e.to=e.groupID})),this.onMessage(i,e)):(this._pollingNoMessageCount+=1,this._pollingNoMessageCount===this.DEFAULT_POLLING_NO_MESSAGE_COUNT&&(this._pollingInterval=this.DEFAULT_POLLING_INTERVAL+this.DEFAULT_POLLING_INTERVAL_PLUS)),this._onBroadcastMessage(u)}}},{key:"_handleFailure",value:function(e,t){}},{key:"onMessage",value:function(e,t){if(it(e)&&0!==e.length){var n="".concat(this._n,".onMessage");t&&(n+=" groupID:".concat(t)),0!==this._pollingNoMessageCount&&(this._pollingNoMessageCount=0,this._pollingInterval=this.DEFAULT_POLLING_INTERVAL);var r=null,o=[],i=this._getModule(11),a=this._getModule(26),s=e.length;s>1&&e.sort((function(e,t){return e.sequence-t.sequence}));var u=this._getModule(12).isUnlimitedAVChatRoom(),c=!1;if(Ge.getLevel()<=0){var l=e.map((function(e){return e.sequence}));Ge.l("".concat(n," count:").concat(l.length," sequenceList:").concat(l)),l.length=0}for(var d=0;d<s;d++){var f=this.restoreMessageFromSimplified(e[d]);if(Hr[f.event]){if(6===f.event){if(this._groupModule.isGroupAttributesUpdatedNotice(f))continue;if(this._groupModule.isGroupCountersNotice(f))continue}if(20!==f.event)if(21!==f.event){r=this.packMessage(f,f.event);var p=1===f.isModified;if(c=1===f.isHistoryMessage,!u){if(this.sequencesLinkedList.has(r.sequence))continue;this.sequencesLinkedList.set(r.sequence)}var h=this.messageIDLinkedList.has(r.ID);if(h)Ge.w("".concat(n," ID:").concat(r.ID," has:").concat(h));else{this.messageIDLinkedList.set(r.ID);var g=!1;if(this._isMessageSentByCurrentInstance(r)?p&&(g=!0,r.isModified=p,i.updateMessageIsModifiedProperty(r)):g=!0,g){if(r.conversationType===O.CONV_SYSTEM&&5===r.payload.operationType&&this._onGroupDismissed(r.payload.groupProfile.groupID),!c&&r.conversationType!==O.CONV_SYSTEM){var v=r.conversationID.replace(O.CONV_GROUP,"");this._pollingInstanceMap.has(v)?this._groupModule.isLoggedIn()&&a.addMessageSequence({key:tr,message:r}):(r.type!==O.MSG_GRP_TIP&&r.clientTime>0&&a.addMessageDelay(r.clientTime),a.addMessageSequence({key:er,message:r}))}o.push(r)}}}else this._getModule(34).onMessageReactionNotify({event:21,dataList:f.elements.messageReactionNotifyList});else this.handleMessageRevokedNotice(f)}else Ge.w("".concat(n,". unknown event:").concat(f.event))}if(0!==o.length){if(this._groupModule.filterModifiedMessage(o),!c){var _=this.packConversationOption(o);_.length>0&&i.onNewMessage({conversationOptionsList:_,isInstantMessage:!0})}this._checkMessageStacked(o);var m=this._groupModule.filterUnmodifiedMessage(o);m.length>0&&this._groupModule.emitOuterEvent(A.MESSAGE_RECEIVED,m),o.length=0}}}},{key:"handleMessageRevokedNotice",value:function(e){var t=this,n=e.groupID,r=e.elements.revokeMsgList,o=e.revokerInfo,i=[];r.forEach((function(e){var t=e.tinyID,r=e.clientTime,a=e.random,s=e.sequence,u={conversationID:"".concat(O.CONV_GROUP).concat(n),ID:"".concat(t,"-").concat(r,"-").concat(a),revoker:o.revoker,revokeReason:o.reason||"",revokerInfo:{userID:o.revoker,nick:"",avatar:""},sequence:s};i.push(u)})),0!==i.length&&this._getModule(11).updateRevokerInfo(i).then((function(e){t._groupModule.emitOuterEvent(A.MESSAGE_REVOKED,e)}))}},{key:"isBroadcastOrNormal",value:function(e){return 3===e||17===e}},{key:"isGroupTip",value:function(e){return 4===e||6===e}},{key:"isGroupSystemNotice",value:function(e){return 5===e}},{key:"restoreGroupTipElements",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.operatorInfo,n=void 0===t?{}:t,r=e.operatorID,o=e.userIDList,i=void 0===o?[]:o,a=e.operationType;et(e.groupJoinType)||1!==a&&2!==a||(e.groupJoinType=2===a?0:1);var s=n.userID,u=void 0===s?r:s,c=n.avatar,l=void 0===c?"":c,d=n.nick,f=void 0===d?"":d;e.operatorInfo={userID:u,avatar:l,nick:f};var p=i.map((function(e){return{userID:e}}));return e.memberInfoList=e.memberInfoList||p,e}},{key:"restoreMessageFromSimplified",value:function(e){var n=e.event;if(this.isBroadcastOrNormal(n)&&(e.cloudCustomData=e.cloudCustomData||"",e.elements=e.elements.map((function(e){if(e.type===O.MSG_CUSTOM){var n=e.content,r=void 0===n?{}:n;e.content=t({data:"",description:"",extension:""},r)}return e}))),(this.isGroupTip(n)||this.isGroupSystemNotice(n))&&(e.from=e.from||"@TIM#SYSTEM"),this.isGroupTip(n)){e.elements=this.restoreGroupTipElements(e.elements);var r=e.elements,o=void 0===r?{}:r,i=o.operationType,a=o.operatorInfo;if(1===i){var s=[{userID:(void 0===a?{}:a).userID}];o.memberInfoList=o.memberInfoList||s}}if(this.isGroupSystemNotice(n)){var u=e.elements,c=u.memberInfoList,d=u.operatorInfo;c||(c=void 0===d?{}:d),e.elements.memberInfoList=t({userID:e.elements.operatorID,avatar:"",nick:""},c),e.elements=t({authentication:"",remarkInfo:"",messageKey:1e3*e.time},e.elements);var f=Object.keys(e.elements).filter((function(e){return"operatorInfo"!==e})).reduce((function(n,r){return t(t({},n),{},l({},r,e.elements[r]))}),{});e.elements=f}return e}},{key:"_onGroupDismissed",value:function(e){Ge.l("".concat(this._n,"._onGroupDismissed groupID:").concat(e)),this._groupModule.deleteLocalGroupAndConversation(e),this.reset(e)}},{key:"_checkMessageStacked",value:function(e){var t="MessageStacked",n=e.length;n>=100&&(this._groupModule.outputWarning(t,n),this._reportMessageStackedCount<5&&(new ar(t).setNetworkType(this._groupModule.getNetworkType()).setMessage("count:".concat(n," groupID:").concat(T(this._joinedGroupMap.keys()))).setLevel("warning").end(),this._reportMessageStackedCount+=1))}},{key:"_isMessageSentByCurrentInstance",value:function(e){return!!this._getModule(11).isMessageSentByCurrentInstance(e)}},{key:"packMessage",value:function(e,t){e.currentUser=this._groupModule.getMyUserID(),e.conversationType=5===t?O.CONV_SYSTEM:O.CONV_GROUP,e.isSystemMessage=!!e.isSystemMessage;var n=new Tr(e),r=this.packElements(e,t);return n.setElement(r,this._groupModule.getFileDownloadProxy()),n}},{key:"packElements",value:function(e,n){return 4===n||6===n?(this._updateMemberCountByGroupTips(e),{type:O.MSG_GRP_TIP,content:t(t({},e.elements),{},{groupProfile:e.groupProfile})}):5===n?{type:O.MSG_GRP_SYS_NOTICE,content:t(t({},e.elements),{},{groupProfile:t(t({},e.groupProfile),{},{groupID:e.groupID})})}:e.elements}},{key:"packConversationOption",value:function(e){for(var t=new Map,n=0;n<e.length;n++){var r=e[n],o=r.conversationID;if(t.has(o)){var i=t.get(o);i.lastMessage=r,"in"===r.flow&&i.unreadCount++}else t.set(o,{conversationID:r.conversationID,unreadCount:"out"===r.flow?0:1,type:r.conversationType,subType:r.conversationSubType,lastMessage:r})}return T(t.values())}},{key:"_updateMemberCountByGroupTips",value:function(e){var t=e.groupProfile.groupID,n=e.elements.onlineMemberInfo,r=void 0===n?void 0:n;if(!Qt(r)){var o=r.onlineMemberNum,i=void 0===o?0:o,a=r.expireTime,s=void 0===a?this.DEFAULT_EXPIRE_TIME:a,u=this._onlineMemberCountMap.get(t)||{},c=Date.now();Qt(u)?Object.assign(u,{lastReqTime:0,lastSyncTime:0,latestUpdateTime:c,memberCount:i,expireTime:s}):(u.latestUpdateTime=c,u.memberCount=i),this._onlineMemberCountMap.set(t,u)}}},{key:"_onBroadcastMessage",value:function(e){if(!Qt(e)){for(var t=[],n=e.length,r=null,o=0;o<n;o++){var i=this.restoreMessageFromSimplified(e[o]);Hr[i.event]?((r=this.packMessage(i,i.event)).isBroadcastMessage=!0,this._broadcastMessageIDMap.has(r.ID)||(t.push(r),this._broadcastMessageIDMap.set(r.ID,1))):Ge.w("".concat(this._n,"._onBroadcastMessage unknown event:").concat(i.event))}t.length>0&&this._groupModule.emitOuterEvent(A.MESSAGE_RECEIVED,t)}}},{key:"start",value:function(e){if(this._pollingInstanceMap.has(e)){var t=this._pollingInstanceMap.get(e);t.isRunning()||t.start()}else{var n=new jr({manager:this,groupID:e,onInit:this._updateRequestData.bind(this),onSuccess:this._handleSuccess.bind(this),onFail:this._handleFailure.bind(this)});n.start(),this._pollingInstanceMap.set(e,n),Ge.l("".concat(this._n,".start groupID:").concat(e))}}},{key:"handleJoinResult",value:function(e){var t=this;return this._preCheck().then((function(){var n=e.longPollingKey,r=e.group,o=r.groupID;return t._joinedGroupMap.set(o,r),t._groupModule.updateGroupMap([r]),t._groupModule.deleteUnjoinedAVChatRoom(o),t._groupModule.emitGroupListUpdate(!0,!1),at(n)?Bn({status:ze,group:r}):Promise.resolve()}))}},{key:"startRunLoop",value:function(e){var t=this;return this.handleJoinResult(e).then((function(){var n=e.longPollingKey,r=e.group,o=e.startSeq,i=void 0===o?0:o,a=r.groupID;return t._pollingRequestInfoMap.set(a,{key:n,startSeq:i}),t.start(a),t._groupModule.isLoggedIn()?Bn({status:ze,group:r}):Bn({status:ze})}))}},{key:"_preCheck",value:function(){if(this._getModule(12).isUnlimitedAVChatRoom())return Promise.resolve();if(!this.hasJoinedAVChatRoom())return Promise.resolve();var e=M(this._joinedGroupMap.entries().next().value,2),t=e[0],n=e[1];if(this._groupModule.isLoggedIn()){if(n.selfInfo.role!==O.GRP_MBR_ROLE_OWNER&&n.ownerID!==this._groupModule.getMyUserID())return this._groupModule.quitGroup(t);this._groupModule.deleteLocalGroupAndConversation(t)}else this._groupModule.deleteLocalGroupAndConversation(t);return this.reset(t),Promise.resolve()}},{key:"joinWithoutAuth",value:function(e){var t=this,n=e.groupID,r="".concat(this._n,".").concat("joinWithoutAuth"),o=new ar("joinWithoutAuth");return this._groupModule.request({protocolName:Kn.APPLY_JOIN_GROUP_NOAUTH,requestData:e}).then((function(e){var i=e.data.longPollingKey;if(t._groupModule.probeNetwork().then((function(e){var t=M(e,2);t[0];var r=t[1];o.setNetworkType(r).setMessage("groupID:".concat(n," longPollingKey:").concat(i)).end(!0)})),at(i))return jn({code:qn.CANNOT_JOIN_NON_AVCHATROOM_WITHOUT_LOGIN});Ge.l("".concat(r," ok. groupID:").concat(n)),t._getModule(11).setCompleted("".concat(O.CONV_GROUP).concat(n));var a=new wr({groupID:n});return t.startRunLoop({group:a,longPollingKey:i}),xn({status:ze})})).catch((function(e){return Ge.e("".concat(r," failed. groupID:").concat(n," error:"),e),t._groupModule.probeNetwork().then((function(t){var r=M(t,2),i=r[0],a=r[1];o.setError(e,i,a).setMessage("groupID:".concat(n)).end(!0)})),jn(e)})).finally((function(){t._groupModule.getModule(14).reportAtOnce()}))}},{key:"getGroupOnlineMemberCount",value:function(e){var t=this._onlineMemberCountMap.get(e)||{},n=Date.now();return Qt(t)||n-t.lastSyncTime>1e3*t.expireTime&&n-t.latestUpdateTime>1e4&&n-t.lastReqTime>3e3?(t.lastReqTime=n,this._onlineMemberCountMap.set(e,t),this._getGroupOnlineMemberCount(e).then((function(e){return xn({memberCount:e.memberCount})})).catch((function(e){return jn(e)}))):Bn({memberCount:t.memberCount})}},{key:"_getGroupOnlineMemberCount",value:function(e){var t=this,n="".concat(this._n,".").concat("_getGroupOnlineMemberCount");return this._groupModule.requestOnlineCount(e).then((function(r){var o=t._onlineMemberCountMap.get(e)||{},i=r.data,a=i.memberCount,s=void 0===a?0:a,u=i.expireTime,c=void 0===u?t.DEFAULT_EXPIRE_TIME:u;Ge.l("".concat(n," ok. groupID:").concat(e," memberCount:").concat(s," expireTime:").concat(c));var l=Date.now();return Qt(o)&&(o.lastReqTime=l),t._onlineMemberCountMap.set(e,Object.assign(o,{lastSyncTime:l,latestUpdateTime:l,memberCount:s,expireTime:c})),{memberCount:s}})).catch((function(r){return Ge.w("".concat(n," failed. error:"),r),new ar("_getGroupOnlineMemberCount").setCode(r.code).setMessage("groupID:".concat(e," error:").concat(JSON.stringify(r))).setNetworkType(t._groupModule.getNetworkType()).end(),Promise.reject(r)}))}},{key:"_getModule",value:function(e){return this._groupModule.getModule(e)}},{key:"setPollingInterval",value:function(e){at(e)||(et(e)?this._pollingInterval=this.DEFAULT_POLLING_INTERVAL=e:this._pollingInterval=this.DEFAULT_POLLING_INTERVAL=parseInt(e,10))}},{key:"setPollingIntervalPlus",value:function(e){at(e)||(et(e)?this.DEFAULT_POLLING_INTERVAL_PLUS=e:this.DEFAULT_POLLING_INTERVAL_PLUS=parseInt(e,10))}},{key:"setPollingNoMessageCount",value:function(e){at(e)||(et(e)?this.DEFAULT_POLLING_NO_MESSAGE_COUNT=e:this.DEFAULT_POLLING_NO_MESSAGE_COUNT=parseInt(e,10))}},{key:"setPollingSimplifiedMessage",value:function(e){at(e)||"0"!==e&&"1"!==e||(this.DEFAULT_POLLING_SIMPLIFIED_MSG=parseInt(e,10))}},{key:"getPollingInterval",value:function(){return this._pollingInterval}},{key:"onAVChatRoomMemberBanned",value:function(e){var t=e.payload.groupProfile.groupID;Ge.l("".concat(this._n,".onAVChatRoomMemberBanned groupID:").concat(t)),this._groupModule.deleteLocalGroupAndConversation(t),this.reset(t)}},{key:"restartPolling",value:function(){Ge.l("".concat(this._n,".restartPolling count:").concat(this._pollingInstanceMap.size));var e,t=D(this._pollingInstanceMap.values());try{for(t.s();!(e=t.n()).done;){var n=e.value;n.stop(),n.start()}}catch(a){t.e(a)}finally{t.f()}}},{key:"getPollingTimerID",value:function(e){if(!this._pollingInstanceMap.has(e))return-1;var t=this._pollingInstanceMap.get(e).getPollingTimerID();return Ge.l("".concat(this._n,".getPollingTimerID groupID:").concat(e," timerID:").concat(t)),t}},{key:"reset",value:function(e){if(e){Ge.l("".concat(this._n,".reset groupID:").concat(e));var t=this._pollingInstanceMap.get(e);t&&t.stop(),this._pollingInstanceMap.delete(e),this._joinedGroupMap.delete(e),this._pollingRequestInfoMap.delete(e),this._onlineMemberCountMap.delete(e)}else{Ge.l("".concat(this._n,".reset all"));var n,r=D(this._pollingInstanceMap.values());try{for(r.s();!(n=r.n()).done;)n.value.stop()}catch(s){r.e(s)}finally{r.f()}this._pollingInstanceMap.clear(),this._joinedGroupMap.clear(),this._pollingRequestInfoMap.clear(),this._onlineMemberCountMap.clear(),this._broadcastMessageIDMap.clear()}this.sequencesLinkedList.reset(),this.messageIDLinkedList.reset(),this._reportMessageStackedCount=0,this._pollingInterval=this.DEFAULT_POLLING_INTERVAL=300,this.DEFAULT_POLLING_NO_MESSAGE_COUNT=20,this.DEFAULT_POLLING_INTERVAL_PLUS=2e3,this._pollingNoMessageCount=0}}]),e}(),Wr=function(){function e(t){a(this,e),this.userID="",this.avatar="",this.nick="",this.role="",this.joinTime="",this.lastSendMsgTime="",this.nameCard="",this.muteUntil=0,this.memberCustomField=[],this.isOnline="Online"===t.onlineStatus,this._initMember(t)}return c(e,[{key:"_initMember",value:function(e){this.updateMember(e)}},{key:"updateMember",value:function(e){var t=[null,void 0,"",0,NaN];e.memberCustomField&&St(this.memberCustomField,e.memberCustomField),pt(this,e,["memberCustomField","marks","onlineStatus"],t)}},{key:"updateRole",value:function(e){["Owner","Admin","Member"].indexOf(e)<0||(this.role=e)}},{key:"updateMuteUntil",value:function(e){at(e)||(this.muteUntil=Math.floor((Date.now()+1e3*e)/1e3))}},{key:"updateNameCard",value:function(e){at(e)||(this.nameCard=e)}},{key:"updateMemberCustomField",value:function(e){e&&St(this.memberCustomField,e)}}]),e}(),Yr=function(){function e(t){a(this,e),this._groupModule=t,this._n="GroupMemberHandler",this.groupMemberListMap=new Map,this.DEFAULT_MEMBER_INFO_FILTER=["Role","JoinTime","NameCard","ShutUpUntil","OnlineStatus"],this._groupModule.getInnerEmitterInstance().on(Cr.PROFILE_UPDATED,this._onProfileUpdated,this)}return c(e,[{key:"_onProfileUpdated",value:function(e){for(var t=this,n=e.data,r=function(e){var r=n[e];t.groupMemberListMap.forEach((function(e){e.has(r.userID)&&e.get(r.userID).updateMember({nick:r.nick,avatar:r.avatar})}))},o=0;o<n.length;o++)r(o)}},{key:"deleteGroupMemberList",value:function(e){this.groupMemberListMap.delete(e)}},{key:"getGroupMemberList",value:function(e){var t,n=this,r=e.groupID,o=e.role,i=void 0===o?void 0:o,a=e.offset,s=void 0===a?0:a,u=e.count,c=void 0===u?15:u,l=e.filter,d=void 0===l?void 0:l,f="".concat(this._n,".").concat("getGroupMemberList"),p=this._groupModule.hasLocalGroup(r);if(Ge.l("".concat(f," groupID:").concat(r," role:").concat(i," offset:").concat(s," count:").concat(c," hasLocalGroup:").concat(p)),!p)return Bn({memberList:[],offset:0});if(this._groupModule.getLocalGroupProfile(r).type===O.GRP_AVCHATROOM){if(this._groupModule.canIUse(q.AVCHATROOM_MBR_LIST))return this._getAVChatRoomMemberList({groupID:r,offset:s,filter:d});this._groupModule.outputWarning("LiveOnlineMember")}i!==O.GRP_MBR_ROLE_ADMIN&&i!==O.GRP_MBR_ROLE_OWNER&&i!==O.GRP_MBR_ROLE_MEMBER||(t=i);var h=new ar("getGroupMemberList"),g=0,v={groupID:r,limit:c>100?100:c,memberRoleFilter:t?[t]:void 0,memberInfoFilter:this.DEFAULT_MEMBER_INFO_FILTER};Ct({groupID:r})?v.next="".concat(s):(v.offset=s,g=s+c);var _=[];return this._groupModule.request({protocolName:Kn.GET_GROUP_MEMBER_LIST,requestData:v}).then((function(e){var t=e.data,o=t.members,i=t.memberNum,a=t.next,s=void 0===a?void 0:a;return at(s)||(g=Qt(s)?0:s),it(o)&&0!==o.length?(n._groupModule.hasLocalGroup(r)&&(n._groupModule.getLocalGroupProfile(r).memberNum=i),_=n._updateLocalGroupMemberMap(r,o),n._groupModule.getModule(4).getUserProfile({userIDList:o.map((function(e){return e.userID})),tagList:[Fe.NICK,Fe.AVATAR]})):(g=0,Promise.resolve([]))})).then((function(e){var t=e.data;if(!it(t)||0===t.length)return Bn({memberList:[],offset:g});var o=t.map((function(e){return{userID:e.userID,nick:e.nick,avatar:e.avatar}}));return n._updateLocalGroupMemberMap(r,o),_.length<c&&(g=0),h.setNetworkType(n._groupModule.getNetworkType()).setMessage("groupID:".concat(r," offset:").concat(s," count:").concat(c)).end(),Ge.l("".concat(f," ok.")),xn({memberList:_,offset:g})})).catch((function(e){return n._groupModule.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];h.setError(e,r,o).end()})),Ge.e("".concat(f," failed. error:"),e),jn(e)}))}},{key:"_getAVChatRoomMemberList",value:function(e){var n=this,r=e.groupID,o=e.offset,i=e.filter,a="".concat(this._n,".").concat("_getAVChatRoomMemberList"),s=new ar("_getAVChatRoomMemberList");return s.setMessage("groupID:".concat(r," offset:").concat(o," filter:").concat(i)),this._groupModule.request({protocolName:Kn.GET_AVCHATROOM_MEMBER_LIST,requestData:{groupID:r,offset:o,filter:i}}).then((function(e){var o=e.data,i=o.memberList,u=void 0===i?[]:i,c=o.offset,l=void 0===c?0:c;s.setNetworkType(n._groupModule.getNetworkType()).end(),Ge.l("".concat(a," ok. member count:").concat(u.length,", next request timestamp:").concat(l));var d=u.map((function(e){return t(t({},e),{},{onlineStatus:"Online"})})),f=n._updateLocalGroupMemberMap(r,d);return xn({memberList:f,offset:l})})).catch((function(e){return n._groupModule.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];s.setError(e,r,o).end()})),Ge.e("".concat(a," failed. error:"),e),jn(e)}))}},{key:"getGroupMemberProfile",value:function(e){var n=this,r="getGroupMemberProfile",o="".concat(this._n,".").concat(r),i="groupID:".concat(e.groupID);e.userIDList.length>5?i+=" userIDList.length:".concat(e.userIDList.length):i+=" userIDList:".concat(e.userIDList),Ge.l("".concat(o," ").concat(i)),e.userIDList.length>50&&(e.userIDList=e.userIDList.slice(0,50));var a=e.groupID,s=e.userIDList,u=this._groupModule.getLocalGroupProfile(a);if(u&&Et(u.type)){var c=qn.OPERATION_NOT_SUPPORTED_IN_AVCHATROOM;return jn({code:c,message:this._groupModule.getErrorMessage(c,r)})}var l=new ar(r);return l.setMessage(i),this._getGroupMemberProfileAdvance(t(t({},e),{},{userIDList:s})).then((function(e){var t=e.data.members;return it(t)&&0!==t.length?(n._updateLocalGroupMemberMap(a,t),n._groupModule.getModule(4).getUserProfile({userIDList:t.map((function(e){return e.userID})),tagList:[Fe.NICK,Fe.AVATAR]})):Bn([])})).then((function(e){var t=e.data.map((function(e){return{userID:e.userID,nick:e.nick,avatar:e.avatar}}));n._updateLocalGroupMemberMap(a,t);var r=s.filter((function(e){return n.hasLocalGroupMember(a,e)})).map((function(e){return n.getLocalGroupMemberInfo(a,e)}));return l.setNetworkType(n._groupModule.getNetworkType()).end(),xn({memberList:r})}))}},{key:"addGroupMember",value:function(e){var t=this,n="".concat(this._n,".").concat("addGroupMember"),r=e.groupID,o=this._groupModule.getLocalGroupProfile(r),i=o.type,a=new ar("addGroupMember");if(a.setMessage("groupID:".concat(r," groupType:").concat(i)),Et(i)){var s=new Fn({code:qn.CANNOT_ADD_MEMBER_IN_AVCHATROOM});return a.setError(s,!0,this._groupModule.getNetworkType()).end(),jn(s)}return e.userIDList=e.userIDList.map((function(e){return{userID:e}})),Ge.l("".concat(n," groupID:").concat(r)),this._groupModule.request({protocolName:Kn.ADD_GROUP_MEMBER,requestData:e}).then((function(r){var i=r.data.members;Ge.l("".concat(n," ok"));var s=i.filter((function(e){return 1===e.result})).map((function(e){return e.userID})),u=i.filter((function(e){return 0===e.result})).map((function(e){return e.userID})),c=i.filter((function(e){return 2===e.result})).map((function(e){return e.userID})),l=i.filter((function(e){return 4===e.result})).map((function(e){return e.userID})),d="groupID:".concat(e.groupID,", ")+"successUserIDList:".concat(s,", ")+"failureUserIDList:".concat(u,", ")+"existedUserIDList:".concat(c,", ")+"overLimitUserIDList:".concat(l);return a.setNetworkType(t._groupModule.getNetworkType()).setMoreMessage(d).end(),0===s.length?xn({successUserIDList:s,failureUserIDList:u,existedUserIDList:c,overLimitUserIDList:l}):(o.memberCount+=s.length,t._updateConversationGroupProfile(o),xn({successUserIDList:s,failureUserIDList:u,existedUserIDList:c,overLimitUserIDList:l,group:o}))})).catch((function(e){return t._groupModule.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];a.setError(e,r,o).end()})),Ge.e("".concat(n," failed. error:"),e),jn(e)}))}},{key:"deleteGroupMember",value:function(e){var t=this,n="".concat(this._n,".").concat("deleteGroupMember"),r=e.groupID,o=e.userIDList,i=this._groupModule.getLocalGroupProfile(r);if(at(i))return jn({code:qn.CANNOT_FIND_GRP});if(Et(i.type))return this._groupModule.canIUse(q.AVCHATROOM_BAN_MBR)?this._banAVChatRoomMember(e):this._groupModule.cannotUseCommercialAbility("deleteGroupMember");var a="groupID:".concat(r," ").concat(o.length>5?"userIDList.length:".concat(o.length):"userIDList:".concat(o));Ge.l("".concat(n," groupID:").concat(r," userIDList:"),o);var s=new ar("deleteGroupMember");return s.setMessage(a),this._groupModule.request({protocolName:Kn.DELETE_GROUP_MEMBER,requestData:e}).then((function(){return s.setNetworkType(t._groupModule.getNetworkType()).end(),Ge.l("".concat(n," ok")),i.memberCount-=1,t._updateConversationGroupProfile(i),t.deleteLocalGroupMembers(r,o),xn({group:i,userIDList:o})})).catch((function(e){return t._groupModule.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];s.setError(e,r,o).end()})),Ge.e("".concat(n," failed. error:"),e),jn(e)}))}},{key:"_updateConversationGroupProfile",value:function(e){this._groupModule.getModule(11).updateConversationGroupProfile([e])}},{key:"_banAVChatRoomMember",value:function(e){var t=this,n="".concat(this._n,".").concat("_banAVChatRoomMember"),r=e.groupID,o=e.userIDList,i="groupID:".concat(r," ").concat(o.length>5?"userIDList.length:".concat(o.length):"userIDList:".concat(o)),a=new ar("_banAVChatRoomMember");a.setMessage(i),Ge.l("".concat(n," groupID:").concat(r," userIDList:"),o);var s=this._groupModule.getLocalGroupProfile(r);return at(e.duration)||0===e.duration?jn({code:qn.BAN_DURATION_INVALID}):this._groupModule.request({protocolName:Kn.BAN_AVCHATROOM_MEMBER,requestData:e}).then((function(){return a.setNetworkType(t._groupModule.getNetworkType()).end(),Ge.l("".concat(n," ok")),t.deleteLocalGroupMembers(r,o),xn({group:s,userIDList:o})})).catch((function(e){return t._groupModule.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];a.setError(e,r,o).end()})),Ge.e("".concat(n," failed. error:"),e),jn(e)}))}},{key:"setGroupMemberMuteTime",value:function(e){var t=this,n=e.groupID,r=e.userID,o=e.muteTime,i="".concat(this._n,".").concat("setGroupMemberMuteTime");if(r===this._groupModule.getMyUserID())return jn({code:qn.CANNOT_MUTE_SELF});var a="groupID:".concat(n," userID:").concat(r," muteTime:").concat(o);Ge.l("".concat(i," ").concat(a));var s=new ar("setGroupMemberMuteTime");return s.setMessage(a),this.modifyGroupMemberInfo({groupID:n,userID:r,muteTime:o}).then((function(e){s.setNetworkType(t._groupModule.getNetworkType()).end(),Ge.l("".concat(i," ok"));var r=t._groupModule.getLocalGroupProfile(n);return xn({group:r,member:e})})).catch((function(e){return t._groupModule.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];s.setError(e,r,o).end()})),Ge.e("".concat(i," failed. error:"),e),jn(e)}))}},{key:"setGroupMemberRole",value:function(e){var t=this,n="".concat(this._n,".").concat("setGroupMemberRole"),r=e.groupID,o=e.userID,i=e.role,a="groupID:".concat(r," userID:").concat(o," role:").concat(i),s=this._groupModule.getLocalGroupProfile(r);if(!s||s.type===O.GRP_WORK||s.type===O.GRP_AVCHATROOM)return jn({code:qn.CANNOT_SET_MEMBER_ROLE_IN_WORK_AND_AVCHATROOM});if(s&&s.selfInfo.role!==O.GRP_MBR_ROLE_OWNER)return jn({code:qn.NOT_OWNER});var u=[O.GRP_MBR_ROLE_ADMIN,O.GRP_MBR_ROLE_MEMBER];if(Ct({groupID:r})&&u.push(O.GRP_MBR_ROLE_CUSTOM),u.indexOf(i)<0)return jn({code:qn.INVALID_MEMBER_ROLE});if(o===this._groupModule.getMyUserID())return jn({code:qn.CANNOT_SET_SELF_MEMBER_ROLE});var c=new ar("setGroupMemberRole");return c.setMessage(a),Ge.l("".concat(n," ").concat(a)),this.modifyGroupMemberInfo({groupID:r,userID:o,role:i}).then((function(e){return c.setNetworkType(t._groupModule.getNetworkType()).end(),Ge.l("".concat(n," ok")),xn({group:s,member:e})})).catch((function(e){return t._groupModule.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];c.setError(e,r,o).end()})),Ge.e("".concat(n," failed. error:"),e),jn(e)}))}},{key:"_filterProfanity",value:function(e,t){var n=this._groupModule.getModule(29);if(!n)return!0;var r=n.filterText(t[e],"group_member_profile"),o=r.isAllowedToSend,i=r.modifiedText;return!0===o&&(t[e]=i,!0)}},{key:"setGroupMemberNameCard",value:function(e){var t=this,n="setGroupMemberNameCard",r="".concat(this._n,".").concat(n);if(e.nameCard&&!1===this._filterProfanity("nameCard",e))return jn({code:qn.PROFANITY_FOUND});var o=e.groupID,i=e.userID,a=void 0===i?this._groupModule.getMyUserID():i,s=e.nameCard,u="groupID:".concat(o," userID:").concat(a," nameCard:").concat(s);Ge.l("".concat(r," ").concat(u));var c=this._groupModule.getLocalGroupProfile(o);if(c&&Et(c.type)){var l=qn.OPERATION_NOT_SUPPORTED_IN_AVCHATROOM;return jn({code:l,message:this._groupModule.getErrorMessage(l,n)})}var d=new ar(n);return d.setMessage(u),this.modifyGroupMemberInfo({groupID:o,userID:a,nameCard:s}).then((function(e){Ge.l("".concat(r," ok")),d.setNetworkType(t._groupModule.getNetworkType()).end();var n=t._groupModule.getLocalGroupProfile(o);return a===t._groupModule.getMyUserID()&&n&&n.setSelfNameCard(s),xn({group:n,member:e})})).catch((function(e){return t._groupModule.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];d.setError(e,r,o).end()})),Ge.e("".concat(r," failed. error:"),e),jn(e)}))}},{key:"setGroupMemberCustomField",value:function(e){var t=this,n="setGroupMemberCustomField",r="".concat(this._n,".").concat(n),o=e.groupID,i=e.userID,a=void 0===i?this._groupModule.getMyUserID():i,s=e.memberCustomField,u="groupID:".concat(o," userID:").concat(a," memberCustomField:").concat(JSON.stringify(s));Ge.l("".concat(r," ").concat(u));var c=this._groupModule.getLocalGroupProfile(o);if(c&&Et(c.type)){var l=qn.OPERATION_NOT_SUPPORTED_IN_AVCHATROOM;return jn({code:l,message:this._groupModule.getErrorMessage(l,n)})}var d=new ar(n);return d.setMessage(u),this.modifyGroupMemberInfo({groupID:o,userID:a,memberCustomField:s}).then((function(e){d.setNetworkType(t._groupModule.getNetworkType()).end(),Ge.l("".concat(r," ok"));var n=t._groupModule.getLocalGroupProfile(o);return xn({group:n,member:e})})).catch((function(e){return t._groupModule.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];d.setError(e,r,o).end()})),Ge.e("".concat(r," failed. error:"),e),jn(e)}))}},{key:"modifyGroupMemberInfo",value:function(e){var n=this,r=e.groupID,o=e.userID,i=void 0;return kt(r)&&(r=Vt(i=r)),this._groupModule.request({protocolName:Kn.MODIFY_GROUP_MEMBER_INFO,requestData:t(t({},e),{},{groupID:r,topicID:i})}).then((function(){if(n.hasLocalGroupMember(r,o)){var t=n.getLocalGroupMemberInfo(r,o);return at(e.muteTime)||t.updateMuteUntil(e.muteTime),at(e.role)||t.updateRole(e.role),at(e.nameCard)||t.updateNameCard(e.nameCard),at(e.memberCustomField)||t.updateMemberCustomField(e.memberCustomField),t}var i=n._groupModule.getLocalGroupProfile(r);if(i&&!Et(i.type))return n.getGroupMemberProfile({groupID:r,userIDList:[o]}).then((function(e){return M(e.data.memberList,1)[0]}))}))}},{key:"markGroupMemberList",value:function(e){var t=this,n="".concat(this._n,".").concat("markGroupMemberList"),r=e.groupID,o=e.markType,i=e.enableMark,a=e.userIDList,s=void 0===a?[]:a,u="groupID:".concat(r," markType:").concat(o," enableMark:").concat(i," userIDList count:").concat(s.length);Ge.l("".concat(n," ").concat(u));var c=2,l=[];!0===i&&(c=1);var d=T(s);s.length>500&&(d=s.slice(0,500),Ge.w("".concat(n," ").concat(Wt(500)))),d.forEach((function(e){l.push({userID:e,markType:[o]})})),d=null;var f=new ar("markGroupMemberList");return f.setMessage(u),this._groupModule.request({protocolName:Kn.MARK_AVCHATROOM_MEMBER_INFO,requestData:{groupID:r,operationType:c,memberList:l}}).then((function(e){var r=e.data.memberList,o=void 0===r?[]:r,i=[],a=[];o.length===s.length?i.push.apply(i,T(s)):(o.forEach((function(e){i.push(e.userID)})),s.forEach((function(e){i.includes(e)||a.push(e)})));var u="success count:".concat(i.length," fail count:").concat(a.length);return f.setNetworkType(t._groupModule.getNetworkType()).setMessage(u).end(),Ge.l("".concat(n," ok. ").concat(u)),xn({successUserIDList:i,failureUserIDList:a})})).catch((function(e){return t._groupModule.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];f.setError(e,r,o).end()})),Ge.e("".concat(n," failed. error:"),e),jn(e)}))}},{key:"_getGroupMemberProfileAdvance",value:function(e){return this._groupModule.request({protocolName:Kn.GET_GROUP_MEMBER_PROFILE,requestData:t(t({},e),{},{memberInfoFilter:e.memberInfoFilter?e.memberInfoFilter:this.DEFAULT_MEMBER_INFO_FILTER})})}},{key:"_updateLocalGroupMemberMap",value:function(e,t){var n=this;return it(t)&&0!==t.length?t.map((function(t){return n.hasLocalGroupMember(e,t.userID)?n.getLocalGroupMemberInfo(e,t.userID).updateMember(t):n.setLocalGroupMember(e,new Wr(t)),n.getLocalGroupMemberInfo(e,t.userID)})):[]}},{key:"deleteLocalGroupMembers",value:function(e,t){var n=this.groupMemberListMap.get(e);n&&t.forEach((function(e){n.delete(e)}))}},{key:"getLocalGroupMemberInfo",value:function(e,t){return this.groupMemberListMap.has(e)?this.groupMemberListMap.get(e).get(t):null}},{key:"setLocalGroupMember",value:function(e,t){if(this.groupMemberListMap.has(e))this.groupMemberListMap.get(e).set(t.userID,t);else{var n=(new Map).set(t.userID,t);this.groupMemberListMap.set(e,n)}}},{key:"getLocalGroupMemberList",value:function(e){return this.groupMemberListMap.get(e)}},{key:"hasLocalGroupMember",value:function(e,t){return this.groupMemberListMap.has(e)&&this.groupMemberListMap.get(e).has(t)}},{key:"hasLocalGroupMemberMap",value:function(e){return this.groupMemberListMap.has(e)}},{key:"reset",value:function(){this.groupMemberListMap.clear()}}]),e}(),zr=function(){function e(t){a(this,e),this._groupModule=t,this._n="GroupSystemNoticeHandler",this.pendencyMap=new Map}return c(e,[{key:"onNewGroupSystemNotice",value:function(e){var t=e.dataList,n=e.isSyncingEnded,r=e.isInstantMessage;Ge.d("".concat(this._n,".onReceiveSystemNotice count:").concat(t.length));var o=this.newSystemNoticeStoredAndSummary({notifiesList:t,isInstantMessage:r}),i=o.eventDataList,a=o.result;i.length>0&&(this._groupModule.getModule(11).onNewMessage({conversationOptionsList:i,isInstantMessage:r}),this._onReceivedGroupSystemNotice({result:a,isInstantMessage:r})),r?a.length>0&&this._groupModule.emitOuterEvent(A.MESSAGE_RECEIVED,a):!0===n&&this._clearGroupSystemNotice()}},{key:"newSystemNoticeStoredAndSummary",value:function(e){var n=e.notifiesList,r=e.isInstantMessage,o=null,i=n.length,a=0,s=[],u={conversationID:O.CONV_SYSTEM,unreadCount:0,type:O.CONV_SYSTEM,subType:null,lastMessage:null};for(a=0;a<i;a++){var c=n[a],l=c.groupProfile,d=l.communityType,f=void 0===d?0:d,p=l.topicID,h=void 0===p?void 0:p,g=c.elements,v=g.topicIDList,_=void 0===v?void 0:v,m=g.operationType;if(!(2!==f||Qt(h)&&Qt(_))){if([17,18,20].includes(m)){this._handleTopicSystemNotice(c);continue}Qt(h)||(c.to=h)}15!==c.elements.operationType&&(c.currentUser=this._groupModule.getMyUserID(),c.conversationType=O.CONV_SYSTEM,c.conversationID=O.CONV_SYSTEM,(o=new Tr(c)).setElement({type:O.MSG_GRP_SYS_NOTICE,content:t(t({},c.elements),{},{groupProfile:t({},c.groupProfile)})}),o.isSystemMessage=!0,(1===o.sequence&&1===o.random||2===o.sequence&&2===o.random)&&(o.sequence=vt(),o.random=vt(),o.generateMessageID(),Ge.l("".concat(this._n,".newSystemNoticeStoredAndSummary sequence and random maybe duplicated, regenerate. ID:").concat(o.ID))),this._groupModule.getModule(11).pushIntoNoticeResult(s,o)&&(r?u.unreadCount++:o.setIsRead(!0),u.subType=o.conversationSubType))}return u.lastMessage=s[s.length-1],{eventDataList:s.length>0?[u]:[],result:s}}},{key:"_clearGroupSystemNotice",value:function(){var e=this;this._getPendencyList().then((function(t){t.forEach((function(t){e.pendencyMap.set("".concat(t.from,"_").concat(t.groupID,"_").concat(t.to),t)}));var n=e._groupModule.getModule(11).getLocalMessageList(O.CONV_SYSTEM),r=[];n.forEach((function(t){var n=t.payload,o=n.operatorID,i=n.operationType,a=n.groupProfile;if(1===i){var s="".concat(o,"_").concat(a.groupID,"_").concat(a.to),u=e.pendencyMap.get(s);u&&et(u.handled)&&0!==u.handled&&r.push(t)}})),e.deleteGroupSystemNotice({messageList:r})}))}},{key:"deleteGroupSystemNotice",value:function(e){var t=this,n="".concat(this._n,".deleteGroupSystemNotice");return it(e.messageList)&&0!==e.messageList.length?(Ge.l("".concat(n," ")+e.messageList.map((function(e){return e.ID}))),this._groupModule.request({protocolName:Kn.DELETE_GROUP_SYSTEM_NOTICE,requestData:{messageListToDelete:e.messageList.map((function(e){return{from:O.CONV_SYSTEM,messageSeq:e.clientSequence,messageRandom:e.random}}))}}).then((function(){Ge.l("".concat(n," ok"));var r=t._groupModule.getModule(11);return e.messageList.forEach((function(e){r.deleteLocalMessage(e)})),xn()})).catch((function(e){return Ge.e("".concat(n," error:"),e),jn(e)}))):Bn()}},{key:"_getPendencyList",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.type,r=void 0===n?void 0:n,o=t.startTime,i=void 0===o?0:o,a=t.limit,s=void 0===a?20:a;return this._groupModule.request({protocolName:Kn.GET_GROUP_PENDENCY,requestData:{type:r,startTime:i,limit:s,handleAccount:this._groupModule.getMyUserID()}}).then((function(t){var n=t.data.pendencyList;return 0!==t.data.nextStartTime?e._getPendencyList({startTime:t.data.nextStartTime}).then((function(e){return[].concat(T(n),T(e))})):n}))}},{key:"getGroupApplicationList",value:function(){var e=this;return this._getPendencyList().then((function(t){return e._getPendencyList({type:O.GRP_COMMUNITY}).then((function(n){return t.push.apply(t,T(n)),e._handlePendencyResult(t)})).catch((function(n){return e._handlePendencyResult(t)}))}))}},{key:"_handlePendencyResult",value:function(e){var t=this,n=[];return e.forEach((function(e){t.pendencyMap.set("".concat(e.from,"_").concat(e.groupID,"_").concat(e.to),e),0===e.handled&&n.push({applicant:e.from,applicantNick:e.fromUserNickName,groupName:e.groupName,groupID:e.groupID,authentication:e.authentication,messageKey:e.time,applicationType:e.applicationType,userID:e.userID,note:e.note})})),Bn({applicationList:n})}},{key:"_onReceivedGroupSystemNotice",value:function(e){var t=this,n=e.result;e.isInstantMessage&&n.forEach((function(e){switch(e.payload.operationType){case 1:break;case 2:t._onApplyGroupRequestAgreed(e);break;case 3:break;case 4:t._onMemberKicked(e);break;case 5:t._onGroupDismissed(e);break;case 6:break;case 7:t._onInviteGroup(e);break;case 8:t._onQuitGroup(e);break;case 9:t._onSetManager(e);break;case 10:t._onDeleteManager(e);break;case 11:case 12:case 15:break;case 20:t._onMessageRemindTypeSynced(e);break;case 21:t._groupModule.onAVChatRoomMemberBanned(e)}}))}},{key:"_onApplyGroupRequestAgreed",value:function(e){var t=this,n=e.payload.groupProfile.groupID;this._groupModule.hasLocalGroup(n)||this._groupModule.getGroupProfile({groupID:n}).then((function(e){var n=e.data.group;if(n){t._groupModule.updateGroupMap([n]);var r=!n.isSupportTopic;t._groupModule.emitGroupListUpdate(!0,r)}}))}},{key:"_onMemberKicked",value:function(e){var t=e.payload.groupProfile.groupID;this._groupModule.hasLocalGroup(t)&&this._groupModule.deleteLocalGroupAndConversation(t)}},{key:"_onGroupDismissed",value:function(e){var t=e.payload.groupProfile.groupID;this._groupModule.hasLocalGroup(t)&&this._groupModule.deleteLocalGroupAndConversation(t);var n=this._groupModule._AVChatRoomHandler;n&&n.checkJoinedAVChatRoomByID(t)&&n.reset(t)}},{key:"_onInviteGroup",value:function(e){var t=this,n=e.payload.groupProfile.groupID;this._groupModule.hasLocalGroup(n)||this._groupModule.getGroupProfile({groupID:n}).then((function(e){var n=e.data.group;n&&(t._groupModule.updateGroupMap([n]),t._groupModule.emitGroupListUpdate())}))}},{key:"_onQuitGroup",value:function(e){var t=e.payload.groupProfile.groupID;this._groupModule.hasLocalGroup(t)&&this._groupModule.deleteLocalGroupAndConversation(t)}},{key:"_onSetManager",value:function(e){var t=e.payload.groupProfile,n=t.to,r=t.groupID,o=this._groupModule.getGroupMemberHandler().getLocalGroupMemberInfo(r,n);o&&o.updateRole(O.GRP_MBR_ROLE_ADMIN)}},{key:"_onDeleteManager",value:function(e){var t=e.payload.groupProfile,n=t.to,r=t.groupID,o=this._groupModule.getGroupMemberHandler().getLocalGroupMemberInfo(r,n);o&&o.updateRole(O.GRP_MBR_ROLE_MEMBER)}},{key:"_onMessageRemindTypeSynced",value:function(e){var t=e.payload.groupProfile.groupID,n=e.payload.messageRemindType;this._groupModule.getModule(11).onGroupMessageRemindTypeUpdated({groupID:t,messageRemindType:n})}},{key:"_handleTopicSystemNotice",value:function(e){var t=e.groupProfile,n=t.groupID,r=t.topicID,o=e.elements,i=o.operationType,a=o.topicIDList,s=o.messageRemindType,u=this._groupModule.getModule(10);17===i?u.onTopicCreated({groupID:n,topicID:r}):18===i?u.onTopicDeleted({groupID:n,topicIDList:a}):20===i&&u.onTopicMessageRemindTypeUpdated({groupID:n,topicID:r,messageRemindType:s})}},{key:"reset",value:function(){this.pendencyMap.clear()}}]),e}(),Jr=["relayFlag"],Xr=function(e){d(r,e);var n=I(r);function r(e){var t;return a(this,r),(t=n.call(this,e))._n="GroupModule",t._commonGroupHandler=new qr(m(t)),t._groupAttributesHandler=new Vr(m(t)),t._groupCountersHandler=new Br(m(t)),t._AVChatRoomHandler=new Kr(m(t)),t._groupTipsHandler=new Fr(m(t)),t._groupSystemNoticeHandler=new zr(m(t)),t._groupMemberHandler=new Yr(m(t)),t.groupMap=new Map,t._unjoinedAVChatRoomList=new Map,t._receiptDetailCompleteMap=new Map,t._onlineMemberCountMap=new Map,t._timeoutIDs=[],t.getInnerEmitterInstance().on(Cr.CLOUD_CONFIG_UPDATED,t._onCloudConfigUpdated,m(t)),t}return c(r,[{key:"_onCloudConfigUpdated",value:function(){var e=this.getCloudConfig("polling_interval"),t=this.getCloudConfig("polling_interval_plus"),n=this.getCloudConfig("polling_no_msg_count"),r=this.getCloudConfig("polling_simplified_msg"),o=this.getCloudConfig("paging_grp_count");Ge.l("".concat(this._n,"._onCloudConfigUpdated pollingInterval:").concat(e)+" pollingIntervalPlus:".concat(t," pollingNoMessageCount:").concat(n)+" pollingSimplifiedMessage:".concat(r," pagingGroupCount:").concat(o)),this._AVChatRoomHandler.setPollingInterval(e),this._AVChatRoomHandler.setPollingIntervalPlus(t),this._AVChatRoomHandler.setPollingNoMessageCount(n),this._AVChatRoomHandler.setPollingSimplifiedMessage(r),this._commonGroupHandler.setPagingGroupCount(o)}},{key:"onCheckTimer",value:function(e){this.isLoggedIn()&&(this._commonGroupHandler.onCheckTimer(e),this._groupTipsHandler.onCheckTimer(e))}},{key:"guardForAVChatRoom",value:function(e){var t=this;if(e.conversationType===O.CONV_GROUP){var n=kt(e.to)?Vt(e.to):e.to;return this.hasLocalGroup(n)?Bn():this.getGroupProfile({groupID:n}).then((function(r){var o=r.data.group.type;if(Ge.l("".concat(t._n,".guardForAVChatRoom. groupID:").concat(n," type:").concat(o)),o===O.GRP_AVCHATROOM){var i=qn.MSG_SEND_FAIL_NOT_IN_AVCHATROOM;return jn(new Fn({code:i,message:t.getErrorMessage(i,e.from,n),data:{message:e}}))}return Bn()}))}return Bn()}},{key:"checkJoinedAVChatRoomByID",value:function(e){return this._AVChatRoomHandler.checkJoinedAVChatRoomByID(e)}},{key:"onNewGroupMessage",value:function(e){this._commonGroupHandler.onNewGroupMessage(e)}},{key:"updateNextMessageSeq",value:function(e){var t=this;if(it(e)){var n=this.getModule(10);e.forEach((function(e){var r=e.conversationID.replace(O.CONV_GROUP,"");kt(r)&&n.updateLastMessage(r,e.lastMessage),t.groupMap.has(r)&&(t.groupMap.get(r).nextMessageSeq=e.lastMessage.sequence+1)}))}}},{key:"onNewGroupTips",value:function(e){this._groupTipsHandler.onNewGroupTips(e)}},{key:"onGroupMessageRevoked",value:function(e){this._commonGroupHandler.onGroupMessageRevoked(e)}},{key:"onNewGroupSystemNotice",value:function(e){this._groupSystemNoticeHandler.onNewGroupSystemNotice(e)}},{key:"onGroupMessageReadNotice",value:function(e){var t=this;e.dataList.forEach((function(e){var n=e.elements.groupMessageReadNotice;if(!at(n)){var r=t.getModule(11);n.forEach((function(e){var n=e.groupID,o=e.topicID,i=void 0===o?void 0:o,a=e.lastMessageSeq;Ge.d("".concat(t._n,".onGroupMessageReadNotice groupID:").concat(n," lastMessageSeq:").concat(a));var s="".concat(O.CONV_GROUP).concat(n),u=!0;Qt(i)||(s="".concat(O.CONV_GROUP).concat(i),u=!1),r.updateIsReadAfterReadReport({conversationID:s,lastMessageSeq:a}),r.updateUnreadCount(s,u),r.clearGroupAtInfoList(s,u)}))}}))}},{key:"onReadReceiptList",value:function(e){var t=this;Ge.d("".concat(this._n,".onReadReceiptList options:"),JSON.stringify(e)),e.dataList.forEach((function(e){var n=e.groupProfile,r=e.elements,o=n.groupID,i=t.getModule(11),a=r.readReceiptList;i.updateReadReceiptInfo({groupID:o,readReceiptList:a})}))}},{key:"onGroupMessageModified",value:function(e){Ge.d("".concat(this._n,".onGroupMessageModified options:"),JSON.stringify(e));var n=this.getModule(11);e.dataList.forEach((function(e){n.onMessageModified(t(t({},e),{},{conversationType:O.CONV_GROUP,to:e.topicID?e.topicID:e.groupID}))}))}},{key:"deleteGroupSystemNotice",value:function(e){this._groupSystemNoticeHandler.deleteGroupSystemNotice(e)}},{key:"initGroupMap",value:function(e){this.groupMap.set(e.groupID,new wr(e))}},{key:"clearGroupMap",value:function(){this.groupMap.clear()}},{key:"deleteGroup",value:function(e){this.groupMap.delete(e)}},{key:"updateGroupMap",value:function(e){var t,n=this,r=this.getModule(11);e.forEach((function(e){t=e.groupID,n.groupMap.has(t)?n.groupMap.get(t).updateGroup(e):(n.groupMap.set(t,new wr(e)),r.deleteGroupRoamingMessageInfo(t))}));var o,i=this.getMyUserID(),a=D(this.groupMap);try{for(a.s();!(o=a.n()).done;){var s=M(o.value,2)[1];s.selfInfo.userID=i,"Owner"===s.selfInfo.role&&(s.ownerID=i)}}catch(f){a.e(f)}finally{a.f()}}},{key:"getGroupMap",value:function(){return this.groupMap}},{key:"getLocalGroupList",value:function(){return T(this.groupMap.values())}},{key:"getLocalGroupProfile",value:function(e){return this.groupMap.get(e)}},{key:"sortLocalGroupList",value:function(){var e=T(this.groupMap).filter((function(e){var t=M(e,2);return t[0],!Qt(t[1].lastMessage)}));e.sort((function(e,t){return t[1].lastMessage.lastTime-e[1].lastMessage.lastTime})),this.groupMap=new Map(T(e))}},{key:"updateGroupLastMessage",value:function(e){this._commonGroupHandler.handleUpdateGroupLastMessage(e)}},{key:"emitGroupListUpdate",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.getLocalGroupList();if(e&&this.emitOuterEvent(A.GROUP_LIST_UPDATED),t){var r=JSON.parse(JSON.stringify(n)),o=this.getModule(11);o.updateConversationGroupProfile(r)}}},{key:"getMyNameCardByGroupID",value:function(e){var t=this.getLocalGroupProfile(e);return t?t.selfInfo.nameCard:""}},{key:"isPagingGetCompleted",value:function(){return this._commonGroupHandler.isPagingGetCompleted()}},{key:"getMessageRemindType",value:function(e){var t=this;if(it(e)&&0!==e.length){var n=e.filter((function(e){return!Et(t.getLocalGroupProfile(e).type)}));0!==n.length&&(Ge.l("".concat(this._n,".getMessageRemindType groupIDList:").concat(n)),this.getGroupProfileAdvance({groupIDList:n,responseFilter:{memberInfoFilter:["MsgFlag"]}}).then((function(e){var n=e.data.successGroupList,r=t.getModule(11);n.forEach((function(e){r.onGroupMessageRemindTypeUpdated({groupID:e.groupID,messageRemindType:it(e.members)?e.members[0].messageRemindType:""})}))})))}}},{key:"getGroupList",value:function(){return this._commonGroupHandler.getGroupList()}},{key:"syncCommunityWithTopic",value:function(){return this._commonGroupHandler.syncGroupList(!0)}},{key:"getGroupProfile",value:function(e){var t=this,n="".concat(this._n,".").concat("getGroupProfile"),r=new ar("getGroupProfile"),o=e.groupID,i=e.groupCustomFieldFilter;Ge.l("".concat(n," groupID:").concat(o));var a={groupIDList:[o],responseFilter:{groupBaseInfoFilter:["Type","Name","Introduction","Notification","FaceUrl","Owner_Account","CreateTime","InfoSeq","LastInfoTime","LastMsgTime","MemberNum","MaxMemberNum","ApplyJoinOption","NextMsgSeq","ShutUpAllMember","InviteJoinOption"],groupCustomFieldFilter:i,memberInfoFilter:["Role","JoinTime","MsgSeq","MsgFlag","NameCard"]}};return this.getGroupProfileAdvance(a).then((function(e){var i,a=e.data,s=a.successGroupList,u=a.failureGroupList;return Ge.l("".concat(n," ok")),u.length>0?jn(u[0]):(Et(s[0].type)&&!t.hasLocalGroup(o)?i=new wr(s[0]):(t.updateGroupMap(s),i=t.getLocalGroupProfile(o)),i.isSupportTopic||t.getModule(11).updateConversationGroupProfile([i]),r.setNetworkType(t.getNetworkType()).setMessage("groupID:".concat(o," type:").concat(i.type," muteAllMembers:").concat(i.muteAllMembers," ownerID:").concat(i.ownerID)).end(),xn({group:i}))})).catch((function(o){return t.probeNetwork().then((function(t){var n=M(t,2),i=n[0],a=n[1];r.setError(o,i,a).setMessage("groupID:".concat(e.groupID)).end()})),Ge.e("".concat(n," failed. error:"),o),jn(o)}))}},{key:"getGroupProfileAdvance",value:function(e){var n="".concat(this._n,".getGroupProfileAdvance"),r=e.groupIDList;it(r)&&r.length>50&&(this.outputWarning("GetGroupProfileLimit"),r.length=50);var o=[],i=[];r.forEach((function(e){Ct({groupID:e})?i.push(e):o.push(e)}));var a=[];if(o.length>0){var s=this._getGroupProfileAdvance(t(t({},e),{},{groupIDList:o}));a.push(s)}if(i.length>0){var u=this._getGroupProfileAdvance(t(t({},e),{},{groupIDList:i,relayFlag:o.length>0}));a.push(u)}return Promise.all(a).then((function(e){var t=[],n=[];return e.forEach((function(e){t.push.apply(t,T(e.successGroupList)),n.push.apply(n,T(e.failureGroupList))})),xn({successGroupList:t,failureGroupList:n})})).catch((function(e){return Ge.e("".concat(n," failed. error:"),e),jn(e)}))}},{key:"_getGroupProfileAdvance",value:function(e){var t=this,n=e.relayFlag,r=void 0!==n&&n,o=_(e,Jr);return this.request({protocolName:Kn.GET_GROUP_PROFILE,requestData:o}).then((function(e){Ge.l("".concat(t._n,"._getGroupProfileAdvance ok. options:"),o);var n=e.data.groups;return{successGroupList:n.filter((function(e){return at(e.errorCode)||0===e.errorCode})),failureGroupList:n.filter((function(e){return e.errorCode&&0!==e.errorCode})).map((function(e){return new Fn({code:e.errorCode,message:e.errorInfo,data:{groupID:e.groupID}})}))}})).catch((function(t){return r&&Ct({groupID:e.groupIDList[0]})?{successGroupList:[],failureGroupList:[]}:jn(t)}))}},{key:"createGroup",value:function(e){var n=this,r=[O.GRP_PUBLIC,O.GRP_WORK,O.GRP_MEETING,O.GRP_AVCHATROOM,O.GRP_COMMUNITY],o="".concat(this._n,".").concat("createGroup"),i=e.type,a=e.groupID;if(e.name&&!1===this._filterProfanity("name",e))return jn({code:qn.PROFANITY_FOUND});if(e.introduction&&!1===this._filterProfanity("introduction",e))return jn({code:qn.PROFANITY_FOUND});if(e.notification&&!1===this._filterProfanity("notification",e))return jn({code:qn.PROFANITY_FOUND});if(!r.includes(i))return jn({code:qn.ILLEGAL_GRP_TYPE});if(!Ct({type:i})){if(!Qt(a)&&Ct({groupID:a}))return jn({code:qn.ILLEGAL_GRP_ID});e.isSupportTopic=void 0}if(Et(i)&&!at(e.memberList)&&e.memberList.length>0&&(e.memberList=void 0),this._canIUseJoinOption(i)||at(e.joinOption)||(e.joinOption=void 0),Ct({type:i})){if(!Qt(a)&&!Ct({groupID:a}))return jn({code:qn.ILLEGAL_GRP_ID});e.isSupportTopic=!0===e.isSupportTopic?1:0}var s=new ar("createGroup");Ge.l("".concat(o," options:"),e);var u=null,c=[];return this.request({protocolName:Kn.CREATE_GROUP,requestData:t(t({},e),{},{ownerID:this.getMyUserID(),webPushFlag:1})}).then((function(r){var i=r.data,a=i.groupID,l=i.overLimitUserIDList,d=void 0===l?[]:l;u=a,c=d;var f="groupType:".concat(e.type," groupID:").concat(a," overLimitUserIDList:").concat(d);if(s.setNetworkType(n.getNetworkType()).setMessage(f).end(),Ge.l("".concat(o," ok. ").concat(f)),e.type===O.GRP_AVCHATROOM)return n.getGroupProfile({groupID:a});if(e.type===O.GRP_COMMUNITY&&1===e.isSupportTopic)return n.getGroupProfile({groupID:a});Qt(e.memberList)||Qt(d)||(e.memberList=e.memberList.filter((function(e){return-1===d.indexOf(e.userID)}))),n.updateGroupMap([t(t({},e),{},{groupID:a})]);var p=n.getModule(2),h="",g=0;e.type===O.GRP_COMMUNITY?(h=n.isIntl()?"Create Community":"创建社群",g=1):h=n.isIntl()?"Create Group":"创建群组";var v=n.getModule(4).getMyNick(),_=p.createCustomMessage({to:a,conversationType:O.CONV_GROUP,payload:{data:JSON.stringify({businessID:"group_create",content:h,cmd:g,opUser:v||n.getMyUserID(),version:4})}});return p.sendMessageInstance(_),n.emitGroupListUpdate(),n.getGroupProfile({groupID:a})})).then((function(e){var t=e.data.group,n=t.selfInfo,r=n.nameCard,o=n.joinTime;return t.updateSelfInfo({nameCard:r,joinTime:o,messageRemindType:O.MSG_REMIND_ACPT_AND_NOTE,role:O.GRP_MBR_ROLE_OWNER}),xn({group:t,overLimitUserIDList:c})})).catch((function(r){if(s.setMessage("groupType:".concat(e.type)),n.probeNetwork().then((function(e){var t=M(e,2),n=t[0],o=t[1];s.setError(r,n,o).end()})),10010===r.code||10007===r.code){n._silentlyGetGroupProfile(r.code,u),n.updateGroupMap([t(t({},e),{},{groupID:u})]);var i=n.getLocalGroupProfile(u);return i.selfInfo.role=O.GRP_MBR_ROLE_OWNER,xn({group:i,overLimitUserIDList:c})}return Ge.e("".concat(o," failed. error:"),r),jn(r)}))}},{key:"dismissGroup",value:function(e){var t=this,n="".concat(this._n,".").concat("dismissGroup"),r="groupID:".concat(e);if(this.hasLocalGroup(e)&&this.getLocalGroupProfile(e).type===O.GRP_WORK)return jn(new Fn({code:qn.CANNOT_DISMISS_WORK}));var o=new ar("dismissGroup");return o.setMessage(r),Ge.l("".concat(n," ").concat(r)),this.request({protocolName:Kn.DISMISS_GROUP,requestData:{groupID:e}}).then((function(){return o.setNetworkType(t.getNetworkType()).end(),Ge.l("".concat(n," ok")),t.deleteLocalGroupAndConversation(e),t.checkJoinedAVChatRoomByID(e)&&t._AVChatRoomHandler.reset(e),t._groupAttributesHandler.deleteLocalGroupAttributes(e),xn({groupID:e})})).catch((function(e){return t.probeNetwork().then((function(t){var n=M(t,2),r=n[0],i=n[1];o.setError(e,r,i).end()})),Ge.e("".concat(n," failed. error:"),e),jn(e)}))}},{key:"updateGroupProfile",value:function(e){var t=this,n="".concat(this._n,".").concat("updateGroupProfile");if(this.hasLocalGroup(e.groupID)){var r=this.getLocalGroupProfile(e.groupID).type;this._canIUseJoinOption(r)||at(e.joinOption)||(Ge.w("".concat(n," joinOption is unavailable for Work/Meeting/AVChatRoom")),e.joinOption=void 0)}if(at(e.muteAllMembers)||(e.muteAllMembers?e.muteAllMembers="On":e.muteAllMembers="Off"),e.name&&!1===this._filterProfanity("name",e))return jn({code:qn.PROFANITY_FOUND});if(e.introduction&&!1===this._filterProfanity("introduction",e))return jn({code:qn.PROFANITY_FOUND});if(e.notification&&!1===this._filterProfanity("notification",e))return jn({code:qn.PROFANITY_FOUND});var o=new ar("updateGroupProfile");return o.setMessage(JSON.stringify(e)),Ge.l("".concat(n," groupID:").concat(e.groupID)),this.request({protocolName:Kn.UPDATE_GROUP_PROFILE,requestData:e}).then((function(){return o.setNetworkType(t.getNetworkType()).end(),Ge.l("".concat(n," ok")),t.hasLocalGroup(e.groupID)&&t.groupMap.get(e.groupID).updateGroup(e),xn({group:t.groupMap.get(e.groupID)})})).catch((function(e){return t.probeNetwork().then((function(t){var n=M(t,2),r=n[0],i=n[1];o.setError(e,r,i).end()})),Ge.l("".concat(n," failed. error:"),e),jn(e)}))}},{key:"_filterProfanity",value:function(e,t){var n=this.getModule(29);if(!n)return!0;var r=n.filterText(t[e],V),o=r.isAllowedToSend,i=r.modifiedText;return!0===o&&(t[e]=i,!0)}},{key:"joinGroup",value:function(e){var t=this,n=e.groupID,r=e.type,o="".concat(this._n,".joinGroup");if(r===O.GRP_WORK)return jn({code:qn.CANNOT_JOIN_WORK});if(this.deleteUnjoinedAVChatRoom(n),this.hasLocalGroup(n)){if(!this.isLoggedIn())return Bn({status:O.JOIN_STATUS_ALREADY_IN_GROUP});var i=new ar("applyJoinGroup");return this.getGroupProfile({groupID:n}).then((function(){return i.setNetworkType(t.getNetworkType()).setMessage("groupID:".concat(n," joinedStatus:").concat(O.JOIN_STATUS_ALREADY_IN_GROUP)).end(),Bn({status:O.JOIN_STATUS_ALREADY_IN_GROUP})})).catch((function(r){return i.setNetworkType(t.getNetworkType()).setMessage("groupID:".concat(n," unjoined")).end(),Ge.w("".concat(o," ").concat(n," was unjoined, now join!")),t.groupMap.delete(n),t.applyJoinGroup(e)}))}return Ge.l("".concat(o," groupID:").concat(n)),this.isLoggedIn()?this.applyJoinGroup(e):this._AVChatRoomHandler.joinWithoutAuth(e)}},{key:"applyJoinGroup",value:function(e){var n=this,r="".concat(this._n,".").concat("applyJoinGroup"),o=e.groupID;if(!Qt(e.applyMessage)&&!1===this._filterProfanity("applyMessage",e))return jn({code:qn.PROFANITY_FOUND});var i=new ar("applyJoinGroup"),a=t({},e),s=this.canIUse(q.AVCHATROOM_HISTORY_MSG);return s&&(a.historyMessageFlag=1),this.getModule(11).deleteTopicRoamingMessageInfo(o),this.request({protocolName:Kn.APPLY_JOIN_GROUP,requestData:a}).then((function(e){var t=e.data,a=t.joinedStatus,u=t.longPollingKey,c=t.startSeq,l=t.avChatRoomFlag,d=t.avChatRoomKey,f=t.messageList,p="groupID:".concat(o," joinedStatus:").concat(a," longPollingKey:").concat(u," startSeq:").concat(c)+" avChatRoomFlag:".concat(l," canGetAVChatRoomHistoryMessage:").concat(s,",")+" history message count:".concat(Qt(f)?0:f.length);switch(i.setNetworkType(n.getNetworkType()).setMessage("".concat(p)).end(),Ge.l("".concat(r," ok. ").concat(p)),a){case Je:return xn({status:Je});case ze:return n.getGroupProfile({groupID:o}).then((function(e){var t=e.data.group;return n._handleJoinResult({group:t,avChatRoomFlag:l,longPollingKey:u,startSeq:c,avChatRoomKey:d,messageList:f})})).catch((function(e){if(10010===e.code||10007===e.code){n._silentlyGetGroupProfile(e.code,o);var t=new wr({groupID:o});return n.updateGroupMap([t]),n._handleJoinResult({group:t,avChatRoomFlag:l,longPollingKey:u,startSeq:c,avChatRoomKey:d,messageList:f})}return Ge.e("".concat(r," failed. error:"),e),jn(e)}));default:var h=new Fn({code:qn.JOIN_GRP_FAIL});return Ge.e("".concat(r," failed. error:"),h),jn(h)}})).catch((function(e){return i.setMessage("groupID:".concat(o)),n.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];i.setError(e,r,o).end()})),Ge.e("".concat(r," failed. error:"),e),jn(e)}))}},{key:"_handleJoinResult",value:function(e){var t,n=this,r=e.group,o=e.avChatRoomFlag,i=e.longPollingKey,a=e.startSeq,s=e.avChatRoomKey,u=e.messageList,c=r.groupID;return 1===o?(this.getModule(11).setCompleted("".concat(O.CONV_GROUP).concat(c)),this._groupAttributesHandler.initGroupAttributesCache({groupID:c,avChatRoomKey:s}),this._groupCountersHandler.initGroupCountersCache({groupID:c,avChatRoomKey:s}),(t=at(i)?this._AVChatRoomHandler.handleJoinResult({group:r}):this._AVChatRoomHandler.startRunLoop({group:r,longPollingKey:i,startSeq:a})).then((function(){n._onAVChatRoomHistoryMessage(u,c)})),t):(this.emitGroupListUpdate(!0,!1),xn({status:ze,group:r}))}},{key:"quitGroup",value:function(e){var t=this,n="".concat(this._n,".").concat("quitGroup"),r="groupID:".concat(e);Ge.l("".concat(n," ").concat(r));var o=this.checkJoinedAVChatRoomByID(e);if(!o&&!this.hasLocalGroup(e))return jn({code:qn.MEMBER_NOT_IN_GRP});if(o&&!this.isLoggedIn())return Ge.l("".concat(n," anonymously ok. ").concat(r)),this.deleteLocalGroupAndConversation(e),this._AVChatRoomHandler.reset(e),Bn({groupID:e});var i=new ar("quitGroup");return i.setMessage(r),this.request({protocolName:Kn.QUIT_GROUP,requestData:{groupID:e}}).then((function(){return i.setNetworkType(t.getNetworkType()).end(),Ge.l("".concat(n," ok")),t.deleteLocalGroupAndConversation(e),o&&t._AVChatRoomHandler.reset(e),t._groupAttributesHandler.deleteLocalGroupAttributes(e),xn({groupID:e})})).catch((function(e){return t.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];i.setError(e,r,o).end()})),Ge.e("".concat(n," failed. error:"),e),jn(e)}))}},{key:"searchGroupByID",value:function(e){var t=this,n="".concat(this._n,".").concat("searchGroupByID"),r={groupIDList:[e]},o=new ar("searchGroupByID");return o.setMessage("groupID:".concat(e)),Ge.l("".concat(n," groupID:").concat(e)),this.request({protocolName:Kn.SEARCH_GROUP,requestData:r}).then((function(e){var r=e.data.groupProfile;if(0!==r[0].errorCode)throw new Fn({code:r[0].errorCode,message:r[0].errorInfo});return o.setNetworkType(t.getNetworkType()).end(),Ge.l("".concat(n," ok")),xn({group:new wr(r[0])})})).catch((function(e){return t.probeNetwork().then((function(t){var n=M(t,2),r=n[0],i=n[1];o.setError(e,r,i).end()})),Ge.w("".concat(n," failed. error:"),e),jn(e)}))}},{key:"changeGroupOwner",value:function(e){var t=this,n="".concat(this._n,".").concat("changeGroupOwner");if(this.hasLocalGroup(e.groupID)&&this.getLocalGroupProfile(e.groupID).type===O.GRP_AVCHATROOM)return jn({code:qn.CANNOT_CHANGE_OWNER_IN_AVCHATROOM});if(e.newOwnerID===this.getMyUserID())return jn({code:qn.CANNOT_CHANGE_OWNER_TO_SELF});var r=new ar("changeGroupOwner");return r.setMessage("groupID:".concat(e.groupID," newOwnerID:").concat(e.newOwnerID)),Ge.l("".concat(n," groupID:").concat(e.groupID)),this.request({protocolName:Kn.CHANGE_GROUP_OWNER,requestData:e}).then((function(){r.setNetworkType(t.getNetworkType()).end(),Ge.l("".concat(n," ok"));var o=e.groupID,i=e.newOwnerID;t.groupMap.get(o).ownerID=i;var a=t._groupMemberHandler.getLocalGroupMemberList(o);if(a instanceof Map){var s=a.get(t.getMyUserID());at(s)||(s.updateRole("Member"),t.groupMap.get(o).selfInfo.role="Member");var u=a.get(i);at(u)||u.updateRole("Owner")}return t.emitGroupListUpdate(!0,!1),xn({group:t.groupMap.get(o)})})).catch((function(e){return t.probeNetwork().then((function(t){var n=M(t,2),o=n[0],i=n[1];r.setError(e,o,i).end()})),Ge.e("".concat(n," failed. error:"),e),jn(e)}))}},{key:"getGroupApplicationList",value:function(){return this._groupSystemNoticeHandler.getGroupApplicationList()}},{key:"handleGroupApplication",value:function(e){var t,n,r,o,i,a=this,s="".concat(this._n,".").concat("handleGroupApplication"),u=e.handleAction,c=e.handleMessage,l=e.message,d=e.application;l?(t=l.payload.operatorID,n=l.payload.groupProfile.groupID,r=l.payload.authentication,o=l.payload.messageKey):d&&(t=d.applicant,n=d.groupID,r=d.authentication,o=d.messageKey);var f=Kn.HANDLE_GROUP_APPLICATION;d&&2===d.applicationType&&(f=Kn.HANDLE_INVITE_JOIN_GROUP,i=d.userID);var p=new ar("handleGroupApplication");return p.setMessage("groupID:".concat(n)),Ge.l("".concat(s," groupID:").concat(n)),this.request({protocolName:f,requestData:{handleAction:u,handleMessage:c,applicant:t,invitee:i,groupID:n,authentication:r,messageKey:o}}).then((function(){return p.setNetworkType(a.getNetworkType()).end(),Ge.l("".concat(s," ok")),l&&a._groupSystemNoticeHandler.deleteGroupSystemNotice({messageList:[e.message]}),xn({group:a.getLocalGroupProfile(n)})})).catch((function(e){return a.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];p.setError(e,r,o).end()})),Ge.e("".concat(s," failed. error"),e),jn(e)}))}},{key:"handleGroupInvitation",value:function(e){var n=this,r="".concat(this._n,".").concat("handleGroupInvitation"),o=e.message.payload,i=o.groupProfile.groupID,a=o.authentication,s=o.messageKey,u=o.operatorID,c=e.handleAction,l=new ar("handleGroupInvitation");return l.setMessage("groupID:".concat(i," inviter:").concat(u," handleAction:").concat(c)),Ge.l("".concat(r," groupID:").concat(i," inviter:").concat(u," handleAction:").concat(c)),this.request({protocolName:Kn.HANDLE_GROUP_INVITATION,requestData:t(t({},e),{},{inviter:u,groupID:i,authentication:a,messageKey:s})}).then((function(){return l.setNetworkType(n.getNetworkType()).end(),Ge.l("".concat(r," ok")),n._groupSystemNoticeHandler.deleteGroupSystemNotice({messageList:[e.message]}),xn({group:n.getLocalGroupProfile(i)})})).catch((function(e){return n.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];l.setError(e,r,o).end()})),Ge.e("".concat(r," failed. error"),e),jn(e)}))}},{key:"getGroupOnlineMemberCount",value:function(e){var t=this,n="".concat(this._n,".getGroupOnlineMemberCount"),r=this._AVChatRoomHandler.checkJoinedAVChatRoomByID(e),o=this.hasLocalGroup(e);if(Ge.l("".concat(n," groupID:").concat(e," isAVChatRoom:").concat(r," has:").concat(o)),r)return this._AVChatRoomHandler.getGroupOnlineMemberCount(e);if(!o)return Bn({memberCount:0});var i=Date.now();if(this._onlineMemberCountMap.has(e)){var a=this._onlineMemberCountMap.get(e);if(i-a.lastReqTime<=6e4)return Bn({memberCount:a.memberCount});a.lastReqTime=i}return this.requestOnlineCount(e).then((function(r){var o=r.data.memberCount,i=void 0===o?0:o;return t._onlineMemberCountMap.set(e,{lastReqTime:Date.now(),memberCount:i}),Ge.l("".concat(n," ok. groupID:").concat(e," memberCount:").concat(i)),Bn({memberCount:i})})).catch((function(e){return Ge.w("".concat(n," failed. error:"),e),Promise.reject(e)}))}},{key:"requestOnlineCount",value:function(e){return this.request({protocolName:Kn.GET_ONLINE_MEMBER_NUM,requestData:{groupID:e}})}},{key:"hasLocalGroup",value:function(e){return this.groupMap.has(e)}},{key:"deleteLocalGroupAndConversation",value:function(e){var t=this.checkJoinedAVChatRoomByID(e);if(Ge.l("".concat(this._n,".deleteLocalGroupAndConversation isJoinedAVChatRoom:").concat(t)),t&&this.getModule(11).deleteLocalConversation("".concat(O.CONV_GROUP).concat(e)),Ct({groupID:e})){var n=this.getLocalGroupProfile(e);n&&!0===n.isSupportTopic&&this.getModule(10).deleteTopicListInCommunity(e)}this._deleteLocalGroup(e),this._onlineMemberCountMap.delete(e),this.emitGroupListUpdate(!0,!1)}},{key:"_deleteLocalGroup",value:function(e){this.groupMap.delete(e),this._groupMemberHandler.deleteGroupMemberList(e)}},{key:"sendMessage",value:function(e,t){if(it(e._receiverList)&&e._receiverList.length>0&&!this.canIUse(q.MSG_TO_SPECIFIED_GRP_MBR))return this.cannotUseCommercialAbility("group direct messages");var n=this.createGroupMessagePack(e,t);return this.request(n)}},{key:"createGroupMessagePack",value:function(e,t){var n=null;t&&t.offlinePushInfo&&(n=t.offlinePushInfo);var r="";nt(e.cloudCustomData)&&e.cloudCustomData.length>0&&(r=e.cloudCustomData);var o=[];if(ot(t)&&ot(t.messageControlInfo)){var i=t.messageControlInfo,a=i.excludedFromUnreadCount,s=i.excludedFromLastMessage,u=i.excludedFromContentModeration;!0===a&&o.push("NoUnread"),!0===s&&o.push("NoLastMsg"),!0===u&&o.push("NoMsgCheck")}var c=void 0;it(e._receiverList)&&e._receiverList.length>0&&(c=e._receiverList,e._receiverList.length>50&&(c=e._receiverList.slice(0,50),this.outputWarning("ReceiverListLimit")));var l=this.isOnlineMessage(e,t)?1:0,d=e.getGroupAtInfoList(),f={fromAccount:this.getMyUserID(),groupID:e.to,msgBody:e.getElements(),cloudCustomData:r,random:e.random,priority:e.priority,clientSequence:e.clientSequence,groupAtInfo:e.type!==O.MSG_TEXT||Qt(d)?void 0:d,onlineOnlyFlag:l,clientTime:e.clientTime,offlinePushInfo:n?{pushFlag:!0===n.disablePush?1:0,title:n.title||"",desc:n.description||"",ext:n.extension||"",apnsInfo:{badgeMode:!0===n.ignoreIOSBadge?1:0,isVoipPush:this._isVoipPush(n)},androidInfo:{OPPOChannelID:n.androidOPPOChannelID||""}}:void 0,messageControlInfo:0===l?o:void 0,needReadReceipt:!0!==e.needReadReceipt||this.isMessageFromOrToAVChatroom(e.to)?0:1,receiverList:c,isSupportExtension:!0===e.isSupportExtension?1:0,isRelayMessage:!0===e._relayFlag?1:0};return kt(e.to)&&(f.groupID=Vt(e.to),f.topicID=e.to),{protocolName:Kn.SEND_GROUP_MESSAGE,tjgID:this.generateTjgID(e),requestData:f}}},{key:"_isVoipPush",value:function(e){var t=void 0;return at(e.disableVoipPush)||(t=!1===e.disableVoipPush?1:0),t}},{key:"revokeMessage",value:function(e){var t={groupID:e.to,msgSeqList:[{msgSeq:e.sequence}]};return kt(e.to)&&(t.groupID=Vt(e.to),t.topicID=e.to),this.request({protocolName:Kn.REVOKE_GROUP_MESSAGE,requestData:t})}},{key:"deleteMessage",value:function(e){var t=e.to,n=e.keyList;Ge.l("".concat(this._n,".deleteMessage groupID:").concat(t," count:").concat(n.length));var r={groupID:t,deleter:this.getMyUserID(),keyList:n};return kt(t)&&(r.groupID=Vt(t),r.topicID=t),this.request({protocolName:Kn.DELETE_GROUP_MESSAGE,requestData:r})}},{key:"modifyRemoteMessage",value:function(e){var t=e.to,n=e.sequence,r=e.payload,o=e.type,i=e.version,a=void 0===i?0:i,s=e.cloudCustomData,u=t,c=void 0;kt(t)&&(u=Vt(t),c=t);var l=void 0;return jt(o)&&(l=[]).push({type:o,content:r}),this.request({protocolName:Kn.MODIFY_GROUP_MESSAGE,requestData:{groupID:u,topicID:c,sequence:n,version:a,elements:l,cloudCustomData:s}})}},{key:"getRoamingMessage",value:function(e){var t=this,n="".concat(this._n,".getRoamingMessage"),r=e.conversationID,o=e.groupID,i=e.sequence,a=new ar("getGroupRoamingMessages"),s=0,u=void 0;return kt(o)&&(o=Vt(u=o)),this._computeLastSequence({groupID:o,topicID:u,sequence:i}).then((function(e){return s=e,Ge.l("".concat(n," groupID:").concat(o," startSequence:").concat(s)),t.request({protocolName:Kn.GET_GROUP_ROAMING_MESSAGE,requestData:{groupID:o,count:21,sequence:s,topicID:u}})})).then((function(e){var i=e.data,c=i.messageList,l=i.complete,d=i.invisibleSequenceList,f=void 0===d?[]:d,p=e.data.nextSequence,h=void 0===p?0:p;at(c)?Ge.l("".concat(n," ok. complete:").concat(l," nextSequence:").concat(h," but messageList is undefined!")):Ge.l("".concat(n," ok. complete:").concat(l," nextSequence:").concat(h," count:").concat(c.length)),a.setNetworkType(t.getNetworkType()).setMessage("groupID:".concat(o," topicID:").concat(u," startSequence:").concat(s," complete:").concat(l," nextSequence:").concat(h)).end();var g=t.getModule(11),v=[];return Qt(c)?h>=1&&g.updateRoamingMessageSequence(r,h):(g.updateRoamingMessageSequence(r,h),v=g.onRoamingMessage(c,r),g.updateIsRead(r),g.patchConversationLastMessage(r)),(2===l||h<1)&&(g.setCompleted(r),h=""),Ge.l("".concat(n," nextReqID:").concat(h,", stored message count:").concat(v.length,", invisible sequence count:").concat(f.length)),{nextReqID:h+"",storedMessageList:v}})).catch((function(e){return t.probeNetwork().then((function(t){var n=M(t,2),r=n[0],i=n[1];a.setError(e,r,i).setMessage("groupID:".concat(o," topicID:").concat(u," startSequence:").concat(s)).end()})),Ge.w("".concat(n," failed. error:"),e),jn(e)}))}},{key:"_getGroupIDOfMessage",value:function(e){return e.conversationID.replace(O.CONV_GROUP,"")}},{key:"getReadReceiptList",value:function(e){var t=this,n="".concat(this._n,".").concat("getReadReceiptList"),r=this._getGroupIDOfMessage(e[0]),o=this.getMyUserID(),i=e.filter((function(e){return e.from===o&&!0===e.needReadReceipt})).map((function(e){return{sequence:e.sequence}}));if(Ge.l("".concat(n," groupID:").concat(r," sequenceList:").concat(JSON.stringify(i))),0===i.length)return Bn({messageList:e});var a=new ar("getReadReceiptList");return a.setMessage("groupID:".concat(r)),this.request({protocolName:Kn.GET_READ_RECEIPT,requestData:{groupID:r,sequenceList:i}}).then((function(t){a.end(),Ge.l("".concat(n," ok"));var r=t.data.readReceiptList;return it(r)&&r.forEach((function(t){e.forEach((function(e){0===t.code&&t.sequence===e.sequence&&(e.readReceiptInfo.readCount=t.readCount,e.readReceiptInfo.unreadCount=t.unreadCount)}))})),xn({messageList:e})})).catch((function(e){return t.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];a.setError(e,r,o).end()})),Ge.w("".concat(n," failed. error:"),e),jn(e)}))}},{key:"sendReadReceipt",value:function(e){var t=this,n="".concat(this._n,".").concat("sendReadReceipt"),r=this._getGroupIDOfMessage(e[0]),o=new ar("sendReadReceipt");o.setMessage("groupID:".concat(r));var i=this.getMyUserID(),a=e.filter((function(e){return e.from!==i&&!0===e.needReadReceipt})).map((function(e){return{sequence:e.sequence}}));return 0===a.length?jn({code:qn.READ_RECEIPT_MSG_LIST_EMPTY}):(Ge.l("".concat(n,". sequenceList:").concat(JSON.stringify(a))),this.request({protocolName:Kn.SEND_READ_RECEIPT,requestData:{groupID:r,sequenceList:a}}).then((function(e){return o.end(),Ge.l("".concat(n," ok")),xn()})).catch((function(e){return t.probeNetwork().then((function(t){var n=M(t,2),r=n[0],i=n[1];o.setError(e,r,i).end()})),Ge.w("".concat(n," failed. error:"),e),jn(e)})))}},{key:"getReadReceiptDetail",value:function(e){var t=this,n=e.message,r=e.filter,o=e.cursor,i=e.count,a=this._getGroupIDOfMessage(n),s=n.ID,u=n.sequence,c="".concat(this._n,".").concat("getReadReceiptDetail"),l=this._receiptDetailCompleteMap.get(s)||!1,d=0!==r&&1!==r?0:r,f=nt(o)?o:"",p=!et(i)||i<=0||i>=100?100:i,h="groupID:".concat(a," sequence:").concat(u," cursor:").concat(f," filter:").concat(d," completeFlag:").concat(l);Ge.l("".concat(c," ").concat(h));var g={cursor:"",isCompleted:!1,messageID:s,unreadUserIDList:[],readUserIDList:[]},v=new ar("getReadReceiptDetail");return v.setMessage(h),this.request({protocolName:Kn.GET_READ_RECEIPT_DETAIL,requestData:{groupID:a,sequence:u,flag:d,cursor:f,count:p}}).then((function(e){v.end();var n=e.data,r=n.cursor,o=n.isCompleted,i=n.unreadUserIDList,a=n.readUserIDList;return g.cursor=r,1===o&&(g.isCompleted=!0,t._receiptDetailCompleteMap.set(s,!0)),0===d?g.readUserIDList=a.map((function(e){return e.userID})):1===d&&(g.unreadUserIDList=i.map((function(e){return e.userID}))),Ge.l("".concat(c," ok")),xn(g)})).catch((function(e){return t.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];v.setError(e,r,o).end()})),Ge.w("".concat(c," failed. error:"),e),jn(e)}))}},{key:"getRoamingMessagesHopping",value:function(e){var t=this,n="".concat(this._n,".getRoamingMessagesHopping"),r=e.groupID,o=e.count,i=e.sequence,a=e.direction,s=i;if(at(i)){if(1===a)return Bn({messageList:[],isCompleted:!0,nextMessageSeq:""});if(this.hasLocalGroup(r)){var u=this.getLocalGroupProfile(r).nextMessageSeq;s=u>1?u-1:0}kt(r)&&(s=0)}else 1===a&&(s=i+o-1);var c=void 0;kt(r)&&(r=Vt(c=r));var l="".concat(c?"topicID:".concat(c):"groupID:".concat(r)," sequence:").concat(i," direction:").concat(a);Ge.l("".concat(n," ").concat(l));var d=new ar("getGroupRoamingMessagesHopping");return this.request({protocolName:Kn.GET_GROUP_ROAMING_MESSAGE,requestData:{groupID:r,topicID:c,count:o,sequence:s}}).then((function(r){var o=r.data,s=o.messageList,u=o.complete,c="complete:".concat(u," count:").concat(s?s.length:0);if(Ge.l("".concat(n," ok. ").concat(c)),d.setNetworkType(t.getNetworkType()).setMessage("".concat(l," ").concat(c)).end(),2===u||Qt(s)){var f=t._computeResult();return xn(f)}var p="".concat(O.CONV_GROUP).concat(e.groupID),h=t.getModule(11).onRoamingMessage(s,p,!1),g=t._computeResult({direction:a,sequence:i,remoteMessageList:s,processedMessageList:h});return xn(g)})).catch((function(e){return t.probeNetwork().then((function(t){var n=M(t,2),a=n[0],s=n[1];d.setError(e,a,s).setMessage("groupID:".concat(r," sequence:").concat(i," count:").concat(o)).end()})),Ge.w("".concat(n," failed. error:"),e),jn(e)}))}},{key:"_computeResult",value:function(e){var t={messageList:[],isCompleted:!1,nextMessageSeq:""};if(at(e))return t.isCompleted=!0,t;var n=e.direction,r=e.sequence,o=e.remoteMessageList,i=void 0===o?[]:o,a=e.processedMessageList,s=void 0===a?[]:a,u=i.length;return 1===n?(t.nextMessageSeq=i[0].sequence+1,s.forEach((function(e){e.sequence>=r&&t.messageList.push(e)})),0===t.messageList.length&&i[0].sequence<r&&(t.isCompleted=!0,t.nextMessageSeq=""),t):(t.nextMessageSeq=i[u-1].sequence-1,t.messageList=T(s),0===t.nextMessageSeq&&(t.isCompleted=!0,t.nextMessageSeq=""),t)}},{key:"setMessageRead",value:function(e){var t=this,n=e.conversationID,r=e.lastMessageSeq,o="".concat(this._n,".setMessageRead");Ge.l("".concat(o," conversationID:").concat(n," lastMessageSeq:").concat(r)),et(r)||this.outputWarning("DoNotModifyLastSeq");var i=new ar("setGroupMessageRead");i.setMessage("".concat(n,"-").concat(r));var a=n.replace(O.CONV_GROUP,""),s=void 0;return kt(a)&&(a=Vt(s=a)),this.request({protocolName:Kn.SET_GROUP_MESSAGE_READ,requestData:{groupID:a,topicID:s,messageReadSeq:r}}).then((function(){i.setNetworkType(t.getNetworkType()).end(),Ge.l("".concat(o," ok."));var e=t.getModule(11);e.updateIsReadAfterReadReport({conversationID:n,lastMessageSeq:r});var u=!0;if(!at(s)){u=!1;var c=t.getModule(10).getLocalTopic(a,s);c&&c.updateSelfInfo({readedSequence:r})}return e.updateUnreadCount(n,u),xn()})).catch((function(e){return t.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];i.setError(e,r,o).end()})),Ge.l("".concat(o," failed. error:"),e),jn(e)}))}},{key:"_computeLastSequence",value:function(e){var t=e.groupID,n=e.topicID,r=void 0===n?void 0:n,o=e.sequence;return o>0?Promise.resolve(o):at(r)?this.getGroupLastSequence(t):Promise.resolve(0)}},{key:"getGroupLastSequence",value:function(e){var t=this,n="".concat(this._n,".").concat("getGroupLastSequence"),r=new ar("getGroupLastSequence"),o=0,i="",a="groupID:".concat(e);if(this.hasLocalGroup(e)){var s=this.getLocalGroupProfile(e),u=s.lastMessage;if(u.lastSequence>0&&!1===u.onlineOnlyFlag)return o=u.lastSequence,i="".concat(a,", ").concat(o," from group.lastMessage.lastSequence"),Ge.l("".concat(n," ").concat(i)),r.setNetworkType(this.getNetworkType()).setMessage(i).end(),Promise.resolve(o);if(s.nextMessageSeq>1)return o=s.nextMessageSeq-1,i="".concat(a,", ").concat(o," from group.nextMessageSeq"),Ge.l("".concat(n," ").concat(i)),r.setNetworkType(this.getNetworkType()).setMessage(i).end(),Promise.resolve(o)}var c=this.getModule(11).getLocalConversation("GROUP".concat(e));if(c&&c.lastMessage.lastSequence&&!1===c.lastMessage.onlineOnlyFlag)return o=c.lastMessage.lastSequence,i="".concat(a,", ").concat(o," from conversation.lastMessage.lastSequence"),Ge.l("".concat(n," ").concat(i)),r.setNetworkType(this.getNetworkType()).setMessage(i).end(),Promise.resolve(o);var l={groupIDList:[e],responseFilter:{groupBaseInfoFilter:["NextMsgSeq"]}};return this.getGroupProfileAdvance(l).then((function(e){var s=e.data.successGroupList;return Qt(s)?Ge.w("".concat(n," ").concat(a,", empty successGroupList")):(o=s[0].nextMessageSeq-1,i="".concat(a,", ").concat(o," from remote"),Ge.l("".concat(n," ").concat(i))),r.setNetworkType(t.getNetworkType()).setMessage(i).end(),o})).catch((function(e){return t.probeNetwork().then((function(t){var n=M(t,2),o=n[0],i=n[1];r.setError(e,o,i).setMessage(a).end()})),Ge.w("".concat(n," failed. error:"),e),jn(e)}))}},{key:"isMessageFromOrToAVChatroom",value:function(e){return this._AVChatRoomHandler.checkJoinedAVChatRoomByID(e)}},{key:"hasJoinedAVChatRoom",value:function(){return this._AVChatRoomHandler.hasJoinedAVChatRoom()}},{key:"getJoinedAVChatRoom",value:function(){return this._AVChatRoomHandler.getJoinedAVChatRoom()}},{key:"isOnlineMessage",value:function(e,t){return!(!this._canIUseOnlineOnlyFlag(e)||!t||!0!==t.onlineUserOnly)}},{key:"_canIUseOnlineOnlyFlag",value:function(e){var t=this.getJoinedAVChatRoom();return!t||!t.includes(e.to)||e.conversationType!==O.CONV_GROUP}},{key:"_onAVChatRoomHistoryMessage",value:function(e,n){if(!Qt(e)){Ge.l("".concat(this._n,"._onAVChatRoomHistoryMessage groupID:").concat(n," count:").concat(e.length));var r=[];e.forEach((function(e){r.push(t(t({},e),{},{isHistoryMessage:1}))})),this.onAVChatRoomMessage(r,n)}}},{key:"onAVChatRoomMessage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this._AVChatRoomHandler.onMessage(e,t)}},{key:"onAVChatRoomMemberBanned",value:function(e){this._AVChatRoomHandler.onAVChatRoomMemberBanned(e)}},{key:"getGroupSimplifiedInfo",value:function(e){var t=this,n=new ar("getGroupSimplifiedInfo"),r={groupIDList:[e],responseFilter:{groupBaseInfoFilter:["Type","Name"]}};return this.getGroupProfileAdvance(r).then((function(r){var o=r.data.successGroupList;return n.setNetworkType(t.getNetworkType()).setMessage("groupID:".concat(e," type:").concat(o[0].type)).end(),o[0]})).catch((function(r){t.probeNetwork().then((function(t){var o=M(t,2),i=o[0],a=o[1];n.setError(r,i,a).setMessage("groupID:".concat(e)).end()}))}))}},{key:"setUnjoinedAVChatRoom",value:function(e){this._unjoinedAVChatRoomList.set(e,1)}},{key:"deleteUnjoinedAVChatRoom",value:function(e){this._unjoinedAVChatRoomList.has(e)&&this._unjoinedAVChatRoomList.delete(e)}},{key:"isUnjoinedAVChatRoom",value:function(e){return this._unjoinedAVChatRoomList.has(e)}},{key:"isGroupAttributesUpdatedNotice",value:function(e){return this._groupAttributesHandler.isGroupAttributesUpdatedNotice(e)}},{key:"updateLocalMainSequenceOnReconnected",value:function(){this._groupAttributesHandler.updateLocalMainSequenceOnReconnected()}},{key:"initGroupAttributes",value:function(e){return this._groupAttributesHandler.initGroupAttributes(e)}},{key:"setGroupAttributes",value:function(e){return this._groupAttributesHandler.setGroupAttributes(e)}},{key:"deleteGroupAttributes",value:function(e){return this._groupAttributesHandler.deleteGroupAttributes(e)}},{key:"getGroupAttributes",value:function(e){return this._groupAttributesHandler.getGroupAttributes(e)}},{key:"isMessageFromTopic",value:function(e,t){return 2===e&&!Qt(t)}},{key:"isMessageFromCommunityOfTopic",value:function(e,t){return 2===e&&Qt(t)}},{key:"getMessageExtensions",value:function(e,t){return Ge.l("".concat(this._n,".getMessageExtensions startSequence:").concat(t)),this.request({protocolName:Kn.GET_GROUP_MESSAGE_EXTENSIONS,requestData:{groupID:e.to,messageSequence:e.sequence,startSequence:t}})}},{key:"modifyMessageExtensions",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Ge.l("".concat(this._n,".modifyMessageExtensions operateType:").concat(n)),this.request({protocolName:Kn.MODIFY_GROUP_MESSAGE_EXTENSIONS,requestData:{groupID:e.to,messageSequence:e.sequence,extensionList:t,operateType:n}})}},{key:"_genNotifyReqList",value:function(e){for(var t=[],n=0,r=e.length;n<r;n++){var o=e[n],i=this.getLocalGroupProfile(o).type,a=this._getGroupLastRevokedTime(o),s=1e3*Re(),u={notifyType:1,limit:20,type:Ct({type:i,groupID:o})?O.GRP_COMMUNITY:void 0,groupID:o,beginTime:a,endTime:s};t.push(u)}return t}},{key:"getGroupNotify",value:function(e){var t=this,n="".concat(this._n,".getGroupNotify"),r=e.filter((function(e){var n=t.getLocalGroupProfile(e),r=n.type,o=n.isSupportTopic;return t.hasLocalGroup(e)&&!Et(r)&&!o})),o="filteredGroupIDList.length:".concat(r.length);r.length<=10&&(o="filteredGroupIDList:".concat(JSON.stringify(r))),Ge.l("".concat(n," ").concat(o)),0!==r.length&&this.request({protocolName:Kn.GET_GROUP_NOTIFY,requestData:{notifyReqList:this._genNotifyReqList(e)}}).then((function(e){var r=e.data.notifyRspList,o=[];if(it(r)){var i={dataList:[]};r.forEach((function(e){var n=e.nextRevokedTime,r=e.groupID;i.dataList.push({elements:{revokedInfos:t._genRevokedInfos(e)}}),0!==n?(t._setGroupLastRevokedTime(r,n),o.push(r)):t._setGroupLastRevokedTime(r,1e3*Re())})),t.onGroupMessageRevoked(i)}o.length>0&&t.getGroupNotify(o);var a="nextGroupIDList.length:".concat(o.length);o.length<=10&&(a="nextGroupIDList:".concat(JSON.stringify(o))),Ge.l("".concat(n," ").concat(a))})).catch((function(e){Ge.e("".concat(n," failed. error:"),e)}))}},{key:"_genRevokedInfos",value:function(e){var n=e.notifyList,r=e.groupID,o=[];return it(n)&&n.forEach((function(e){o.push({groupID:r,sequence:e.sequence,random:e.random,revokerInfo:t({},e.revokerInfo)})})),o}},{key:"_getGroupLastRevokedTime",value:function(e){return this.hasLocalGroup(e)?this.getLocalGroupProfile(e)._lastRevokedTime:0}},{key:"_setGroupLastRevokedTime",value:function(e,t){this.hasLocalGroup(e)&&(this.getLocalGroupProfile(e)._lastRevokedTime=t)}},{key:"isGroupCountersNotice",value:function(e){return this._groupCountersHandler.isGroupCountersNotice(e)}},{key:"setGroupCounters",value:function(e){return this._groupCountersHandler.setGroupCounters(e)}},{key:"increaseGroupCounter",value:function(e){return this._groupCountersHandler.increaseGroupCounter(e)}},{key:"decreaseGroupCounter",value:function(e){return this._groupCountersHandler.decreaseGroupCounter(e)}},{key:"getGroupCounters",value:function(e){return this._groupCountersHandler.getGroupCounters(e)}},{key:"getGroupMemberHandler",value:function(){return this._groupMemberHandler}},{key:"getGroupMemberList",value:function(e){return this._groupMemberHandler.getGroupMemberList(e)}},{key:"getGroupMemberProfile",value:function(e){return this._groupMemberHandler.getGroupMemberProfile(e)}},{key:"addGroupMember",value:function(e){return this._groupMemberHandler.addGroupMember(e)}},{key:"deleteGroupMember",value:function(e){return this._groupMemberHandler.deleteGroupMember(e)}},{key:"setGroupMemberMuteTime",value:function(e){return this._groupMemberHandler.setGroupMemberMuteTime(e)}},{key:"setGroupMemberRole",value:function(e){return this._groupMemberHandler.setGroupMemberRole(e)}},{key:"setGroupMemberNameCard",value:function(e){return this._groupMemberHandler.setGroupMemberNameCard(e)}},{key:"setGroupMemberCustomField",value:function(e){return this._groupMemberHandler.setGroupMemberCustomField(e)}},{key:"markGroupMemberList",value:function(e){return this._groupMemberHandler.markGroupMemberList(e)}},{key:"modifyGroupMemberInfo",value:function(e){return this._groupMemberHandler.modifyGroupMemberInfo(e)}},{key:"restartPolling",value:function(){this._AVChatRoomHandler.restartPolling()}},{key:"getPollingTimerID",value:function(e){if(!e)return-1;var t=this.getLocalGroupProfile(e);return t&&Et(t.type)?this._AVChatRoomHandler.getPollingTimerID(e):-1}},{key:"_canIUseJoinOption",value:function(e){return function(e){return e===O.GRP_PUBLIC}(e)||Ct({type:e})}},{key:"_silentlyGetGroupProfile",value:function(e,t){var n=setTimeout(this.getGroupProfile.bind(this,{groupID:t}),3e3);this._timeoutIDs.push(n),Ge.l("".concat(this._n,"._silentlyGetGroupProfile errorCode:").concat(e," groupID:").concat(t," timeoutIDs:").concat(this._timeoutIDs))}},{key:"_clearTimeoutIDs",value:function(){this._timeoutIDs.forEach((function(e){clearTimeout(e)})),this._timeoutIDs=[]}},{key:"reset",value:function(){this.groupMap.clear(),this._unjoinedAVChatRoomList.clear(),this._receiptDetailCompleteMap.clear(),this._onlineMemberCountMap.clear(),this._commonGroupHandler.reset(),this._groupSystemNoticeHandler.reset(),this._groupTipsHandler.reset(),this._groupAttributesHandler.reset(),this._groupCountersHandler.reset(),this._AVChatRoomHandler.reset(),this._groupMemberHandler.reset(),this._clearTimeoutIDs()}}]),r}(Hn),$r=["topicID","topicName","avatar","introduction","notification","unreadCount","muteAllMembers","customData","groupAtInfoList","nextMessageSeq","selfInfo"],Zr=function(e,t){return Qt(e)?{lastTime:0,lastSequence:0,fromAccount:"",payload:null,type:"",messageForShow:"",nick:"",avatar:"",version:0,cloudCustomData:"",isRevoked:!1,revoker:null}:{lastTime:e.time||0,lastSequence:e.sequence||0,fromAccount:e.from||"",payload:e.payload||null,type:e.type||"",messageForShow:Bt(e.type,e.payload,t),nick:e.nick||"",avatar:e.avatar||"",version:e.version||0,cloudCustomData:e.cloudCustomData||"",isRevoked:e.isRevoked||!1,revoker:e.revoker||null}},Qr=function(){function e(t,n){a(this,e),this.topicID="",this.topicName="",this.avatar="",this.introduction="",this.notification="",this.unreadCount=0,this.muteAllMembers=!1,this.customData="",this.groupAtInfoList=[],this.nextMessageSeq=0,this.lastMessage=Zr(t.lastMessage,n),this.selfInfo={muteTime:0,readedSequence:0,messageRemindType:"",excludedUnreadSequenceList:void 0},this._initTopic(t)}return c(e,[{key:"_initTopic",value:function(e){for(var t in e)$r.indexOf(t)<0||("selfInfo"===t?this.updateSelfInfo(e[t]):this[t]="muteAllMembers"===t?1===e[t]:e[t])}},{key:"updateUnreadCount",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.unreadCount=e}},{key:"updateNextMessageSeq",value:function(e){this.nextMessageSeq=e}},{key:"updateLastMessage",value:function(e){this.lastMessage=Zr(e)}},{key:"updateGroupAtInfoList",value:function(e){this.groupAtInfoList=JSON.parse(JSON.stringify(e))}},{key:"updateTopic",value:function(e){at(e.selfInfo)||this.updateSelfInfo(e.selfInfo),at(e.muteAllMembers)||(this.muteAllMembers=1===e.muteAllMembers),pt(this,e,["groupID","lastMessageTime","selfInfo","muteAllMembers","lastMsg"])}},{key:"updateSelfInfo",value:function(e){return 0!==pt(this.selfInfo,e,[],[""])}},{key:"reduceUnreadCount",value:function(){return this.unreadCount>=1&&(this.unreadCount-=1,!0)}},{key:"isLastMessageRevoked",value:function(e){return e.sequence===this.lastMessage.lastSequence}},{key:"setLastMessageRevoked",value:function(e){this.lastMessage.isRevoked=e}},{key:"setLastMessageRevoker",value:function(e){this.lastMessage.revoker=e}}]),e}(),eo=function(e){d(r,e);var n=I(r);function r(e){var t;return a(this,r),(t=n.call(this,e))._n="TopicModule",t._topicMap=new Map,t._getTopicTimeMap=new Map,t.TOPIC_CACHE_TIME=300,t.TOPIC_LAST_ACTIVE_TIME=3600,t.getInnerEmitterInstance().on(Cr.CLOUD_CONFIG_UPDATED,t._onCloudConfigUpdated,m(t)),t}return c(r,[{key:"_onCloudConfigUpdated",value:function(){var e=this.getCloudConfig("topic_cache_time"),t=this.getCloudConfig("topic_last_active_time");at(e)||(this.TOPIC_CACHE_TIME=Number(e)),at(t)||(this.TOPIC_LAST_ACTIVE_TIME=Number(t))}},{key:"onTopicCreated",value:function(e){var t=e.groupID;this.resetGetTopicTime(t),this.emitOuterEvent(A.TOPIC_CREATED,e)}},{key:"onTopicDeleted",value:function(e){var t=this,n=e.groupID,r=e.topicIDList;(void 0===r?[]:r).forEach((function(e){t._deleteLocalTopic(n,e)})),this.emitOuterEvent(A.TOPIC_DELETED,e)}},{key:"onTopicMessageRemindTypeUpdated",value:function(e){var t=e.groupID,n=e.topicID,r=e.messageRemindType,o=this.getLocalTopic(t,n);if(o){var i=o.updateSelfInfo({messageRemindType:r});i&&this.emitOuterEvent(A.TOPIC_UPDATED,{groupID:t,topic:o}),Ge.d("".concat(this._n,".onTopicMessageRemindTypeUpdated topicID:").concat(n)+" messageRemindType:".concat(r," isTopicUpdated:").concat(i))}}},{key:"onTopicProfileUpdated",value:function(e){var t=e.groupID,n=e.topicID,r=this.getLocalTopic(t,n);r&&(r.updateTopic(e),this.emitOuterEvent(A.TOPIC_UPDATED,{groupID:t,topic:r}))}},{key:"onConversationProxy",value:function(e){var t=e.topicID,n=e.unreadCount,r=e.groupAtInfoList,o=Vt(t),i=this.getLocalTopic(o,t),a=!1;i&&(at(n)||i.unreadCount===n||(i.updateUnreadCount(n),a=!0),at(r)||(i.updateGroupAtInfoList(r),a=!0)),a&&this.emitOuterEvent(A.TOPIC_UPDATED,{groupID:o,topic:i})}},{key:"onMessageSent",value:function(e){var t=e.groupID,n=e.topicID,r=e.lastMessage,o=this.getLocalTopic(t,n);o&&(o.nextMessageSeq+=1,o.updateLastMessage(r),this.emitOuterEvent(A.TOPIC_UPDATED,{groupID:t,topic:o}))}},{key:"onMessageModified",value:function(e){var t=e.to,n=e.time,r=e.sequence,o=e.elements,i=e.cloudCustomData,a=e.messageVersion,s=Vt(t),u=this.getLocalTopic(s,t);if(u){var c=u.lastMessage;Ge.d("".concat(this._n,".onMessageModified topicID:").concat(t," lastMessage:"),JSON.stringify(c),"options:",JSON.stringify(e)),c&&(null===c.payload||c.lastTime===n&&c.lastSequence===r&&c.version!==a)&&(c.type=o[0].type,c.payload=o[0].content,c.messageForShow=Bt(c.type,c.payload,this.isIntl()),c.cloudCustomData=i,c.version=a,c.lastSequence=r,c.lastTime=n,this.emitOuterEvent(A.TOPIC_UPDATED,{groupID:s,topic:u}))}}},{key:"onMessageRevoked",value:function(e){var t=this;if(0!==e.length){var n=null,r=null,o=!1;e.forEach((function(e){var i=e.to;r=Vt(i),(n=t.getLocalTopic(r,i))&&(n.reduceUnreadCount()&&(o=!0),n.isLastMessageRevoked(e)&&(n.setLastMessageRevoked(!0),n.setLastMessageRevoker(e.revoker),o=!0))})),o&&this.emitOuterEvent(A.TOPIC_UPDATED,{groupID:r,topic:n})}}},{key:"isLastMessageRevoked",value:function(e){var t=e.topicID,n=e.sequence,r=Vt(t),o=this.getLocalTopic(r,t),i=!1;return o&&(i=o.isLastMessageRevoked({sequence:n})),i}},{key:"getJoinedCommunityList",value:function(){return this.getModule(7).syncCommunityWithTopic()}},{key:"createTopicInCommunity",value:function(e){var n=this,r="".concat(this._n,".").concat("createTopicInCommunity"),o=e.topicID;if(!at(o)&&!kt(o))return jn({code:qn.ILLEGAL_TOPIC_ID});if(e.topicName&&!1===this._filterProfanity("topicName",e))return jn({code:qn.PROFANITY_FOUND});if(e.introduction&&!1===this._filterProfanity("introduction",e))return jn({code:qn.PROFANITY_FOUND});if(e.notification&&!1===this._filterProfanity("notification",e))return jn({code:qn.PROFANITY_FOUND});var i=new ar("createTopicInCommunity");return this.request({protocolName:Kn.CREATE_TOPIC,requestData:t({},e)}).then((function(o){var a=o.data.topicID;return i.setMessage("topicID:".concat(a)).setNetworkType(n.getNetworkType()).end(),Ge.l("".concat(r," ok. topicID:").concat(a)),n._updateTopicMap([t(t({},e),{},{topicID:a})]),xn({topicID:a})})).catch((function(e){return n.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];i.setError(e,r,o).end()})),Ge.e("".concat(r," failed. error:"),e),jn(e)}))}},{key:"deleteTopicFromCommunity",value:function(e){var t=this,n="".concat(this._n,".").concat("deleteTopicFromCommunity"),r=e.groupID,o=e.topicIDList,i=void 0===o?[]:o,a=new ar("deleteTopicFromCommunity");return a.setMessage("groupID:".concat(r," topicIDList:").concat(i)),this.request({protocolName:Kn.DELETE_TOPIC,requestData:{groupID:r,topicIDList:i}}).then((function(e){var o=e.data.resultList,i=[],s=[];(void 0===o?[]:o).forEach((function(e){var t=e.topicID,n=e.errorCode,r=e.errorInfo;0===n?i.push({topicID:t}):s.push({topicID:t,code:n,message:r})}));var u="success count:".concat(i.length,", fail count:").concat(s.length);return a.setMoreMessage(u).setNetworkType(t.getNetworkType()).end(),Ge.l("".concat(n," ok. ").concat(u)),i.forEach((function(e){t._deleteLocalTopic(r,e.topicID)})),xn({successTopicList:i,failureTopicList:s})})).catch((function(e){return t.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];a.setError(e,r,o).end()})),Ge.e("".concat(n," failed. error:"),e),jn(e)}))}},{key:"updateTopicProfile",value:function(e){var n=this,r="".concat(this._n,".").concat("updateTopicProfile");if(Ge.l("".concat(r," options:"),e),e.topicName&&!1===this._filterProfanity("topicName",e))return jn({code:qn.PROFANITY_FOUND});if(e.introduction&&!1===this._filterProfanity("introduction",e))return jn({code:qn.PROFANITY_FOUND});if(e.notification&&!1===this._filterProfanity("notification",e))return jn({code:qn.PROFANITY_FOUND});var o=new ar("updateTopicProfile");return o.setMessage("groupID:".concat(e.groupID," topicID:").concat(e.topicID)),at(e.muteAllMembers)||(e.muteAllMembers=!0===e.muteAllMembers?"On":"Off"),this.request({protocolName:Kn.UPDATE_TOPIC_PROFILE,requestData:t({},e)}).then((function(){return o.setNetworkType(n.getNetworkType()).end(),Ge.l("".concat(r," ok")),n._updateTopicMap([e]),xn({topic:n.getLocalTopic(e.groupID,e.topicID)})})).catch((function(e){return n.probeNetwork().then((function(t){var n=M(t,2),r=n[0],i=n[1];o.setError(e,r,i).end()})),Ge.e("".concat(r," failed. error:"),e),jn(e)}))}},{key:"getTopicList",value:function(e){var n=this,r="".concat(this._n,".").concat("getTopicList"),o=e.groupID,i=e.topicIDList,a=void 0===i?[]:i,s=0===a.length,u=new ar("getTopicList");if(u.setMessage("groupID:".concat(o)),this._getTopicTimeMap.has(o)){var c=this._getTopicTimeMap.get(o),l=c.isGetAll,d=c.time;if((l||!l&&!s)&&Date.now()-d<1e3*this.TOPIC_CACHE_TIME){var f=this._getLocalTopicList(o,a);if(s||f.length===a.length)return u.setNetworkType(this.getNetworkType()).setMoreMessage("from cache, topic count:".concat(f.length)).end(),Ge.l("".concat(r," groupID:").concat(o," from cache, topic count:").concat(f.length)),Bn({successTopicList:f,failureTopicList:[]})}}return this.request({protocolName:Kn.GET_TOPIC_LIST,requestData:{groupID:o,topicIDList:a}}).then((function(e){var i=e.data.topicInfoList,a=[],c=[],l=[];(void 0===i?[]:i).forEach((function(e){var n=e.topic,r=e.selfInfo,o=e.errorCode,i=e.errorInfo,s=n.topicID;0===o?(a.push(t(t({},n),{},{selfInfo:r})),c.push(s)):l.push({topicID:s,code:o,message:i})})),n._updateTopicMap(a),n._handleTopicAtInfo(a);var d="success count:".concat(c.length,", fail count:").concat(l.length);u.setNetworkType(n.getNetworkType()).setMoreMessage(d).end(),Ge.l("".concat(r," groupID:").concat(o," from remote, ").concat(d));var f=[];return Qt(c)||(n._getTopicTimeMap.set(o,{time:Date.now(),isGetAll:s}),f=n._getLocalTopicList(o,c)),xn({successTopicList:f,failureTopicList:l})})).catch((function(e){return n.probeNetwork(e).then((function(t){var n=M(t,2),r=n[0],o=n[1];u.setError(e,r,o).end()})),Ge.e("".concat(r," failed. error:"),e),jn(e)}))}},{key:"hasLocalTopic",value:function(e,t){return!!this._topicMap.has(e)&&this._topicMap.get(e).has(t)}},{key:"getLocalTopic",value:function(e,t){var n=null;return this._topicMap.has(e)&&(n=this._topicMap.get(e).get(t)),n}},{key:"_getLocalTopicList",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=this._topicMap.get(e),r=[];return n&&(r=T(n.values())),0===t.length?r:r.filter((function(e){return t.includes(e.topicID)}))}},{key:"_deleteLocalTopic",value:function(e,t){this._topicMap.has(e)&&this._topicMap.get(e).has(t)&&(this._topicMap.get(e).delete(t),Ge.l("".concat(this._n,"._deleteLocalTopic groupID:").concat(e," topicID:").concat(t)))}},{key:"_updateTopicMap",value:function(e){var t=this,n=[];e.forEach((function(e){var r=e.groupID,o=e.topicID,i=null;t._topicMap.has(r)||t._topicMap.set(r,new Map),t._topicMap.get(r).has(o)?(i=t._topicMap.get(r).get(o)).updateTopic(e):(t._getTopicLastMessage(e),i=new Qr(e,t.isIntl()),t._topicMap.get(r).set(o,i));var a=t._computeUnreadCount(i);i.updateUnreadCount(a),n.push({conversationID:"".concat(O.CONV_GROUP).concat(o),type:O.CONV_TOPIC,unreadCount:a})})),n.length>0&&this.getModule(11).updateTopicConversation(n)}},{key:"resetGetTopicTime",value:function(e){var t=this;at(e)?T(this._getTopicTimeMap.keys()).forEach((function(e){t._getTopicTimeMap.set(e,0)})):this._getTopicTimeMap.set(e,0)}},{key:"getTopicListOnReconnected",value:function(){var e=this,t=T(this._topicMap.keys()),n=[],r=this.getModule(11);t.forEach((function(t){var o=[],i=e._getLocalTopicList(t);r.deleteTopicRoamingMessageInfo(t),i.forEach((function(t){var n=t.lastMessage.lastTime,r=void 0===n?0:n;Date.now()-1e3*r<1e3*e.TOPIC_LAST_ACTIVE_TIME&&o.push(t.topicID)})),o.length>0&&n.push({groupID:t,topicIDList:o})})),Ge.l("".concat(this._n,".getTopicListOnReconnected. active community count:").concat(n.length)),this._relayGetTopicList(n)}},{key:"_relayGetTopicList",value:function(e){var t=this;if(0!==e.length){var n=e.shift(),r=n.topicIDList.length>5?"topicIDList.length:".concat(n.topicIDList.length):"topicIDList:".concat(n.topicIDList),o=new ar("relayGetTopicList");o.setMessage(r),Ge.l("".concat(this._n,"._relayGetTopicList. ").concat(r)),this.getTopicList(n).then((function(){o.setNetworkType(t.getNetworkType()).end(),t._relayGetTopicList(e)})).catch((function(n){t.probeNetwork().then((function(e){var t=M(e,2),r=t[0],i=t[1];o.setError(n,r,i).end()})),t._relayGetTopicList(e)}))}}},{key:"_handleTopicAtInfo",value:function(e){var n=this;0!==e.length&&e.forEach((function(e){var r=e.groupID,o=e.topicID,i=e.groupAtInfoList,a=[];at(i)||(i.forEach((function(e){a.push(t(t({},e),{},{groupID:r,topicID:o}))})),n.getModule(11).onNewGroupAtTips({dataList:a}))}))}},{key:"_getTopicLastMessage",value:function(e){if(!at(e.lastMsg)){var t={time:e.lastMsg.time,sequence:e.lastMsg.sequence,from:e.lastMsg.from,payload:e.lastMsg.elements[0]?e.lastMsg.elements[0].content:null,type:e.lastMsg.elements[0]?e.lastMsg.elements[0].type:"",nick:e.lastMsg.nick,avatar:e.lastMsg.avatar,version:e.lastMsg.messageVersion,cloudCustomData:e.lastMsg.cloudCustomData,isRevoked:2===e.lastMsg.isPlaceMessage,revoker:Qt(e.lastMsg.revokerInfo)?null:e.lastMsg.revokerInfo.revoker};e.lastMessage=t}}},{key:"deleteTopicListInCommunity",value:function(e){var t=this,n=this._getLocalTopicList(e),r=this.getModule(11);n.forEach((function(n){var o=n.topicID;t._deleteLocalTopic(e,o),t._getTopicTimeMap.delete(e),r.deleteLocalConversation("".concat(O.CONV_GROUP).concat(o))}))}},{key:"_computeUnreadCount",value:function(e){var t=e.selfInfo,n=t.excludedUnreadSequenceList,r=t.readedSequence,o=e.nextMessageSeq-e.selfInfo.readedSequence-1;if(it(n)){var i=0;n.forEach((function(t){t>=r&&t<=e.nextMessageSeq-1&&(i+=1)})),i>=1&&(o-=i)}return o<0?0:o}},{key:"_filterProfanity",value:function(e,t){var n=this.getModule(29);if(!n)return!0;var r=n.filterText(t[e],V),o=r.isAllowedToSend,i=r.modifiedText;return!0===o&&(t[e]=i,!0)}},{key:"updateLastMessage",value:function(e,t){var n=Vt(e),r=this.getLocalTopic(n,e);if(r){var o=t.sequence+1;r.updateNextMessageSeq(o),r.updateLastMessage(t),this.emitOuterEvent(A.TOPIC_UPDATED,{groupID:n,topic:r})}}},{key:"getMessageExtensions",value:function(e,t){Ge.l("".concat(this._n,".getMessageExtensions startSequence:").concat(t));var n=Vt(e.to);return this.request({protocolName:Kn.GET_GROUP_MESSAGE_EXTENSIONS,requestData:{groupID:n,topicID:e.to,messageSequence:e.sequence,startSequence:t}})}},{key:"modifyMessageExtensions",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;Ge.l("".concat(this._n,".modifyMessageExtensions operateType:").concat(n));var r=Vt(e.to);return this.request({protocolName:Kn.MODIFY_GROUP_MESSAGE_EXTENSIONS,requestData:{groupID:r,topicID:e.to,messageSequence:e.sequence,extensionList:t,operateType:n}})}},{key:"reset",value:function(){Ge.l("".concat(this._n,".reset")),this._topicMap.clear(),this._getTopicTimeMap.clear(),this.TOPIC_CACHE_TIME=300,this.TOPIC_LAST_ACTIVE_TIME=3600}}]),r}(Hn),to=function(){function e(t){a(this,e),this._userModule=t,this._n="ProfileHandler",this.TAG="profile",this.accountProfileMap=new Map,this.expirationTime=864e5}return c(e,[{key:"setExpirationTime",value:function(e){this.expirationTime=e}},{key:"getUserProfile",value:function(e){var t=this,n="".concat(this._n,".").concat("getUserProfile"),r=e.userIDList;e.fromAccount=this._userModule.getMyAccount(),r.length>100&&(Ge.w("".concat(n," ").concat(Wt(100))),r.length=100);for(var o,i=[],a=[],s=0,u=r.length;s<u;s++)o=r[s],this._userModule.isMyFriend(o)&&this._contains(o)?a.push(this._getProfileFromMap(o)):i.push(o);if(0===i.length)return Bn(a);e.toAccount=i;var c=e.bFromGetMyProfile||!1,l=[];e.toAccount.forEach((function(e){l.push({toAccount:e,standardSequence:0,customSequence:0})})),e.userItem=l;var d=new ar("getUserProfile");return d.setMessage(r.length>5?"userIDList.length:".concat(r.length):"userIDList:".concat(r)),this._userModule.request({protocolName:Kn.GET_USER_PROFILE,requestData:e}).then((function(e){d.setNetworkType(t._userModule.getNetworkType()).end(),Ge.i("".concat(n," ok"));var r=t._handleResponse(e).concat(a);return xn(c?r[0]:r)})).catch((function(e){return t._userModule.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];d.setError(e,r,o).end()})),Ge.e("".concat(n," failed. error:"),e),jn(e)}))}},{key:"getMyProfile",value:function(){var e=this._userModule.getMyAccount(),t="".concat(this._n,".getMyProfile");if(Ge.l("".concat(t," myAccount:").concat(e)),this._fill(),this._contains(e)){var n=this._getProfileFromMap(e);return Ge.d("".concat(t," from cache, myProfile:").concat(JSON.stringify(n))),Bn(n)}return this.getUserProfile({fromAccount:e,userIDList:[e],bFromGetMyProfile:!0})}},{key:"_handleResponse",value:function(e){var t=e.data.userProfileItem;if(!it(t))return[];for(var n=[],r=Date.now(),o=0,i=t.length;o<i;o++){var a=t[o],s=a.to,u=a.profileItem;if("@TLS#NOT_FOUND"!==s&&""!==s){var c=this._update(s,this._getLatestProfileFromResponse(s,u)).latestProfile;n.push(c)}}return Ge.l("".concat(this._n,"._handleResponse cost:").concat(Xt(r))),n}},{key:"_getLatestProfileFromResponse",value:function(e,t){var n={userID:e,profileCustomField:[]};if(!Qt(t))for(var r=0,o=t.length;r<o;r++)if(t[r].tag.indexOf("Tag_Profile_Custom")>-1)n.profileCustomField.push({key:t[r].tag,value:t[r].value});else switch(t[r].tag){case Fe.NICK:n.nick=t[r].value;break;case Fe.GENDER:n.gender=t[r].value;break;case Fe.BIRTHDAY:n.birthday=t[r].value;break;case Fe.LOCATION:n.location=t[r].value;break;case Fe.SELFSIGNATURE:n.selfSignature=t[r].value;break;case Fe.ALLOWTYPE:n.allowType=t[r].value;break;case Fe.LANGUAGE:n.language=t[r].value;break;case Fe.AVATAR:n.avatar=t[r].value;break;case Fe.MESSAGESETTINGS:n.messageSettings=t[r].value;break;case Fe.ADMINFORBIDTYPE:n.adminForbidType=t[r].value;break;case Fe.LEVEL:n.level=t[r].value;break;case Fe.ROLE:n.role=t[r].value;break;default:Ge.w("".concat(this._n,"._getLatestProfileFromResponse unknown tag:"),t[r].tag,t[r].value)}return n}},{key:"updateMyProfile",value:function(e){var t=this,n="".concat(this._n,".").concat("updateMyProfile");if(e.nick&&!1===this._userModule.filterProfanity("nick",e))return jn({code:qn.PROFANITY_FOUND});if(e.selfSignature&&!1===this._userModule.filterProfanity("selfSignature",e))return jn({code:qn.PROFANITY_FOUND});var r=new ar("updateMyProfile");r.setMessage(JSON.stringify(e));var o=(new Ar).validate(e);if(!o.valid)return r.setCode(qn.UPDATE_PROFILE_INVALID_PARAM).setMoreMessage("info:".concat(o.tips)).setNetworkType(this._userModule.getNetworkType()).end(),Ge.e("".concat(n," info:").concat(o.tips)),jn({code:qn.UPDATE_PROFILE_INVALID_PARAM});var i=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&("profileCustomField"===a?e.profileCustomField.forEach((function(e){i.push({tag:e.key,value:e.value})})):i.push({tag:Fe[a.toUpperCase()],value:e[a]}));if(0===i.length){var s=new Fn({code:qn.UPDATE_PROFILE_NO_KEY});return r.setError(s,!0,this._userModule.getNetworkType()).end(),Ge.e("".concat(n," failed. error:"),s),jn(s)}var u=this._userModule.getMyAccount();return this._userModule.request({protocolName:Kn.UPDATE_MY_PROFILE,requestData:{fromAccount:u,profileItem:i}}).then((function(o){r.setNetworkType(t._userModule.getNetworkType()).end(),Ge.i("".concat(n," ok"));var i=t._update(u,e),a=i.isProfileUpdated,s=i.latestProfile;return!0===a&&t._userModule.emitOuterEvent(A.PROFILE_UPDATED,[s]),Bn(s)})).catch((function(e){return t._userModule.probeNetwork().then((function(t){var n=M(t,2),o=n[0],i=n[1];r.setError(e,o,i).end()})),Ge.e("".concat(n," failed. error:"),e),jn(e)}))}},{key:"onProfileModified",value:function(e){var t=e.dataList;if(!Qt(t)){var n,r=t.length;Ge.d("".concat(this._n,".onProfileModified count:").concat(r," dataList:"),e.dataList);for(var o=[],i=0;i<r;i++){n=t[i].userID;var a=this._update(n,this._getLatestProfileFromResponse(n,t[i].profileList)),s=a.isProfileUpdated,u=a.latestProfile;!0===s&&o.push(u)}o.length>0&&(this._userModule.emitInnerEvent(Cr.PROFILE_UPDATED,o),this._userModule.emitOuterEvent(A.PROFILE_UPDATED,o))}}},{key:"_fill",value:function(){if(0===this.accountProfileMap.size){for(var e=this._getCachedProfiles(),t=Date.now(),n=0,r=e.length;n<r;n++)t-e[n].lastUpdatedTime<this.expirationTime&&this.accountProfileMap.set(e[n].userID,e[n]);Ge.l("".concat(this._n,"._fill from cache, size:").concat(this.accountProfileMap.size))}}},{key:"_update",value:function(e,t){var n,r=!1,o=Date.now();return this._contains(e)?(n=this._getProfileFromMap(e),t.profileCustomField&&!0===St(n.profileCustomField,t.profileCustomField)&&(n.lastUpdatedTime=o,r=!0),pt(n,t,["profileCustomField"])>0&&(n.lastUpdatedTime=o,r=!0)):(n=new Ar(t),(this._userModule.isMyFriend(e)||e===this._userModule.getMyAccount())&&(n.lastUpdatedTime=o,r=!0,this.accountProfileMap.set(e,n))),this._flush(e===this._userModule.getMyAccount()),!0===r&&Ge.l("".concat(this._n,"._update account:").concat(e," isProfileUpdated:").concat(r)),{isProfileUpdated:r,latestProfile:n}}},{key:"_flush",value:function(e){var t=T(this.accountProfileMap.values()),n=this._userModule.getStorageModule();Ge.d("".concat(this._n,"._flush length:").concat(t.length," flushAtOnce:").concat(e)),n.setItem(this.TAG,t,e)}},{key:"_contains",value:function(e){return this.accountProfileMap.has(e)}},{key:"_getProfileFromMap",value:function(e){return this.accountProfileMap.get(e)}},{key:"_getCachedProfiles",value:function(){var e=this._userModule.getStorageModule().getItem(this.TAG);return Qt(e)?[]:e}},{key:"onConversationsProfileUpdated",value:function(e){for(var t,n,r,o=[],i=0,a=e.length;i<a;i++)n=(t=e[i]).userID,this._userModule.isMyFriend(n)&&(this._contains(n)?(r=this._getProfileFromMap(n),pt(r,t)>0&&o.push(n)):o.push(t.userID));0!==o.length&&(Ge.i("".concat(this._n,".onConversationsProfileUpdated toAccountList:").concat(o)),this.getUserProfile({userIDList:o}))}},{key:"getNickAndAvatarByUserID",value:function(e){if(this._contains(e)){var t=this._getProfileFromMap(e);return{nick:t.nick,avatar:t.avatar}}return{nick:"",avatar:""}}},{key:"getUserNickAndAvatar",value:function(e){var t=this,n=T(new Set(e));Ge.l("".concat(this._n,".getUserNickAndAvatar userIDList.length:").concat(e.length," uniqueUserIDList.length:").concat(n.length));var r=[];if(0===e.length)return Promise.resolve(r);var o=this._createUserIDListGroup(n),i=[];return o.forEach((function(e){i.push(t.getUserProfile({userIDList:e}))})),Promise.all(i).then((function(e){return e.forEach((function(e){var t=e.data.map((function(e){return{userID:e.userID,nick:e.nick,avatar:e.avatar}}));r.push.apply(r,T(t))})),r}))}},{key:"_createUserIDListGroup",value:function(e){for(var t=[],n=0;n<e.length;)t.push(e.slice(n,n+=100));return t}},{key:"reset",value:function(){this._flush(!0),this.accountProfileMap.clear()}}]),e}(),no=c((function e(t){a(this,e),Qt||(this.userID=t.userID||"",this.timeStamp=t.timeStamp||0)})),ro=function(){function e(t){a(this,e),this._userModule=t,this._n="BlacklistHandler",this._blacklistMap=new Map,this.startIndex=0,this.maxLimited=100,this.currentSequence=0}return c(e,[{key:"getLocalBlacklist",value:function(){return T(this._blacklistMap.keys())}},{key:"getBlacklist",value:function(){var e=this,t="".concat(this._n,".getBlacklist"),n={fromAccount:this._userModule.getMyAccount(),maxLimited:this.maxLimited,startIndex:0,lastSequence:this.currentSequence},r=new ar("getBlacklist");return this._userModule.request({protocolName:Kn.GET_BLACKLIST,requestData:n}).then((function(n){var o=n.data,i=o.blackListItem,a=o.currentSequence,s=Qt(i)?0:i.length;r.setNetworkType(e._userModule.getNetworkType()).setMessage("count:".concat(s)).end(),Ge.i("".concat(t," ok")),e.currentSequence=a,e._handleResponse(i,!0),e._userModule.emitOuterEvent(A.BLACKLIST_UPDATED,T(e._blacklistMap.keys()))})).catch((function(n){return e._userModule.probeNetwork().then((function(e){var t=M(e,2),o=t[0],i=t[1];r.setError(n,o,i).end()})),Ge.e("".concat(t," failed. error:"),n),jn(n)}))}},{key:"addBlacklist",value:function(e){var t=this,n=new ar("addToBlacklist"),r="".concat(this._n,".addBlacklist"),o=this._userModule.getMyAccount();if(1===e.userIDList.length&&e.userIDList[0]===o){var i=qn.CANNOT_ADD_SELF_TO_BLACKLIST,a=this._userModule.getErrorMessage(i);n.setCode(i).setMessage(a).setNetworkType(this._userModule.getNetworkType()).end();var s=new Fn({code:i});return Ge.e("".concat(r," failed. error:"),s),jn(s)}return e.userIDList.includes(o)&&(e.userIDList=e.userIDList.filter((function(e){return e!==o}))),e.fromAccount=this._userModule.getMyAccount(),e.toAccount=e.userIDList,this._userModule.request({protocolName:Kn.ADD_TO_BLACKLIST,requestData:e}).then((function(o){return n.setNetworkType(t._userModule.getNetworkType()).setMessage(e.userIDList.length>5?"userIDList.length:".concat(e.userIDList.length):"userIDList:".concat(e.userIDList)).end(),Ge.i("".concat(r," ok")),t._handleResponse(o.resultItem,!0),xn(T(t._blacklistMap.keys()))})).catch((function(e){return t._userModule.probeNetwork().then((function(t){var r=M(t,2),o=r[0],i=r[1];n.setError(e,o,i).end()})),Ge.e("".concat(r," failed. error:"),e),jn(e)}))}},{key:"_handleResponse",value:function(e,t){if(!Qt(e))for(var n,r,o,i=0,a=e.length;i<a;i++)r=e[i].to,o=e[i].resultCode,(at(o)||0===o)&&(t?((n=this._blacklistMap.has(r)?this._blacklistMap.get(r):new no).userID=r,!Qt(e[i].addBlackTimeStamp)&&(n.timeStamp=e[i].addBlackTimeStamp),this._blacklistMap.set(r,n)):this._blacklistMap.has(r)&&(n=this._blacklistMap.get(r),this._blacklistMap.delete(r)));Ge.l("".concat(this._n,"._handleResponse total:").concat(this._blacklistMap.size," bAdd:").concat(t))}},{key:"deleteBlacklist",value:function(e){var t=this,n="".concat(this._n,".deleteBlacklist"),r=new ar("removeFromBlacklist");return e.fromAccount=this._userModule.getMyAccount(),e.toAccount=e.userIDList,this._userModule.request({protocolName:Kn.REMOVE_FROM_BLACKLIST,requestData:e}).then((function(o){return r.setNetworkType(t._userModule.getNetworkType()).setMessage(e.userIDList.length>5?"userIDList.length:".concat(e.userIDList.length):"userIDList:".concat(e.userIDList)).end(),Ge.i("".concat(n," ok")),t._handleResponse(o.data.resultItem,!1),xn(T(t._blacklistMap.keys()))})).catch((function(e){return t._userModule.probeNetwork().then((function(t){var n=M(t,2),o=n[0],i=n[1];r.setError(e,o,i).end()})),Ge.e("".concat(n," failed. error:"),e),jn(e)}))}},{key:"onAccountDeleted",value:function(e){for(var t=0,n=e.length;t<n;t++){var r=e[t];this._blacklistMap.has(r)&&this._blacklistMap.delete(r)}var o=e.length;o>0&&(Ge.l("".concat(this._n,".onAccountDeleted count:").concat(o," ").concat(o<30?"userIDList:".concat(e):"")),this._userModule.emitOuterEvent(A.BLACKLIST_UPDATED,T(this._blacklistMap.keys())))}},{key:"onAccountAdded",value:function(e){for(var t,n=[],r=0,o=e.length;r<o;r++)t=e[r],this._blacklistMap.has(t)||(this._blacklistMap.set(t,new no({userID:t})),n.push(t));n.length>0&&(Ge.l("".concat(this._n,".onAccountAdded count:").concat(n.length," userIDList:"),n),this._userModule.emitOuterEvent(A.BLACKLIST_UPDATED,T(this._blacklistMap.keys())))}},{key:"reset",value:function(){this._blacklistMap.clear(),this.startIndex=0,this.maxLimited=100,this.currentSequence=0}}]),e}(),oo=function(e){var t=String(e).replace(/[=]+$/,""),n="";if(t.length%4==1)return"";for(var r,o,i=0,a=0;o=t.charAt(a++);~o&&(r=i%4?64*r+o:o,i++%4)?n+=String.fromCharCode(255&r>>(-2*i&6)):0)o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(o);try{return decodeURIComponent(escape(n))}catch(d){return""}},io=function(){function e(t){a(this,e),this._userModule=t,this._n="UserStatusHandler",this.MAX_QUERY_USER_COUNT=500,this.MAX_SUBSCRIBE_USER_COUNT=100,this.MAX_UNSUBSCRIBE_USER_COUNT=100,this._userModule.getInnerEmitterInstance().on(Cr.CLOUD_CONFIG_UPDATED,this._onCloudConfigUpdated,this)}return c(e,[{key:"_onCloudConfigUpdated",value:function(){var e=this._userModule.getCloudConfig("status_query_count"),t=this._userModule.getCloudConfig("status_sub_count"),n=this._userModule.getCloudConfig("status_unsub_count");Ge.l("".concat(this._n,"._onCloudConfigUpdated statusQueryCount:").concat(e," statusSubscribeCount:").concat(t)+" statusUnsubscribeCount:".concat(n)),at(e)||(this.MAX_QUERY_USER_COUNT=parseInt(e,10)),at(e)||(this.MAX_SUBSCRIBE_USER_COUNT=parseInt(t,10)),at(e)||(this.MAX_UNSUBSCRIBE_USER_COUNT=parseInt(n,10))}},{key:"onUserStatusUpdated",value:function(e){var t=e.dataList,n=this._userModule.getMyUserID(),r=this._userModule.getModule(12),o=t.map((function(e){var t=e.to,o=e.statusType,i=e.customStatus,a=oo(i);return t===n&&r.setCustomStatus(a),{userID:t,statusType:o,customStatus:a}}));this._userModule.emitOuterEvent(A.USER_STATUS_UPDATED,o)}},{key:"setSelfStatus",value:function(e){var t=this,n="".concat(this._n,".setSelfStatus");if(!1===this._userModule.filterProfanity("customStatus",e))return jn({code:qn.PROFANITY_FOUND});var r=new ar("setSelfStatus"),o=e.customStatus;return this._userModule.request({protocolName:Kn.SET_SELF_STATUS,requestData:{customStatus:o}}).then((function(e){return r.setNetworkType(t._userModule.getNetworkType()).setMessage("customStatus:".concat(o)).end(),Ge.l("".concat(n," ok. customStatus:").concat(o)),t._userModule.getModule(12).setCustomStatus(o),xn({userID:t._userModule.getMyUserID(),statusType:1,customStatus:o})})).catch((function(e){return t._userModule.probeNetwork().then((function(t){var n=M(t,2),o=n[0],i=n[1];r.setError(e,o,i).end()})),Ge.e("".concat(n," failed. error:"),e),jn(e)}))}},{key:"getUserStatus",value:function(e){var t=this,n="".concat(this._n,".").concat("getUserStatus"),r=e.userIDList,o=void 0===r?[]:r,i=this._userModule.getMyUserID(),a=T(o),s=void 0,u=a.indexOf(i);if(u>-1){a.splice(u,1);var c=this._userModule.getModule(12).getCustomStatus();s={userID:i,statusType:1,customStatus:c}}if(0===a.length)return Bn({successUserList:[s],failureUserList:[]});if(!this._userModule.canIUse(q.USER_STATUS))return this._userModule.cannotUseCommercialAbility("getUserStatus");a.length>this.MAX_QUERY_USER_COUNT&&(Ge.w("".concat(n," ").concat(Wt(this.MAX_QUERY_USER_COUNT))),a=o.slice(0,this.MAX_QUERY_USER_COUNT));var l=new ar("getUserStatus");return this._userModule.request({protocolName:Kn.GET_USER_STATUS,requestData:{userIDList:a}}).then((function(e){var r=e.data,i=r.successUserList,a=void 0===i?[]:i,u=r.failureUserList,c=void 0===u?[]:u,d=a.map((function(e){var t=e.userID,n=e.statusType,r=e.customStatus;return{userID:t,statusType:n,customStatus:oo(r)}})),f=c.map((function(e){var t=e.userID,n=e.invalidUserID,r=e.errorCode,o=e.errorInfo;return{userID:Qt(n)?t:n,code:r,message:o}}));at(s)||d.unshift(s);var p="userID count:".concat(o.length,", success count:").concat(d.length,", fail count:").concat(f.length);return l.setNetworkType(t._userModule.getNetworkType()).setMessage("".concat(p)).end(),Ge.l("".concat(n," ok. ").concat(p,".")),xn({successUserList:d,failureUserList:f})})).catch((function(e){return t._userModule.probeNetwork().then((function(t){var n=M(t,2),r=n[0],i=n[1];l.setMessage("userID count:".concat(o.length)).setError(e,r,i).end()})),Ge.e("".concat(n," failed. error:"),e),jn(e)}))}},{key:"subscribeUserStatus",value:function(e){var t=this,n="subscribeUserStatus";if(!this._userModule.canIUse(q.USER_STATUS))return this._userModule.cannotUseCommercialAbility(n);var r="".concat(this._n,".").concat(n),o=e.userIDList,i=void 0===o?[]:o,a=T(i);a.length>this.MAX_SUBSCRIBE_USER_COUNT&&(Ge.w("".concat(r," ").concat(Wt(this.MAX_SUBSCRIBE_USER_COUNT))),a=i.slice(0,this.MAX_SUBSCRIBE_USER_COUNT));var s=new ar(n),u="userID count:".concat(i.length);return Ge.l("".concat(r," ").concat(u)),this._userModule.request({protocolName:Kn.SUBSCRIBE_USER_STATUS,requestData:{userIDList:a}}).then((function(e){var n=e.data.failureUserList,o=(void 0===n?[]:n).map((function(e){var t=e.userID,n=e.invalidUserID,r=e.errorCode,o=e.errorInfo;return{userID:Qt(n)?t:n,code:r,message:o}}));return s.setNetworkType(t._userModule.getNetworkType()).setMessage("".concat(u," fail count:").concat(o.length)).end(),Ge.l("".concat(r," ok. fail count:").concat(o.length,".")),xn({failureUserList:o})})).catch((function(e){return t._userModule.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];s.setMessage("".concat(u)).setError(e,r,o).end()})),Ge.e("".concat(r," failed. error:"),e),jn(e)}))}},{key:"unsubscribeUserStatus",value:function(e){var t=this,n="unsubscribeUserStatus";if(!this._userModule.canIUse(q.USER_STATUS))return this._userModule.cannotUseCommercialAbility(n);var r="".concat(this._n,".").concat(n),o=(e||{}).userIDList,i=void 0===o?[]:o,a=T(i);i.length>this.MAX_UNSUBSCRIBE_USER_COUNT&&(Ge.w("".concat(r," ").concat(Wt(this.MAX_UNSUBSCRIBE_USER_COUNT))),a=i.slice(0,this.MAX_UNSUBSCRIBE_USER_COUNT));var s=new ar(n),u="userID count:".concat(i.length);Ge.l("".concat(r," ").concat(u));var c={userIDList:a};return 0===a.length&&(c.userIDList=void 0,c.unsubscribeAll=1),this._userModule.request({protocolName:Kn.UNSUBSCRIBE_USER_STATUS,requestData:c}).then((function(e){var n=e.data.failureUserList,o=(void 0===n?[]:n).map((function(e){var t=e.userID,n=e.invalidUserID,r=e.errorCode,o=e.errorInfo;return{userID:Qt(n)?t:n,code:r,message:o}}));return s.setNetworkType(t._userModule.getNetworkType()).setMessage("".concat(u," fail count:").concat(o.length)).end(),Ge.l("".concat(r," ok. fail count:").concat(o.length,".")),xn({failureUserList:o})})).catch((function(e){return t._userModule.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];s.setMessage("".concat(u)).setError(e,r,o).end()})),Ge.e("".concat(r," failed. error:"),e),jn(e)}))}},{key:"reset",value:function(){this.MAX_QUERY_USER_COUNT=500,this.MAX_SUBSCRIBE_USER_COUNT=100,this.MAX_UNSUBSCRIBE_USER_COUNT=100}}]),e}(),ao=function(e){d(n,e);var t=I(n);function n(e){var r;return a(this,n),(r=t.call(this,e))._n="UserModule",r._profileHandler=new to(m(r)),r._blacklistHandler=new ro(m(r)),r._userStatusHandler=new io(m(r)),r.getInnerEmitterInstance().on(Cr.A2KEY_AND_TINYID_UPDATED,r.onContextUpdated,m(r)),r}return c(n,[{key:"onContextUpdated",value:function(e){this._profileHandler.getMyProfile(),this._blacklistHandler.getBlacklist()}},{key:"mockOnNickAvatarModified",value:function(e,t){Ge.l("".concat(this._n,"._mockOnNickAvatarModified nick:").concat(e," avatar:").concat(t)),this.onProfileModified({dataList:[{pushType:1,userID:this.getMyUserID(),profileList:[{tag:Fe.NICK,value:e},{tag:Fe.AVATAR,value:t}]}]})}},{key:"onProfileModified",value:function(e){this._profileHandler.onProfileModified(e)}},{key:"onRelationChainModified",value:function(e){var t=e.dataList;if(!Qt(t)){var n=[];t.forEach((function(e){e.blackListDelAccount&&n.push.apply(n,T(e.blackListDelAccount))})),n.length>0&&this._blacklistHandler.onAccountDeleted(n);var r=[];t.forEach((function(e){e.blackListAddAccount&&r.push.apply(r,T(e.blackListAddAccount))})),r.length>0&&this._blacklistHandler.onAccountAdded(r)}}},{key:"onConversationsProfileUpdated",value:function(e){this._profileHandler.onConversationsProfileUpdated(e)}},{key:"getMyAccount",value:function(){return this.getMyUserID()}},{key:"getMyNick",value:function(){return this._profileHandler.getNickAndAvatarByUserID(this.getMyUserID()).nick}},{key:"getMyProfile",value:function(){return this._profileHandler.getMyProfile()}},{key:"getStorageModule",value:function(){return this.getModule(13)}},{key:"filterProfanity",value:function(e,t){var n=this.getModule(29);if(!n)return!0;var r=n.filterText(t[e],"user_profile"),o=r.isAllowedToSend,i=r.modifiedText;return!0===o&&(t[e]=i,!0)}},{key:"isMyFriend",value:function(e){var t=this.getModule(8);return!!t&&t.isMyFriend(e)}},{key:"getUserProfile",value:function(e){return this._profileHandler.getUserProfile(e)}},{key:"updateMyProfile",value:function(e){return this._profileHandler.updateMyProfile(e)}},{key:"getNickAndAvatarByUserID",value:function(e){return this._profileHandler.getNickAndAvatarByUserID(e)}},{key:"getUserNickAndAvatar",value:function(e){return this._profileHandler.getUserNickAndAvatar(e)}},{key:"getLocalBlacklist",value:function(){var e=this._blacklistHandler.getLocalBlacklist();return Bn(e)}},{key:"addBlacklist",value:function(e){return this._blacklistHandler.addBlacklist(e)}},{key:"deleteBlacklist",value:function(e){return this._blacklistHandler.deleteBlacklist(e)}},{key:"onUserStatusUpdated",value:function(e){this._userStatusHandler.onUserStatusUpdated(e)}},{key:"setSelfStatus",value:function(e){return this._userStatusHandler.setSelfStatus(e)}},{key:"getUserStatus",value:function(e){return this._userStatusHandler.getUserStatus(e)}},{key:"subscribeUserStatus",value:function(e){return this._userStatusHandler.subscribeUserStatus(e)}},{key:"unsubscribeUserStatus",value:function(e){return this._userStatusHandler.unsubscribeUserStatus(e)}},{key:"reset",value:function(){Ge.l("".concat(this._n,".reset")),this._profileHandler.reset(),this._blacklistHandler.reset(),this._userStatusHandler.reset()}}]),n}(Hn),so=function(){function e(t,n){a(this,e),this._m=t,this._isLoggedIn=!1,this._SDKAppID=n.SDKAppID,this._userID=n.userID||"",this._userSig=n.userSig||"",this._version="3.2.3",this._a2Key="",this._tinyID="",this._customStatus="",this._contentType="json",this._unlimitedAVChatRoom=n.unlimitedAVChatRoom,this._scene=n.scene||"",this._oversea=n.oversea,this._instanceID=n.instanceID,this._statusInstanceID=0,this._isDevMode=n.devMode,this._proxyServer=n.proxyServer,this._fileUploadProxy=n.fileUploadProxy,this._fileDownloadProxy=n.fileDownloadProxy,this._applicationID=0,this._isUsingChatCore=!1}return c(e,[{key:"isLoggedIn",value:function(){return this._isLoggedIn}},{key:"isOversea",value:function(){return this._oversea}},{key:"isPrivateNetWork",value:function(){return this._proxyServer}},{key:"isDevMode",value:function(){return this._isDevMode}},{key:"isSingaporeSite",value:function(){return this._SDKAppID>=2e7&&this._SDKAppID<3e7||this._SDKAppID>=172e7&&this._SDKAppID<173e7}},{key:"isKoreaSite",value:function(){return this._SDKAppID>=3e7&&this._SDKAppID<4e7||this._SDKAppID>=173e7&&this._SDKAppID<174e7}},{key:"isGermanySite",value:function(){return this._SDKAppID>=4e7&&this._SDKAppID<5e7||this._SDKAppID>=174e7&&this._SDKAppID<175e7}},{key:"isIndiaSite",value:function(){return this._SDKAppID>=5e7&&this._SDKAppID<6e7||this._SDKAppID>=175e7&&this._SDKAppID<176e7}},{key:"isJapanSite",value:function(){return this._SDKAppID>=6e7&&this._SDKAppID<7e7||this._SDKAppID>=176e7&&this._SDKAppID<177e7}},{key:"isUSASite",value:function(){return this._SDKAppID>=7e7&&this._SDKAppID<8e7||this._SDKAppID>=177e7&&this._SDKAppID<178e7}},{key:"isIndonesiaSite",value:function(){return this._SDKAppID>=8e7&&this._SDKAppID<9e7||this._SDKAppID>=178e7&&this._SDKAppID<179e7}},{key:"isIntl",value:function(){return 0===(e=this._SDKAppID)||e>=2e7&&e<9e7||e>=172e7&&e<179e7;var e}},{key:"isUnlimitedAVChatRoom",value:function(){return this._unlimitedAVChatRoom}},{key:"isUsingChatCore",value:function(){return this._isUsingChatCore}},{key:"setUsingChatCore",value:function(e){this._isUsingChatCore=e}},{key:"setUserID",value:function(e){this._userID=e}},{key:"getUserID",value:function(){return this._userID}},{key:"setUserSig",value:function(e){this._userSig=e}},{key:"getUserSig",value:function(){return this._userSig}},{key:"getSDKAppID",value:function(){return this._SDKAppID}},{key:"setTinyID",value:function(e){this._tinyID=e,this._isLoggedIn=!0}},{key:"getTinyID",value:function(){return this._tinyID}},{key:"setCustomStatus",value:function(e){this._customStatus=e}},{key:"getCustomStatus",value:function(){return this._customStatus}},{key:"getScene",value:function(){return Ee?window.tencent_cloud_im_csig_flutter_for_web_25F_cy:this._isTUIKit()?"tuikit":this._scene}},{key:"getInstanceID",value:function(){return this._instanceID}},{key:"getStatusInstanceID",value:function(){return this._statusInstanceID}},{key:"setStatusInstanceID",value:function(e){this._statusInstanceID=e}},{key:"getVersion",value:function(){return this._version}},{key:"getA2Key",value:function(){return this._a2Key}},{key:"setA2Key",value:function(e){this._a2Key=e}},{key:"getContentType",value:function(){return this._contentType}},{key:"getProxyServer",value:function(){return this._proxyServer}},{key:"getFileUploadProxy",value:function(){return this._fileUploadProxy}},{key:"getFileDownloadProxy",value:function(){return this._fileDownloadProxy}},{key:"setApplicationID",value:function(e){this._applicationID=e}},{key:"getApplicationID",value:function(){return this._applicationID}},{key:"_isTUIKit",value:function(){var e=!1,t=!1,n=!1,r=!1,i=[];$&&(i=Object.keys(Q)),Z&&(i=X?Object.keys(o):Object.keys(window));for(var a=0,s=i.length;a<s;a++)if(i[a].toLowerCase().includes("uikit")){e=!0;break}if(i=null,$&&!ut(Q.createGamePortal)&&ut(getApp)&&!at(getApp())){var u=getApp().globalData;ot(u)&&!0===u.isTUIKit&&(t=!0)}!0===this._m.getModule(13).getStorageSync("TIM_".concat(this._SDKAppID,"_isTUIKit"))&&(n=!0);var c=null;if(B&&!K&&"undefined"==typeof o&&__wxConfig&&(c=__wxConfig.pages),H&&"undefined"==typeof o&&__qqConfig&&(c=__qqConfig.pages),it(c)&&c.length>0){for(var l=0,d=c.length;l<d;l++)if(c[l].toLowerCase().includes("tui")){r=!0;break}c=null}return e||t||n||r}},{key:"reset",value:function(){this._isLoggedIn=!1,this._userSig="",this._a2Key="",this._tinyID="",this._customStatus="",this._statusInstanceID=0}}]),e}(),uo={"k-vue2-pc":1,"k-vue2-h5":2,"k-vue2-h5-uni":3,"k-vue2-app-uni":4,"k-vue2-mp-uni":5,"k-vue2-pc-uni":6,"k-vue3-pc":7,"k-vue3-h5":8,"k-vue3-h5-uni":9,"k-vue3-app-uni":10,"k-vue3-mp-uni":11,"k-vue3-pc-uni":12},co=function(e){d(n,e);var t=I(n);function n(e){var r;return a(this,n),(r=t.call(this,e))._n="SignModule",r._helloInterval=120,r._lastLoginTs=0,r._lastWsHelloTs=0,r._isWebUniapp=0,kr.mixin(m(r)),r}return c(n,[{key:"onCheckTimer",value:function(e){this.isLoggedIn()&&e%this._helloInterval==0&&this._hello()}},{key:"login",value:function(e){var t="";if(this.isLoggedIn()){var n=this.getMyUserID();return(t=this.getErrorMessage("RepeatLogin",n))&&Ge.w(t),Bn({actionStatus:"OK",errorCode:0,errorInfo:t,repeatLogin:!0})}if(Date.now()-this._lastLoginTs<=15e3)return this.outputWarning("LoggingIn",e.userID),jn({code:qn.REPEAT_LOGIN});Ge.l("".concat(this._n,".login userID:").concat(e.userID));var r=this._checkLoginInfo(e);if(0!==r.code)return jn(r);var o=this.getModule(12),i=e.userID,a=e.userSig;return o.setUserID(i),o.setUserSig(a),this.getModule(20).updateProtocolConfig(),this._login()}},{key:"_login",value:function(){var e=this,t=this.getModule(12),n=t.getScene(),r=0,i=n;n&&n.startsWith("k-")&&(i=uo[n],n="tuikit");var a=new ar("login");a.setMessage("".concat(i)).setMoreMessage("identifier:".concat(this.getMyUserID()));var s="tuikit"===n;X?s?3===i||4===i||5===i||6===i?a.setUIPlatform(31):9===i||10===i||11===i||12===i?a.setUIPlatform(32):a.setUIPlatform(4):a.setUIPlatform(3):$?"tuikit"===n?a.setUIPlatform(12):a.setUIPlatform(11):Z&&(Ee?"flutter_web_uikit"===n?a.setUIPlatform(21):a.setUIPlatform(20):this._isReactUIKit()?Se?a.setUIPlatform(25):a.setUIPlatform(24):s?1===i||2===i?a.setUIPlatform(29):7===i||8===i?a.setUIPlatform(30):Se?a.setUIPlatform(17):a.setUIPlatform(14):Se?a.setUIPlatform(16):a.setUIPlatform(13));var u=this.getModule(28);if(u.canIUseOfflinePush()){this._isWebUniapp=u.getUniAppPlatform();var c=this._getStatusInstanceID();t.setStatusInstanceID(c),this.getModule(20).updateProtocolConfig(),r=u.getDeviceBrand()}var l="".concat(this._n,"._login");return this._lastLoginTs=Date.now(),this.request({protocolName:Kn.LOGIN,requestData:{deviceBrand:r,isWebUniapp:this._isWebUniapp}}).then((function(r){e._lastLoginTs=0;var i=Date.now(),s=null,u=r.data,c=u.a2Key,d=u.tinyID,f=u.helloInterval,p=u.instanceID,h=u.timeStamp,g=u.customStatus,v=void 0===g?"":g,_=u.purchaseBits,m=1e3*h,y=i-a.getStartTs(),I=m+parseInt(y/2)-i,M=a.getStartTs()+I;if(a.start(M),function(e,t){Oe=t;var n=new Date;n.setTime(e),Ge.i("baseTime from server:".concat(n," offset:").concat(Oe))}(m,I),!d)throw s=new Fn({code:qn.NO_TINYID}),a.setError(s,!0,e.getNetworkType()).end(),s;if(!c)throw s=new Fn({code:qn.NO_A2KEY}),a.setError(s,!0,e.getNetworkType()).end(),s;var T=oo(v),S="scene:".concat(n," helloInterval:").concat(f," instanceID:").concat(p," timeStamp:").concat(h," offset:").concat(I," customStatus:").concat(T," ");Ge.l("".concat(l," ok. ").concat(S));var E="",C="";if(B&&ut(Q.getAccountInfoSync)){var k=Q.getAccountInfoSync().miniProgram;k&&(E=k.appId,C=k.envVersion)}a.setNetworkType(e.getNetworkType()).setMoreMessage("".concat(S," href:").concat(Z?window.location.href:""," mpAppId:").concat(E," envVersion:").concat(C)).end(),t.setA2Key(c),t.setTinyID(d),t.setStatusInstanceID(p),t.setCustomStatus(T),_&&e.getModule(27).onPushedConfig({errorCode:0,expiredTime:0,purchaseBits:_}),e.getModule(20).updateProtocolConfig(),e.emitInnerEvent(Cr.A2KEY_AND_TINYID_UPDATED),e._helloInterval=f,e.triggerReady();var b=e.getModule(28);return b.canIUseOfflinePush()&&(o.setStorageSync("timUniAppInstanceID",p),b.init()),e._fetchCloudControlConfig(),e.getModule(29).init(),r})).catch((function(t){return e.probeNetwork().then((function(e){var n=M(e,2),r=n[0],o=n[1];a.setError(t,r,o).end(!0)})),e._m.setNotReadyReason(qn.LOGIN_FAILED),Ge.e("".concat(l," failed. error:"),t),e._lastLoginTs=0,e._m.onLoginFailed(),jn(t)}))}},{key:"logout",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!this.isLoggedIn())return jn({code:qn.USER_NOT_LOGGED_IN});var n=new ar("logout");n.setNetworkType(this.getNetworkType()).setMessage("identifier:".concat(this.getMyUserID())).end(!0);var r="".concat(this._n,".logout");return Ge.i("".concat(r," type:").concat(t)),0===t&&this._m.setNotReadyReason(qn.LOGGED_OUT),this.request({protocolName:Kn.LOGOUT,requestData:{type:t}}).then((function(){return e.resetReady(),Bn({})})).catch((function(t){return Ge.e("".concat(r," error:"),t),e.resetReady(),Bn({})}))}},{key:"getLoginUser",value:function(){return this.isLoggedIn()?this.getMyUserID():""}},{key:"_fetchCloudControlConfig",value:function(){this.getModule(23).fetchConfig()}},{key:"_getStatusInstanceID",value:function(){return o.getStorageSync("timUniAppInstanceID")}},{key:"_hello",value:function(){var e=this;this._lastWsHelloTs=Date.now(),this.request({protocolName:Kn.HELLO,requestData:{isWebUniapp:this._isWebUniapp}}).catch((function(t){Ge.w("".concat(e._n,"._hello error:"),t)}))}},{key:"getLastWsHelloTs",value:function(){return this._lastWsHelloTs}},{key:"_checkLoginInfo",value:function(e){var t=0;return Qt(this.getModule(12).getSDKAppID())?t=qn.NO_SDKAPPID:Qt(e.userID)?t=qn.NO_IDENTIFIER:Qt(e.userSig)&&(t=qn.NO_USERSIG),{code:t}}},{key:"_isReactUIKit",value:function(){return Z&&void 0!==window.tencent_cloud_im_csig_react_uikit_23F_xa}},{key:"onMultipleAccountKickedOut",value:function(e){var t=this;new ar("kickedOut").setNetworkType(this.getNetworkType()).setMessage("type:".concat(O.KICKED_OUT_MULT_ACCOUNT," newInstanceInfo:").concat(JSON.stringify(e))).end(!0),Ge.w("".concat(this._n,".onMultipleAccountKickedOut userID:").concat(this.getMyUserID()," newInstanceInfo:"),e),this.logout(1).then((function(){t.emitOuterEvent(A.KICKED_OUT,{type:O.KICKED_OUT_MULT_ACCOUNT}),t._m.setNotReadyReason(qn.KICKED_OUT_MULT_ACCOUNT),t._m.reset()}))}},{key:"onMultipleDeviceKickedOut",value:function(e){var t=this;new ar("kickedOut").setNetworkType(this.getNetworkType()).setMessage("type:".concat(O.KICKED_OUT_MULT_DEVICE," newInstanceInfo:").concat(JSON.stringify(e))).end(!0),Ge.w("".concat(this._n,".onMultipleDeviceKickedOut userID:").concat(this.getMyUserID()," newInstanceInfo:"),e),this.logout(1).then((function(){t.emitOuterEvent(A.KICKED_OUT,{type:O.KICKED_OUT_MULT_DEVICE}),t._m.setNotReadyReason(qn.KICKED_OUT_MULT_DEVICE),t._m.reset()}))}},{key:"onUserSigExpired",value:function(){new ar("kickedOut").setNetworkType(this.getNetworkType()).setMessage(O.KICKED_OUT_USERSIG_EXPIRED).end(!0),Ge.w("".concat(this._n,".onUserSigExpired userID:").concat(this.getMyUserID())),0!==this.getModule(12).getStatusInstanceID()&&(this.emitOuterEvent(A.KICKED_OUT,{type:O.KICKED_OUT_USERSIG_EXPIRED}),this._m.setNotReadyReason(qn.KICKED_OUT_USERSIG_EXPIRED),this._m.reset())}},{key:"onRestApiKickedOut",value:function(e){new ar("kickedOut").setNetworkType(this.getNetworkType()).setMessage("type:".concat(O.KICKED_OUT_REST_API," newInstanceInfo:").concat(JSON.stringify(e))).end(!0),Ge.w("".concat(this._n,".onRestApiKickedOut userID:").concat(this.getMyUserID()," newInstanceInfo:"),e),0!==this.getModule(12).getStatusInstanceID()&&(this.emitOuterEvent(A.KICKED_OUT,{type:O.KICKED_OUT_REST_API}),this._m.setNotReadyReason(qn.KICKED_OUT_REST_API),this._m.reset(),this.getModule(21).onRestApiKickedOut())}},{key:"reset",value:function(){Ge.l("".concat(this._n,".reset")),this.resetReady(),this._helloInterval=120,this._lastLoginTs=0,this._lastWsHelloTs=0,this._isWebUniapp=0}}]),n}(Hn);function lo(){return null}var fo=function(){function e(t){a(this,e),this._m=t,this._n="StorageModule",this._storageQueue=new Map,this._errorTolerantHandle()}return c(e,[{key:"_errorTolerantHandle",value:function(){$||!at(window)&&this._canIUseCookies()||(this.getItem=lo,this.setItem=lo,this.removeItem=lo,this.clear=lo)}},{key:"onCheckTimer",value:function(e){if(e%20==0){if(0===this._storageQueue.size)return;this._doFlush()}}},{key:"_doFlush",value:function(){try{var e,t=D(this._storageQueue);try{for(t.s();!(e=t.n()).done;){var n=M(e.value,2),r=n[0],o=n[1];this._setStorageSync(this._getKey(r),o)}}catch(c){t.e(c)}finally{t.f()}this._storageQueue.clear()}catch(l){Ge.w("".concat(this._n,"._doFlush error:"),l)}}},{key:"_getPrefix",value:function(){var e=this._m.getModule(12);return"TIM_".concat(e.getSDKAppID(),"_").concat(e.getUserID(),"_")}},{key:"_getKey",value:function(e){return"".concat(this._getPrefix()).concat(e)}},{key:"getItem",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];try{var n=t?this._getKey(e):e;return this.getStorageSync(n)}catch(a){return Ge.w("".concat(this._n,".getItem error:"),a),{}}}},{key:"setItem",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(n){var o=r?this._getKey(e):e;this._setStorageSync(o,t)}else this._storageQueue.set(e,t)}},{key:"clear",value:function(){try{$?Q.clearStorageSync():this._canIUseCookies()&&localStorage.clear()}catch(e){Ge.w("".concat(this._n,".clear error:"),e)}}},{key:"removeItem",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];try{var n=t?this._getKey(e):e;this._removeStorageSync(n)}catch(a){Ge.w("".concat(this._n,".removeItem error:"),a)}}},{key:"getSize",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"b";try{var r={size:0,limitSize:5242880,unit:n};if(Object.defineProperty(r,"leftSize",{enumerable:!0,get:function(){return r.limitSize-r.size}}),$&&(r.limitSize=1024*Q.getStorageInfoSync().limitSize),e)r.size=JSON.stringify(this.getItem(e)).length+this._getKey(e).length;else if($){var o=Q.getStorageInfoSync(),i=o.keys;i.forEach((function(e){r.size+=JSON.stringify(t.getStorageSync(e)).length+t._getKey(e).length}))}else if(this._canIUseCookies())for(var a in localStorage)localStorage.hasOwnProperty(a)&&(r.size+=localStorage.getItem(a).length+a.length);return this._convertUnit(r)}catch(d){Ge.w("".concat(this._n," error:"),d)}}},{key:"_convertUnit",value:function(e){var t={},n=e.unit;for(var r in t.unit=n,e)"number"==typeof e[r]&&("kb"===n.toLowerCase()?t[r]=Math.round(e[r]/1024):"mb"===n.toLowerCase()?t[r]=Math.round(e[r]/1024/1024):t[r]=e[r]);return t}},{key:"_setStorageSync",value:function(e,t){$?Y?my.setStorageSync({key:e,data:t}):Q.setStorageSync(e,t):this._canIUseCookies()&&localStorage.setItem(e,JSON.stringify(t))}},{key:"getStorageSync",value:function(e){return $?Y?my.getStorageSync({key:e}).data:Q.getStorageSync(e):this._canIUseCookies()?JSON.parse(localStorage.getItem(e)):{}}},{key:"_removeStorageSync",value:function(e){$?Y?my.removeStorageSync({key:e}):Q.removeStorageSync(e):this._canIUseCookies()&&localStorage.removeItem(e)}},{key:"_canIUseCookies",value:function(){return navigator&&navigator.cookieEnabled&&localStorage}},{key:"reset",value:function(){Ge.l("".concat(this._n,".reset")),this._doFlush()}}]),e}(),po=function(){function e(t){a(this,e),this._n="SSOLogBody",this._report=[]}return c(e,[{key:"pushIn",value:function(e){Ge.d("".concat(this._n,".pushIn"),this._report.length,e),this._report.push(e)}},{key:"backfill",value:function(e){var t;it(e)&&0!==e.length&&(Ge.d("".concat(this._n,".backfill"),this._report.length,e.length),(t=this._report).unshift.apply(t,T(e)))}},{key:"getLogsNumInMemory",value:function(){return this._report.length}},{key:"isEmpty",value:function(){return 0===this._report.length}},{key:"_reset",value:function(){this._report.length=0,this._report=[]}},{key:"getLogsInMemory",value:function(){var e=this._report.slice();return this._reset(),e}}]),e}(),ho=function(e){var t=e.getModule(12);return{SDKType:10,SDKAppID:t.getSDKAppID(),SDKVersion:t.getVersion(),tinyID:Number(t.getTinyID()),userID:t.getUserID(),platform:e.getPlatform(),instanceID:t.getInstanceID(),traceID:Re()}},go=function(e){d(r,e);var n=I(r);function r(e){var t;a(this,r),(t=n.call(this,e))._n="EventStatModule",t.TAG="im-ssolog-event",t._reportBody=new po,t.MIN_THRESHOLD=20,t.MAX_THRESHOLD=100,t.WAITING_TIME=6e4,t.REPORT_LEVEL=[4,5,6],t.REPORT_SDKAPPID_BLACKLIST=[],t.REPORT_TINYID_WHITELIST=[],t._lastReportTime=Date.now();var o=t.getInnerEmitterInstance();return o.on(Cr.A2KEY_AND_TINYID_UPDATED,t._onLoginSuccess,m(t)),o.on(Cr.CLOUD_CONFIG_UPDATED,t._onCloudConfigUpdated,m(t)),t}return c(r,[{key:"reportAtOnce",value:function(){this._report()}},{key:"_onLoginSuccess",value:function(){var e=this,t=this.getModule(13),n=t.getItem(this.TAG,!1);!Qt(n)&&ut(n.forEach)&&(Ge.l("".concat(this._n,"._onLoginSuccess. logs count:").concat(n.length)),n.forEach((function(t){e._reportBody.pushIn(t)})),t.removeItem(this.TAG,!1))}},{key:"_onCloudConfigUpdated",value:function(){var e=this.getCloudConfig("evt_rpt_threshold"),t=this.getCloudConfig("evt_rpt_waiting"),n=this.getCloudConfig("evt_rpt_level"),r=this.getCloudConfig("evt_rpt_sdkappid_bl"),o=this.getCloudConfig("evt_rpt_tinyid_wl");at(e)||(this.MIN_THRESHOLD=Number(e)),at(t)||(this.WAITING_TIME=Number(t)),at(n)||(this.REPORT_LEVEL=n.split(",").map((function(e){return Number(e)}))),at(r)||(this.REPORT_SDKAPPID_BLACKLIST=r.split(",").map((function(e){return Number(e)}))),at(o)||(this.REPORT_TINYID_WHITELIST=o.split(","))}},{key:"pushIn",value:function(e){e instanceof ar&&(e.updateTimeStamp(),this._reportBody.pushIn(e),this._reportBody.getLogsNumInMemory()>=this.MIN_THRESHOLD&&this._report())}},{key:"onCheckTimer",value:function(){Date.now()<this._lastReportTime+this.WAITING_TIME||this._reportBody.isEmpty()||this._report()}},{key:"_filterLogs",value:function(e){var t=this,n=this.getModule(12),r=n.getSDKAppID(),o=n.getTinyID();return Ft(this.REPORT_SDKAPPID_BLACKLIST,r)&&!qt(this.REPORT_TINYID_WHITELIST,o)?[]:e.filter((function(e){return t.REPORT_LEVEL.includes(e.level)}))}},{key:"_report",value:function(){var e=this;if(!this._reportBody.isEmpty()){var n=this._reportBody.getLogsInMemory(),r=this._filterLogs(n);if(0!==r.length){var o={header:ho(this),event:r};this.request({protocolName:Kn.SSO_STAT,requestData:t({},o)}).then((function(){e._lastReportTime=Date.now()})).catch((function(t){Ge.w("".concat(e._n,"._report failed. networkType:").concat(e.getNetworkType()," error:"),t),e._lastReportTime=Date.now(),e._reportBody.backfill(n),e._reportBody.getLogsNumInMemory()>e.MAX_THRESHOLD&&e._flushAtOnce()}))}else this._lastReportTime=Date.now()}}},{key:"_flushAtOnce",value:function(){var e=this.getModule(13),t=e.getItem(this.TAG,!1),n=this._reportBody.getLogsInMemory(),r="".concat(this._n,"._flushAtOnce");if(Qt(t))Ge.l("".concat(r," count:").concat(n.length)),e.setItem(this.TAG,n,!0,!1);else{var o=n.concat(t);o.length>this.MAX_THRESHOLD&&(o=o.slice(0,this.MAX_THRESHOLD)),Ge.l("".concat(r," count:").concat(o.length)),e.setItem(this.TAG,o,!0,!1)}}},{key:"reset",value:function(){Ge.l("".concat(this._n,".reset")),this._lastReportTime=0,this._report(),this.REPORT_SDKAPPID_BLACKLIST=[],this.REPORT_TINYID_WHITELIST=[]}}]),r}(Hn),vo="none",_o="online",mo=[qn.OVER_FREQUENCY_LIMIT,qn.OPEN_SERVICE_OVERLOAD_ERROR],yo=function(){function e(t){a(this,e),this._m=t,this._networkType="",this._n="NetMonitorModule",this.MAX_WAIT_TIME=3e3,this._mpNetworkStatusCallback=null,this._webOnlineCallback=null,this._webOfflineCallback=null}return c(e,[{key:"start",value:function(){var e=this;$?(Q.getNetworkType({success:function(t){e._networkType=t.networkType||t.subtype||"",t.networkType===vo?Ge.w("".concat(e._n,".start no network, please check!")):Ge.i("".concat(e._n,".start networkType:").concat(t.networkType))}}),this._mpNetworkStatusCallback=this._onNetworkStatusChange.bind(this),Q.onNetworkStatusChange(this._mpNetworkStatusCallback)):(this._networkType=_o,this._webOnlineCallback=this._onWebOnline.bind(this),this._webOfflineCallback=this._onWebOffline.bind(this),window&&(window.addEventListener("online",this._webOnlineCallback),window.addEventListener("offline",this._webOfflineCallback)))}},{key:"_onWebOnline",value:function(){this._onNetworkStatusChange({isConnected:!0,networkType:_o})}},{key:"_onWebOffline",value:function(){this._onNetworkStatusChange({isConnected:!1,networkType:vo})}},{key:"_onNetworkStatusChange",value:function(e){var t=e.isConnected,n=e.networkType,r="".concat(this._n,"._onNetworkStatusChange"),o=!1;t?(Ge.i("".concat(r," previous:").concat(this._networkType," current:").concat(n)),this._networkType!==n&&(o=!0,this._m.getModule(21).reConnect(!0))):this._networkType!==n&&(o=!0,Ge.w("".concat(r," no network, please check!")),this._m.getModule(21).offline()),o&&(new ar("networkChange").setMessage("isConnected:".concat(t," previousNetworkType:").concat(this._networkType," networkType:").concat(n)).end(),this._networkType=n)}},{key:"probe",value:function(e){var t=this;if(!at(e)&&mo.includes(e.code))return Promise.resolve([!0,this._networkType]);var n="".concat(this._n,".probe");return new Promise((function(e,r){$?Q.getNetworkType({success:function(r){t._networkType=r.networkType,r.networkType===vo?(Ge.w("".concat(n," no network, please check!")),e([!1,r.networkType])):(Ge.i("".concat(n," networkType:").concat(r.networkType)),e([!0,r.networkType]))}}):t._networkType===vo?e([!1,vo]):e([!0,_o])}))}},{key:"getNetworkType",value:function(){return this._networkType}},{key:"reset",value:function(){Ge.l("".concat(this._n,".reset")),$?null!==this._mpNetworkStatusCallback&&(Q.offNetworkStatusChange&&(J||K?Q.offNetworkStatusChange(this._mpNetworkStatusCallback):Q.offNetworkStatusChange()),this._mpNetworkStatusCallback=null):window&&(null!==this._webOnlineCallback&&(window.removeEventListener("online",this._webOnlineCallback),this._webOnlineCallback=null),null!==this._onWebOffline&&(window.removeEventListener("offline",this._webOfflineCallback),this._webOfflineCallback=null))}}]),e}(),Io=function(e,t){return function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}function o(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function i(e,t,r,i,a){if("function"!=typeof r)throw new TypeError("The listener must be a function");var s=new o(r,i||e,a),u=n?n+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],s]:e._events[u].push(s):(e._events[u]=s,e._eventsCount++),e}function a(e,t){0==--e._eventsCount?e._events=new r:delete e._events[t]}function s(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),s.prototype.eventNames=function(){var e,r,o=[];if(0===this._eventsCount)return o;for(r in e=this._events)t.call(e,r)&&o.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(e)):o},s.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var o=0,i=r.length,a=new Array(i);o<i;o++)a[o]=r[o].fn;return a},s.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},s.prototype.emit=function(e,t,r,o,i,a){var s=n?n+e:e;if(!this._events[s])return!1;var u,c,l=this._events[s],d=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),d){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,r),!0;case 4:return l.fn.call(l.context,t,r,o),!0;case 5:return l.fn.call(l.context,t,r,o,i),!0;case 6:return l.fn.call(l.context,t,r,o,i,a),!0}for(c=1,u=new Array(d-1);c<d;c++)u[c-1]=arguments[c];l.fn.apply(l.context,u)}else{var f,p=l.length;for(c=0;c<p;c++)switch(l[c].once&&this.removeListener(e,l[c].fn,void 0,!0),d){case 1:l[c].fn.call(l[c].context);break;case 2:l[c].fn.call(l[c].context,t);break;case 3:l[c].fn.call(l[c].context,t,r);break;case 4:l[c].fn.call(l[c].context,t,r,o);break;default:if(!u)for(f=1,u=new Array(d-1);f<d;f++)u[f-1]=arguments[f];l[c].fn.apply(l[c].context,u)}}return!0},s.prototype.on=function(e,t,n){return i(this,e,t,n,!1)},s.prototype.once=function(e,t,n){return i(this,e,t,n,!0)},s.prototype.removeListener=function(e,t,r,o){var i=n?n+e:e;if(!this._events[i])return this;if(!t)return a(this,i),this;var s=this._events[i];if(s.fn)s.fn!==t||o&&!s.once||r&&s.context!==r||a(this,i);else{for(var u=0,c=[],l=s.length;u<l;u++)(s[u].fn!==t||o&&!s[u].once||r&&s[u].context!==r)&&c.push(s[u]);c.length?this._events[i]=1===c.length?c[0]:c:a(this,i)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&a(this,t)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,e.exports=s}(t={exports:{}}),t.exports}(),Mo=["requestSnapshotUrl"],To=function(e){d(r,e);var n=I(r);function r(e){var t;a(this,r),(t=n.call(this,e))._n="UploadModule",t.TIMUploadPlugin=null,t.timUploadPlugin=null,t.COSSDK=null,t._cosUploadMethod=null,t.expiredTimeLimit=600,t.appid=0,t.bucketName="",t.ciUrl="",t.directory="",t.downloadUrl="",t.uploadUrl="",t.region="ap-shanghai",t.cos=null,t.cosOptions={secretId:"",secretKey:"",sessionToken:"",expiredTime:0},t.uploadFileType="",t.duration=900,t.tryCount=0,t.UPLOAD_SIZE_LIMIT={A:20971520,F:104857600,I:20971520,V:104857600},t.isSimpleCos=!1;var o=t.getInnerEmitterInstance();return o.on(Cr.A2KEY_AND_TINYID_UPDATED,t._init,m(t)),o.on(Cr.CLOUD_CONFIG_UPDATED,t._onCloudConfigUpdated,m(t)),t}return c(r,[{key:"_init",value:function(){var e=this.getModule(18);if(this.TIMUploadPlugin=e.getPlugin("tim-upload-plugin"),this.TIMUploadPlugin)this._initUploaderMethod();else{var t=$?"cos-wx-sdk":"cos-js-sdk";this.COSSDK=e.getPlugin(t),this.COSSDK?(this._getAuthorizationKey(),this.outputWarning("CosReplacement",t)):this.outputWarning("PluginUndetected")}}},{key:"_onCloudConfigUpdated",value:function(){var e="".concat(this._n,"._onCloudConfigUpdated"),t=this.getCloudConfig("upload_size_limit"),n=this.getCloudConfig("simple_cos");if(Ge.l("".concat(e," uploadSizeLimit:").concat(t," simpleCos:").concat(n)),!at(t))try{var o=JSON.parse(t);this.UPLOAD_SIZE_LIMIT={A:o.a?1048576*parseInt(o.a):this.UPLOAD_SIZE_LIMIT.A,F:o.f?1048576*parseInt(o.f):this.UPLOAD_SIZE_LIMIT.F,I:o.i?1048576*parseInt(o.i):this.UPLOAD_SIZE_LIMIT.I,V:o.v?1048576*parseInt(o.v):this.UPLOAD_SIZE_LIMIT.V}}catch(r){}at(n)||(this.isSimpleCos="1"===n)}},{key:"_getAuthorizationKey",value:function(){var e=this,t="".concat(this._n,".").concat("_getAuthorizationKey"),n=new ar("_getAuthorizationKey"),r=Math.ceil(Date.now()/1e3);this.request({protocolName:Kn.COS_SIGN,requestData:{duration:this.expiredTimeLimit}}).then((function(o){var i=o.data;Ge.l("".concat(t," ok. data:"),i);var a=i.expiredTime-r;n.setMessage("requestId:".concat(i.requestId," requestTime:").concat(r," expiredTime:").concat(i.expiredTime," diff:").concat(a,"s")).setNetworkType(e.getNetworkType()).end(),!$&&i.region&&(e.region=i.region),e.appid=i.appid,e.bucketName=i.bucketName,e.ciUrl=i.ciUrl,e.directory=i.directory,e.downloadUrl=i.downloadUrl,e.uploadUrl=i.uploadUrl,e.cosOptions={secretId:i.secretId,secretKey:i.secretKey,sessionToken:i.sessionToken,expiredTime:i.expiredTime},Ge.l("".concat(t," ok. region:").concat(e.region," bucketName:").concat(e.bucketName)),e._initUploaderMethod()})).catch((function(r){e.probeNetwork().then((function(e){var t=M(e,2),o=t[0],i=t[1];n.setError(r,o,i).end()})),Ge.w("".concat(t," failed. error:"),r)}))}},{key:"_getCosPreSigUrl",value:function(e){var t=this,n="".concat(this._n,".").concat("_getCosPreSigUrl"),r=Math.ceil(Date.now()/1e3),o=new ar("_getCosPreSigUrl"),i={uploadMethod:e.uploadMethod,platform:this.getPlatform(),SDKAppID:this.getSDKAppID(),userID:e.userID,conversationType:e.conversationType,uploadConfig:[{fileID:1,fileType:e.fileType,fileName:e.fileName}]},a=Kn.SIMPLE_COS_PRE_SIG;return this.isSimpleCos||(i={fileType:e.fileType,fileName:e.fileName,uploadMethod:e.uploadMethod,duration:e.duration},a=Kn.COS_PRE_SIG),this.request({protocolName:a,requestData:i}).then((function(e){t.tryCount=0;var i=e.data||{};Ge.l("".concat(n," ok. isSimpleCos:").concat(t.isSimpleCos," data:"),i);var a="";if(t.isSimpleCos){var s=i.preSig[0],u=s.uploadUrl,c=s.fileKey;a="uploadIP:".concat(i.uploadIP," uploadUrl:").concat(u," fileKey:").concat(c," cost:").concat(Xt(r))}else a="requestId:".concat(i.requestId," expiredTime:").concat(i.expiredTime," diff:").concat(i.expiredTime-r,"s");return o.setMessage(a).setNetworkType(t.getNetworkType()).end(),i})).catch((function(r){return-1===r.code&&(r.code=qn.COS_GET_SIG_FAIL),t.probeNetwork().then((function(e){var t=M(e,2),n=t[0],i=t[1];o.setError(r,n,i).end()})),Ge.w("".concat(n," failed. error:"),r),t.tryCount<1?(t.tryCount++,t._getCosPreSigUrl(e)):(t.tryCount=0,jn({code:qn.COS_GET_SIG_FAIL}))}))}},{key:"_initUploaderMethod",value:function(){var e=this;if(this.TIMUploadPlugin)return this.timUploadPlugin=new this.TIMUploadPlugin,void(this._cosUploadMethod=function(t,n){e.timUploadPlugin.uploadFile(t,n)});this.appid&&(this.cos=$?new this.COSSDK({ForcePathStyle:!0,getAuthorization:this._getAuthorization.bind(this)}):new this.COSSDK({getAuthorization:this._getAuthorization.bind(this)}),this._cosUploadMethod=$?function(t,n){e.cos.postObject(t,n)}:function(t,n){e.cos.uploadFiles(t,n)})}},{key:"onCheckTimer",value:function(e){this.COSSDK&&(this.TIMUploadPlugin||this.isLoggedIn()&&e%60==0&&Math.ceil(Date.now()/1e3)>=this.cosOptions.expiredTime-120&&this._getAuthorizationKey())}},{key:"_getAuthorization",value:function(e,t){t({TmpSecretId:this.cosOptions.secretId,TmpSecretKey:this.cosOptions.secretKey,XCosSecurityToken:this.cosOptions.sessionToken,ExpiredTime:this.cosOptions.expiredTime})}},{key:"upload",value:function(e){if(!0===e._relayFlag)return Promise.resolve();var t=this.getModule(26);switch(e.type){case O.MSG_IMAGE:return t.addTotalCount(Zn),this._uploadImage(e);case O.MSG_FILE:return t.addTotalCount(Zn),this._uploadFile(e);case O.MSG_AUDIO:return t.addTotalCount(Zn),this._uploadAudio(e);case O.MSG_VIDEO:return t.addTotalCount(Zn),this._uploadVideo(e);default:return Promise.resolve()}}},{key:"_uploadImage",value:function(e){var n=this,r=this.getModule(2),o=e.getElements()[0],i=r.getMessageOption(e.clientSequence);return this.doUploadImage({file:i.payload.file,to:i.to,message:e,onProgress:function(e){if(o.updatePercent(e),ut(i.onProgress))try{i.onProgress(e)}catch(t){return jn({code:qn.MSG_ONPROGRESS_FUNCTION_ERROR})}}}).then((function(r){var i=r.location,a=r.fileType,s=r.fileSize,u=r.width,c=r.height,l=r.smallImageUrl,d=r.smallImageWidth,f=r.smallImageHeight,p=r.largeImageUrl,h=r.largeImageWidth,g=r.largeImageHeight,v=r.imageInfoArray,_=n.isPrivateNetWork()?i:Mt(i);o.updateImageFormat(a);var m,y,I={size:s,url:_,width:u,height:c};if(v&&v.length>0)for(var M=0;M<v.length;M++){var T=v[M];1===T.type?m=T:2===T.type?y=T:I=t(t({},I),T)}else l&&p?(m={url:l,width:d,height:f},y={url:p,width:h,height:g}):(m=Pt({originUrl:_,originWidth:u,originHeight:c,min:198}),y=Pt({originUrl:_,originWidth:u,originHeight:c,min:720}));return o.updateImageInfoArray([t({},I),t({},y),t({},m)]),e}))}},{key:"_uploadFile",value:function(e){var t=this,n=this.getModule(2),r=e.getElements()[0],o=n.getMessageOption(e.clientSequence);return this.doUploadFile({file:o.payload.file,to:o.to,message:e,onProgress:function(e){if(r.updatePercent(e),ut(o.onProgress))try{o.onProgress(e)}catch(t){return jn({code:qn.MSG_ONPROGRESS_FUNCTION_ERROR})}}}).then((function(n){var o=n.location,i=t.isPrivateNetWork()?o:Mt(o);return r.updateFileUrl(i),e}))}},{key:"_uploadAudio",value:function(e){var t=this,n=this.getModule(2),r=e.getElements()[0],o=n.getMessageOption(e.clientSequence);return this.doUploadAudio({file:o.payload.file,to:o.to,message:e,onProgress:function(e){if(r.updatePercent(e),ut(o.onProgress))try{o.onProgress(e)}catch(t){return jn({code:qn.MSG_ONPROGRESS_FUNCTION_ERROR})}}}).then((function(n){var o=n.location,i=t.isPrivateNetWork()?o:Mt(o);return r.updateAudioUrl(i),e}))}},{key:"_uploadVideo",value:function(e){var t=this,n=this.getModule(2),r=e.getElements()[0],o=n.getMessageOption(e.clientSequence);return this.doUploadVideo({file:o.payload.file,to:o.to,message:e,onProgress:function(e){if(r.updatePercent(e),ut(o.onProgress))try{o.onProgress(e)}catch(t){return jn({code:qn.MSG_ONPROGRESS_FUNCTION_ERROR})}}}).then((function(n){var o=n.location,i=n.snapshotInfo,a=t.isPrivateNetWork()?o:Mt(o);return r.updateVideoUrl(a),Qt(i)||r.updateSnapshotInfo(i),e}))}},{key:"_checkSizeError",value:function(e){var t="";return"A"===e?t="audio":"I"===e?t="image":"V"===e?t="video":"F"===e&&(t="file"),jn({code:qn["MSG_".concat(e,"_SIZE_LIMIT")],message:this.getErrorMessage("UploadSizeLimit",t,"".concat(this.UPLOAD_SIZE_LIMIT[e]/1048576,"MB"))})}},{key:"doUploadImage",value:function(e){var t=this;if(!e.file||this._isEmptyFileList(e.file.files))return jn({code:qn.MSG_I_SELECT_F_FIRST});var n=this._checkImageType(e.file);if(!0!==n)return n;var r=this._checkImageSize(e.file);if(!0!==r)return r;var o=null;return this._setUploadFileType(1),this.uploadByCOS(e).then((function(e){if(o=e,t.isPrivateNetWork())return Rt(e.location);if(it(o.imageInfoArray)){var n=o.imageInfoArray.find((function(e){return 3===e.type}));if(n)return n}return Rt("https://".concat(e.location))})).then((function(e){return o.width=e.width,o.height=e.height,Promise.resolve(o)}))}},{key:"_checkImageType",value:function(e){var t="";return t=$?e.url.slice(e.url.lastIndexOf(".")+1):e.files[0].name.slice(e.files[0].name.lastIndexOf(".")+1),br.indexOf(t.toLowerCase())>=0||jn({code:qn.MSG_I_TYPES_LIMIT})}},{key:"_checkImageSize",value:function(e){var t;return 0===(t=$?e.size:e.files[0].size)?jn({code:qn.MSG_F_IS_EMPTY}):t<this.UPLOAD_SIZE_LIMIT.I||this._checkSizeError("I")}},{key:"doUploadFile",value:function(e){return!e.file||this._isEmptyFileList(e.file.files)?jn({code:qn.MSG_F_SELECT_F_FIRST}):e.file.files[0].size>this.UPLOAD_SIZE_LIMIT.F?this._checkSizeError("F"):0===e.file.files[0].size?jn({code:qn.MSG_F_IS_EMPTY}):(this._setUploadFileType(255),this.uploadByCOS(e))}},{key:"doUploadVideo",value:function(e){return e.file.videoFile.size>this.UPLOAD_SIZE_LIMIT.V?this._checkSizeError("V"):0===e.file.videoFile.size?jn({code:qn.MSG_F_IS_EMPTY}):-1===Dr.indexOf(e.file.videoFile.type)?jn({code:qn.MSG_V_TYPES_LIMIT}):(this._setUploadFileType(2),$?this.handleVideoUpload(t(t({},e),{},{file:e.file.videoFile})):Z?this.handleVideoUpload(e):void 0)}},{key:"handleVideoUpload",value:function(e){var t=this;return new Promise((function(n,r){t.uploadByCOS(e).then((function(e){n(e)})).catch((function(){t.uploadByCOS(e).then((function(e){n(e)})).catch((function(){r(new Fn({code:qn.MSG_V_UPLOAD_FAIL}))}))}))}))}},{key:"doUploadAudio",value:function(e){return e.file?e.file.size>this.UPLOAD_SIZE_LIMIT.A?this._checkSizeError("A"):0===e.file.size?jn({code:qn.MSG_F_IS_EMPTY}):(this._setUploadFileType(3),this.uploadByCOS(e)):jn({code:qn.MSG_A_UPLOAD_FAIL})}},{key:"uploadByCOS",value:function(e){var t=this;if(!ut(this._cosUploadMethod))return this.outputWarning("PluginUndetected"),jn({code:qn.COS_UNDETECTED});if(this.timUploadPlugin)return this._uploadWithPreSigUrl(e);var n=new ar("upload"),r="".concat(this._n,".uploadByCOS"),o=Date.now(),i=this._getFile(e);return new Promise((function(a,s){var u=$?t._createCosOptionsWXMiniApp(e):t._createCosOptionsWeb(e),c=t;t._cosUploadMethod(u,(function(e,u){var l=Object.create(null);if(u){if(e||it(u.files)&&u.files[0].error){var d=new Fn({code:qn.MSG_F_UPLOAD_FAIL});return n.setError(d,!0,t.getNetworkType()).end(),Ge.l("".concat(r," failed. error:"),u.files[0].error),403===u.files[0].error.statusCode&&(Ge.w("".concat(r," failed. cos AccessKeyId was invalid, regain auth key!")),t._getAuthorizationKey()),void s(d)}l.fileName=i.name,l.fileSize=i.size,l.fileType=i.type.slice(i.type.indexOf("/")+1).toLowerCase(),l.location=$?u.Location:u.files[0].data.Location;var f=Date.now()-o,p=c._formatFileSize(i.size),h=c._formatSpeed(1e3*i.size/f),g="size:".concat(p," time:").concat(f,"ms speed:").concat(h);Ge.l("".concat(r," success. name:").concat(i.name," ").concat(g)),a(l);var v=t.getModule(26);return v.addCost(Zn,f),v.addFileSize(Zn,i.size),void n.setNetworkType(t.getNetworkType()).setMessage(g).end()}var _=new Fn({code:qn.MSG_F_UPLOAD_FAIL});n.setError(_,!0,c.getNetworkType()).end(),Ge.w("".concat(r," failed. error:"),e),403===e.statusCode&&(Ge.w("".concat(r," failed. cos AccessKeyId was invalid, regain auth key!")),t._getAuthorizationKey()),s(_)}))}))}},{key:"_uploadWithPreSigUrl",value:function(e){var t=this,n="".concat(this._n,"._uploadWithPreSigUrl"),r=this._getFile(e);return this._createCosOptionsPreSigUrl(e).then((function(e){return new Promise((function(o,i){var a=new ar("upload"),s=e.requestSnapshotUrl,u=void 0===s?void 0:s,c=_(e,Mo),l=Date.now();t._cosUploadMethod(c,(function(s,d){if(s||403===d.statusCode){a.setError(new Fn(s),!0,t.getNetworkType()).end();var f={HttpStatusCode:9999,CostTime:Xt(l,!1),error:s,url:e.url};return d.data&&d.data.uploadIP&&(f.uploadIP=d.data.uploadIP),t._uploadSSOLog(f),Ge.l("".concat(n," failed, error:"),s),void i(new Fn({code:qn.MSG_F_UPLOAD_FAIL}))}var p=Object.create(null),h=d.data.location||"";t.isPrivateNetWork()||0!==h.indexOf("https://")&&0!==h.indexOf("http://")||(h=h.split("//")[1]),p.fileName=r.name,p.fileSize=r.size,p.fileType=r.type.slice(r.type.indexOf("/")+1).toLowerCase(),p.location=h;var g=Xt(l,!1),v=t._formatFileSize(r.size),_=t._formatSpeed(1e3*r.size/g),m="size:".concat(v," time:").concat(g,"ms speed:").concat(_," res:").concat(JSON.stringify(d.data));Ge.l("".concat(n," ok. name:").concat(r.name," ").concat(m)),a.setNetworkType(t.getNetworkType()).setMessage(m).end();var y={HttpStatusCode:d.statusCode,FileSize:r.size,CostTime:g,url:e.url};d.data&&d.data.uploadIP&&(y.uploadIP=d.data.uploadIP),t._uploadSSOLog(y);var I=t.getModule(26);I.addCost(Zn,g),I.addFileSize(Zn,r.size);var M=[];if(c.thumbUrl&&c.largeUrl&&M.push.apply(M,[t._getSmallImageInfoByUrl(c.thumbUrl,p),t._getLargeImageInfoByUrl(c.largeUrl,p)]),1===t.uploadFileType&&t.isSimpleCos&&(M.push(t._getImageInfoArray(c.downloadUrl,p)),d.data.uploadIP&&M.push(t._getDownloadIP(c.downloadUrl.split("//")[1].split("/")[0],p))),u&&M.push(t._getSnapshotInfoByUrl(u,p)),M.length>0)return Promise.all(M).then((function(){o(p)}));o(p)}))}))}))}},{key:"_getDownloadIP",value:function(e,t){var n="".concat(this._n,"._getDownloadIP"),r=Date.now();return this.request({protocolName:Kn.GET_IP,requestData:{domainName:e}}).then((function(e){if(e.data&&e.data.ip){Ge.l("".concat(n," ok. downloadIP:").concat(e.data.ip," cost:").concat(Xt(r)));var o=t.location.split("/");o[0]=e.data.ip,t.location=o.join("/")}})).catch((function(e){}))}},{key:"_getImageInfoArray",value:function(e,t){var n=this,r="".concat(this._n,"._getImageInfoArray"),o=Date.now();return this.request({protocolName:Kn.GET_IMAGE_INFO,requestData:{imageUrl:e}}).then((function(e){var n=e.data||{};return Ge.l("".concat(r," ok. data: ").concat(JSON.stringify(n)," cost:").concat(Xt(o))),t.imageInfoArray=n.imageInfoArray,n})).catch((function(r){t.imageInfoArray=void 0,n._uploadSSOLog({HttpStatusCode:1e4,CostTime:Xt(o,!1),url:e})}))}},{key:"_uploadSSOLog",value:function(e){if(this.isSimpleCos){var t=new ar;t.setEventType(18),e.error?t.setError(new Fn(e.error),!0,this.getNetworkType()):t.setNetworkType(this.getNetworkType());var n="HttpStatusCode:".concat(e.HttpStatusCode,"|CosRequestId:").concat(e.CosRequestId||"","|")+"FileAlreadyExist:".concat(e.FileAlreadyExist||0,"|FileSize:").concat(e.FileSize||0,"|CostTime:").concat(e.CostTime);e.uploadIP&&(n+="|FinalIP:".concat(e.uploadIP)),t.setMessage("OK").setMoreMessage(e.url).setExtension(n).end()}}},{key:"_getRawOrUploadProxyUrl",value:function(e){var t=this.getModule(12).getFileUploadProxy(),n=e;return t&&(n=e.replace(/^https:\/\/[^/]+/,t)),n}},{key:"_getFile",value:function(e){return it(e.file.files)||lt(e.file.files)?e.file.files[0]:e.file}},{key:"_formatFileSize",value:function(e){return e<1024?e+"B":e<1048576?Math.floor(e/1024)+"KB":Math.floor(e/1048576)+"MB"}},{key:"_formatSpeed",value:function(e){return e<=1048576?xt(e/1024,1)+"KB/s":xt(e/1048576,1)+"MB/s"}},{key:"_createCosOptionsWeb",value:function(e){var t=this._getFile(e),n=t.name,r=n.slice(n.lastIndexOf(".")),o=this._genFileName("".concat(vt(999999)).concat(r));return{files:[{Bucket:"".concat(this.bucketName,"-").concat(this.appid),Region:this.region,Key:"".concat(this.directory,"/").concat(o),Body:t}],SliceSize:1048576,onProgress:function(t){if("function"==typeof e.onProgress)try{e.onProgress(t.percent)}catch(n){Ge.w("onProgress callback error:",n)}},onFileFinish:function(e,t,n){}}}},{key:"_createCosOptionsWXMiniApp",value:function(e){var t=this._getFile(e),n=this._genFileName(t.name),r=t.url;return{Bucket:"".concat(this.bucketName,"-").concat(this.appid),Region:this.region,Key:"".concat(this.directory,"/").concat(n),FilePath:r,onProgress:function(t){if(Ge.l(JSON.stringify(t)),"function"==typeof e.onProgress)try{e.onProgress(t.percent)}catch(n){Ge.w("onProgress callback error:",n)}}}}},{key:"_createCosOptionsPreSigUrl",value:function(e){var t=this,n="",r="",o=0,i=this._getFile(e);if($){if(e.message.type===O.MSG_FILE){var a=i.name,s=a.slice(a.lastIndexOf("."));n=this._genFileName("".concat(vt(999999)).concat(s))}else n=this._genFileName(i.name);r=i.url,o=1}else{var u=i.name,c=u.slice(u.lastIndexOf("."));n=this._genFileName("".concat(vt(999999)).concat(c)),r=i,o=0}return this._getCosPreSigUrl({fileType:this.uploadFileType,fileName:n,uploadMethod:o,duration:this.duration,userID:e.message.from,conversationType:bt(e.message.conversationID)?1:2}).then((function(o){var i=t.isSimpleCos?o.preSig[0]:o,a=i.uploadUrl,s=i.downloadUrl,u=i.requestSnapshotUrl,c=void 0===u?void 0:u,l=i.thumbUrl,d=i.largeUrl,f=i.fileKey,p=o.uploadIP,h=void 0===p?"":p;return{url:t._getRawOrUploadProxyUrl(a),fileType:t.uploadFileType,fileName:n,resources:r,downloadUrl:s,requestSnapshotUrl:c,thumbUrl:l,largeUrl:d,fileKey:f,uploadIP:!t.isPrivateNetWork()&&h,onProgress:function(t){if("function"==typeof e.onProgress)try{e.onProgress(t.percent)}catch(n){Ge.w("onProgress callback error:",n),Ge.e(n)}}}}))}},{key:"_genFileName",value:function(e){return"".concat(Nt(),"-").concat(e)}},{key:"_setUploadFileType",value:function(e){this.uploadFileType=e}},{key:"_getSnapshotInfoByUrl",value:function(e,t){var n=this,r="_getSnapshotInfoByUrl",o=new ar(r);return this.request({protocolName:Kn.VIDEO_COVER,requestData:{platform:this.getPlatform(),coverName:this._genFileName(vt(99999)),requestSnapshotUrl:e}}).then((function(e){var i=(e.data||{}).snapshotUrl;return Ge.l("".concat(n._n,".").concat(r," ok. snapshotUrl:").concat(i)),o.setMessage("snapshotUrl:".concat(i)).end(),Qt(i)?{}:Rt(i).then((function(e){t.snapshotInfo={snapshotUrl:i,snapshotWidth:e.width,snapshotHeight:e.height}}))})).catch((function(e){return Ge.w("".concat(n._n,".").concat(r," failed. error:"),e),o.setCode(e.errorCode).setMessage(e.errorInfo).end(),{}}))}},{key:"_getSmallImageInfoByUrl",value:function(e,t){return Rt(e).then((function(n){t.smallImageUrl=e,t.smallImageWidth=n.width,t.smallImageHeight=n.height}))}},{key:"_getLargeImageInfoByUrl",value:function(e,t){return Rt(e).then((function(n){t.largeImageUrl=e,t.largeImageWidth=n.width,t.largeImageHeight=n.height}))}},{key:"_isEmptyFileList",value:function(e){return!(!lt(e)||0!==e.length)}},{key:"reset",value:function(){Ge.l("".concat(this._n,".reset"))}}]),r}(Hn),So=["downloadKey","pbDownloadKey","messageList"],Eo=function(){function e(t){a(this,e),this._n="MergerMessageHandler",this._messageModule=t}return c(e,[{key:"uploadMergerMessage",value:function(e,t){var n=this,r="".concat(this._n,".").concat("uploadMergerMessage");Ge.d("".concat(r," message:"),e,"messageBytes:".concat(t));var o=e.payload.messageList,i=o.length,a=new ar("uploadMergerMessage");return this._messageModule.request({protocolName:Kn.UPLOAD_MERGER_MESSAGE,requestData:{messageList:o}}).then((function(e){Ge.d("".concat(r," ok. response:"),e.data);var o=e.data,s=o.pbDownloadKey,u=o.downloadKey,c={pbDownloadKey:s,downloadKey:u,messageNumber:i};return a.setNetworkType(n._messageModule.getNetworkType()).setMessage("".concat(i,"-").concat(t,"-").concat(u)).end(),c})).catch((function(e){throw Ge.w("".concat(r," failed. error:"),e),n._messageModule.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];a.setError(e,r,o).end()})),e}))}},{key:"downloadMergerMessage",value:function(e){var n=this,r="".concat(this._n,".").concat("downloadMergerMessage");Ge.d("".concat(r," message:"),e);var o=e.payload.downloadKey,i=this._messageModule.getFileDownloadProxy(),a=new ar("downloadMergerMessage");return a.setMessage("downloadKey:".concat(o)),this._messageModule.request({protocolName:Kn.DOWNLOAD_MERGER_MESSAGE,requestData:{downloadKey:o}}).then((function(o){if(Ge.d("".concat(r," ok. response:"),o.data),ut(e.clearElement)){var s=e.payload;s.downloadKey,s.pbDownloadKey,s.messageList;var u=_(s,So);e.clearElement(),e.setElement({type:e.type,content:t({messageList:o.data.messageList},u)},i)}else{var c=[];o.data.messageList.forEach((function(e){if(!Qt(e)){var t=new yr(e,i);c.push(t)}})),e.payload.messageList=c,e.payload.downloadKey="",e.payload.pbDownloadKey=""}return a.setNetworkType(n._messageModule.getNetworkType()).end(),e})).catch((function(e){throw Ge.w("".concat(r," failed. key:").concat(o," error:"),e),n._messageModule.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];a.setError(e,r,o).end()})),e}))}},{key:"createMergerMessagePack",value:function(e,t,n){return e.conversationType===O.CONV_C2C?this._createC2CMergerMessagePack(e,t,n):this._createGroupMergerMessagePack(e,t,n)}},{key:"_createC2CMergerMessagePack",value:function(e,t,n){var r=null;t&&(t.offlinePushInfo&&(r=t.offlinePushInfo),!0===t.onlineUserOnly&&(r?r.disablePush=!0:r={disablePush:!0}));var o=[];if(ot(t)&&ot(t.messageControlInfo)){var i=t.messageControlInfo,a=i.excludedFromUnreadCount,s=i.excludedFromLastMessage,u=i.excludedFromContentModeration;!0===a&&o.push("NoUnread"),!0===s&&o.push("NoLastMsg"),!0===u&&o.push("NoMsgCheck")}var c="";nt(e.cloudCustomData)&&e.cloudCustomData.length>0&&(c=e.cloudCustomData);var l=n.pbDownloadKey,d=n.downloadKey,f=n.messageNumber,p=e.payload,h=p.title,g=p.abstractList,v=p.compatibleText,_=this._messageModule.getModule(6),m=_&&_.isOnlineMessage(e,t)?0:void 0;return{protocolName:Kn.SEND_C2C_MESSAGE,tjgID:this._messageModule.generateTjgID(e),requestData:{fromAccount:this._messageModule.getMyUserID(),toAccount:e.to,msgBody:[{msgType:e.type,msgContent:{pbDownloadKey:l,downloadKey:d,title:h,abstractList:g,compatibleText:v,messageNumber:f}}],cloudCustomData:c,clientTime:e.clientTime,msgSeq:e.sequence,msgRandom:e.random,msgLifeTime:m,offlinePushInfo:r?{pushFlag:!0===r.disablePush?1:0,title:r.title||"",desc:r.description||"",ext:r.extension||"",apnsInfo:{badgeMode:!0===r.ignoreIOSBadge?1:0},androidInfo:{OPPOChannelID:r.androidOPPOChannelID||""}}:void 0,messageControlInfo:0!==m?o:void 0,isSupportExtension:!0===e.isSupportExtension?1:0,isRelayMessage:!0===e._relayFlag?1:0}}}},{key:"_createGroupMergerMessagePack",value:function(e,t,n){var r=null;t&&t.offlinePushInfo&&(r=t.offlinePushInfo);var o=[];if(ot(t)&&ot(t.messageControlInfo)){var i=t.messageControlInfo,a=i.excludedFromUnreadCount,s=i.excludedFromLastMessage,u=i.excludedFromContentModeration;!0===a&&o.push("NoUnread"),!0===s&&o.push("NoLastMsg"),!0===u&&o.push("NoMsgCheck")}var c="";nt(e.cloudCustomData)&&e.cloudCustomData.length>0&&(c=e.cloudCustomData);var l=n.pbDownloadKey,d=n.downloadKey,f=n.messageNumber,p=e.payload,h=p.title,g=p.abstractList,v=p.compatibleText,_=this._messageModule.getModule(7),m=_&&_.isOnlineMessage(e,t)?1:0;return{protocolName:Kn.SEND_GROUP_MESSAGE,tjgID:this._messageModule.generateTjgID(e),requestData:{fromAccount:this._messageModule.getMyUserID(),groupID:e.to,msgBody:[{msgType:e.type,msgContent:{pbDownloadKey:l,downloadKey:d,title:h,abstractList:g,compatibleText:v,messageNumber:f}}],random:e.random,priority:e.priority,clientSequence:e.clientSequence,groupAtInfo:void 0,cloudCustomData:c,onlineOnlyFlag:m,offlinePushInfo:r?{pushFlag:!0===r.disablePush?1:0,title:r.title||"",desc:r.description||"",ext:r.extension||"",apnsInfo:{badgeMode:!0===r.ignoreIOSBadge?1:0},androidInfo:{OPPOChannelID:r.androidOPPOChannelID||""}}:void 0,clientTime:e.clientTime,needReadReceipt:!0!==e.needReadReceipt||_.isMessageFromOrToAVChatroom(e.to)?0:1,messageControlInfo:0===m?o:void 0,isSupportExtension:!0===e.isSupportExtension?1:0,isRelayMessage:!0===e._relayFlag?1:0}}}}]),e}(),Co={ERR_SVR_COMM_SENSITIVE_TEXT:80001,ERR_SVR_COMM_BODY_SIZE_LIMIT:80002,OPEN_SERVICE_OVERLOAD_ERROR:60022,ERR_SVR_MSG_PKG_PARSE_FAILED:20001,ERR_SVR_MSG_INTERNAL_AUTH_FAILED:20002,ERR_SVR_MSG_INVALID_ID:20003,ERR_SVR_MSG_PUSH_DENY:20006,ERR_SVR_MSG_IN_PEER_BLACKLIST:20007,ERR_SVR_MSG_BOTH_NOT_FRIEND:20009,ERR_SVR_MSG_NOT_PEER_FRIEND:20010,ERR_SVR_MSG_NOT_SELF_FRIEND:20011,ERR_SVR_MSG_SHUTUP_DENY:20012,ERR_SVR_GROUP_INVALID_PARAMETERS:10004,ERR_SVR_GROUP_PERMISSION_DENY:10007,ERR_SVR_GROUP_NOT_FOUND:10010,ERR_SVR_GROUP_INVALID_GROUPID:10015,ERR_SVR_GROUP_REJECT_FROM_THIRDPARTY:10016,ERR_SVR_GROUP_SHUTUP_DENY:10017,MSG_SEND_FAIL:2100,OVER_FREQUENCY_LIMIT:2996},ko=[qn.MSG_ONPROGRESS_FUNCTION_ERROR,qn.MSG_I_SELECT_F_FIRST,qn.MSG_I_TYPES_LIMIT,qn.MSG_F_IS_EMPTY,qn.MSG_I_SIZE_LIMIT,qn.MSG_F_SELECT_F_FIRST,qn.MSG_F_SIZE_LIMIT,qn.MSG_V_SIZE_LIMIT,qn.MSG_V_TYPES_LIMIT,qn.MSG_A_UPLOAD_FAIL,qn.MSG_A_SIZE_LIMIT,qn.COS_UNDETECTED];function bo(e){var t=!1;return Object.values(Co).includes(e)&&(t=!0),(e>=120001&&e<=13e4||e>=10100&&e<=10200)&&(t=!0),t}var Do=["conversationID","timePosition","timePeriod"],Ao=function(e){d(r,e);var n=I(r);function r(e){var t;return a(this,r),(t=n.call(this,e))._n="MessageModule",t._messageOptionsMap=new Map,t._mergerMessageHandler=new Eo(m(t)),t}return c(r,[{key:"createTextMessage",value:function(e){var t=this.getMyUserID();e.currentUser=t,e.senderTinyID=this.getMyTinyID();var n=new Tr(e),r=nt(e.payload)?e.payload:e.payload.text,o=new sr({text:r}),i=this._getNickAndAvatarByUserID(t);return n.setElement(o),n.setNickAndAvatar(i),n.setNameCard(this._getNameCardByGroupID(n)),n}},{key:"createImageMessage",value:function(e){var t=this.getMyUserID();e.currentUser=t,e.senderTinyID=this.getMyTinyID();var n=new Tr(e);if($){var r=e.payload.file;if(Qe(r))return void this.outputWarning("FileUnsupportedInMP","createImageMessage");var i=r.tempFiles[0].path||r.tempFiles[0].tempFilePath,a={url:i,name:i.slice(i.lastIndexOf("/")+1),size:r.tempFiles&&r.tempFiles[0].size||1,type:i.slice(i.lastIndexOf(".")+1).toLowerCase()};e.payload.file=a}else if(Z)if(Qe(e.payload.file)){var s=e.payload.file;e.payload.file={files:[s]}}else if(ot(e.payload.file)&&"undefined"!=typeof o){var u=e.payload.file.tempFiles[0];e.payload.file={files:[u]}}var c=new ur({imageFormat:xe.UNKNOWN,uuid:this._generateUUID(e.payload.file),file:e.payload.file}),l=this._getNickAndAvatarByUserID(t);return n.setElement(c),n.setNickAndAvatar(l),n.setNameCard(this._getNameCardByGroupID(n)),this._messageOptionsMap.set(n.clientSequence,e),n}},{key:"createAudioMessage",value:function(e){var t=e.payload.file;if($){var n={url:t.tempFilePath,name:t.tempFilePath.slice(t.tempFilePath.lastIndexOf("/")+1),size:t.fileSize,second:parseInt(t.duration)/1e3,type:t.tempFilePath.slice(t.tempFilePath.lastIndexOf(".")+1).toLowerCase()};e.payload.file=n}var r=this.getMyUserID();e.currentUser=r,e.senderTinyID=this.getMyTinyID();var o=new Tr(e),i=new lr({second:Math.floor(t.duration/1e3),size:t.fileSize||t.size,url:t.tempFilePath,uuid:this._generateUUID(e.payload.file)}),a=this._getNickAndAvatarByUserID(r);return o.setElement(i),o.setNickAndAvatar(a),o.setNameCard(this._getNameCardByGroupID(o)),this._messageOptionsMap.set(o.clientSequence,e),o}},{key:"createVideoMessage",value:function(e){var t=this.getMyUserID();e.currentUser=t,e.senderTinyID=this.getMyTinyID(),e.payload.file.thumbUrl="",e.payload.file.thumbSize=0;var n={};if($){if(Y)return void this.outputWarning("VideoUnsupportedInAlipay");if(Qe(e.payload.file))return void this.outputWarning("FileUnsupportedInMP","createVideoMessage");var r=e.payload.file;it(r.tempFiles)&&(r=r.tempFiles[0]),n.url=r.tempFilePath,n.name=r.tempFilePath.slice(r.tempFilePath.lastIndexOf("/")+1),n.size=r.size||1,n.second=r.duration||0,n.type=r.tempFilePath.slice(r.tempFilePath.lastIndexOf(".")+1).toLowerCase()}else if(Z){if(Qe(e.payload.file)){var i=e.payload.file;e.payload.file.files=[i]}else if(ot(e.payload.file)&&"undefined"!=typeof o){var a=e.payload.file.tempFile;e.payload.file.files=[a]}var s=e.payload.file;n.url=window.URL.createObjectURL(s.files[0]),n.name=s.files[0].name,n.size=s.files[0].size||1,n.second=s.files[0].duration||0,n.type=s.files[0].type.split("/")[1]}e.payload.file.videoFile=n;var u=new Tr(e),c=new _r({videoFormat:n.type,videoSecond:xt(n.second,0),videoSize:n.size,remoteVideoUrl:"",videoUrl:n.url,videoUUID:this._generateUUID(e.payload.file.videoFile),thumbUUID:this._generateUUID(e.payload.file.videoFile),thumbWidth:e.payload.file.width||200,thumbHeight:e.payload.file.height||200,thumbUrl:e.payload.file.thumbUrl,thumbSize:e.payload.file.thumbSize,thumbFormat:e.payload.file.thumbUrl.slice(e.payload.file.thumbUrl.lastIndexOf(".")+1).toLowerCase()}),l=this._getNickAndAvatarByUserID(t);return u.setElement(c),u.setNickAndAvatar(l),u.setNameCard(this._getNameCardByGroupID(u)),this._messageOptionsMap.set(u.clientSequence,e),u}},{key:"createCustomMessage",value:function(e){var t=this.getMyUserID();e.currentUser=t,e.senderTinyID=this.getMyTinyID();var n=new Tr(e),r=new vr({data:e.payload.data,description:e.payload.description,extension:e.payload.extension}),o=this._getNickAndAvatarByUserID(t);return n.setElement(r),n.setNickAndAvatar(o),n.setNameCard(this._getNameCardByGroupID(n)),n}},{key:"createFaceMessage",value:function(e){var t=this.getMyUserID();e.currentUser=t,e.senderTinyID=this.getMyTinyID();var n=new Tr(e),r=new cr(e.payload),o=this._getNickAndAvatarByUserID(t);return n.setElement(r),n.setNickAndAvatar(o),n.setNameCard(this._getNameCardByGroupID(n)),n}},{key:"createMergerMessage",value:function(e){var t=this.getMyUserID();e.currentUser=t,e.senderTinyID=this.getMyTinyID();var n=this._getNickAndAvatarByUserID(t),r=new Tr(e),o=new Ir(e.payload);return r.setElement(o),r.setNickAndAvatar(n),r.setNameCard(this._getNameCardByGroupID(r)),r.setRelayFlag(!0),r}},{key:"createForwardMessage",value:function(e){var t=e.to,n=e.conversationType,r=e.priority,o=e.payload,i=e.needReadReceipt,a=e.receiverList;if(!it(o._elements))return jn({code:qn.MSG_FORWARD_INVALID_ELEMENTS});var s=this.getMyUserID(),u=this._getNickAndAvatarByUserID(s);if(o.type===O.MSG_GRP_TIP)return jn({code:qn.MSG_FORWARD_TYPE_INVALID});var c={to:t,conversationType:n,conversationID:"".concat(n).concat(t),priority:r,isPlaceMessage:0,status:rn.UNSEND,currentUser:s,senderTinyID:this.getMyTinyID(),cloudCustomData:e.cloudCustomData||o.cloudCustomData||"",needReadReceipt:i,receiverList:a,isSupportExtension:e.isSupportExtension||!1},l=new Tr(c);return l.setElement(o._elements[0]),l.setNickAndAvatar(u),l.setNameCard(this._getNameCardByGroupID(o)),l.setRelayFlag(!0),l}},{key:"downloadMergerMessage",value:function(e){return this._mergerMessageHandler.downloadMergerMessage(e)}},{key:"createFileMessage",value:function(e){if($){if(!B&&!H&&!J)return;var n=Q.getSystemInfoSync().SDKVersion;if(B&&Lt(n,"2.5.0")<0)return void this.outputWarning("WXChooseMessageFile");if(H&&Lt(n,"1.18.0")<0)return void this.outputWarning("QQChooseMessageFile")}if(Z||J){if(Qe(e.payload.file)){var r=e.payload.file;e.payload.file={files:[r]}}else if(ot(e.payload.file)&&"undefined"!=typeof o){var i=e.payload.file,a=i.tempFiles,s=i.files,u=null;it(a)?u=a[0]:it(s)&&(u=s[0]),e.payload.file={files:[u]}}}else if(B||H){var c=e.payload.file.tempFiles,l=t(t({},c[0]),{},{url:c[0].path});e.payload.file={files:[l]}}var d=this.getMyUserID();e.currentUser=d,e.senderTinyID=this.getMyTinyID();var f=new Tr(e),p=new gr({uuid:this._generateUUID(e.payload.file),file:e.payload.file}),h=this._getNickAndAvatarByUserID(d);return f.setElement(p),f.setNickAndAvatar(h),f.setNameCard(this._getNameCardByGroupID(f)),this._messageOptionsMap.set(f.clientSequence,e),f}},{key:"createLocationMessage",value:function(e){var t=this.getMyUserID();e.currentUser=t,e.senderTinyID=this.getMyTinyID();var n=new Tr(e),r=new mr(e.payload),o=this._getNickAndAvatarByUserID(t);return n.setElement(r),n.setNickAndAvatar(o),n.setNameCard(this._getNameCardByGroupID(n)),n}},{key:"_onCannotFindModule",value:function(){return jn({code:qn.CANNOT_FIND_MODULE})}},{key:"sendMessageInstance",value:function(e,t){var n=this;if(!1===this.getModule(29).filterMessage(e,t))return e.hasRiskContent=!0,this._onSendMessageFailed(e,new Fn({code:qn.PROFANITY_FOUND}));var r=null;if(e.conversationType===O.CONV_C2C)r=this.getModule(6);else{if(e.conversationType!==O.CONV_GROUP)return jn({code:qn.MSG_INVALID_CONV_TYPE});r=this.getModule(7)}var o,i="".concat(this._n,".sendMessageInstance"),a=this.getModule(11),s=r.isOnlineMessage(e,t);return this.getModule(17).upload(e).then((function(){return n._getSendMessageSpecifiedKey(e)===$n&&n.getModule(26).addSuccessCount(Zn),n._guardForGroup(e).then((function(){if(!e.isSendable())return jn({code:qn.MSG_F_URL_IS_EMPTY});n._addSendMessageTotalCount(e),o=Date.now();var i=function(e){var t="utf-8";Z&&document&&(t=document.charset.toLowerCase());var n,r,o=0;if(r=e.length,"utf-8"===t||"utf8"===t)for(var i=0;i<r;i++)(n=e.codePointAt(i))<=127?o+=1:n<=2047?o+=2:n<=65535?o+=3:(o+=4,i++);else if("utf-16"===t||"utf16"===t)for(var a=0;a<r;a++)(n=e.codePointAt(a))<=65535?o+=2:(o+=4,a++);else o=e.replace(/[^\x00-\xff]/g,"aa").length;return o}(JSON.stringify(e));return e.type===O.MSG_MERGER&&i>11264?n._mergerMessageHandler.uploadMergerMessage(e,i).then((function(r){var o=n._mergerMessageHandler.createMergerMessagePack(e,t,r);return n.request(o)})):(a.setMessageRandom(e),r.sendMessage(e,t))})).then((function(r){var u=r.data,c=u.time,l=u.sequence,d=u.readReceiptCode,f=u.messageDropReason;if(et(d)&&0!==d&&(new ar("sendMessageWithReceipt").setMessage("from:".concat(e.from," to:").concat(e.to," sequence:").concat(l," readReceiptCode:").concat(d)).end(),Ge.w("".concat(i," readReceiptCode:").concat(d," message:").concat(n.getErrorMessage(d)))),f){var p=new ar("messageDropReason"),h="from:".concat(e.from," to:").concat(e.to," sequence:").concat(l," messageDropReason:").concat(f);p.setMessage(h).end(),Ge.w("".concat(i," ").concat(h))}if(n._addSendMessageSuccessCount(e,o),n._messageOptionsMap.delete(e.clientSequence),!0===e.isResend){var g=a.findMessage(e.ID);g&&(Ge.l("".concat(i," resend ok. ID:").concat(g.ID)),a.deleteLocalMessage(g))}e.status=rn.SUCCESS,e.time=c;var v=!1;if(e.conversationType===O.CONV_GROUP)e.sequence=l;else if(e.conversationType===O.CONV_C2C){var _=a.getLatestMessageSentByMe(e.conversationID);if(_){var m=_.nick,y=_.avatar;m===e.nick&&y===e.avatar||(v=!0)}}if(v&&a.modifyMessageSentByMe({conversationID:e.conversationID,latestNick:e.nick,latestAvatar:e.avatar}),!0===s)e._onlineOnlyFlag=!0;else{a.appendToMessageList(e);var I=e;ot(t)&&ot(t.messageControlInfo)&&(!0===t.messageControlInfo.excludedFromLastMessage&&(e._isExcludedFromLastMessage=!0,I=""),!0===t.messageControlInfo.excludedFromUnreadCount&&(e._isExcludedFromUnreadCount=!0));var M=e.conversationType;kt(e.to)&&(M=O.CONV_TOPIC,n.getModule(10).onMessageSent({groupID:Vt(e.to),topicID:e.to,lastMessage:I})),a.onMessageSent({conversationOptionsList:[{conversationID:e.conversationID,unreadCount:0,type:M,subType:e.conversationSubType,lastMessage:I}]})}return e._relayFlag||"TIMImageElem"!==e.type||Ut(e.payload.imageInfoArray),xn({message:e})}))})).catch((function(t){return n._onSendMessageFailed(e,t,s)}))}},{key:"_guardForGroup",value:function(e){if(e.conversationType!==O.CONV_GROUP)return Promise.resolve();var t=this.getModule(7);if(!t)return this._onCannotFindModule();if(Ct({groupID:e.to})){var n=t.getLocalGroupProfile(e.to);if(n&&n.isSupportTopic)return jn({code:qn.MSG_SEND_GRP_WITH_TOPIC_FAIL})}return t.guardForAVChatRoom(e)}},{key:"_onSendMessageFailed",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r="".concat(this._n,"._onSendMessageFailed");e.status=rn.FAIL,80001!==t.code&&80004!==t.code||(e.hasRiskContent=!0);var o=this.getModule(11);o.deleteMessageRandom(e);var i=t.code>=10100&&t.code<=10200||t.code>=120001&&t.code<=13e4;if(!n&&!i){var a=o.appendToMessageList(e);!0===a&&Ge.l("".concat(r," message stored, ID:").concat(e.ID))}this._addSendMessageFailCountOnUser(e,t);var s=new ar("sendMessage");return s.setMessage("tjg_id:".concat(this.generateTjgID(e)," type:").concat(e.type," from:").concat(e.from," to:").concat(e.to)),this.probeNetwork().then((function(e){var n=M(e,2),r=n[0],o=n[1];s.setError(t,r,o).end()})),Ge.e("".concat(r," error:"),t),jn(new Fn({code:t&&t.code?t.code:qn.MSG_SEND_FAIL,message:t&&t.message?t.message:void 0,data:{message:e}}))}},{key:"_getSendMessageSpecifiedKey",value:function(e){if([O.MSG_IMAGE,O.MSG_AUDIO,O.MSG_VIDEO,O.MSG_FILE].includes(e.type))return $n;if(e.conversationType===O.CONV_C2C)return zn;if(e.conversationType===O.CONV_GROUP){var t=this.getModule(7);if(!t)return;var n=t.getLocalGroupProfile(e.to);if(!n)return;var r=n.type;return Et(r)?Xn:Jn}}},{key:"_addSendMessageTotalCount",value:function(e){var t=this._getSendMessageSpecifiedKey(e);t&&this.getModule(26).addTotalCount(t)}},{key:"_addSendMessageSuccessCount",value:function(e,t){var n=this._getSendMessageSpecifiedKey(e);if(n){var r=this.getModule(26);r.addSuccessCount(n),r.addCost(n,Xt(t,!1))}}},{key:"_addSendMessageFailCountOnUser",value:function(e,t){var n,r,o=t.code,i=void 0===o?-1:o,a=this.getModule(26),s=this._getSendMessageSpecifiedKey(e);s===$n&&(n=i,r=!1,ko.includes(n)&&(r=!0),r)?a.addFailedCountOfUserSide(Zn):bo(i)&&s&&a.addFailedCountOfUserSide(s)}},{key:"resendMessage",value:function(e,t){return e.isResend=!0,e.status=rn.UNSEND,this.sendMessageInstance(e,t)}},{key:"revokeMessage",value:function(e){var t=this,n=null;if(e.conversationType===O.CONV_C2C?n=this.getModule(6):e.conversationType===O.CONV_GROUP&&(n=this.getModule(7)),!n)return this._onCannotFindModule();var r=new ar("revokeMessage");r.setMessage("tjg_id:".concat(this.generateTjgID(e)," type:").concat(e.type," from:").concat(e.from," to:").concat(e.to));var o="".concat(this._n,".").concat("revokeMessage");return n.revokeMessage(e).then((function(n){var i=n.data.recallRetList;if(!Qt(i)&&0!==i[0].retCode){var a=new Fn({code:i[0].retCode,data:{message:e}});return r.setCode(a.code).setMoreMessage(a.message).end(),jn(a)}return Ge.i("".concat(o," ok. ID:").concat(e.ID)),e.isRevoked=!0,r.end(),t.getModule(11).onMessageRevoked([e]),xn({message:e})})).catch((function(n){t.probeNetwork().then((function(e){var t=M(e,2),o=t[0],i=t[1];r.setError(n,o,i).end()}));var i=new Fn({code:n&&n.code?n.code:qn.MSG_REVOKE_FAIL,message:n&&n.message?n.message:void 0,data:{message:e}});return Ge.w("".concat(o," failed. error:"),n),jn(i)}))}},{key:"deleteMessage",value:function(e){var t=this,n=null,r=e[0],o=r.conversationID,i="",a=[],s=[];if(r.conversationType===O.CONV_C2C)n=this.getModule(6),i=o.replace(O.CONV_C2C,""),e.forEach((function(e){e&&e.status===rn.SUCCESS&&e.conversationID===o&&(e._onlineOnlyFlag||a.push("".concat(e.sequence,"_").concat(e.random,"_").concat(e.time)),s.push(e))}));else if(r.conversationType===O.CONV_GROUP)n=this.getModule(7),i=o.replace(O.CONV_GROUP,""),e.forEach((function(e){e&&e.status===rn.SUCCESS&&e.conversationID===o&&(e._onlineOnlyFlag||a.push("".concat(e.sequence)),s.push(e))}));else if(r.conversationType===O.CONV_SYSTEM)return jn({code:qn.CANNOT_DELETE_GRP_SYSTEM_NOTICE});if(!n)return this._onCannotFindModule();if(0===a.length)return this._onMessageDeleted(s);a.length>30&&(a=a.slice(0,30),s=s.slice(0,30));var u=new ar("deleteMessage");u.setMessage("to:".concat(i," count:").concat(a.length));var c="".concat(this._n,".").concat("deleteMessage");return n.deleteMessage({to:i,keyList:a}).then((function(e){return u.end(),Ge.i("".concat(c," ok")),t._onMessageDeleted(s)})).catch((function(e){t.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];u.setError(e,r,o).end()})),Ge.w("".concat(c," failed. error:"),e);var n=new Fn({code:e&&e.code?e.code:qn.MSG_DELETE_FAIL,message:e&&e.message?e.message:void 0});return jn(n)}))}},{key:"_onMessageDeleted",value:function(e){return this.getModule(11).onMessageDeleted(e),Bn({messageList:e})}},{key:"translateText",value:function(e){var n="".concat(this._n,".").concat("translateText"),r=e.sourceTextList,o=e.sourceLanguage,i=e.targetLanguage,a=new ar("translateText");return a.setMessage("sourceLanguage:".concat(o," targetLanguage:").concat(i)),this.request({protocolName:Kn.TRANSLATE_TEXT,requestData:{sourceTextList:r,source:o||"auto",target:i,from:this.getMyTinyID(),SDKAppID:this.getSDKAppID()}}).then((function(e){var r=e.data,o=r.error,i=r.requestID,s=r.translatedTextList;if(0===o.code)return a.end(),Ge.i("".concat(n," ok. requestID:").concat(i)),xn({translatedTextList:s});throw t(t({},o),{},{requestID:i})})).catch((function(e){return a.setCode(e.code).setMoreMessage(e.requestID).end(),Ge.w("".concat(n," failed. error:"),e),jn({code:qn.TRANSLATE_TEXT_FAIL})}))}},{key:"convertVoiceToText",value:function(e){var n=e.message,r=e.language,o=n.payload.url;n.from===this.getMyUserID()&&"out"===n.flow&&(o=n.payload.remoteAudioUrl);var i=/\.(wav|pcm|ogg-opus|speex|silk|mp3|m4a|aac|amr)/;if(!i.test(o))return jn({code:qn.UNSUPPORTED_VOICE_FORMAT});var a=i.exec(o)[1]||"mp3",s="16k_zh-PY";r?"zh (cmn-Hans-CN)"===r?s="16k_zh":"en-US"===r?s="16k_en":"yue-Hant-HK"===r?s="16k_yue":"ja-JP"===r&&(s="16k_ja"):s="16k_zh-PY";var u="serviceType:".concat(s," url:").concat(o),c="".concat(this._n,".").concat("convertVoiceToText");Ge.i("".concat(c," ").concat(u));var l=new ar("convertVoiceToText");return l.setMessage(u),this.request({protocolName:Kn.VOICE_TO_TEXT,requestData:{url:o,language:s,SDKAppID:this.getSDKAppID(),format:a}}).then((function(e){var n=e.data,r=n.error,o=n.requestID,i=n.result;if(0===r.code)return l.end(),Ge.i("".concat(c," ok. requestID:").concat(o)),xn({result:i});throw t(t({},r),{},{requestID:o})})).catch((function(e){return l.setCode(e.code).setMoreMessage(e.requestID||"").end(),Ge.w("".concat(c," failed. error:"),e),jn({code:qn.VOICE_TO_TEXT_FAIL})}))}},{key:"modifyRemoteMessage",value:function(e){var t=this,n=null,r=e.conversationType,o=e.to,i=this.getModule(7);if(!i)return this._onCannotFindModule();if(i.isMessageFromOrToAVChatroom(o))return jn({code:qn.MSG_MODIFY_DISABLED_IN_AVCHATROOM,data:{message:e}});if(!1===this.getModule(29).filterMessage(e))return e.hasRiskContent=!0,jn({code:qn.PROFANITY_FOUND,data:{message:e}});r===O.CONV_C2C?n=this.getModule(6):r===O.CONV_GROUP&&(n=this.getModule(7));var a=new ar("modifyMessage");a.setMessage("to:".concat(o));var s="".concat(this._n,".modifyRemoteMessage");return n.modifyRemoteMessage(e).then((function(n){a.end(),Ge.i("".concat(s," ok"));var r=t._onModifyRemoteMessageResp(e,n.data);return xn({message:r})})).catch((function(n){if(a.setCode(n.code).setMoreMessage(n.message).end(),Ge.w("".concat(s," failed. error:"),n),20027===n.code){var r=t._onModifyRemoteMessageResp(e,n.data);return jn({code:qn.MSG_MODIFY_CONFLICT,data:{message:r}})}return jn({code:n.code,message:n.message,data:{message:e}})}))}},{key:"_generateSearchRequestData",value:function(e){var t=e.conversationID,n=e.timePosition,r=e.timePeriod,o=_(e,Do);return at(t)||(bt(t)&&(o.account=t.replace(O.CONV_C2C,"")),Dt(t)&&(o.groupID=t.replace(O.CONV_GROUP,""))),et(r)&&r>0&&(et(n)&&n>0?o.startTime=n-r:o.startTime=we()-r),o.startTime&&o.startTime<0&&(o.startTime=void 0),et(n)&&n>0&&(o.endTime=n),o}},{key:"searchCloudMessages",value:function(e){var t=this,n="searchCloudMessages",r="".concat(this._n,".").concat(n);if(!e)return jn({code:qn.OPTIONS_IS_EMPTY,message:this.getErrorMessage(qn.OPTIONS_IS_EMPTY,n)});var o=e.keywordList,i=e.keywordListMatchType,a=e.conversationID,s=e.cursor,u=it(e.senderUserIDList)&&e.senderUserIDList.length>0,c=it(e.messageTypeList)&&e.messageTypeList.length>0;if(!o&&!u&&!c)throw Ge.e("[".concat(n,'] Missing required params: "keywordList".')),new Error("Params validate failed.");var l=Date.now(),d=new ar(n),f="keywordList:".concat(o," keywordListMatchType:").concat(i," ")+"conversationID:".concat(a," cursor:").concat(s);return Ge.l("".concat(r," ").concat(f)),this.request({protocolName:Kn.MESSAGE_CLOUD_SEARCH,requestData:this._generateSearchRequestData(e)}).then((function(n){var o=n.data,i=o.code,a=o.message;if(0!==i){var s=i;60020===i&&(s="SearchCloudMessagesUnavailable");var u=t.getErrorMessage(s)||a,c=new Fn({code:i,message:u});return t.probeNetwork().then((function(e){var t=M(e,2),n=t[0],r=t[1];d.setMessage(f).setError(c,n,r).end()})),jn(c)}var p=n.data,h=p.cursor,g=p.totalCount,v=p.searchResult,_="totalCount:".concat(g," cost:").concat(Xt(l));Ge.l("".concat(r," ok. cursor:").concat(h," ").concat(_)),d.setNetworkType(t.getNetworkType()).setMessage("".concat(f," ").concat(_)).end();var m=t._handleSearchResults(v,!e.conversationID);return xn({searchResultList:m,cursor:h,totalCount:g})})).catch((function(e){return t.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];d.setMessage(f).setError(e,r,o).end()})),jn(e)}))}},{key:"_handleSearchResults",value:function(e,t){var n=this.getModule(11);return it(e)&&0!==e.length?e.map((function(e){var r=e.groupID,o=e.userID,i=e.messageCount,a=e.messageList,s=r?"".concat(O.CONV_GROUP).concat(r):"".concat(O.CONV_C2C).concat(o),u={conversationID:s,messageCount:i,messageList:[]};if(t&&i>1)return u;if(a&&a.length>0){var c=n.onRoamingMessage(a,s,!1);r&&c.reverse(),u.messageList=c}return u})):[]}},{key:"_onModifyRemoteMessageResp",value:function(e,t){Ge.d("".concat(this._n,"._onModifyRemoteMessageResp options:"),t);var n=e.conversationType,r=e.from,o=e.to,i=e.random,a=e.sequence,s=e.time,u=t.elements,c=t.messageVersion,l=t.cloudCustomData,d=void 0===l?"":l;return this.getModule(11).onMessageModified({conversationType:n,from:r,to:o,time:s,random:i,sequence:a,elements:u,cloudCustomData:d,messageVersion:c})}},{key:"_generateUUID",value:function(e){var t=this.getModule(12),n="".concat(t.getSDKAppID(),"-").concat(t.getUserID(),"-").concat(function(){for(var e="",t=32;t>0;--t)e+=_t[Math.floor(Math.random()*mt)];return e}()),r=e.name||e.value||e.url||e.tempFilePath,o=r&&r.slice(r.lastIndexOf(".")+1);return o&&(n="".concat(n,".").concat(o)),n}},{key:"getMessageOption",value:function(e){return this._messageOptionsMap.get(e)}},{key:"_getNickAndAvatarByUserID",value:function(e){return this.getModule(4).getNickAndAvatarByUserID(e)}},{key:"_getNameCardByGroupID",value:function(e){if(e.conversationType===O.CONV_GROUP){var t=this.getModule(7);if(t)return t.getMyNameCardByGroupID(e.to)}return""}},{key:"reset",value:function(){Ge.l("".concat(this._n,".reset")),this._messageOptionsMap.clear()}}]),r}(Hn),Oo=function(e){d(n,e);var t=I(n);function n(e){var r;return a(this,n),(r=t.call(this,e))._n="MessageExtensionModule",r.messageExtensionMap=new Map,r.globalSeqMap=new Map,r.getMessageExtensionsMap=new Map,r}return c(n,[{key:"onMessageExtensionNotify",value:function(e){var t=this,n=e.dataList,r=n.messageInfo,o=n.operateType,i=n.operateResultList,a=n.tinyID,s=n.globalSequence,u=r.clientTime,c=r.random,l="".concat(a,"-").concat(u,"-").concat(c),d=[],f=[];Ge.l("".concat(this._n,".onMessageExtensionNotify messageID:").concat(l," operateType:").concat(o," globalSequence:").concat(s)),this._updateGlobalSequence(l,s);var p=!1,h=!1;i.forEach((function(e){var n=e.extensions,r=void 0===n?[]:n,i=e.clearSequence;1===o?(p=!0,r.forEach((function(e){d.push({key:e.key,value:e.value})})),t._updateLocalExtension(l,r)):2===o?(h=!0,r.forEach((function(e){f.push(e.key)})),t._updateLocalExtension(l,r)):3===o&&(h=!0,t._hasLocalExtension(l)&&t._getLocalExtension(l).forEach((function(e,t){e.seq<=i&&!Qt(e.value)&&f.push(t)})),t._clearLocalExtension(l,i))})),p&&this.emitOuterEvent(A.MESSAGE_EXTENSIONS_UPDATED,{messageID:l,extensions:d}),h&&this.emitOuterEvent(A.MESSAGE_EXTENSIONS_DELETED,{messageID:l,keyList:f})}},{key:"setMessageExtensions",value:function(e,t){var n=this,r="setMessageExtensions";if(!this.canIUse(q.MSG_EXT))return this.cannotUseCommercialAbility(r);var o="".concat(this._n,".").concat(r),i=e.ID,a=e.conversationID,s=e.sequence,u=e.time,c=T(t);t.length>20&&(c=t.slice(0,20),Ge.w("".concat(o,". the length of extensions cannot exceed 20.")));var l="conversationID:".concat(a," messageID:").concat(i," sequence:").concat(s," time:").concat(u," count:").concat(c.length),d=new ar(r);return d.setMessage(l),Ge.l("".concat(o," ").concat(l)),this._modifyMessageExtensions(e,c).then((function(e){var t=e.resultList,n=e.successCount,r=e.failureCount,i="success count:".concat(n," fail count:").concat(r);return d.setMoreMessage(i).end(),Ge.l("".concat(o," ok. ").concat(i)),xn({extensions:t})})).catch((function(e){return n.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];d.setError(e,r,o).end()})),Ge.e("".concat(o," failed. error:"),e),jn(e)}))}},{key:"getMessageExtensions",value:function(e){var t=this,n="getMessageExtensions";if(!this.canIUse(q.MSG_EXT))return this.cannotUseCommercialAbility(n);var r="".concat(this._n,".").concat(n),o=e.ID,i=e.conversationID,a=e.sequence,s=e.time,u="conversationID:".concat(i," messageID:").concat(o," sequence:").concat(a," time:").concat(s),c=new ar(n);c.setMessage(u),Ge.l("".concat(r," ").concat(u));var l=void 0;return this.getMessageExtensionsMap.has(o)&&(l=this._getGlobalSequence(o)),this._getMessageExtensions(e,l).then((function(e){return c.end(),Ge.l("".concat(r," ok. total count:").concat(e.length)),at(l)&&e.length>0&&t.getMessageExtensionsMap.set(o,1),xn({extensions:e})})).catch((function(e){return t.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];c.setError(e,r,o).end()})),Ge.e("".concat(r," failed. error:"),e),jn(e)}))}},{key:"deleteMessageExtensions",value:function(e,t){var n=this,r="deleteMessageExtensions";if(!this.canIUse(q.MSG_EXT))return this.cannotUseCommercialAbility(r);var o="".concat(this._n,".").concat(r),i=[],a=3;Qt(t)||(a=2,t.forEach((function(e){i.push({key:e,value:"",seq:0})})));var s=e.ID,u=e.conversationID,c=e.sequence,l=e.time,d="conversationID:".concat(u," messageID:").concat(s," sequence:").concat(c," time:").concat(l," operateType:").concat(a),f=new ar(r);return f.setMessage(d),Ge.l("".concat(o," ").concat(d)),this._modifyMessageExtensions(e,i,a).then((function(e){var t=e.resultList,n=e.successCount,r=e.failureCount,i="";return 2===a&&(i="success count:".concat(n," fail count:").concat(r)),f.setMoreMessage("".concat(i)).end(),Ge.l("".concat(o," ok. ").concat(i)),xn({extensions:t})})).catch((function(e){return n.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];f.setError(e,r,o).end()})),Ge.e("".concat(o," failed. error:"),e),jn(e)}))}},{key:"_modifyMessageExtensions",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=kt(e.to)?O.CONV_TOPIC:e.conversationType,i=void 0;3!==r&&(i=this._getRequestExtensions(e,t));var a=null;switch(o){case O.CONV_C2C:a=this.getModule(6);break;case O.CONV_GROUP:a=this.getModule(7);break;case O.CONV_TOPIC:a=this.getModule(10);break;default:return jn({code:qn.CANNOT_FIND_MODULE})}return a.modifyMessageExtensions(e,i,r).then((function(t){var r=t.data,o=r.extensions,i=r.seq,a=[],s=0,u=0,c=[];return(o=Qt(o)?[]:o).forEach((function(e){var t=e.errorCode,n=e.extension,r=n.key,o=n.value,i=n.seq;a.push({code:t,key:r,value:o}),0===t?s++:u++,c.push({key:r,value:o,seq:i})})),n._updateGlobalSequence(e.ID,i),c.length>0&&(n._updateLocalExtension(e.ID,c),c=null),{resultList:a,successCount:s,failureCount:u}})).catch((function(e){return jn(e)}))}},{key:"_getRequestExtensions",value:function(e,t){var n=[];if(this._hasLocalExtension(e.ID)){var r=this._getLocalExtension(e.ID);return t.forEach((function(e){var t=e.key,o=e.value,i=0;r.has(t)&&(i=r.get(t).seq),n.push({key:t,value:o,seq:i})})),n}return t.forEach((function(e){var t=e.key,r=e.value;n.push({key:t,value:r,seq:0})})),n}},{key:"_getMessageExtensions",value:function(e,t){var n=this,r="".concat(this._n,"._getMessageExtensions"),o=e.ID,i=e.to,a=null;switch(kt(i)?O.CONV_TOPIC:e.conversationType){case O.CONV_C2C:a=this.getModule(6);break;case O.CONV_GROUP:a=this.getModule(7);break;case O.CONV_TOPIC:a=this.getModule(10);break;default:return jn({code:qn.CANNOT_FIND_MODULE})}return a.getMessageExtensions(e,t).then((function(t){var i=t.data,a=i.extensions,s=i.completeFlag,u=i.globalSequence,c=i.clearSequence;if(a=Qt(a)?[]:a,Ge.l("".concat(r," ok. completeFlag:").concat(s," globalSequence:").concat(u," clearSequence:").concat(c," count:").concat(a.length)),n._updateLocalExtension(o,a),n._clearLocalExtension(o,c),n._updateGlobalSequence(o,u),1!==s){var l=a.slice(-1)[0].seq+1;return n._getMessageExtensions(e,l)}return n._getLocalExtensions(o)})).catch((function(e){return jn(e)}))}},{key:"_hasLocalExtension",value:function(e){return this.messageExtensionMap.has(e)}},{key:"_getLocalExtension",value:function(e){return this.messageExtensionMap.get(e)}},{key:"_updateLocalExtension",value:function(e,t){this._hasLocalExtension(e)||this.messageExtensionMap.set(e,new Map);var n=this._getLocalExtension(e);t.forEach((function(e){var t=e.key,r=e.value,o=void 0===r?"":r,i=e.seq;n.set(t,{value:o,seq:i})}))}},{key:"_clearLocalExtension",value:function(e,t){if(!(t<=0)&&this._hasLocalExtension(e)){var n=this._getLocalExtension(e);n.forEach((function(e,r){e.seq<=t&&n.delete(r)}))}}},{key:"_getLocalExtensions",value:function(e){var t=[];return this._hasLocalExtension(e)&&this._getLocalExtension(e).forEach((function(e,n){var r=e.value;Qt(r)||t.push({key:n,value:r})})),t}},{key:"_getGlobalSequence",value:function(e){return this.globalSeqMap.get(e)}},{key:"_updateGlobalSequence",value:function(e,t){this.globalSeqMap.set(e,t)}},{key:"reset",value:function(){Ge.l("".concat(this._n,".reset")),this.messageExtensionMap.clear(),this.globalSeqMap.clear(),this.getMessageExtensionsMap.clear()}}]),n}(Hn),Ro=function(e){d(r,e);var n=I(r);function r(e){var t;return a(this,r),(t=n.call(this,e))._n="MessageReactionModule",t._reactedByMyselfMap=new Map,t._reactionInfoMap=new Map,t}return c(r,[{key:"onMessageReactionNotifyList",value:function(e){var n=this,r=(e||{}).dataList;(void 0===r?[]:r).forEach((function(e){var r=e.C2CMessageInfo,o=void 0===r?{}:r,i=e.groupMessageInfo,a=void 0===i?{}:i,s=e.reactionList,u=void 0===s?[]:s,c=t(t({},o),a),l=c.tinyID,d=c.clientTime,f=c.random,p="".concat(l,"-").concat(d,"-").concat(f),h=[];u.forEach((function(e){at(e.userIDList)&&(e.userIDList=[],e.count=0),h.push.apply(h,T(e.userIDList))})),Ge.l("".concat(n._n,".onMessageReactionNotifyList messageID:").concat(p," reactionList:").concat(u.length)),n._handleReactionSummary([{messageID:p,reactionList:u}],h).then((function(e){n.emitOuterEvent(A.MESSAGE_REACTIONS_UPDATED,t({},e[0]))}))}))}},{key:"onMessageReactionNotify",value:function(e){var n=e.dataList||{},r=n.C2CMessageInfo,o=void 0===r?{}:r,i=n.groupMessageInfo,a=void 0===i?{}:i,s=n.reactionID,u=n.operateType,c=t(t({},o),a),l=c.tinyID,d=c.clientTime,f=c.random,p="".concat(l,"-").concat(d,"-").concat(f);Ge.l("".concat(this._n,".onMessageReactionNotify messageID:").concat(p," reactionID:").concat(s," operateType:").concat(u)),1===u?this._addReactedByMyselfMap(p,s):this._removeReactedByMyselfMap(p,s);var h="".concat(p,"-").concat(s);if(this._reactionInfoMap.has(h)){var g=this._reactionInfoMap.get(h);g.reactedByMyself=1===u,this.emitOuterEvent(A.MESSAGE_REACTIONS_UPDATED,{messageID:p,reactionList:[g]})}}},{key:"addMessageReaction",value:function(e,t){var n=this,r="addMessageReaction";if(!this.canIUse(q.MSG_REACTION))return this.cannotUseCommercialAbility(r);var o="".concat(this._n,".").concat(r),i=e.ID,a=e.conversationID,s="conversationID:".concat(a," messageID:").concat(i," reactionID:").concat(t),u=new ar(r);u.setMessage(s),Ge.l("".concat(o," ").concat(s));var c=this._createReactionOperationPack(e,t,1);return this._addReactedByMyselfMap(e.ID,t),this.request(c).then((function(){return u.end(),Ge.l("".concat(o," ok.")),xn()})).catch((function(r){return n._removeReactedByMyselfMap(e.ID,t),n.probeNetwork().then((function(e){var t=M(e,2),n=t[0],o=t[1];u.setError(r,n,o).end()})),Ge.e("".concat(o," failed. error:"),r),jn(r)}))}},{key:"removeMessageReaction",value:function(e,t){var n=this,r="removeMessageReaction";if(!this.canIUse(q.MSG_REACTION))return this.cannotUseCommercialAbility(r);var o="".concat(this._n,".").concat(r),i=e.ID,a=e.conversationID,s="conversationID:".concat(a," messageID:").concat(i," reactionID:").concat(t),u=new ar(r);u.setMessage(s),Ge.l("".concat(o," ").concat(s));var c=this._createReactionOperationPack(e,t,2);return this._removeReactedByMyselfMap(e.ID,t),this.request(c).then((function(){return u.end(),Ge.l("".concat(o," ok.")),xn()})).catch((function(e){return n.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];u.setError(e,r,o).end()})),Ge.e("".concat(o," failed. error:"),e),jn(e)}))}},{key:"getMessageReactions",value:function(e){var n=this,r="getMessageReactions";if(!this.canIUse(q.MSG_REACTION))return this.cannotUseCommercialAbility(r);var o="".concat(this._n,".").concat(r),i=e.messageList,a=e.maxUserCountPerReaction,s=i[0].conversationID,u="conversationID:".concat(s," maxUserCountPerReaction:").concat(a," messageList:").concat(i.length),c=new ar(r);c.setMessage(u),Ge.l("".concat(o," ").concat(u));var l=new Map,d=this._createReactionSummaryPack(t(t({},e),{},{messageIDMap:l}));return this.request(d).then((function(e){var t=e.data.resultList,r=[],o=[];return(void 0===t?[]:t).forEach((function(e){var t=e.messageKey,n=void 0===t?void 0:t,i=e.messageSequence,a=void 0===i?void 0:i,s=e.reactionList,u=void 0===s?[]:s,c=at(n)?l.get(a):l.get(n);r.push({messageID:c,reactionList:u}),u.forEach((function(e){o.push.apply(o,T(e.userIDList))}))})),n._handleReactionSummary(r,o)})).then((function(e){return c.end(),Ge.l("".concat(o," ok.")),l.clear(),xn({resultList:e})})).catch((function(e){return n.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];c.setError(e,r,o).end()})),Ge.e("".concat(o," failed. error:"),e),jn(e)}))}},{key:"getAllUserListOfMessageReaction",value:function(e){var t=this,n="getAllUserListOfMessageReaction";if(!this.canIUse(q.MSG_REACTION))return this.cannotUseCommercialAbility(n);var r="".concat(this._n,".").concat(n),o=e.message,i=e.reactionID,a=e.nextSeq,s=e.count,u=o.ID,c=o.conversationID,l="conversationID:".concat(c," messageID:").concat(u," reactionID:").concat(i," nextSeq:").concat(a," count:").concat(s),d=new ar(n);d.setMessage(l),Ge.l("".concat(r," ").concat(l));var f={userList:[],nextSeq:0,isCompleted:!1},p=this._createReactionUserListPack(e);return this.request(p).then((function(e){var n=e.data,r=n.userIDList,o=void 0===r?[]:r,i=n.nextSeq,a=void 0===i?0:i;return f.nextSeq=a,f.isCompleted=0===a,t.getModule(4).getUserNickAndAvatar(o)})).then((function(e){return f.userList=e,d.end(),Ge.l("".concat(r," ok.")),xn(f)})).catch((function(e){return t.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];d.setError(e,r,o).end()})),Ge.e("".concat(r," failed. error:"),e),jn(e)}))}},{key:"_createReactionOperationPack",value:function(e,t,n){var r=void 0,o={reactionID:t,userIDList:[this.getMyUserID()]};if(e.conversationType===O.CONV_C2C){var i=this.getModule(6);r=1===n?Kn.ADD_C2C_MSG_REACTION:Kn.REMOVE_C2C_MSG_REACTION,o.from=e.from,o.to=e.to,o.messageKey=i.getMessageKey(e)}if(e.conversationType===O.CONV_GROUP){var a=void 0,s=e.to;kt(e.to)&&(s=Vt(a=e.to)),r=1===n?Kn.ADD_GRP_MSG_REACTION:Kn.REMOVE_GRP_MSG_REACTION,o.groupID=s,o.topicID=a,o.messageSequence=e.sequence}return{protocolName:r,requestData:o}}},{key:"_createReactionSummaryPack",value:function(e){var t=e.messageList,n=e.maxUserCountPerReaction,r=void 0===n?10:n,o=e.messageIDMap,i=t[0],a=void 0,s=void 0;if(i.conversationType===O.CONV_C2C){var u=this.getModule(6),c=t.map((function(e){var t=u.getMessageKey(e);return o.set(t,e.ID),t}));a=Kn.GET_C2C_MSG_REACTIONS,s={from:i.from,to:i.to,messageKeyList:c,count:r}}if(i.conversationType===O.CONV_GROUP){var l=void 0,d=i.to;kt(i.to)&&(d=Vt(l=i.to));var f=t.map((function(e){return o.set(e.sequence,e.ID),e.sequence}));a=Kn.GET_GRP_MSG_REACTIONS,s={groupID:d,topicID:l,messageSequenceList:f,count:r}}return{protocolName:a,requestData:s}}},{key:"_createReactionUserListPack",value:function(e){var t=e.message,n=e.reactionID,r=e.nextSeq,o=void 0===r?0:r,i=e.count,a=void 0===i?100:i,s=void 0,u={reactionID:n,nextSeq:o,count:a>100?100:a};if(t.conversationType===O.CONV_C2C){var c=this.getModule(6);s=Kn.GET_C2C_MSG_REACTION_USER_LIST,u.from=t.from,u.to=t.to,u.messageKey=c.getMessageKey(t)}if(t.conversationType===O.CONV_GROUP){var l=void 0,d=t.to;kt(t.to)&&(d=Vt(l=t.to)),s=Kn.GET_GRP_MSG_REACTION_USER_LIST,u.groupID=d,u.topicID=l,u.messageSequence=t.sequence}return{protocolName:s,requestData:u}}},{key:"_handleReactionSummary",value:function(e,t){var n=this;return this.getModule(4).getUserNickAndAvatar(t).then((function(t){var r=[];return e.forEach((function(e){var o=[];e.reactionList.forEach((function(r){var i=r.reactionID,a=r.count,s=r.userIDList,u=r.reactedByMyself,c=void 0===u?void 0:u,l=[];s.forEach((function(e){t.forEach((function(t){e===t.userID&&l.push(t)}))}));var d={reactionID:i,totalUserCount:a,partialUserList:l,reactedByMyself:n._computeReactedByMyself({reactedByMyself:c,messageID:e.messageID,reactionID:i})};if(o.push(d),at(c)&&!n._reactedByMyselfMap.has(e.messageID)){var f="".concat(e.messageID,"-").concat(i);n._reactionInfoMap.set(f,d)}})),r.push({messageID:e.messageID,reactionList:o})})),r}))}},{key:"_addReactedByMyselfMap",value:function(e,t){this._reactedByMyselfMap.has(e)||this._reactedByMyselfMap.set(e,[]);var n=this._reactedByMyselfMap.get(e);-1===n.indexOf(t)&&n.push(t)}},{key:"_removeReactedByMyselfMap",value:function(e,t){if(this._reactedByMyselfMap.has(e)){var n=this._reactedByMyselfMap.get(e),r=n.indexOf(t);r>-1&&n.splice(r,1)}}},{key:"_computeReactedByMyself",value:function(e){var t=e.reactedByMyself,n=e.messageID,r=e.reactionID;return at(t)?!!this._reactedByMyselfMap.has(n)&&this._reactedByMyselfMap.get(n).includes(r):1===t}},{key:"reset",value:function(){Ge.l("".concat(this._n,".reset")),this._reactedByMyselfMap.clear(),this._reactionInfoMap.clear()}}]),r}(Hn),No=function(e){d(n,e);var t=I(n);function n(e){var r;return a(this,n),(r=t.call(this,e))._n="ComboMessageModule",r}return c(n,[{key:"sendMessage",value:function(e){var t=this,n=this._constructMessageInstance(e);if(null===n)return jn({code:qn.MSG_SEND_FAIL});this._addSendMessageTotalCount(n);var r=Date.now();return this.getModule(11).setMessageRandom(n),this._sendComboMessage(n,e).then((function(e){var o=e.data,i=o.time,a=o.sequence,s=o.readReceiptCode;et(s)&&0!==s&&(new ar("sendMessageWithReceipt").setMessage("from:".concat(n.from," to:").concat(n.to," sequence:").concat(a," readReceiptCode:").concat(s)).end(),Ge.w("".concat(t._n,".sendMessage readReceiptCode:").concat(s," message:").concat(t.getErrorMessage(s)))),t._addSendMessageSuccessCount(n,r);var u=t.getModule(11);n.status=rn.SUCCESS,n.time=i,n.conversationType===O.CONV_GROUP&&(n.sequence=a),u.appendToMessageList(n);var c=n;return!0===n._isExcludedFromLastMessage&&(c=""),u.onMessageSent({conversationOptionsList:[{conversationID:n.conversationID,unreadCount:0,type:n.conversationType,subType:n.conversationSubType,lastMessage:c}]}),xn({message:n})})).catch((function(e){return t._onSendMessageFailed(n,e)}))}},{key:"_sendComboMessage",value:function(e,t){var n=this._m.getModule(20),r="";return e.conversationType===O.CONV_C2C&&(r="".concat(F.NAME.OPEN_IM,".").concat(Kn.SEND_C2C_MESSAGE)),e.conversationType===O.CONV_GROUP&&(r="".concat(F.NAME.GROUP,".").concat(Kn.SEND_GROUP_MESSAGE)),n.sendComboMessage({servcmd:r,data:t})}},{key:"_constructMessageInstance",value:function(e){var t="".concat(this._n,"._constructMessageInstance"),n=null;try{var r=this.getMyUserID(),o={};if(o.senderTinyID=this.getMyTinyID(),o.currentUser=r,o.from=e.From_Account||r,e.GroupId?(o.conversationID="".concat(O.CONV_GROUP).concat(e.GroupId),o.conversationType=O.CONV_GROUP,o.to=e.GroupId):e.To_Account&&(o.conversationID="".concat(O.CONV_C2C).concat(e.To_Account),o.conversationType=O.CONV_C2C,o.to=e.To_Account),o.time=e.MsgTimeStamp||0,o.random=e.Random||e.MsgRandom||0,o.priority=e.MsgPriority,nt(e.CloudCustomData)&&e.CloudCustomData.length>0&&(o.cloudCustomData=e.CloudCustomData),it(e.SendMsgControl)&&(o.messageControlInfo={},e.SendMsgControl.includes("NoUnread")&&(o.messageControlInfo.excludedFromUnreadCount=1),e.SendMsgControl.includes("NoLastMsg")&&(o.messageControlInfo.excludedFromLastMessage=1)),o.conversationType===O.CONV_GROUP&&it(e.To_Account)&&e.To_Account.length>0){var i=e.To_Account;e.To_Account.length>50&&(i=e.To_Account.slice(0,50),Ge.w("".concat(t," To_Account must be less than or equal to 50."))),o.receiverList=T(i),e.To_Account=T(i)}1!==e.IsNeedReadReceipt&&1!==e.NeedReadReceipt||(o.needReadReceipt=!0),1===e.SupportMessageExtension&&(o.isSupportExtension=!0),(n=new Tr(o)).status=rn.UNSEND,e.MsgClientTime=n.clientTime,n.conversationType===O.CONV_C2C&&(e.MsgSeq=n.sequence);for(var a,s=e.MsgBody.length,u=0;u<s;u++)"TIMTextElem"===(a=e.MsgBody[u]).MsgType?n.setTextElement(a.MsgContent.Text):"TIMCustomElem"===a.MsgType?n.setCustomElement({data:a.MsgContent.Data||"",description:a.MsgContent.Desc||"",extension:a.MsgContent.Ext||""}):"TIMFaceElem"===a.MsgType&&n.setFaceElement({index:a.MsgContent.Index,data:a.MsgContent.Data});var c=n.getElements();n.payload=c[0].content,n.type=c[0].type}catch(h){n=null,Ge.e("".concat(t," failed. error:"),h)}return n}},{key:"_onSendMessageFailed",value:function(e,t){e.status=rn.FAIL,this.getModule(11).deleteMessageRandom(e),this._addSendMessageFailCountOnUser(e,t);var n=new ar("sendMessage");return n.setMessage("tjg_id:".concat(this.generateTjgID(e)," type:").concat(e.type," from:").concat(e.from," to:").concat(e.to)),this.probeNetwork().then((function(e){var r=M(e,2),o=r[0],i=r[1];n.setError(t,o,i).end()})),Ge.e("".concat(this._n,"._onSendMessageFailed error:"),t),jn(new Fn({code:t&&t.code?t.code:qn.MSG_SEND_FAIL,message:t&&t.message?t.message:void 0,data:{message:e}}))}},{key:"_getSendMessageSpecifiedKey",value:function(e){if(e.conversationType===O.CONV_C2C)return zn;if(e.conversationType===O.CONV_GROUP){var t=this.getModule(7).getLocalGroupProfile(e.to);if(!t)return;var n=t.type;return Et(n)?Xn:Jn}}},{key:"_addSendMessageTotalCount",value:function(e){var t=this._getSendMessageSpecifiedKey(e);t&&this.getModule(26).addTotalCount(t)}},{key:"_addSendMessageSuccessCount",value:function(e,t){var n=this._getSendMessageSpecifiedKey(e);if(n){var r=this.getModule(26);r.addSuccessCount(n),r.addCost(n,Xt(t,!1))}}},{key:"_addSendMessageFailCountOnUser",value:function(e,t){var n=t.code,r=void 0===n?-1:n,o=this.getModule(26),i=this._getSendMessageSpecifiedKey(e);bo(r)&&i&&o.addFailedCountOfUserSide(i)}}]),n}(Hn),wo=function(e){d(n,e);var t=I(n);function n(e){var r;return a(this,n),(r=t.call(this,e))._n="PluginModule",r.plugins={},r}return c(n,[{key:"registerPlugin",value:function(e){var t=this;Object.keys(e).forEach((function(n){t.plugins[n]=e[n]})),new ar("registerPlugin").setMessage("".concat(Object.keys(e))).end()}},{key:"getPlugin",value:function(e){return this.plugins[e]}},{key:"reset",value:function(){}}]),n}(Hn),Lo=function(e){d(r,e);var n=I(r);function r(e){var t;return a(this,r),(t=n.call(this,e))._n="SyncUnreadMessageModule",t._cookie="",t._onlineSyncFlag=!1,t.getInnerEmitterInstance().on(Cr.A2KEY_AND_TINYID_UPDATED,t._onLoginSuccess,m(t)),t}return c(r,[{key:"_onLoginSuccess",value:function(e){this._startSync({cookie:this._cookie,syncFlag:0,isOnlineSync:0})}},{key:"_startSync",value:function(e){var n=this,r=e.cookie,o=e.syncFlag,i=e.isOnlineSync,a="".concat(this._n,"._startSync");Ge.l("".concat(a," cookie:").concat(r," syncFlag:").concat(o," isOnlineSync:").concat(i)),this.request({protocolName:Kn.SYNC_UNREAD_MESSAGE,requestData:{cookie:r,syncFlag:o,isOnlineSync:i}}).then((function(e){var r=e.data,o=r.cookie,i=r.syncFlag;n._cookie=o,Qt(o)||(0===i||1===i?(n._dispatchUnreadMessage(t(t({},e.data),{},{isSyncingEnded:!1})),n._startSync({cookie:o,syncFlag:i,isOnlineSync:0})):2===i&&n._dispatchUnreadMessage(t(t({},e.data),{},{isSyncingEnded:!0})))})).catch((function(e){Ge.e("".concat(a," failed. error:"),e)}))}},{key:"_dispatchUnreadMessage",value:function(e){e.eventArray&&this.getModule(20).onMessage({head:{},body:{eventArray:e.eventArray,isInstantMessage:this._onlineSyncFlag,isSyncingEnded:e.isSyncingEnded}}),this.getModule(6).onNewC2CMessage({dataList:e.messageList,isInstantMessage:!!e.isSyncingEnded&&this._onlineSyncFlag,C2CRemainingUnreadList:e.C2CRemainingUnreadList,C2CPairUnreadList:e.C2CPairUnreadList,isSyncingEnded:e.isSyncingEnded})}},{key:"startOnlineSync",value:function(){Ge.l("".concat(this._n,".startOnlineSync")),this._onlineSyncFlag=!0,this._startSync({cookie:this._cookie,syncFlag:0,isOnlineSync:1})}},{key:"startSyncOnReconnected",value:function(){Ge.l("".concat(this._n,".startSyncOnReconnected.")),this._onlineSyncFlag=!0,this._startSync({cookie:this._cookie,syncFlag:0,isOnlineSync:0})}},{key:"reset",value:function(){Ge.l("".concat(this._n,".reset")),this._onlineSyncFlag=!1,this._cookie=""}}]),r}(Hn),Po={request:{toAccount:"To_Account",fromAccount:"From_Account",to:"To_Account",from:"From_Account",groupID:"GroupId",groupAtUserID:"GroupAt_Account",extension:"Ext",data:"Data",description:"Desc",elements:"MsgBody",sizeType:"Type",downloadFlag:"Download_Flag",thumbUUID:"ThumbUUID",videoUUID:"VideoUUID",remoteAudioUrl:"Url",remoteVideoUrl:"VideoUrl",videoUrl:"",imageUrl:"URL",fileUrl:"Url",uuid:"UUID",priority:"MsgPriority",receiverUserID:"To_Account",receiverGroupID:"GroupId",messageSender:"SenderId",messageReceiver:"ReceiverId",nick:"From_AccountNick",avatar:"From_AccountHeadurl",messageNumber:"MsgNum",pbDownloadKey:"PbMsgKey",downloadKey:"JsonMsgKey",applicationType:"PendencyType",userIDList:"To_Account",groupNameList:"GroupName",userID:"To_Account",groupAttributeList:"GroupAttr",mainSequence:"AttrMainSeq",avChatRoomKey:"BytesKey",attributeControl:"AttrControl",sequence:"seq",messageControlInfo:"SendMsgControl",updateSequence:"UpdateSeq",clientTime:"MsgClientTime",sequenceList:"MsgSeqList",topicID:"TopicId",customData:"CustomString",isSupportTopic:"SupportTopic",isWebUniapp:"is_web_uniapp",isSupportExtension:"SupportMessageExtension",messageSequence:"MsgSeq",messageKey:"MsgKey",startSequence:"startSeq",simplifiedMessage:"DownsizeFlag",isRelayMessage:"IsRelayMsg",reactionID:"Reaction",messageSequenceList:"MsgSeqList",messageKeyList:"MsgKeyList"},response:{MsgPriority:"priority",ThumbUUID:"thumbUUID",VideoUUID:"videoUUID",Download_Flag:"downloadFlag",GroupId:"groupID",Member_Account:"userID",MsgList:"messageList",SyncFlag:"syncFlag",To_Account:"to",From_Account:"from",MsgSeq:"sequence",MsgRandom:"random",MsgTime:"time",MsgTimeStamp:"time",MsgContent:"content",MsgBody:"elements",From_AccountNick:"nick",From_AccountHeadurl:"avatar",GroupWithdrawInfoArray:"revokedInfos",GroupReadInfoArray:"groupMessageReadNotice",LastReadMsgSeq:"lastMessageSeq",WithdrawC2cMsgNotify:"c2cMessageRevokedNotify",C2cWithdrawInfoArray:"revokedInfos",C2cReadedReceipt:"c2cMessageReadReceipt",ReadC2cMsgNotify:"c2cMessageReadNotice",LastReadTime:"peerReadTime",MsgRand:"random",MsgType:"type",MsgShow:"messageShow",NextMsgSeq:"nextMessageSeq",FaceUrl:"avatar",ProfileDataMod:"profileModify",Profile_Account:"userID",ValueBytes:"value",ValueNum:"value",NoticeSeq:"noticeSequence",NotifySeq:"notifySequence",MsgFrom_AccountExtraInfo:"messageFromAccountExtraInformation",Operator_Account:"operatorID",OpType:"operationType",ReportType:"operationType",UserId:"userID",User_Account:"userID",List_Account:"userIDList",MsgOperatorMemberExtraInfo:"operatorInfo",MsgMemberExtraInfo:"memberInfoList",ImageUrl:"avatar",NickName:"nick",MsgGroupNewInfo:"newGroupProfile",MsgAppDefinedData:"groupCustomField",Owner_Account:"ownerID",GroupFaceUrl:"avatar",GroupIntroduction:"introduction",GroupNotification:"notification",GroupApplyJoinOption:"joinOption",MsgKey:"messageKey",GroupInfo:"groupProfile",ShutupTime:"muteTime",Desc:"description",Ext:"extension",GroupAt_Account:"groupAtUserID",MsgNum:"messageNumber",PbMsgKey:"pbDownloadKey",JsonMsgKey:"downloadKey",MsgModifiedFlag:"isModified",PendencyItem:"applicationItem",PendencyType:"applicationType",AddTime:"time",AddSource:"source",AddWording:"wording",ProfileImImage:"avatar",PendencyAdd:"friendApplicationAdded",FrienPencydDel_Account:"friendApplicationDeletedUserIDList",Peer_Account:"userID",GroupAttr:"groupAttributeList",GroupAttrAry:"groupAttributeList",AttrMainSeq:"mainSequence",seq:"sequence",GroupAttrOption:"groupAttributeOption",BytesChangedKeys:"changedKeyList",GroupAttrInfo:"groupAttributeList",GroupAttrSeq:"mainSequence",PushChangedAttrValFlag:"isWithChangedAttributeInfo",SubKeySeq:"sequence",Val:"value",MsgGroupFromCardName:"senderNameCard",MsgGroupFromNickName:"senderNick",C2cNick:"peerNick",C2cImage:"peerAvatar",SendMsgControl:"messageControlInfo",NoLastMsg:"excludedFromLastMessage",NoUnread:"excludedFromUnreadCount",UpdateSeq:"updateSequence",MuteNotifications:"muteFlag",MsgClientTime:"clientTime",TinyId:"tinyID",GroupMsgReceiptList:"readReceiptList",ReadNum:"readCount",UnreadNum:"unreadCount",TopicId:"topicID",MillionGroupFlag:"communityType",SupportTopic:"isSupportTopic",MsgTopicNewInfo:"newTopicInfo",ShutupAll:"muteAllMembers",CustomString:"customData",TopicFaceUrl:"avatar",TopicIntroduction:"introduction",TopicNotification:"notification",TopicIdArray:"topicIDList",MsgVersion:"messageVersion",C2cMsgModNotifys:"c2cMessageModified",GroupMsgModNotifys:"groupMessageModified",ApplyJoinOption:"joinOption",MsgFlag:"messageRemindType",AtInfoList:"groupAtInfoList",AtFlagList:"groupAtType",AtMsgSeq:"sequence",BanDuration:"duration",BanDescription:"reason",NotVisible:"invisible",BytesTag:"tag",BytesValue:"value",RptBytesValue:"value",LatestSeq:"globalSequence",ClearSeq:"clearSequence",SupportMessageExtension:"isSupportExtension",ExtensionList:"extensions",GroupCounter:"counterList",Revoker_Account:"revoker",MsgExtensionNotify:"messageExtensionNotify",ExtensionC2cMsgInfo:"messageInfo",ExtensionGroupMsgInfo:"messageInfo",MsgOptType:"operateType",SetKVInfo:"operateResultList",DeleteKVInfo:"operateResultList",ClearKVInfo:"operateResultList",MsgKeyValue:"extensions",ClearMsgSeq:"clearSequence",MsgLastSeq:"globalSequence",InviteJoinOption:"inviteOption",MemberList_Account:"inviteeList",MsgMemberExtraInfoList:"inviteeInfoList",E:"event",GInf:"groupProfile",MCT:"clientTime",MR:"random",MP:"priority",MTS:"time",GId:"groupID",MS:"sequence",CCD:"cloudCustomData",F_Account:"from",F_Hd:"avatar",F_NN:"nick",GN:"groupName",GT:"groupType",IsSys:"isSystemMessage",OpInf:"operatorInfo",Img:"avatar",NN:"nick",OnlineInf:"onlineMemberInfo",ET:"expireTime",Num:"onlineMemberNum",Opt:"operationType",O_Account:"operatorID",RT:"operationType",UDF:"userDefinedField",L_Account:"userIDList",IsPlaceMsg:"isPlaceMessage",MsgCheckResult:"checkResult",Results:"resultList",Reaction:"reactionID",Reaction_Account:"userIDList",MsgReactionNotifyList:"messageReactionNotifyList",MsgReactionNotify:"messageReactionNotify",MsgReactionSummary:"reactionList",C2CMsgInfo:"C2CMessageInfo",GroupMsgInfo:"groupMessageInfo",int32_err_code:"errorCode",str_err_msg:"errorMsg",MsgDropReason:"messageDropReason",ReactedByMe:"reactedByMyself"},ignoreKeyWord:["C2C","ID","USP"]};function Uo(e,t){if("string"!=typeof e&&!Array.isArray(e))throw new TypeError("Expected the input to be `string | string[]`");var n;return t=Object.assign({pascalCase:!1},t),0===(e=Array.isArray(e)?e.map((function(e){return e.trim()})).filter((function(e){return e.length})).join("-"):e.trim()).length?"":1===e.length?t.pascalCase?e.toUpperCase():e.toLowerCase():(e!==e.toLowerCase()&&(e=Go(e)),e=e.replace(/^[_.\- ]+/,"").toLowerCase().replace(/[_.\- ]+(\w|$)/g,(function(e,t){return t.toUpperCase()})).replace(/\d+(\w|$)/g,(function(e){return e.toUpperCase()})),n=e,t.pascalCase?n.charAt(0).toUpperCase()+n.slice(1):n)}var Go=function(e){for(var t=!1,n=!1,r=!1,o=0;o<e.length;o++){var i=e[o];t&&/[a-zA-Z]/.test(i)&&i.toUpperCase()===i?(e=e.slice(0,o)+"-"+e.slice(o),t=!1,r=n,n=!0,o++):n&&r&&/[a-zA-Z]/.test(i)&&i.toLowerCase()===i?(e=e.slice(0,o-1)+"-"+e.slice(o-1),r=n,n=!1,t=!0):(t=i.toLowerCase()===i&&i.toUpperCase()!==i,r=n,n=i.toUpperCase()===i&&i.toLowerCase()!==i)}return e};for(var xo=String.fromCharCode,Fo=function(e){var t=0|e.charCodeAt(0);if(55296<=t)if(t<56320){var n=0|e.charCodeAt(1);if(56320<=n&&n<=57343){if((t=(t<<10)+n-56613888|0)>65535)return xo(240|t>>>18,128|t>>>12&63,128|t>>>6&63,128|63&t)}else t=65533}else t<=57343&&(t=65533);return t<=2047?xo(192|t>>>6,128|63&t):xo(224|t>>>12,128|t>>>6&63,128|63&t)},qo=function(e){for(var t=void 0===e?"":(""+e).replace(/[\x80-\uD7ff\uDC00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]?/g,Fo),n=0|t.length,r=new Uint8Array(n),o=0;o<n;o=o+1|0)r[o]=0|t.charCodeAt(o);return r},Vo=function(e){for(var t=new Uint8Array(e),n="",r=0,o=t.length;r<o;){var i=t[r],a=0,s=0;if(i<=127?(a=0,s=255&i):i<=223?(a=1,s=31&i):i<=239?(a=2,s=15&i):i<=244&&(a=3,s=7&i),o-r-a>0)for(var u=0;u<a;)s=s<<6|63&(i=t[r+u+1]),u+=1;else s=65533,a=o-r;n+=String.fromCodePoint(s),r+=a+1}return n},Bo=function(){function e(t){a(this,e),this._handler=t;var n=t.getURL();if(this._socket=null,this._workerSocket=null,this._id=vt(),this._handler.getIsWorkerEnabled()){var r=URL.createObjectURL(new Blob([';let _socket = null;onmessage = function(event) {  if (event.data.cmd === "start") {    const url = event.data.url;    _socket = new WebSocket(url);    _socket.binaryType = "arraybuffer";    _socket.onopen = function() {      postMessage({ callback: "onOpen" });    };    _socket.onclose = function(e) {      postMessage({ callback: "onOpen", e: { code: e.code, reason: e.reason } });    };    _socket.onmessage = function(e) {      postMessage({ callback: "onMessage", data: e.data });    };    _socket.onerror = function(e) {      postMessage({ callback: "onError", e: { isTrusted: "true" } });    };  } else if (event.data.cmd === "sendMessage") {    if (_socket !== null) {      _socket.send(event.data.data);    }  } else if (event.data.cmd === "stop") {    if (_socket !== null) {      _socket.close(event.data.code);      _socket = null;    }  }};'],{type:"application/javascript; charset=utf-8"}));this._workerSocket=new Worker(r);var o=this;this._workerSocket.onmessage=function(e){var t=e.data,n=t.callback,r=t.e;"onOpen"===n?o._onOpen():"onClose"===n?o._onClose(r):"onError"===n?o._onError(r):"onMessage"===n&&o._onMessage(e.data)},this._workerSocket.postMessage({cmd:"start",id:this._id,url:n})}else $?Y?(Q.connectSocket({url:n,header:{"content-type":"application/json"}}),Q.onSocketClose(this._onClose.bind(this)),Q.onSocketOpen(this._onOpen.bind(this)),Q.onSocketMessage(this._onMessage.bind(this)),Q.onSocketError(this._onError.bind(this))):(this._socket=Q.connectSocket({url:n,header:{"content-type":"application/json"},complete:function(){}}),this._socket.onClose(this._onClose.bind(this)),this._socket.onOpen(this._onOpen.bind(this)),this._socket.onMessage(this._onMessage.bind(this)),this._socket.onError(this._onError.bind(this))):Z&&(this._socket=new WebSocket(n),this._socket.binaryType="arraybuffer",this._socket.onopen=this._onOpen.bind(this),this._socket.onmessage=this._onMessage.bind(this),this._socket.onclose=this._onClose.bind(this),this._socket.onerror=this._onError.bind(this));this._canIUseBinaryFrame=t.canIUseBinaryFrame()}return c(e,[{key:"getID",value:function(){return this._id}},{key:"_onOpen",value:function(){this._handler.onOpen({id:this._id})}},{key:"_onClose",value:function(e){this._handler.onClose({id:this._id,e:e})}},{key:"_onMessage",value:function(e){this._handler.onMessage({data:this._canIUseBinaryFrame?Vo(e.data):e.data})}},{key:"_onError",value:function(e){this._handler.onError({id:this._id,e:e})}},{key:"setIsWorkerEnabled",value:function(e){this._isWorkerEnabled=!0}},{key:"close",value:function(e){if(this._workerSocket&&(this._workerSocket.postMessage({cmd:"stop",code:e}),this._workerSocket.terminate(),this._workerSocket=null),Y)return Q.offSocketClose(),Q.offSocketMessage(),Q.offSocketOpen(),Q.offSocketError(),void Q.closeSocket();this._socket&&($?(this._socket.onClose((function(){})),this._socket.onOpen((function(){})),this._socket.onMessage((function(){})),this._socket.onError((function(){}))):Z&&(this._socket.onopen=null,this._socket.onmessage=null,this._socket.onclose=null,this._socket.onerror=null),W?this._socket.close({code:e}):this._socket.close(e),this._socket=null)}},{key:"send",value:function(e){if(this._workerSocket)this._workerSocket.postMessage({cmd:"sendMessage",data:this._canIUseBinaryFrame?qo(e.data).buffer:e.data});else{if(Y)return void Q.sendSocketMessage({data:e.data,fail:function(){e.fail&&e.requestID&&e.fail(e.requestID)}});this._socket&&($?this._socket.send({data:this._canIUseBinaryFrame?qo(e.data).buffer:e.data,fail:function(){e.fail&&e.requestID&&e.fail(e.requestID)}}):Z&&this._socket.send(this._canIUseBinaryFrame?qo(e.data).buffer:e.data))}}}]),e}(),jo=["keyMap"],Ho=["keyMap"],Ko="connected",Wo="connecting",Yo="disconnected",zo=function(){function e(t){a(this,e),this._channelModule=t,this._n="SocketHandler",this._promiseMap=new Map,this._readyState=Yo,this._simpleRequestMap=new Map,this.MAX_SIZE=100,this._startSequence=vt(),this._startTs=0,this._reConnectFlag=!1,this._nextPingTs=0,this._reConnectCount=0,this.MAX_RECONNECT_COUNT=3,this._socketID=-1,this._random=0,this._socket=null,this._url="",this._onOpenTs=0,this._canIUseBinaryFrame=!0,this._isWorkerEnabled=!0,this._setWebsocketHost(),this._initConnection()}return c(e,[{key:"_setWebsocketHost",value:function(){var e=this._channelModule.getModule(12),t=x;this._channelModule.isOversea()&&(t="OVERSEA"),e.isSingaporeSite()?t="SINGAPORE":e.isKoreaSite()?t="KOREA":e.isGermanySite()?t="GERMANY":e.isIndiaSite()?t="IND":e.isJapanSite()?t="JPN":e.isUSASite()?t="USA":e.isIndonesiaSite()&&(t="INDONESIA"),F.HOST.setCurrent(t)}},{key:"_initConnection",value:function(){at(F.HOST.CURRENT.BACKUP)||""===this._url?this._url=F.HOST.CURRENT.DEFAULT:this._url===F.HOST.CURRENT.DEFAULT?this._url=F.HOST.CURRENT.BACKUP:this._url===F.HOST.CURRENT.BACKUP?this._url=this._canIUseAnyCast()?F.HOST.CURRENT.ANYCAST:F.HOST.CURRENT.DEFAULT:this._url===F.HOST.CURRENT.ANYCAST&&(F.HOST.CURRENT.ANYCAST="",this._url=F.HOST.CURRENT.DEFAULT);var e=this._channelModule.getModule(12).getProxyServer();Qt(e)||(this._url=e),this._connect(),this._nextPingTs=0}},{key:"_canIUseAnyCast",value:function(){return Z&&F.HOST.CURRENT.ANYCAST}},{key:"onCheckTimer",value:function(e){e%1==0&&this._checkPromiseMap()}},{key:"_checkPromiseMap",value:function(){var e=this;0!==this._promiseMap.size&&this._promiseMap.forEach((function(t,n){var r=t.reject,o=t.timestamp,i=15e3;-1!==n.indexOf(Kn.LOGIN)&&(i=9e4),Date.now()-o>=i&&(Ge.l("".concat(e._n,"._checkPromiseMap request timeout, delete requestID:").concat(n)),e._promiseMap.delete(n),r(new Fn({code:qn.NETWORK_TIMEOUT})),e._channelModule.onRequestTimeout(n))}))}},{key:"onOpen",value:function(e){if(""!==this._readyState){this._onOpenTs=Date.now();var t=e.id;this._socketID=t;var n=Xt(this._startTs,!1);Ge.l("".concat(this._n,"._onOpen cost:").concat(n," ms. socketID:").concat(t)),new ar("wsOnOpen").setMessage(n).setCostTime(n).setMoreMessage("socketID:".concat(t)).end(),e.id===this._socketID&&(this._readyState=Ko,this._reConnectCount=0,this._resend(),!0===this._reConnectFlag&&(this._channelModule.onReconnected(),this._reConnectFlag=!1),this._channelModule.onOpen())}}},{key:"onClose",value:function(e){var t=new ar("wsOnClose"),n=e.id,r=e.e,o="sourceSocketID:".concat(n," currentSocketID:").concat(this._socketID," code:").concat(r.code," reason:").concat(r.reason),i=0;0!==this._onOpenTs&&(i=Date.now()-this._onOpenTs),t.setMessage(i).setCostTime(i).setMoreMessage(o).setCode(r.code).end(),Ge.l("".concat(this._n,"._onClose ").concat(o," onlineTime:").concat(i)),n===this._socketID&&(this._readyState=Yo,i<1e3?this._channelModule.onReconnectFailed():this._channelModule.onClose())}},{key:"onError",value:function(e){var t=e.id,n=e.e,r="sourceSocketID:".concat(t," currentSocketID:").concat(this._socketID);new ar("wsOnError").setMessage(n.errMsg||ht(n)).setMoreMessage(r).setLevel("error").end(),Ge.w("".concat(this._n,"._onError"),n,r),t===this._socketID&&(this._readyState="",this._channelModule.onError())}},{key:"onMessage",value:function(e){var t;try{t=JSON.parse(e.data)}catch(p){new ar("jsonParseError").setMessage(e.data).end()}if(t&&t.head){var n=this._getRequestIDFromHead(t.head),r=t.body;if(!this._channelModule.getModule(30).isTRTCCommand(n)){var o=Gt(t.head);r=function e(t,n){if(it(t))return t.map((function(t){return rt(t)?e(t,n):t}));if(rt(t)){var r=(o=t,i=function(e,t){return at(n[t])?Uo(t):n[t]},a={},Object.keys(o).forEach((function(e){a[i(o[e],e)]=o[e]})),a);return Ot(r,(function(t){return it(t)||rt(t)?e(t,n):t}))}var o,i,a}(t.body,this._getResponseKeyMap(o))}if(Ge.d("".concat(this._n,".onMessage ret:").concat(JSON.stringify(r)," requestID:").concat(n," has:").concat(this._promiseMap.has(n))),this._setNextPingTs(),this._promiseMap.has(n)){var i=this._promiseMap.get(n),a=i.resolve,s=i.reject,u=i.timestamp;return this._promiseMap.delete(n),this._calcRTT(u),void(r.errorCode&&0!==r.errorCode?(this._channelModule.onErrorCodeNotZero(r),s(new Fn({code:r.errorCode,message:r.errorInfo||"",data:n.includes(Kn.MODIFY_C2C_MESSAGE)||n.includes(Kn.MODIFY_GROUP_MESSAGE)?{elements:r.elements,messageVersion:r.messageVersion,cloudCustomData:r.cloudCustomData}:void 0}))):a(xn(r)))}this._channelModule.onMessage({head:t.head,body:r})}}},{key:"_calcRTT",value:function(e){var t=Date.now()-e;this._channelModule.getModule(26).addRTT(t)}},{key:"_connect",value:function(){this._startTs=Date.now(),this._onOpenTs=0,this._socket=new Bo(this),this._socketID=this._socket.getID(),this._readyState=Wo,Ge.l("".concat(this._n,"._connect isWorkerEnabled:").concat(this.getIsWorkerEnabled()," socketID:").concat(this._socketID," url:").concat(this.getURL())),new ar("wsConnect").setMessage("socketID:".concat(this._socketID," url:").concat(this.getURL())).end()}},{key:"getURL",value:function(){this._channelModule.isDevMode()&&(this._canIUseBinaryFrame=!1);var e=wt();(Y||B&&"windows"===e||J)&&(this._canIUseBinaryFrame=!1);var t=-1;"ios"===e?t=le||-1:"android"===e&&(t=fe||-1);var n=this._channelModule.getModule(12),r=this._channelModule.getPlatform(),o=n.getSDKAppID(),i=n.getInstanceID(),a="sdkappid=".concat(o,"&instanceid=").concat(i,"&random=").concat(this._getRandom(),"&platform=").concat(r,"&host=").concat(e,"&version=").concat(t,"&sdkversion=").concat("3.2.3");return j&&(a+="&isminigame=1"),this._canIUseBinaryFrame?"".concat(this._url,"/binfo?").concat(a):"".concat(this._url,"/info?").concat(a)}},{key:"_closeConnection",value:function(e){Ge.l("".concat(this._n,"._closeConnection socketID:").concat(this._socketID)),this._socket&&(this._socket.close(e),this._socketID=-1,this._socket=null,this._readyState=Yo)}},{key:"_resend",value:function(){var e=this;if(Ge.l("".concat(this._n,"._resend reConnectFlag:").concat(this._reConnectFlag),"promiseMap.size:".concat(this._promiseMap.size," simpleRequestMap.size:").concat(this._simpleRequestMap.size)),this._promiseMap.size>0&&this._promiseMap.forEach((function(t,n){var r=t.uplinkData,o=t.resolve,i=t.reject;e._promiseMap.set(n,{resolve:o,reject:i,timestamp:Date.now(),uplinkData:r}),e._execute(n,r)})),this._simpleRequestMap.size>0){var t,n=D(this._simpleRequestMap);try{for(n.s();!(t=n.n()).done;){var r=M(t.value,2),o=r[0],i=r[1];this._execute(o,i)}}catch(l){n.e(l)}finally{n.f()}this._simpleRequestMap.clear()}}},{key:"send",value:function(e){var t=this;e.head.seq=this._getSequence(),e.head.reqtime=Math.floor(Date.now()/1e3),e.keyMap;var n=_(e,jo),r=this._getRequestIDFromHead(e.head),o=JSON.stringify(n);return new Promise((function(e,i){t._promiseMap.set(r,{resolve:e,reject:i,timestamp:Date.now(),uplinkData:o}),Ge.d("".concat(t._n,".send uplinkData:").concat(JSON.stringify(n)," requestID:").concat(r," readyState:").concat(t._readyState)),t._readyState!==Ko?t._reConnect():(t._execute(r,o),t._channelModule.getModule(26).addRequestCount())}))}},{key:"simplySend",value:function(e){e.head.seq=this._getSequence(),e.head.reqtime=Math.floor(Date.now()/1e3),e.keyMap;var t=_(e,Ho),n=this._getRequestIDFromHead(e.head),r=JSON.stringify(t);this._readyState!==Ko?(this._simpleRequestMap.size<this.MAX_SIZE?this._simpleRequestMap.set(n,r):Ge.l("".concat(this._n,".simplySend. simpleRequestMap is full, drop request!")),this._reConnect()):this._execute(n,r)}},{key:"_execute",value:function(e,t){this._socket.send({data:t,fail:$?this._onSendFail.bind(this):void 0,requestID:e})}},{key:"_onSendFail",value:function(e){Ge.l("".concat(this._n,"._onSendFail requestID:").concat(e))}},{key:"_getSequence",value:function(){var e;if(this._startSequence<2415919103)return e=this._startSequence,this._startSequence+=1,2415919103===this._startSequence&&(this._startSequence=vt()),e}},{key:"_getRequestIDFromHead",value:function(e){return e.servcmd+e.seq}},{key:"_getResponseKeyMap",value:function(e){var n=this._channelModule.getKeyMap(e);return t(t({},Po.response),n.response)}},{key:"_reConnect",value:function(){this._readyState!==Ko&&this._readyState!==Wo&&this.forcedReconnect()}},{key:"forcedReconnect",value:function(){var e=this,t="".concat(this._n,".forcedReconnect");Ge.l("".concat(t," count:").concat(this._reConnectCount," readyState:").concat(this._readyState)),this._reConnectFlag=!0,this._resetRandom(),this._reConnectCount<this.MAX_RECONNECT_COUNT?(this._reConnectCount+=1,this._closeConnection(4001),this._initConnection()):(this._reConnectCount=0,this._channelModule.probeNetwork().then((function(n){var r=M(n,2),o=r[0];r[1],o?(Ge.w("".concat(t," disconnected from wsserver but network is ok, continue...")),e._closeConnection(4001),e._initConnection()):e._channelModule.onReconnectFailed()})))}},{key:"getReconnectFlag",value:function(){return this._reConnectFlag}},{key:"_setNextPingTs",value:function(){this._nextPingTs=Date.now()+1e4}},{key:"getNextPingTs",value:function(){return this._nextPingTs}},{key:"isConnected",value:function(){return this._readyState===Ko}},{key:"canIUseBinaryFrame",value:function(){return this._canIUseBinaryFrame}},{key:"setIsWorkerEnabled",value:function(e){Ge.l("".concat(this._n,".setIsWorkerEnabled flag:").concat(e)),this._isWorkerEnabled=e}},{key:"getIsWorkerEnabled",value:function(){return this._isWorkerEnabled&&Te}},{key:"_getRandom",value:function(){return 0===this._random&&(this._random=Math.random()),this._random}},{key:"_resetRandom",value:function(){this._random=0}},{key:"close",value:function(){Ge.l("".concat(this._n,".close")),this._closeConnection(4e3),this._promiseMap.clear(),this._startSequence=vt(),this._readyState=Yo,this._simpleRequestMap.clear(),this._reConnectFlag=!1,this._reConnectCount=0,this._onOpenTs=0,this._url="",this._random=0,this._canIUseBinaryFrame=!0,this._isWorkerEnabled=!0}}]),e}(),Jo=function(e){d(n,e);var t=I(n);function n(e){var r;if(a(this,n),(r=t.call(this,e))._n="ChannelModule",r._socketHandler=new zo(m(r)),r._probing=!1,r._isAppShowing=!0,r._previousState=O.NET_STATE_CONNECTED,$&&"function"==typeof Q.onAppShow&&"function"==typeof Q.onAppHide){var o=r._onAppHide.bind(m(r)),i=r._onAppShow.bind(m(r));"function"==typeof Q.offAppHide&&Q.offAppHide(o),"function"==typeof Q.offAppShow&&Q.offAppShow(i),Q.onAppHide(o),Q.onAppShow(i)}return r._timerForNotLoggedIn=-1,r._timerForNotLoggedIn=setInterval(r.onCheckTimer.bind(m(r)),1e3),r._fatalErrorFlag=!1,r._disconnectedTS=0,r}return c(n,[{key:"onCheckTimer",value:function(e){this._socketHandler&&(this.isLoggedIn()?(this._timerForNotLoggedIn>0&&(clearInterval(this._timerForNotLoggedIn),this._timerForNotLoggedIn=-1),this._socketHandler.onCheckTimer(e)):this._socketHandler.onCheckTimer(1),this._checkNextPing())}},{key:"onErrorCodeNotZero",value:function(e){this.getModule(20).onErrorCodeNotZero(e)}},{key:"onMessage",value:function(e){this.getModule(20).onMessage(e)}},{key:"send",value:function(e){return this._socketHandler?this._previousState!==O.NET_STATE_CONNECTED&&e.head.servcmd.includes(Kn.SSO_STAT)?(this.reConnect(),this.getModule(12).getProxyServer()?Promise.resolve():this._sendLogViaHTTP(e)):this._socketHandler.send(e):Promise.reject()}},{key:"_sendLogViaHTTP",value:function(e){var t=F.HOST.CURRENT.STAT;return new Promise((function(n,r){var o="".concat(t,"/v4/imopenstat/tim_web_report_v2?sdkappid=").concat(e.head.sdkappid,"&reqtime=").concat(Date.now()),i=JSON.stringify(e.body),a="application/x-www-form-urlencoded;charset=UTF-8";if($)Q.request({url:o,data:i,method:"POST",timeout:3e3,header:{"content-type":a},success:function(){n()},fail:function(){r(new Fn({code:qn.NETWORK_ERROR}))}});else{var s=new XMLHttpRequest,u=setTimeout((function(){s.abort(),r(new Fn({code:qn.NETWORK_TIMEOUT}))}),3e3);s.onreadystatechange=function(){4===s.readyState&&(clearTimeout(u),200===s.status||304===s.status?n():r(new Fn({code:qn.NETWORK_ERROR})))},s.open("POST",o,!0),s.setRequestHeader("Content-type",a),s.send(i)}}))}},{key:"simplySend",value:function(e){return this._socketHandler?this._socketHandler.simplySend(e):Promise.reject()}},{key:"onOpen",value:function(){this._ping()}},{key:"onClose",value:function(){this._socketHandler&&this._socketHandler.getReconnectFlag()&&this._emitNetStateChangeEvent(O.NET_STATE_DISCONNECTED),this.reConnect()}},{key:"onError",value:function(){$&&!J&&this.outputWarning("DomainNameInMP"),this._emitNetStateChangeEvent(O.NET_STATE_DISCONNECTED)}},{key:"getKeyMap",value:function(e){return this.getModule(20).getKeyMap(e)}},{key:"_onAppHide",value:function(){this._isAppShowing=!1}},{key:"_onAppShow",value:function(){this._isAppShowing=!0}},{key:"onRequestTimeout",value:function(e){}},{key:"onReconnected",value:function(){Ge.l("".concat(this._n,".onReconnected cost:").concat(Xt(this._disconnectedTS,!0,!1))),this._m.restartTimer(),this.getModule(20).onReconnected(Xt(this._disconnectedTS,!1,!1)),this._disconnectedTS=0,this._emitNetStateChangeEvent(O.NET_STATE_CONNECTED)}},{key:"onReconnectFailed",value:function(){Ge.l("".concat(this._n,".onReconnectFailed")),this._emitNetStateChangeEvent(O.NET_STATE_DISCONNECTED)}},{key:"setIsWorkerEnabled",value:function(e){this._socketHandler&&this._socketHandler.setIsWorkerEnabled(!1)}},{key:"offline",value:function(){this._emitNetStateChangeEvent(O.NET_STATE_DISCONNECTED)}},{key:"reConnect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!1;this._socketHandler&&(t=this._socketHandler.getReconnectFlag());var n="forcedFlag:".concat(e," fatalErrorFlag:").concat(this._fatalErrorFlag," previousState:").concat(this._previousState," reconnectFlag:").concat(t);if(Ge.l("".concat(this._n,".reConnect ").concat(n)),!this._fatalErrorFlag&&this._socketHandler){if(!0===e)this._socketHandler.forcedReconnect();else{if(this._previousState===O.NET_STATE_CONNECTING&&t)return;this._socketHandler.forcedReconnect()}this._emitNetStateChangeEvent(O.NET_STATE_CONNECTING)}}},{key:"_emitNetStateChangeEvent",value:function(e){this._previousState!==e&&(Ge.l("".concat(this._n,"._emitNetStateChangeEvent from ").concat(this._previousState," to ").concat(e)),e===O.NET_STATE_DISCONNECTED&&0===this._disconnectedTS&&(this._disconnectedTS=Date.now()),this._previousState=e,this.emitOuterEvent(A.NET_STATE_CHANGE,{state:e}))}},{key:"_ping",value:function(){var e=this;if(!0!==this._probing){this._probing=!0;var t=this.getModule(20).getProtocolData({protocolName:Kn.PING});this.send(t).then((function(){e._probing=!1})).catch((function(t){if(Ge.w("".concat(e._n,"._ping failed. error:"),t),e._probing=!1,t&&60002===t.code)return new ar("error").setMessage("code:".concat(t.code," message:").concat(t.message)).setNetworkType(e.getModule(15).getNetworkType()).end(),e._fatalErrorFlag=!0,void e._emitNetStateChangeEvent(O.NET_STATE_DISCONNECTED);e.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];Ge.l("".concat(e._n,"._ping failed. probe network, isAppShowing:").concat(e._isAppShowing," online:").concat(r," networkType:").concat(o)),r?e.reConnect():e._emitNetStateChangeEvent(O.NET_STATE_DISCONNECTED)}))}))}}},{key:"_checkNextPing",value:function(){this._socketHandler&&this._socketHandler.isConnected()&&Date.now()>=this._socketHandler.getNextPingTs()&&this._ping()}},{key:"dealloc",value:function(){this._socketHandler&&(this._socketHandler.close(),this._socketHandler=null),this._timerForNotLoggedIn>-1&&clearInterval(this._timerForNotLoggedIn)}},{key:"onRestApiKickedOut",value:function(){this._socketHandler&&(this._socketHandler.close(),this.reConnect(!0))}},{key:"reset",value:function(){Ge.l("".concat(this._n,".reset")),this._previousState=O.NET_STATE_CONNECTED,this._probing=!1,this._fatalErrorFlag=!1,this._timerForNotLoggedIn=setInterval(this.onCheckTimer.bind(this),1e3),this._disconnectedTS=0}}]),n}(Hn),Xo=["a2","tinyid"],$o=["a2","tinyid"],Zo=function(){function e(t){a(this,e),this._n="ProtocolHandler",this._sessionModule=t,this._configMap=new Map,this._fillConfigMap()}return c(e,[{key:"_fillConfigMap",value:function(){this._configMap.clear();var e=this._sessionModule.genCommonHead(),n=this._sessionModule.genCosSpecifiedHead(),r=this._sessionModule.genSSOReportHead();this._configMap.set(Kn.LOGIN,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.IM_OPEN_STATUS,".").concat(Kn.LOGIN)}),body:{state:"Online",isWebUniapp:0,deviceBrand:0},keyMap:{request:{deviceBrand:"InstType"},response:{InstId:"instanceID",HelloInterval:"helloInterval"}}}}(e)),this._configMap.set(Kn.LOGOUT,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.IM_OPEN_STATUS,".").concat(Kn.LOGOUT)}),body:{type:0},keyMap:{request:{type:"wslogout_type"}}}}(e)),this._configMap.set(Kn.HELLO,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.IM_OPEN_STATUS,".").concat(Kn.HELLO)}),body:{isWebUniapp:0},keyMap:{response:{NewInstInfo:"newInstanceInfo"}}}}(e)),this._configMap.set(Kn.KICK_OTHER,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.STAT_SERVICE,".").concat(Kn.KICK_OTHER)}),body:{}}}(e)),this._configMap.set(Kn.COS_SIGN,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.IM_COS_SIGN,".").concat(Kn.COS_SIGN)}),body:{cmd:"open_im_cos_svc",subCmd:"get_cos_token",duration:300,version:2},keyMap:{request:{userSig:"usersig",subCmd:"sub_cmd",cmd:"cmd",duration:"duration",version:"version"},response:{expired_time:"expiredTime",bucket_name:"bucketName",session_token:"sessionToken",tmp_secret_id:"secretId",tmp_secret_key:"secretKey"}}}}(n)),this._configMap.set(Kn.COS_PRE_SIG,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.CUSTOM_UPLOAD,".").concat(Kn.COS_PRE_SIG)}),body:{fileType:void 0,fileName:void 0,uploadMethod:0,duration:900},keyMap:{request:{userSig:"usersig",fileType:"file_type",fileName:"file_name",uploadMethod:"upload_method"},response:{expired_time:"expiredTime",request_id:"requestId",head_url:"headUrl",upload_url:"uploadUrl",download_url:"downloadUrl",ci_url:"ciUrl",snapshot_url:"requestSnapshotUrl"}}}}(n)),this._configMap.set(Kn.SIMPLE_COS_PRE_SIG,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.CUSTOM_UPLOAD,".").concat(Kn.SIMPLE_COS_PRE_SIG)}),body:{uploadMethod:0,platform:2,SDKAppID:0,userID:"",conversationType:1,uploadConfig:[{fileID:1,fileType:1,fileName:""}]},keyMap:{request:{platform:"uint32_platform",SDKAppID:"uint32_sdkappid",userID:"str_user_id",uploadMethod:"uint32_upload_method",conversationType:"uint32_scene",uploadConfig:"rpt_upload_object",fileID:"uint32_file_id",fileType:"uint32_file_type",fileName:"str_file_name"},response:{str_final_ip:"uploadIP",rpt_pre_sig:"preSig",uint32_file_id:"fileID",uint32_exist_flag:"existFlag",str_download_url:"downloadUrl",str_upload_url:"uploadUrl",str_snapshot_url:"requestSnapshotUrl",str_file_key:"fileKey"}}}}(n)),this._configMap.set(Kn.GET_IMAGE_INFO,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.CUSTOM_UPLOAD,".").concat(Kn.GET_IMAGE_INFO)}),body:{imageUrl:""},keyMap:{request:{imageUrl:"str_image_url"},response:{rpt_msg_image_info:"imageInfoArray",uint32_image_type:"type",str_url:"url",uint32_width:"width",uint32_height:"height",str_image_format:"imageFormat"}}}}(n)),this._configMap.set(Kn.GET_IP,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.CUSTOM_UPLOAD,".").concat(Kn.GET_IP)}),body:{domainName:""},keyMap:{request:{domainName:"str_domain"},response:{str_final_ip:"ip"}}}}(n)),this._configMap.set(Kn.VIDEO_COVER,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.CUSTOM_UPLOAD,".").concat(Kn.VIDEO_COVER)}),body:{version:1,platform:void 0,coverName:void 0,requestSnapshotUrl:void 0},keyMap:{request:{version:"version",platform:"platform",coverName:"cover_name",requestSnapshotUrl:"snapshot_url"},response:{error_code:"errorCode",error_msg:"errorInfo",download_url:"snapshotUrl"}}}}(n)),this._configMap.set(Kn.FETCH_COMMERCIAL_CONFIG,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.IM_CONFIG_MANAGER,".").concat(Kn.FETCH_COMMERCIAL_CONFIG)}),body:{SDKAppID:0},keyMap:{request:{SDKAppID:"uint32_sdkappid"},response:{int32_error_code:"errorCode",str_error_message:"errorMessage",str_purchase_bits:"purchaseBits",uint32_expired_time:"expiredTime"}}}}(e)),this._configMap.set(Kn.PUSHED_COMMERCIAL_CONFIG,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.IM_CONFIG_MANAGER,".").concat(Kn.PUSHED_COMMERCIAL_CONFIG)}),body:{},keyMap:{response:{int32_error_code:"errorCode",str_error_message:"errorMessage",str_purchase_bits:"purchaseBits",uint32_expired_time:"expiredTime"}}}}(e)),this._configMap.set(Kn.FETCH_CLOUD_CONTROL_CONFIG,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.IM_CONFIG_MANAGER,".").concat(Kn.FETCH_CLOUD_CONTROL_CONFIG)}),body:{SDKAppID:0,version:0},keyMap:{request:{SDKAppID:"uint32_sdkappid",version:"uint64_version"},response:{int32_error_code:"errorCode",str_error_message:"errorMessage",str_json_config:"cloudControlConfig",uint32_expired_time:"expiredTime",uint32_sdkappid:"SDKAppID",uint64_version:"version"}}}}(e)),this._configMap.set(Kn.PUSHED_CLOUD_CONTROL_CONFIG,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.IM_CONFIG_MANAGER,".").concat(Kn.PUSHED_CLOUD_CONTROL_CONFIG)}),body:{},keyMap:{response:{int32_error_code:"errorCode",str_error_message:"errorMessage",str_json_config:"cloudControlConfig",uint32_expired_time:"expiredTime",uint32_sdkappid:"SDKAppID",uint64_version:"version"}}}}(e)),this._configMap.set(Kn.OVERLOAD_NOTIFY,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.OVERLOAD_PUSH,".").concat(Kn.OVERLOAD_NOTIFY)}),body:{},keyMap:{response:{OverLoadServCmd:"overloadCommand",DelaySecs:"waitingTime"}}}}(e)),this._configMap.set(Kn.SYNC_UNREAD_MESSAGE,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.OPEN_IM,".").concat(Kn.SYNC_UNREAD_MESSAGE)}),body:{cookie:"",syncFlag:0,needAbstract:1,isOnlineSync:0,needSignaling:1},keyMap:{request:{fromAccount:"From_Account",toAccount:"To_Account",from:"From_Account",to:"To_Account",time:"MsgTimeStamp",sequence:"MsgSeq",random:"MsgRandom",elements:"MsgBody"},response:{MsgList:"messageList",SyncFlag:"syncFlag",To_Account:"to",From_Account:"from",ClientSeq:"clientSequence",MsgSeq:"sequence",NoticeSeq:"noticeSequence",NotifySeq:"notifySequence",MsgRandom:"random",MsgTimeStamp:"time",MsgContent:"content",ToGroupId:"to",MsgKey:"messageKey",GroupTips:"groupTips",MsgBody:"elements",MsgType:"type",C2CRemainingUnreadCount:"C2CRemainingUnreadList",C2CPairUnreadCount:"C2CPairUnreadList"}}}}(e)),this._configMap.set(Kn.GET_PROFANITY_LIST,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.IM_MSG_AUDIT_MGR,".").concat(Kn.GET_PROFANITY_LIST)}),body:{version:0,deviceID:"",startIndex:void 0},keyMap:{request:{version:"uint64_version",deviceID:"str_device_id",startIndex:"uint64_start_index"},response:{msg_cmd_error_code:"errorInfo",str_err_msg:"errorMessage",uint32_code:"errorCode",msg_scene_ctl_config:"filterConfig",uint64_c2c_custom_msg_flag:"c2c_custom_message",uint64_c2c_text_msg_flag:"c2c_text_message",uint64_group_custom_msg_flag:"group_custom_message",uint64_group_text_msg_flag:"group_text_message",uint64_group_info_flag:"group_profile",uint64_group_member_info_flag:"group_member_profile",uint64_relation_chain_flag:"sns",uint64_user_info_flag:"user_profile",rpt_msg_dirty_word:"lexicon",str_dirty_word:"profanity",str_replaced_content:"replacement",uint64_filter_type:"filterType",uint64_id:"id",uint64_word_type:"profanityType",uint64_complete_flag:"completeFlag",uint64_next_start_index:"nextStartIndex",uint64_version:"version",uint64_expired_time:"expiredTime"}}}}(e)),this._configMap.set(Kn.SEND_C2C_MESSAGE,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.OPEN_IM,".").concat(Kn.SEND_C2C_MESSAGE)}),body:{fromAccount:"",toAccount:"",msgSeq:0,msgRandom:0,msgBody:[],cloudCustomData:void 0,nick:"",avatar:"",msgLifeTime:void 0,offlinePushInfo:{pushFlag:0,title:"",desc:"",ext:"",apnsInfo:{badgeMode:0,isVoipPush:void 0},androidInfo:{OPPOChannelID:""}},messageControlInfo:void 0,clientTime:void 0,needReadReceipt:0,isSupportExtension:0,isRelayMessage:0},keyMap:{request:{fromAccount:"From_Account",toAccount:"To_Account",msgTimeStamp:"MsgTimeStamp",msgSeq:"MsgSeq",msgRandom:"MsgRandom",msgBody:"MsgBody",count:"MaxCnt",lastMessageTime:"LastMsgTime",messageKey:"MsgKey",peerAccount:"Peer_Account",data:"Data",description:"Desc",extension:"Ext",type:"MsgType",content:"MsgContent",sizeType:"Type",uuid:"UUID",url:"",imageUrl:"URL",fileUrl:"Url",remoteAudioUrl:"Url",remoteVideoUrl:"VideoUrl",thumbUUID:"ThumbUUID",videoUUID:"VideoUUID",videoUrl:"",downloadFlag:"Download_Flag",nick:"From_AccountNick",avatar:"From_AccountHeadurl",from:"From_Account",time:"MsgTimeStamp",messageRandom:"MsgRandom",messageSequence:"MsgSeq",elements:"MsgBody",clientSequence:"ClientSeq",payload:"MsgContent",messageList:"MsgList",messageNumber:"MsgNum",abstractList:"AbstractList",messageBody:"MsgBody",needReadReceipt:"IsNeedReadReceipt"}}}}(e)),this._configMap.set(Kn.SEND_GROUP_MESSAGE,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.GROUP,".").concat(Kn.SEND_GROUP_MESSAGE)}),body:{fromAccount:"",groupID:"",random:0,clientSequence:0,priority:"",msgBody:[],cloudCustomData:void 0,onlineOnlyFlag:0,offlinePushInfo:{pushFlag:0,title:"",desc:"",ext:"",apnsInfo:{badgeMode:0,isVoipPush:void 0},androidInfo:{OPPOChannelID:""}},groupAtInfo:[],messageControlInfo:void 0,clientTime:void 0,needReadReceipt:0,topicID:void 0,receiverList:void 0,isSupportExtension:0,isRelayMessage:0},keyMap:{request:{to:"GroupId",extension:"Ext",data:"Data",description:"Desc",random:"Random",sequence:"ReqMsgSeq",count:"ReqMsgNumber",type:"MsgType",priority:"MsgPriority",content:"MsgContent",elements:"MsgBody",sizeType:"Type",uuid:"UUID",url:"",imageUrl:"URL",fileUrl:"Url",remoteAudioUrl:"Url",remoteVideoUrl:"VideoUrl",thumbUUID:"ThumbUUID",videoUUID:"VideoUUID",videoUrl:"",downloadFlag:"Download_Flag",clientSequence:"ClientSeq",from:"From_Account",time:"MsgTimeStamp",messageRandom:"MsgRandom",messageSequence:"MsgSeq",payload:"MsgContent",messageList:"MsgList",messageNumber:"MsgNum",abstractList:"AbstractList",messageBody:"MsgBody",needReadReceipt:"NeedReadReceipt",receiverList:"To_Account"},response:{MsgTime:"time",MsgSeq:"sequence"}}}}(e)),this._configMap.set(Kn.REVOKE_C2C_MESSAGE,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.OPEN_IM,".").concat(Kn.REVOKE_C2C_MESSAGE)}),body:{msgInfo:{fromAccount:"",toAccount:"",msgTimeStamp:0,msgSeq:0,msgRandom:0}},keyMap:{request:{msgInfo:"MsgInfo",msgTimeStamp:"MsgTimeStamp",msgSeq:"MsgSeq",msgRandom:"MsgRandom"}}}}(e)),this._configMap.set(Kn.REVOKE_GROUP_MESSAGE,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.GROUP,".").concat(Kn.REVOKE_GROUP_MESSAGE)}),body:{groupID:"",msgSeqList:void 0,topicID:""},keyMap:{request:{msgSeqList:"MsgSeqList",msgSeq:"MsgSeq"}}}}(e)),this._configMap.set(Kn.GET_C2C_ROAMING_MESSAGE,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.OPEN_IM,".").concat(Kn.GET_C2C_ROAMING_MESSAGE)}),body:{peerAccount:"",count:15,lastMessageTime:0,messageKey:"",withRecalledMessage:1,direction:0},keyMap:{request:{messageKey:"MsgKey",peerAccount:"Peer_Account",count:"MaxCnt",lastMessageTime:"LastMsgTime",withRecalledMessage:"WithRecalledMsg",direction:"GetDirection"},response:{LastMsgTime:"lastMessageTime",IsNeedReadReceipt:"needReadReceipt",IsPeerRead:"readReceiptSentByPeer"}}}}(e)),this._configMap.set(Kn.MODIFY_C2C_MESSAGE,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.OPEN_IM,".").concat(Kn.MODIFY_C2C_MESSAGE)}),body:{from:"",to:"",sequence:0,random:0,time:0,version:0,elements:void 0,cloudCustomData:void 0},keyMap:{request:{sequence:"MsgSeq",random:"MsgRandom",time:"MsgTime",version:"MsgVersion",type:"MsgType",content:"MsgContent"}}}}(e)),this._configMap.set(Kn.GET_GROUP_ROAMING_MESSAGE,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.GROUP,".").concat(Kn.GET_GROUP_ROAMING_MESSAGE)}),body:{withRecalledMsg:1,groupID:"",count:15,sequence:"",topicID:void 0},keyMap:{request:{sequence:"ReqMsgSeq",count:"ReqMsgNumber",withRecalledMessage:"WithRecalledMsg"},response:{Random:"random",MsgTime:"time",MsgSeq:"sequence",ReqMsgSeq:"sequence",RspMsgList:"messageList",IsSystemMsg:"isSystemMessage",ToGroupId:"to",EnumFrom_AccountType:"fromAccountType",EnumTo_AccountType:"toAccountType",GroupCode:"groupCode",MsgPriority:"priority",MsgBody:"elements",MsgType:"type",MsgContent:"content",IsFinished:"complete",Download_Flag:"downloadFlag",ClientSeq:"clientSequence",ThumbUUID:"thumbUUID",VideoUUID:"videoUUID",ToTopicId:"topicID",InvisibleMsgSeq:"invisibleSequenceList",NextReqMsgSeq:"nextSequence"}}}}(e)),this._configMap.set(Kn.SET_C2C_MESSAGE_READ,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.OPEN_IM,".").concat(Kn.SET_C2C_MESSAGE_READ)}),body:{C2CMsgReaded:void 0},keyMap:{request:{lastMessageTime:"LastedMsgTime"}}}}(e)),this._configMap.set(Kn.SET_C2C_PEER_MUTE_NOTIFICATIONS,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.OPEN_IM,".").concat(Kn.SET_C2C_PEER_MUTE_NOTIFICATIONS)}),body:{userIDList:void 0,muteFlag:0},keyMap:{request:{userIDList:"Peer_Account",muteFlag:"Mute_Notifications"}}}}(e)),this._configMap.set(Kn.GET_C2C_PEER_MUTE_NOTIFICATIONS,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.OPEN_IM,".").concat(Kn.GET_C2C_PEER_MUTE_NOTIFICATIONS)}),body:{toAccount:void 0,userIDList:void 0},keyMap:{request:{userIDList:"Peer_Account"},response:{MuteNotificationsList:"muteFlagList"}}}}(e)),this._configMap.set(Kn.SET_GROUP_MESSAGE_READ,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.GROUP,".").concat(Kn.SET_GROUP_MESSAGE_READ)}),body:{groupID:void 0,messageReadSeq:void 0,topicID:void 0},keyMap:{request:{messageReadSeq:"MsgReadedSeq"}}}}(e)),this._configMap.set(Kn.SET_ALL_MESSAGE_READ,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.OPEN_IM,".").concat(Kn.SET_ALL_MESSAGE_READ)}),body:{readAllC2CMessage:0,groupMessageReadInfoList:[]},keyMap:{request:{readAllC2CMessage:"C2CReadAllMsg",groupMessageReadInfoList:"GroupReadInfo",messageSequence:"MsgSeq"},response:{C2CReadAllMsg:"readAllC2CMessage",GroupReadInfoArray:"groupMessageReadInfoList"}}}}(e)),this._configMap.set(Kn.DELETE_C2C_MESSAGE,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.OPEN_IM,".").concat(Kn.DELETE_C2C_MESSAGE)}),body:{fromAccount:"",to:"",keyList:void 0},keyMap:{request:{keyList:"MsgKeyList"}}}}(e)),this._configMap.set(Kn.DELETE_GROUP_MESSAGE,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.GROUP,".").concat(Kn.DELETE_GROUP_MESSAGE)}),body:{groupID:"",deleter:"",keyList:void 0,topicID:void 0},keyMap:{request:{deleter:"Deleter_Account",keyList:"Seqs"}}}}(e)),this._configMap.set(Kn.TRANSLATE_TEXT,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.IM_OPEN_TRANSLATE,".").concat(Kn.TRANSLATE_TEXT)}),body:{sourceTextList:void 0,SDKAppID:0,from:0,source:"",target:""},keyMap:{request:{sourceTextList:"SourceText",SDKAppID:"SdkAppId",from:"FromAccount"},response:{TargetText:"translatedTextList",RequestId:"requestID",CmdErrorCode:"error",ErrorCode:"code",ErrorInfo:"message"}}}}(e)),this._configMap.set(Kn.VOICE_TO_TEXT,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.IM_OPEN_SPEECH,".").concat(Kn.VOICE_TO_TEXT)}),body:{url:"",SDKAppID:0,format:"",sourceType:0,language:""},keyMap:{request:{url:"BytesUrl",SDKAppID:"Uint32Sdkappid",format:"BytesVoiceFormat",sourceType:"Uint64SourceType",language:"BytesEngServiceType"},response:{BytesRequestid:"requestID",BytesResult:"result",CmdErrorCode:"error",ErrorCode:"code",ErrorInfo:"message"}}}}(e)),this._configMap.set(Kn.MODIFY_GROUP_MESSAGE,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.OPEN_IM,".").concat(Kn.MODIFY_GROUP_MESSAGE)}),body:{groupID:"",topicID:void 0,sequence:0,version:0,elements:void 0,cloudCustomData:void 0},keyMap:{request:{sequence:"MsgSeq",version:"MsgVersion",type:"MsgType",content:"MsgContent"}}}}(e)),this._configMap.set(Kn.GET_READ_RECEIPT,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.GROUP,".").concat(Kn.GET_READ_RECEIPT)}),body:{groupID:"",sequenceList:void 0},keyMap:{request:{sequence:"MsgSeq"}}}}(e)),this._configMap.set(Kn.SEND_C2C_READ_RECEIPT,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.OPEN_IM,".").concat(Kn.SEND_C2C_READ_RECEIPT)}),body:{peerAccount:"",messageInfoList:void 0},keyMap:{request:{peerAccount:"Peer_Account",messageInfoList:"C2CMsgInfo",fromAccount:"From_Account",toAccount:"To_Account",sequence:"MsgSeq",random:"MsgRandom",time:"MsgTime",clientTime:"MsgClientTime"}}}}(e)),this._configMap.set(Kn.SEND_READ_RECEIPT,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.GROUP,".").concat(Kn.SEND_READ_RECEIPT)}),body:{groupID:"",sequenceList:void 0},keyMap:{request:{sequenceList:"MsgSeqList",sequence:"MsgSeq"}}}}(e)),this._configMap.set(Kn.GET_READ_RECEIPT_DETAIL,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.GROUP,".").concat(Kn.GET_READ_RECEIPT_DETAIL)}),body:{groupID:"",sequence:void 0,flag:0,cursor:0,count:0},keyMap:{request:{sequence:"MsgSeq",count:"Num"},response:{ReadList:"readUserIDList",Read_Account:"userID",UnreadList:"unreadUserIDList",Unread_Account:"userID",IsFinish:"isCompleted"}}}}(e)),this._configMap.set(Kn.MODIFY_C2C_MESSAGE_EXTENSIONS,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.OPEN_IM_MSG_EXT,".").concat(Kn.MODIFY_C2C_MESSAGE_EXTENSIONS)}),body:{from:void 0,to:void 0,messageKey:void 0,operateType:void 0,extensionList:void 0}}}(e)),this._configMap.set(Kn.GET_C2C_MESSAGE_EXTENSIONS,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.OPEN_IM_MSG_EXT,".").concat(Kn.GET_C2C_MESSAGE_EXTENSIONS)}),body:{from:void 0,to:void 0,messageKey:void 0,startSequence:void 0}}}(e)),this._configMap.set(Kn.MODIFY_GROUP_MESSAGE_EXTENSIONS,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.OPEN_IM_MSG_EXT,".").concat(Kn.MODIFY_GROUP_MESSAGE_EXTENSIONS)}),body:{groupID:void 0,topicID:void 0,messageSequence:void 0,operateType:void 0,extensionList:void 0}}}(e)),this._configMap.set(Kn.GET_GROUP_MESSAGE_EXTENSIONS,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.OPEN_IM_MSG_EXT,".").concat(Kn.GET_GROUP_MESSAGE_EXTENSIONS)}),body:{groupID:void 0,topicID:void 0,messageSequence:void 0,startSequence:void 0}}}(e)),this._configMap.set(Kn.MESSAGE_CLOUD_SEARCH,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.MESSAGE_SEARCH,".").concat(Kn.MESSAGE_CLOUD_SEARCH)}),body:{keywordList:void 0,keywordListMatchType:"or",account:void 0,groupID:void 0,count:100,cursor:void 0,messageTypeList:void 0,senderUserIDList:void 0,startTime:void 0,endTime:void 0},keyMap:{request:{keywordListMatchType:"MatchType",account:"PeerAccount",groupID:"GroupID",messageTypeList:"MsgTypeList",senderUserIDList:"SendUserIDList"},response:{GroupID:"groupID",UserID:"userID",Count:"messageCount",LastMsgTime:"lastMessageTime",ConversationMsgs:"searchResult",IsNeedReadReceipt:"needReadReceipt",IsPeerRead:"readReceiptSentByPeer",MsgSeq:"sequence",ReqMsgSeq:"sequence",IsSystemMsg:"isSystemMessage",ToGroupId:"to",EnumFrom_AccountType:"fromAccountType",EnumTo_AccountType:"toAccountType",GroupCode:"groupCode",MsgContent:"content",ClientSeq:"clientSequence",ToTopicId:"topicID",InvisibleMsgSeq:"invisibleSequenceList",ErrorCode:"code",ErrorInfo:"message"}}}}(e)),this._configMap.set(Kn.ADD_C2C_MSG_REACTION,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.OPEN_IM_MSG_EXT,".").concat(Kn.ADD_C2C_MSG_REACTION)}),body:{from:void 0,to:void 0,reactionID:void 0,messageKey:void 0,userIDList:void 0},keyMap:{request:{userIDList:"Add_Account"}}}}(e)),this._configMap.set(Kn.REMOVE_C2C_MSG_REACTION,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.OPEN_IM_MSG_EXT,".").concat(Kn.REMOVE_C2C_MSG_REACTION)}),body:{from:void 0,to:void 0,reactionID:void 0,messageKey:void 0,userIDList:void 0},keyMap:{request:{userIDList:"Del_Account"}}}}(e)),this._configMap.set(Kn.GET_C2C_MSG_REACTIONS,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.OPEN_IM_MSG_EXT,".").concat(Kn.GET_C2C_MSG_REACTIONS)}),body:{from:void 0,to:void 0,messageKeyList:void 0,count:void 0}}}(e)),this._configMap.set(Kn.GET_C2C_MSG_REACTION_USER_LIST,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.OPEN_IM_MSG_EXT,".").concat(Kn.GET_C2C_MSG_REACTION_USER_LIST)}),body:{from:void 0,to:void 0,reactionID:void 0,messageKey:void 0,count:void 0}}}(e)),this._configMap.set(Kn.ADD_GRP_MSG_REACTION,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.OPEN_IM_MSG_EXT,".").concat(Kn.ADD_GRP_MSG_REACTION)}),body:{groupID:void 0,topicID:void 0,reactionID:void 0,messageSequence:void 0,userIDList:void 0},keyMap:{request:{userIDList:"Add_Account"}}}}(e)),this._configMap.set(Kn.REMOVE_GRP_MSG_REACTION,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.OPEN_IM_MSG_EXT,".").concat(Kn.REMOVE_GRP_MSG_REACTION)}),body:{groupID:void 0,topicID:void 0,reactionID:void 0,messageSequence:void 0,userIDList:void 0},keyMap:{request:{userIDList:"Del_Account"}}}}(e)),this._configMap.set(Kn.GET_GRP_MSG_REACTIONS,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.OPEN_IM_MSG_EXT,".").concat(Kn.GET_GRP_MSG_REACTIONS)}),body:{groupID:void 0,topicID:void 0,messageSequenceList:void 0,count:void 0},keyMap:{response:{MsgSeq:"messageSequence"}}}}(e)),this._configMap.set(Kn.GET_GRP_MSG_REACTION_USER_LIST,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.OPEN_IM_MSG_EXT,".").concat(Kn.GET_GRP_MSG_REACTION_USER_LIST)}),body:{groupID:void 0,topicID:void 0,reactionID:void 0,messageSequence:void 0,nextSeq:void 0,count:void 0}}}(e)),this._configMap.set(Kn.GET_C2C_PEER_READ_TIME,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.OPEN_IM,".").concat(Kn.GET_C2C_PEER_READ_TIME)}),body:{userIDList:void 0},keyMap:{request:{userIDList:"To_Account"},response:{ReadTime:"peerReadTimeList"}}}}(e)),this._configMap.set(Kn.PAGING_GET_CONVERSATION_LIST,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.RECENT_CONTACT,".").concat(Kn.PAGING_GET_CONVERSATION_LIST)}),body:{fromAccount:void 0,timeStamp:void 0,startIndex:void 0,pinnedTimeStamp:void 0,pinnedStartIndex:void 0,orderType:void 0,messageAssistFlag:15,assistFlag:31},keyMap:{request:{messageAssistFlag:"MsgAssistFlags",assistFlag:"AssistFlags",pinnedTimeStamp:"TopTimeStamp",pinnedStartIndex:"TopStartIndex"},response:{SessionItem:"conversations",ToAccount:"groupID",To_Account:"userID",UnreadMsgCount:"unreadCount",MsgGroupReadedSeq:"messageReadSeq",C2cPeerReadTime:"c2cPeerReadTime",LastMsgFlags:"lastMessageFlag",TopFlags:"isPinned",TopTimeStamp:"pinnedTimeStamp",TopStartIndex:"pinnedStartIndex",GroupId:"convGroupID",C2cRemark:"friendRemark",MsgRecvOption:"messageRemindType",GroupIgnoredUnreadSeqCount:"noUnreadCount",GroupNextMsgSeq:"nextMessageSeq"}}}}(e)),this._configMap.set(Kn.DELETE_CONVERSATION,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.RECENT_CONTACT,".").concat(Kn.DELETE_CONVERSATION)}),body:{fromAccount:"",conversationList:void 0,clearHistoryMessage:void 0},keyMap:{request:{toGroupID:"ToGroupid",clearHistoryMessage:"ClearRamble",conversationList:"ContactItem"},response:{ResultItem:"resultList",ToGroupid:"groupID",ResultCode:"code",ResultInfo:"info"}}}}(e)),this._configMap.set(Kn.CLEAR_HISTORY_MESSAGE,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.RECENT_CONTACT,".").concat(Kn.CLEAR_HISTORY_MESSAGE)}),body:{fromAccount:"",toAccount:void 0,type:1,toGroupID:void 0},keyMap:{request:{toGroupID:"ToGroupid"}}}}(e)),this._configMap.set(Kn.PIN_CONVERSATION,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.RECENT_CONTACT,".").concat(Kn.PIN_CONVERSATION)}),body:{fromAccount:"",operationType:1,itemList:void 0},keyMap:{request:{itemList:"RecentContactItem"}}}}(e)),this._configMap.set(Kn.DELETE_GROUP_AT_TIPS,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.OPEN_IM,".").concat(Kn.DELETE_GROUP_AT_TIPS)}),body:{messageListToDelete:void 0},keyMap:{request:{messageListToDelete:"DelMsgList",messageSeq:"MsgSeq",messageRandom:"MsgRandom"}}}}(e)),this._configMap.set(Kn.SET_CONVERSATION_CUSTOM_DATA,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.RECENT_CONTACT,".").concat(Kn.MARK_CONVERSATION)}),body:{fromAccount:"",itemList:void 0},keyMap:{request:{itemList:"MarkItem",operationType:"OptType",groupID:"ToGroupId"},response:{ToGroupId:"groupID",OptType:"operationType"}}}}(e)),this._configMap.set(Kn.MARK_CONVERSATION,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.RECENT_CONTACT,".").concat(Kn.MARK_CONVERSATION)}),body:{fromAccount:"",itemList:void 0},keyMap:{request:{itemList:"MarkItem",operationType:"OptType",groupID:"ToGroupId"},response:{ToGroupId:"groupID",OptType:"operationType"}}}}(e)),this._configMap.set(Kn.CREATE_CONVERSATION_GROUP,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.RECENT_CONTACT,".").concat(Kn.RENAME_CONVERSATION_GROUP)}),body:{fromAccount:"",itemList:void 0},keyMap:{request:{itemList:"GroupContactItem",groupID:"ToGroupId"},response:{GroupId:"convGroupID",ToGroupId:"groupID",OptType:"operationType"}}}}(e)),this._configMap.set(Kn.DELETE_CONVERSATION_GROUP,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.RECENT_CONTACT,".").concat(Kn.DELETE_CONVERSATION_GROUP)}),body:{fromAccount:"",groupName:void 0},keyMap:{request:{},response:{GroupId:"convGroupID"}}}}(e)),this._configMap.set(Kn.RENAME_CONVERSATION_GROUP,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.RECENT_CONTACT,".").concat(Kn.RENAME_CONVERSATION_GROUP)}),body:{fromAccount:"",updateType:void 0,updateGroup:void 0},keyMap:{request:{oldName:"OldGroupName",newName:"NewGroupName",groupID:"ToGroupId",operationType:"ContactOptType",groupName:"OldGroupName",updateItem:"ContactUpdateItem"},response:{ContactOptType:"operationType",ToGroupId:"groupID",GroupId:"convGroupID"}}}}(e)),this._configMap.set(Kn.ADD_CONVERSATIONS_TO_GROUP,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.RECENT_CONTACT,".").concat(Kn.RENAME_CONVERSATION_GROUP)}),body:{fromAccount:"",updateType:void 0,updateGroup:{groupName:void 0,updateGroupType:void 0,updateItem:void 0}},keyMap:{request:{},response:{}}}}(e)),this._configMap.set(Kn.DELETE_CONVERSATIONS_FROM_GROUP,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.RECENT_CONTACT,".").concat(Kn.RENAME_CONVERSATION_GROUP)}),body:{fromAccount:"",updateType:void 0,updateGroup:void 0},keyMap:{request:{},response:{}}}}(e)),this._configMap.set(Kn.GET_CONVERSATION_GROUP_LIST,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.RECENT_CONTACT,".").concat(Kn.GET_CONVERSATION_GROUP_LIST)}),body:{fromAccount:"",startTime:void 0,startIndex:void 0},keyMap:{request:{},response:{GroupId:"convGroupID",ToGroupId:"groupID",OptType:"operationType",CustomMark:"customData",ContactGroupId:"convGroupIDList"}}}}(e)),this._configMap.set(Kn.GET_USER_PROFILE,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.PROFILE,".").concat(Kn.GET_USER_PROFILE)}),body:{fromAccount:"",userItem:[]},keyMap:{request:{toAccount:"To_Account",standardSequence:"StandardSequence",customSequence:"CustomSequence"}}}}(e)),this._configMap.set(Kn.UPDATE_MY_PROFILE,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.PROFILE,".").concat(Kn.UPDATE_MY_PROFILE)}),body:{fromAccount:"",profileItem:[{tag:Fe.NICK,value:""},{tag:Fe.GENDER,value:""},{tag:Fe.ALLOWTYPE,value:""},{tag:Fe.AVATAR,value:""}]},keyMap:{request:{toAccount:"To_Account",standardSequence:"StandardSequence",customSequence:"CustomSequence"}}}}(e)),this._configMap.set(Kn.GET_BLACKLIST,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.FRIEND,".").concat(Kn.GET_BLACKLIST)}),body:{fromAccount:"",startIndex:0,maxLimited:30,lastSequence:0},keyMap:{response:{CurruentSequence:"currentSequence"}}}}(e)),this._configMap.set(Kn.ADD_TO_BLACKLIST,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.FRIEND,".").concat(Kn.ADD_TO_BLACKLIST)}),body:{fromAccount:"",toAccount:[]}}}(e)),this._configMap.set(Kn.REMOVE_FROM_BLACKLIST,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.FRIEND,".").concat(Kn.REMOVE_FROM_BLACKLIST)}),body:{fromAccount:"",toAccount:[]}}}(e)),this._configMap.set(Kn.SET_SELF_STATUS,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.IM_OPEN_STATUS,".").concat(Kn.SET_SELF_STATUS)}),body:{customStatus:""},keyMap:{}}}(e)),this._configMap.set(Kn.GET_USER_STATUS,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.IM_OPEN_STATUS,".").concat(Kn.GET_USER_STATUS)}),body:{userIDList:void 0},keyMap:{response:{UserStatusList:"successUserList",ErrorList:"failureUserList",To_Account:"userID",Invalid_Account:"invalidUserID",Status:"statusType"}}}}(e)),this._configMap.set(Kn.SUBSCRIBE_USER_STATUS,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.IM_OPEN_STATUS,".").concat(Kn.SUBSCRIBE_USER_STATUS)}),body:{userIDList:void 0},keyMap:{response:{ErrorList:"failureUserList",To_Account:"userID",Invalid_Account:"invalidUserID"}}}}(e)),this._configMap.set(Kn.UNSUBSCRIBE_USER_STATUS,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.IM_OPEN_STATUS,".").concat(Kn.UNSUBSCRIBE_USER_STATUS)}),body:{userIDList:void 0,unsubscribeAll:void 0},keyMap:{response:{ErrorList:"failureUserList",To_Account:"userID",Invalid_Account:"invalidUserID"}}}}(e)),this._configMap.set(Kn.GET_FRIEND_LIST,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.FRIEND,".").concat(Kn.GET_FRIEND_LIST)}),body:{fromAccount:"",startIndex:0,standardSequence:0,customSequence:0},keyMap:{response:{FriendNum:"friendCount",UserDataItem:"resultList",ValueItem:"tagValueList"}}}}(e)),this._configMap.set(Kn.ADD_FRIEND,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.FRIEND,".").concat(Kn.ADD_FRIEND)}),body:{fromAccount:"",addFriendItem:[],type:""},keyMap:{request:{source:"AddSource",wording:"AddWording",type:"AddType"},response:{ResultItem:"resultList"}}}}(e)),this._configMap.set(Kn.UPDATE_FRIEND,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.FRIEND,".").concat(Kn.UPDATE_FRIEND)}),body:{fromAccount:"",updateItem:void 0},keyMap:{request:{snsItem:"SnsItem"},response:{ResultItem:"resultList"}}}}(e)),this._configMap.set(Kn.DELETE_FRIEND,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.FRIEND,".").concat(Kn.DELETE_FRIEND)}),body:{fromAccount:"",userIDList:[],type:""},keyMap:{request:{type:"DeleteType"},response:{ResultItem:"resultList"}}}}(e)),this._configMap.set(Kn.GET_FRIEND_PROFILE,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.FRIEND,".").concat(Kn.GET_FRIEND_PROFILE)}),body:{fromAccount:"",userIDList:void 0},keyMap:{response:{InfoItem:"resultList",SnsProfileItem:"tagValueList"}}}}(e)),this._configMap.set(Kn.CHECK_FRIEND,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.FRIEND,".").concat(Kn.CHECK_FRIEND)}),body:{fromAccount:"",userIDList:[],type:""},keyMap:{request:{type:"CheckType"},response:{InfoItem:"resultList"}}}}(e)),this._configMap.set(Kn.GET_FRIEND_APPLICATION_LIST,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.FRIEND,".").concat(Kn.GET_FRIEND_APPLICATION_LIST)}),body:{fromAccount:"",applicationType:"",startTime:0,maxLimited:0,lastSequence:0},keyMap:{response:{PendencyItem:"resultList",AddSource:"source",AddTime:"time",AddWording:"wording",Image:"avatar",UnreadPendencyCount:"unreadCount",To_Account:"userID",PendencyType:"type"}}}}(e)),this._configMap.set(Kn.RESPOND_FRIEND_APPLICATION,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.FRIEND,".").concat(Kn.RESPOND_FRIEND_APPLICATION)}),body:{fromAccount:"",responseFriendItem:[]},keyMap:{request:{tag:"TagName",action:"ResponseAction"},response:{ResultItem:"resultList"}}}}(e)),this._configMap.set(Kn.DELETE_FRIEND_APPLICATION,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.FRIEND,".").concat(Kn.DELETE_FRIEND_APPLICATION)}),body:{fromAccount:"",type:"",userIDList:void 0},keyMap:{request:{type:"PendencyType",userIDList:"To_Account"},response:{ResultItem:"resultList"}}}}(e)),this._configMap.set(Kn.REPORT_FRIEND_APPLICATION,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.FRIEND,".").concat(Kn.REPORT_FRIEND_APPLICATION)}),body:{fromAccount:"",latestTimeStamp:""},keyMap:{request:{latestTimeStamp:"LatestPendencyTimeStamp"}}}}(e)),this._configMap.set(Kn.CREATE_FRIEND_GROUP,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.FRIEND,".").concat(Kn.CREATE_FRIEND_GROUP)}),body:{fromAccount:"",groupName:void 0,userIDList:void 0},keyMap:{request:{groupName:"GroupName",userIDList:"To_Account"},response:{ResultItem:"resultList"}}}}(e)),this._configMap.set(Kn.DELETE_FRIEND_GROUP,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.FRIEND,".").concat(Kn.DELETE_FRIEND_GROUP)}),body:{fromAccount:"",nameList:void 0},keyMap:{request:{nameList:"GroupName"}}}}(e)),this._configMap.set(Kn.GET_FRIEND_GROUP_LIST,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.FRIEND,".").concat(Kn.GET_FRIEND_GROUP_LIST)}),body:{fromAccount:"",lastSequence:0,needFriend:"Need_Friend_Type_Yes"},keyMap:{response:{ResultItem:"resultList",GroupName:"name",FriendNumber:"friendCount",To_Account:"userIDList"}}}}(e)),this._configMap.set(Kn.UPDATE_FRIEND_GROUP,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.FRIEND,".").concat(Kn.UPDATE_FRIEND_GROUP)}),body:{fromAccount:"",oldName:"",newName:void 0,updateGroupItem:void 0},keyMap:{request:{oldName:"GroupOldName",newName:"GroupNewName"},response:{UpdateType:"type",ResultItem:"resultList"}}}}(e)),this._configMap.set(Kn.GET_GROUP_LIST,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.GROUP,".").concat(Kn.GET_GROUP_LIST)}),body:{memberAccount:"",limit:void 0,offset:void 0,groupType:void 0,responseFilter:{groupBaseInfoFilter:void 0,selfInfoFilter:void 0},isSupportTopic:0},keyMap:{request:{memberAccount:"Member_Account"},response:{GroupIdList:"groups",NoUnreadSeqList:"excludedUnreadSequenceList",MsgSeq:"readedSequence",LastRecallTime:"_lastRevokedTime"}}}}(e)),this._configMap.set(Kn.GET_GROUP_PROFILE,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.GROUP,".").concat(Kn.GET_GROUP_PROFILE)}),body:{groupIDList:void 0,responseFilter:{groupBaseInfoFilter:void 0,groupCustomFieldFilter:void 0,memberInfoFilter:void 0,memberCustomFieldFilter:void 0}},keyMap:{request:{groupIDList:"GroupIdList",groupCustomField:"AppDefinedData",memberCustomField:"AppMemberDefinedData",groupCustomFieldFilter:"AppDefinedDataFilter_Group",memberCustomFieldFilter:"AppDefinedDataFilter_GroupMember"},response:{GroupIdList:"groups",AppDefinedData:"groupCustomField",AppMemberDefinedData:"memberCustomField",AppDefinedDataFilter_Group:"groupCustomFieldFilter",AppDefinedDataFilter_GroupMember:"memberCustomFieldFilter",InfoSeq:"infoSequence",MemberList:"members",GroupInfo:"groups",ShutUpUntil:"muteUntil",ShutUpAllMember:"muteAllMembers"}}}}(e)),this._configMap.set(Kn.CREATE_GROUP,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.GROUP,".").concat(Kn.CREATE_GROUP)}),body:{type:void 0,name:void 0,groupID:void 0,ownerID:void 0,introduction:void 0,notification:void 0,maxMemberNum:void 0,joinOption:void 0,memberList:void 0,groupCustomField:void 0,memberCustomField:void 0,webPushFlag:1,avatar:"",isSupportTopic:void 0,inviteOption:void 0},keyMap:{request:{ownerID:"Owner_Account",userID:"Member_Account",avatar:"FaceUrl",maxMemberNum:"MaxMemberCount",joinOption:"ApplyJoinOption",groupCustomField:"AppDefinedData",memberCustomField:"AppMemberDefinedData",inviteOption:"InviteJoinOption"},response:{HugeGroupFlag:"avChatRoomFlag",OverJoinedGroupLimit_Account:"overLimitUserIDList"}}}}(e)),this._configMap.set(Kn.DISMISS_GROUP,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.GROUP,".").concat(Kn.DISMISS_GROUP)}),body:{groupID:void 0}}}(e)),this._configMap.set(Kn.UPDATE_GROUP_PROFILE,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.GROUP,".").concat(Kn.UPDATE_GROUP_PROFILE)}),body:{groupID:void 0,name:void 0,introduction:void 0,notification:void 0,avatar:void 0,joinOption:void 0,groupCustomField:void 0,muteAllMembers:void 0,inviteOption:void 0},keyMap:{request:{groupCustomField:"AppDefinedData",muteAllMembers:"ShutUpAllMember",joinOption:"ApplyJoinOption",avatar:"FaceUrl",inviteOption:"InviteJoinOption"},response:{AppDefinedData:"groupCustomField",ShutUpAllMember:"muteAllMembers"}}}}(e)),this._configMap.set(Kn.APPLY_JOIN_GROUP,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.GROUP,".").concat(Kn.APPLY_JOIN_GROUP)}),body:{groupID:void 0,applyMessage:void 0,userDefinedField:void 0,webPushFlag:1,historyMessageFlag:void 0},keyMap:{request:{applyMessage:"ApplyMsg",historyMessageFlag:"HugeGroupHistoryMsgFlag"},response:{HugeGroupFlag:"avChatRoomFlag",AVChatRoomKey:"avChatRoomKey",RspMsgList:"messageList",ToGroupId:"to"}}}}(e)),this._configMap.set(Kn.APPLY_JOIN_GROUP_NOAUTH,function(e){return e.a2,e.tinyid,{head:t(t({},_(e,Xo)),{},{servcmd:"".concat(F.NAME.BIG_GROUP_NO_AUTH,".").concat(Kn.APPLY_JOIN_GROUP)}),body:{groupID:void 0,applyMessage:void 0,userDefinedField:void 0,webPushFlag:1},keyMap:{request:{applyMessage:"ApplyMsg"},response:{HugeGroupFlag:"avChatRoomFlag"}}}}(e)),this._configMap.set(Kn.QUIT_GROUP,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.GROUP,".").concat(Kn.QUIT_GROUP)}),body:{groupID:void 0}}}(e)),this._configMap.set(Kn.SEARCH_GROUP,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.GROUP,".").concat(Kn.SEARCH_GROUP)}),body:{groupIDList:void 0,responseFilter:{groupBasePublicInfoFilter:["Type","Name","Introduction","Notification","FaceUrl","CreateTime","Owner_Account","LastInfoTime","LastMsgTime","NextMsgSeq","MemberNum","MaxMemberNum","ApplyJoinOption","InviteJoinOption"]}},keyMap:{response:{}}}}(e)),this._configMap.set(Kn.CHANGE_GROUP_OWNER,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.GROUP,".").concat(Kn.CHANGE_GROUP_OWNER)}),body:{groupID:void 0,newOwnerID:void 0},keyMap:{request:{newOwnerID:"NewOwner_Account"}}}}(e)),this._configMap.set(Kn.HANDLE_GROUP_APPLICATION,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.GROUP,".").concat(Kn.HANDLE_GROUP_APPLICATION)}),body:{groupID:void 0,applicant:void 0,handleAction:void 0,handleMessage:void 0,authentication:void 0,messageKey:void 0,userDefinedField:void 0},keyMap:{request:{applicant:"Applicant_Account",handleAction:"HandleMsg",handleMessage:"ApprovalMsg",messageKey:"MsgKey"}}}}(e)),this._configMap.set(Kn.HANDLE_INVITE_JOIN_GROUP,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.GROUP,".").concat(Kn.HANDLE_INVITE_JOIN_GROUP)}),body:{groupID:void 0,applicant:void 0,invitee:void 0,handleAction:void 0,handleMessage:void 0,authentication:void 0,userDefinedField:void 0},keyMap:{request:{applicant:"Applicant_Account",invitee:"Invited_Account",handleAction:"HandleMsg",handleMessage:"ApprovalMsg"}}}}(e)),this._configMap.set(Kn.HANDLE_GROUP_INVITATION,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.GROUP,".").concat(Kn.HANDLE_GROUP_INVITATION)}),body:{groupID:void 0,inviter:void 0,handleAction:void 0,handleMessage:void 0,authentication:void 0,messageKey:void 0,userDefinedField:void 0},keyMap:{request:{inviter:"Inviter_Account",handleAction:"HandleMsg",handleMessage:"ApprovalMsg",messageKey:"MsgKey"}}}}(e)),this._configMap.set(Kn.GET_GROUP_PENDENCY,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.GROUP,".").concat(Kn.GET_GROUP_PENDENCY)}),body:{startTime:void 0,limit:void 0,handleAccount:void 0},keyMap:{request:{handleAccount:"Handle_Account"},response:{To_Account:"userID",ApplyInviteMsg:"note"}}}}(e)),this._configMap.set(Kn.DELETE_GROUP_SYSTEM_NOTICE,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.OPEN_IM,".").concat(Kn.DELETE_GROUP_SYSTEM_NOTICE)}),body:{messageListToDelete:void 0},keyMap:{request:{messageListToDelete:"DelMsgList",messageSeq:"MsgSeq",messageRandom:"MsgRandom"}}}}(e)),this._configMap.set(Kn.AVCHATROOM_POLLING,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.BIG_GROUP_LONG_POLLING,".").concat(Kn.AVCHATROOM_POLLING)}),body:{USP:1,startSeq:1,startBroadcastSeq:void 0,holdTime:90,key:void 0,simplifiedMessage:void 0},keyMap:{request:{USP:"USP"},response:{ToGroupId:"groupID",RspBroadcastMsgList:"broadcastMessageList",IsSystemMsg:"isSystemMessage"}}}}(e)),this._configMap.set(Kn.AVCHATROOM_NOAUTH_POLLING,function(e){return e.a2,e.tinyid,{head:t(t({},_(e,$o)),{},{servcmd:"".concat(F.NAME.BIG_GROUP_LONG_POLLING_NO_AUTH,".").concat(Kn.AVCHATROOM_POLLING)}),body:{USP:1,startSeq:1,holdTime:90,key:void 0,simplifiedMessage:void 0},keyMap:{request:{USP:"USP"},response:{ToGroupId:"groupID",RspBroadcastMsgList:"broadcastMessageList",IsSystemMsg:"isSystemMessage"}}}}(e)),this._configMap.set(Kn.GET_ONLINE_MEMBER_NUM,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.GROUP,".").concat(Kn.GET_ONLINE_MEMBER_NUM)}),body:{groupID:void 0},keyMap:{response:{OnlineMemberNum:"memberCount"}}}}(e)),this._configMap.set(Kn.SET_GROUP_ATTRIBUTES,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.GROUP,".").concat(Kn.SET_GROUP_ATTRIBUTES)}),body:{groupID:void 0,groupAttributeList:void 0,mainSequence:void 0,avChatRoomKey:void 0,attributeControl:["RaceConflict"]},keyMap:{request:{key:"key",value:"value"}}}}(e)),this._configMap.set(Kn.MODIFY_GROUP_ATTRIBUTES,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.GROUP,".").concat(Kn.MODIFY_GROUP_ATTRIBUTES)}),body:{groupID:void 0,groupAttributeList:void 0,mainSequence:void 0,avChatRoomKey:void 0,attributeControl:["RaceConflict"]},keyMap:{request:{key:"key",value:"value"}}}}(e)),this._configMap.set(Kn.DELETE_GROUP_ATTRIBUTES,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.GROUP,".").concat(Kn.DELETE_GROUP_ATTRIBUTES)}),body:{groupID:void 0,groupAttributeList:void 0,mainSequence:void 0,avChatRoomKey:void 0,attributeControl:["RaceConflict"]},keyMap:{request:{key:"key"}}}}(e)),this._configMap.set(Kn.CLEAR_GROUP_ATTRIBUTES,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.GROUP,".").concat(Kn.CLEAR_GROUP_ATTRIBUTES)}),body:{groupID:void 0,mainSequence:void 0,avChatRoomKey:void 0,attributeControl:["RaceConflict"]}}}(e)),this._configMap.set(Kn.GET_GROUP_ATTRIBUTES,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.GROUP_ATTR,".").concat(Kn.GET_GROUP_ATTRIBUTES)}),body:{groupID:void 0,avChatRoomKey:void 0,groupType:1},keyMap:{request:{avChatRoomKey:"Key",groupType:"GroupType"}}}}(e)),this._configMap.set(Kn.GET_GROUP_NOTIFY,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.GROUP,".").concat(Kn.GET_GROUP_NOTIFY)}),body:{notifyReqList:[]},keyMap:{request:{notifyReqList:"NotifyReqList"},response:{NextMsgTime:"nextRevokedTime",NotifyMsgList:"notifyList",NotifyRspList:"notifyRspList"}}}}(e)),this._configMap.set(Kn.UPDATE_GROUP_COUNTER,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.GROUP,".").concat(Kn.UPDATE_GROUP_COUNTER)}),body:{groupID:void 0,counterList:void 0,avChatRoomKey:void 0,mode:void 0},keyMap:{request:{counterList:"GroupCounter"}}}}(e)),this._configMap.set(Kn.GET_GROUP_COUNTER,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.GROUP,".").concat(Kn.GET_GROUP_COUNTER)}),body:{groupID:void 0,keyList:[],avChatRoomKey:void 0},keyMap:{request:{keyList:"GroupCounterKeys"}}}}(e)),this._configMap.set(Kn.CREATE_TOPIC,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.GROUP_COMMUNITY,".").concat(Kn.CREATE_TOPIC)}),body:{groupID:void 0,topicName:void 0,avatar:void 0,customData:void 0,topicID:void 0,notification:void 0,introduction:void 0},keyMap:{request:{avatar:"FaceUrl"}}}}(e)),this._configMap.set(Kn.DELETE_TOPIC,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.GROUP_COMMUNITY,".").concat(Kn.DELETE_TOPIC)}),body:{groupID:void 0,topicIDList:void 0},keyMap:{request:{topicIDList:"TopicIdList"},response:{DestroyResultItem:"resultList"}}}}(e)),this._configMap.set(Kn.UPDATE_TOPIC_PROFILE,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.GROUP_COMMUNITY,".").concat(Kn.UPDATE_TOPIC_PROFILE)}),body:{groupID:void 0,topicID:void 0,avatar:void 0,customData:void 0,notification:void 0,introduction:void 0,muteAllMembers:void 0,topicName:void 0},keyMap:{request:{avatar:"FaceUrl",muteAllMembers:"ShutUpAllMember"}}}}(e)),this._configMap.set(Kn.GET_TOPIC_LIST,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.GROUP_COMMUNITY,".").concat(Kn.GET_TOPIC_LIST)}),body:{groupID:void 0,topicIDList:void 0,MemberInfoFilter:["NoUnreadSeqList"]},keyMap:{request:{topicIDList:"TopicIdList"},response:{TopicAndSelfInfo:"topicInfoList",TopicInfo:"topic",GroupID:"groupID",ShutUpTime:"muteTime",ShutUpAllFlag:"muteAllMembers",LastMsgTime:"lastMessageTime",MsgSeq:"readedSequence",LastMsgSeq:"sequence",NoUnreadSeqList:"excludedUnreadSequenceList"}}}}(e)),this._configMap.set(Kn.GET_GROUP_MEMBER_LIST,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.GROUP,".").concat(Kn.GET_GROUP_MEMBER_LIST)}),body:{groupID:void 0,limit:0,offset:void 0,next:void 0,memberRoleFilter:void 0,memberInfoFilter:void 0,memberCustomFieldFilter:void 0},keyMap:{request:{memberCustomFieldFilter:"AppDefinedDataFilter_GroupMember"},response:{AppMemberDefinedData:"memberCustomField",AppDefinedDataFilter_GroupMember:"memberCustomFieldFilter",MemberList:"members",ShutUpUntil:"muteUntil"}}}}(e)),this._configMap.set(Kn.GET_AVCHATROOM_MEMBER_LIST,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.GROUP_AVCHATROOM,".").concat(Kn.GET_AVCHATROOM_MEMBER_LIST)}),body:{groupID:void 0,offset:void 0,filter:void 0},keyMap:{request:{offset:"Timestamp",filter:"Mark"},response:{NextTimestamp:"offset"}}}}(e)),this._configMap.set(Kn.GET_GROUP_MEMBER_PROFILE,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.GROUP,".").concat(Kn.GET_GROUP_MEMBER_PROFILE)}),body:{groupID:void 0,userIDList:void 0,memberInfoFilter:void 0,memberCustomFieldFilter:void 0},keyMap:{request:{userIDList:"Member_List_Account",memberCustomFieldFilter:"AppDefinedDataFilter_GroupMember"},response:{MemberList:"members",ShutUpUntil:"muteUntil",AppDefinedDataFilter_GroupMember:"memberCustomFieldFilter",AppMemberDefinedData:"memberCustomField"}}}}(e)),this._configMap.set(Kn.ADD_GROUP_MEMBER,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.GROUP,".").concat(Kn.ADD_GROUP_MEMBER)}),body:{groupID:void 0,silence:void 0,userIDList:void 0},keyMap:{request:{userID:"Member_Account",userIDList:"MemberList"},response:{MemberList:"members"}}}}(e)),this._configMap.set(Kn.DELETE_GROUP_MEMBER,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.GROUP,".").concat(Kn.DELETE_GROUP_MEMBER)}),body:{groupID:void 0,userIDList:void 0,reason:void 0},keyMap:{request:{userIDList:"MemberToDel_Account"}}}}(e)),this._configMap.set(Kn.BAN_AVCHATROOM_MEMBER,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.GROUP,".").concat(Kn.BAN_AVCHATROOM_MEMBER)}),body:{groupID:void 0,userIDList:void 0,duration:void 0,reason:""},keyMap:{request:{userIDList:"Members_Account",duration:"Duration",reason:"Description"}}}}(e)),this._configMap.set(Kn.MODIFY_GROUP_MEMBER_INFO,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.GROUP,".").concat(Kn.MODIFY_GROUP_MEMBER_INFO)}),body:{groupID:void 0,topicID:void 0,userID:void 0,messageRemindType:void 0,nameCard:void 0,role:void 0,memberCustomField:void 0,muteTime:void 0},keyMap:{request:{userID:"Member_Account",memberCustomField:"AppMemberDefinedData",muteTime:"ShutUpTime",messageRemindType:"MsgFlag"}}}}(e)),this._configMap.set(Kn.MARK_AVCHATROOM_MEMBER_INFO,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.GROUP_AVCHATROOM,".").concat(Kn.MARK_AVCHATROOM_MEMBER_INFO)}),body:{groupID:void 0,operationType:1,memberList:[]},keyMap:{request:{operationType:"CommandType",memberList:"MemberList",markType:"Marks",userID:"Member_Account"},response:{CommandType:"operationType",Marks:"markType",Member_Account:"userID"}}}}(e)),this._configMap.set(Kn.SSO_STAT,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.IM_OPEN_STAT,".").concat(Kn.SSO_STAT)}),body:{header:{},event:[],quality:[]},keyMap:{request:{SDKType:"sdk_type",SDKVersion:"sdk_version",deviceType:"device_type",platform:"platform",instanceID:"instance_id",traceID:"trace_id",SDKAppID:"sdk_app_id",userID:"user_id",tinyID:"tiny_id",extension:"extension",timestamp:"timestamp",networkType:"network_type",eventType:"event_type",code:"error_code",message:"error_message",moreMessage:"more_message",duplicate:"duplicate",costTime:"cost_time",level:"level",qualityType:"quality_type",reportIndex:"report_index",wholePeriod:"whole_period",totalCount:"total_count",rttCount:"success_count_business",successRateOfRequest:"percent_business",countLessThan1Second:"success_count_business",percentOfCountLessThan1Second:"percent_business",countLessThan3Second:"success_count_platform",percentOfCountLessThan3Second:"percent_platform",successCountOfBusiness:"success_count_business",successRateOfBusiness:"percent_business",successCountOfPlatform:"success_count_platform",successRateOfPlatform:"percent_platform",successCountOfMessageReceived:"success_count_business",successRateOfMessageReceived:"percent_business",avgRTT:"average_value",avgDelay:"average_value",avgValue:"average_value",uiPlatform:"ui_platform"}}}}(r)),this._configMap.set(Kn.PING,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.HEARTBEAT,".").concat(Kn.PING)}),body:{}}}(e)),this._configMap.set(Kn.MESSAGE_PUSH,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.IM_OPEN_PUSH,".").concat(Kn.MESSAGE_PUSH)}),body:{},keyMap:{response:{C2cMsgArray:"C2CMessageArray",GroupMsgArray:"groupMessageArray",GroupTips:"groupTips",C2cNotifyMsgArray:"C2CNotifyMessageArray",C2cMsgInfo:"C2CReadReceiptArray",ClientSeq:"clientSequence",MsgPriority:"priority",NoticeSeq:"noticeSequence",MsgContent:"content",MsgType:"type",MsgBody:"elements",ToGroupId:"to",Desc:"description",Ext:"extension",IsSyncMsg:"isSyncMessage",Flag:"needSync",NeedAck:"needAck",PendencyAdd_Account:"userID",ProfileImNick:"nick",PendencyType:"applicationType",C2CReadAllMsg:"readAllC2CMessage",IsNeedReadReceipt:"needReadReceipt",Status:"statusType"}}}}(e)),this._configMap.set(Kn.MULTI_MESSAGE_PUSH,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.IM_OPEN_PUSH,".").concat(Kn.MULTI_MESSAGE_PUSH)}),body:{},keyMap:{response:{GroupMsgArray:"groupMessageArray",GroupTips:"groupTips",ClientSeq:"clientSequence",MsgPriority:"priority",NoticeSeq:"noticeSequence",MsgContent:"content",MsgType:"type",MsgBody:"elements",ToGroupId:"to",Desc:"description",Ext:"extension",IsSyncMsg:"isSyncMessage",Flag:"needSync",NeedAck:"needAck",PendencyType:"applicationType"}}}}(e)),this._configMap.set(Kn.MESSAGE_PUSH_ACK,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.OPEN_IM,".").concat(Kn.MESSAGE_PUSH_ACK)}),body:{sessionData:void 0},keyMap:{request:{sessionData:"SessionData"}}}}(e)),this._configMap.set(Kn.STATUS_FORCE_OFFLINE,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.IM_OPEN_STATUS,".").concat(Kn.STATUS_FORCE_OFFLINE)}),body:{},keyMap:{response:{C2cNotifyMsgArray:"C2CNotifyMessageArray",NoticeSeq:"noticeSequence",KickoutMsgNotify:"kickoutMsgNotify",NewInstInfo:"newInstanceInfo"}}}}(e)),this._configMap.set(Kn.DOWNLOAD_MERGER_MESSAGE,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.IM_LONG_MESSAGE,".").concat(Kn.DOWNLOAD_MERGER_MESSAGE)}),body:{downloadKey:""},keyMap:{response:{Data:"data",Desc:"description",Ext:"extension",Download_Flag:"downloadFlag",ThumbUUID:"thumbUUID",VideoUUID:"videoUUID"}}}}(e)),this._configMap.set(Kn.UPLOAD_MERGER_MESSAGE,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.IM_LONG_MESSAGE,".").concat(Kn.UPLOAD_MERGER_MESSAGE)}),body:{messageList:[]},keyMap:{request:{fromAccount:"From_Account",toAccount:"To_Account",msgTimeStamp:"MsgTimeStamp",msgSeq:"MsgSeq",msgRandom:"MsgRandom",msgBody:"MsgBody",type:"MsgType",content:"MsgContent",data:"Data",description:"Desc",extension:"Ext",sizeType:"Type",uuid:"UUID",url:"",imageUrl:"URL",fileUrl:"Url",remoteAudioUrl:"Url",remoteVideoUrl:"VideoUrl",thumbUUID:"ThumbUUID",videoUUID:"VideoUUID",videoUrl:"",downloadFlag:"Download_Flag",from:"From_Account",time:"MsgTimeStamp",messageRandom:"MsgRandom",messageSequence:"MsgSeq",elements:"MsgBody",clientSequence:"ClientSeq",payload:"MsgContent",messageList:"MsgList",messageNumber:"MsgNum",abstractList:"AbstractList",messageBody:"MsgBody"}}}}(e)),this._configMap.set(Kn.SET_TOKEN,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.IM_OPEN_STATUS,".").concat(Kn.SET_TOKEN)}),body:{tokenID:"",pushMsg:0,sdkAppID:0,businessID:"",deviceBrand:"",deviceToken:"",isTpns:0,isWebUniapp:0},keyMap:{request:{tokenID:"TokenID",pushMsg:"PushMsg",sdkAppID:"EnterVersion",businessID:"BusiID",deviceBrand:"InstType",deviceToken:"VarToken",isTpns:"IsTpns"}}}}(e)),this._configMap.set(Kn.STAT_FOREGROUND,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.IM_OPEN_STATUS,".").concat(Kn.STAT_FOREGROUND)}),body:{isWebUniapp:0}}}(e)),this._configMap.set(Kn.STAT_BACKGROUND,function(e){return{head:t(t({},e),{},{servcmd:"".concat(F.NAME.IM_OPEN_STATUS,".").concat(Kn.STAT_BACKGROUND)}),body:{C2CUnread:0,GroupUnread:0,isWebUniapp:0},keyMap:{request:{c2cUnreadCount:"C2cUnread",groupUnreadCount:"GrpUnread"}}}}(e))}},{key:"has",value:function(e){return this._configMap.has(e)}},{key:"get",value:function(e){return this._configMap.get(e)}},{key:"update",value:function(){this._fillConfigMap()}},{key:"getKeyMap",value:function(e){return this.has(e)?this.get(e).keyMap||{}:(Ge.w("".concat(this._n,".getKeyMap unknown protocolName:").concat(e)),{})}},{key:"getProtocolData",value:function(e){var t=e.protocolName,n=e.requestData,r=this.get(t),o=null;if(n){var i=this._simpleDeepCopy(r),a=this._updateService(n,i),s=a.body,u=Object.create(null);for(var c in s)if(Object.prototype.hasOwnProperty.call(s,c)){if(u[c]=s[c],void 0===n[c])continue;u[c]=n[c]}a.body=u,o=this._getUplinkData(a)}else o=this._getUplinkData(r);return o}},{key:"_getUplinkData",value:function(e){var t=this._requestDataCleaner(e),n=Gt(t.head),r=function(e,t){var n=0;return function e(t,r){if(++n>100)return n--,t;if(it(t)){var o=t.map((function(t){return rt(t)?e(t,r):t}));return n--,o}if(rt(t)){var i=(a=t,s=function(e,t){if(!ft(t))return!1;if((o=t)!==Uo(o))for(var n=0;n<Po.ignoreKeyWord.length&&!t.includes(Po.ignoreKeyWord[n]);n++);var o;return at(r[t])?function(e){return"OPPOChannelID"===e?e:e[0].toUpperCase()+Uo(e).slice(1)}(t):r[t]},u=Object.create(null),Object.keys(a).forEach((function(e){var t=s(a[e],e);t&&(u[t]=a[e])})),u);return i=Ot(i,(function(t,n){return it(t)||rt(t)?e(t,r):t})),n--,i}var a,s,u}(e,t)}(t.body,this._getRequestKeyMap(n));return t.body=r,t}},{key:"_updateService",value:function(e,t){var n=Gt(t.head);if(this._isFromGroupRequest(t)){var r=e.type,o=e.groupID,i=void 0===o?void 0:o,a=e.groupIDList,s=void 0===a?[]:a;at(i)&&(i=s[0]||""),Ct({type:r,groupID:i})&&(t.head.servcmd="".concat(F.NAME.GROUP_COMMUNITY,".").concat(n))}return t}},{key:"_isFromGroupRequest",value:function(e){return e.head.servcmd.includes(F.NAME.GROUP)||e.head.servcmd.includes(F.NAME.GROUP_ATTR)}},{key:"_getRequestKeyMap",value:function(e){var n=this.getKeyMap(e);return t(t({},Po.request),n.request)}},{key:"_requestDataCleaner",value:function(e){var t=Array.isArray(e)?[]:Object.create(null);for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&ft(r)&&null!==e[r]&&void 0!==e[r]&&("object"!==n(e[r])?t[r]=e[r]:t[r]=this._requestDataCleaner.bind(this)(e[r]));return t}},{key:"_simpleDeepCopy",value:function(e){for(var t,n=Object.keys(e),r={},o=0,i=n.length;o<i;o++)t=n[o],it(e[t])?r[t]=Array.from(e[t]):rt(e[t])?r[t]=this._simpleDeepCopy(e[t]):r[t]=e[t];return r}}]),e}(),Qo=[Kn.MESSAGE_PUSH_ACK],ei=function(){function e(t){a(this,e),this._sessionModule=t,this._n="DownlinkHandler",this._eventHandlerMap=new Map,this._eventHandlerMap.set("C2CMessageArray",this._c2cMessageArrayHandler.bind(this)),this._eventHandlerMap.set("groupMessageArray",this._groupMessageArrayHandler.bind(this)),this._eventHandlerMap.set("groupTips",this._groupTipsHandler.bind(this)),this._eventHandlerMap.set("C2CNotifyMessageArray",this._C2CNotifyMessageArrayHandler.bind(this)),this._eventHandlerMap.set("C2CReadReceiptArray",this._C2CReadReceiptArrayHandler.bind(this)),this._eventHandlerMap.set("profileModify",this._profileHandler.bind(this)),this._eventHandlerMap.set("friendListMod",this._relationChainHandler.bind(this)),this._eventHandlerMap.set("recentContactMod",this._recentContactHandler.bind(this)),this._eventHandlerMap.set("readAllC2CMessage",this._allMessageReadHandler.bind(this)),this._eventHandlerMap.set("c2cMessageModified",this._c2cMessageModifiedHandler.bind(this)),this._eventHandlerMap.set("groupMessageModified",this._groupMessageModifiedHandler.bind(this)),this._eventHandlerMap.set("userStatusList",this._userStatusListHandler.bind(this)),this._eventHandlerMap.set("messageExtensionNotify",this._messageExtensionNotifyHandler.bind(this)),this._eventHandlerMap.set("messageReactionNotifyList",this._messageReactionNotifyListHandler.bind(this)),this._eventHandlerMap.set("messageReactionNotify",this._messageReactionNotifyHandler.bind(this)),this._keys=T(this._eventHandlerMap.keys())}return c(e,[{key:"_c2cMessageArrayHandler",value:function(e){var t=this._sessionModule.getModule(6);t&&(e.dataList.forEach((function(e){if(1===e.isSyncMessage){var t=e.from;e.from=e.to,e.to=t}})),1===e.needSync&&this._sessionModule.getModule(19).startOnlineSync(),t.onNewC2CMessage({dataList:e.dataList,isInstantMessage:!0}))}},{key:"_c2cMessageModifiedHandler",value:function(e){var t=this._sessionModule.getModule(6);t&&t.onC2CMessageModified(e)}},{key:"_groupMessageArrayHandler",value:function(e){var t=this._sessionModule.getModule(7);t&&t.onNewGroupMessage({event:e.event,dataList:e.dataList,isInstantMessage:!0})}},{key:"_groupMessageModifiedHandler",value:function(e){var t=this._sessionModule.getModule(7);t&&t.onGroupMessageModified(e)}},{key:"_groupTipsHandler",value:function(e){var t=this._sessionModule.getModule(7);if(t){var n=e.event,r=e.dataList,o=e.isInstantMessage,i=void 0===o||o,a=e.isSyncingEnded;switch(n){case 4:case 6:t.onNewGroupTips({event:n,dataList:r});break;case 5:for(var s=0;s<r.length;s++)if(it(r[s].elements.revokedInfos))t.onGroupMessageRevoked({dataList:r});else if(it(r[s].elements.groupMessageReadNotice))t.onGroupMessageReadNotice({dataList:r});else{if(!it(r[s].elements.readReceiptList)){t.onNewGroupSystemNotice({dataList:r,isInstantMessage:i,isSyncingEnded:a});break}t.onReadReceiptList({dataList:r})}break;case 12:this._sessionModule.getModule(11).onNewGroupAtTips({dataList:r});break;default:Ge.l("".concat(this._n,"._groupTipsHandler unknown event:").concat(n," dataList:"),r)}}}},{key:"_C2CNotifyMessageArrayHandler",value:function(e){var t=this,n=e.dataList;if(it(n)){var r=this._sessionModule.getModule(6);n.forEach((function(e){if(ot(e))if(e.hasOwnProperty("kickoutMsgNotify")){var o=e.kickoutMsgNotify,i=o.kickType,a=o.newInstanceInfo,s=void 0===a?{}:a;1===i?t._sessionModule.onMultipleAccountKickedOut(s):2===i?t._sessionModule.onMultipleDeviceKickedOut(s):3===i&&t._sessionModule.onRestApiKickedOut(s)}else e.hasOwnProperty("c2cMessageRevokedNotify")?r&&r.onC2CMessageRevoked({dataList:n}):e.hasOwnProperty("c2cMessageReadReceipt")?r&&r.onC2CMessageReadReceipt({dataList:n}):e.hasOwnProperty("c2cMessageReadNotice")?r&&r.onC2CMessageReadNotice({dataList:n}):e.hasOwnProperty("muteNotificationsSync")&&t._sessionModule.getModule(11).onC2CMessageRemindTypeSynced({dataList:n})}))}}},{key:"_C2CReadReceiptArrayHandler",value:function(e){this._sessionModule.getModule(6).onReadReceiptList(e)}},{key:"_profileHandler",value:function(e){this._sessionModule.getModule(4).onProfileModified({dataList:e.dataList});var t=this._sessionModule.getModule(8);t&&t.onFriendProfileModified({dataList:e.dataList})}},{key:"_relationChainHandler",value:function(e){this._sessionModule.getModule(4).onRelationChainModified({dataList:e.dataList});var t=this._sessionModule.getModule(8);t&&t.onRelationChainModified({dataList:e.dataList})}},{key:"_recentContactHandler",value:function(e){var t=e.dataList;if(it(t)){var n=this._sessionModule.getModule(11);n&&t.forEach((function(e){var t=e.pushType;if(1===t){var r=e.recentContactDeleteItem;n.onConversationDeleted(r.recentContactList)}else if(2===t){var o=e.recentContactTopItem;n.onConversationPinned(o.recentContactList)}else if(3===t){var i=e.recentContactTopItem;n.onConversationUnpinned(i.recentContactList)}else if(4===t){var a=e.recentContactMarkContact;n.onConversationMarkUpdated(a.recentContactMarkContactItem)}else if(5===t){var s=e.recentContactCreateContactGroup;n.onConversationGroupCreated(s.msgContactGroupContactItem)}else if(6===t){var u=e.recentContactDelContactGroup;n.onConversationGroupDeleted(u.msgGroupItem)}else if(7===t){var c=e.recentContactUpdateContactGroup,l=c.updateType,d=c.msgUpdateGroup,f=c.msgUpdateContact;if(1===l){var p=d.updateGroupType;1===p?n.onConversationGroupNameUpdated(d):2===p&&n.onConversationInGroupUpdated(d)}else 2===l&&n.onConversationAddedToOrDeletedFromGroup(f)}}))}}},{key:"_allMessageReadHandler",value:function(e){var t=e.dataList,n=this._sessionModule.getModule(11);n&&n.onPushedAllMessageRead(t)}},{key:"_userStatusListHandler",value:function(e){this._sessionModule.getModule(4).onUserStatusUpdated(e)}},{key:"_messageExtensionNotifyHandler",value:function(e){this._sessionModule.getModule(3).onMessageExtensionNotify(e)}},{key:"_messageReactionNotifyListHandler",value:function(e){this._sessionModule.getModule(34).onMessageReactionNotifyList(e)}},{key:"_messageReactionNotifyHandler",value:function(e){this._sessionModule.getModule(34).onMessageReactionNotify(e)}},{key:"onMessage",value:function(e){var t=this,n=e.body;if(this._filterMessageFromIMOpenPush(e)){var r=n.eventArray,o=n.isInstantMessage,i=n.isSyncingEnded,a=n.needSync;if(it(r))for(var s=null,u=null,c=0,l=0,d=r.length;l<d;l++)if(100!==(c=(s=r[l]).event)){var f=Object.keys(s).find((function(e){return-1!==t._keys.indexOf(e)}));f?(u=14===c?{readAllC2CMessage:s[f],groupMessageReadInfoList:s.groupMessageReadNotice||[]}:16===c?{userID:s.userID,readReceiptList:s[f]}:s[f],this._eventHandlerMap.get(f)({event:c,dataList:u,isInstantMessage:o,isSyncingEnded:i,needSync:a})):Ge.l("".concat(this._n,".onMessage unknown eventItem:").concat(s))}else this._onRoomCustomData(s.content)}}},{key:"_onRoomCustomData",value:function(e){this._sessionModule.getModule(30).onRoomCustomDataReceived(e)}},{key:"_filterMessageFromIMOpenPush",value:function(e){var t=e.head,n=e.body,r=t.servcmd,o=!1;if(at(r)||(o=r.includes(F.NAME.IM_CONFIG_MANAGER)||r.includes(F.NAME.OVERLOAD_PUSH)||r.includes(F.NAME.STAT_SERVICE)),!o)return!0;if(r.includes(Kn.PUSHED_CLOUD_CONTROL_CONFIG))this._sessionModule.getModule(23).onPushedCloudControlConfig(n);else if(r.includes(Kn.PUSHED_COMMERCIAL_CONFIG))this._sessionModule.getModule(27).onPushedConfig(n);else if(r.includes(Kn.OVERLOAD_NOTIFY))this._sessionModule.onPushedServerOverload(n);else if(r.includes(Kn.KICK_OTHER)){var i=Date.now();this._sessionModule.reLoginOnKickOther();var a=new ar("kickOther"),s=this._sessionModule.getModule(1).getLastWsHelloTs(),u=i-s;a.setMessage("last wshello time:".concat(s," diff:").concat(u,"ms")).setNetworkType(this._sessionModule.getNetworkType()).end()}return!1}}]),e}(),ti=[{cmd:Kn.GET_GROUP_PROFILE,interval:1,count:8},{cmd:Kn.UPDATE_GROUP_PROFILE,interval:1,count:8},{cmd:Kn.GET_AVCHATROOM_MEMBER_LIST,interval:3,count:1},{cmd:Kn.GET_GROUP_PENDENCY,interval:1,count:15},{cmd:Kn.GET_TOPIC_LIST,interval:1,count:10},{cmd:Kn.SET_GROUP_ATTRIBUTES,interval:5,count:10},{cmd:Kn.MODIFY_GROUP_ATTRIBUTES,interval:5,count:10},{cmd:Kn.DELETE_GROUP_ATTRIBUTES,interval:5,count:10},{cmd:Kn.CLEAR_GROUP_ATTRIBUTES,interval:5,count:10},{cmd:Kn.GET_GROUP_ATTRIBUTES,interval:5,count:20},{cmd:Kn.UPDATE_GROUP_COUNTER,interval:5,count:20},{cmd:Kn.GET_GROUP_COUNTER,interval:5,count:20},{cmd:Kn.SET_ALL_MESSAGE_READ,interval:1,count:1},{cmd:Kn.GET_USER_STATUS,interval:5,count:20},{cmd:Kn.SUBSCRIBE_USER_STATUS,interval:5,count:20},{cmd:Kn.UNSUBSCRIBE_USER_STATUS,interval:5,count:20},{cmd:Kn.MESSAGE_CLOUD_SEARCH,interval:1,count:2}],ni=new Map,ri=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"],oi=0,ii=ri.length;oi<ii;oi++)ni.set(oi,ri[oi]);function ai(e){var t,n,r=e;e.length%8!=0&&(r="0".repeat(8-e.length%8)+e);for(var o="",i=0,a=r.length;i<a;i+=8)t=parseInt(r.slice(i,i+4),2),n=parseInt(r.slice(i+4,i+8),2),o+=ni.get(t)+ni.get(n);return o}var si=function(e){d(r,e);var n=I(r);function r(e){var t;return a(this,r),(t=n.call(this,e))._n="SessionModule",t._platform=t.getPlatform(),t._protocolHandler=new Zo(m(t)),t._messageDispatcher=new ei(m(t)),t._commandFrequencyLimitMap=new Map,t._commandRequestInfoMap=new Map,t._serverOverloadInfoMap=new Map,t._incrementalPullContactFlag=!0,t._init(),t.getInnerEmitterInstance().on(Cr.CLOUD_CONFIG_UPDATED,t._onCloudConfigUpdated,m(t)),t}return c(r,[{key:"_init",value:function(){this._updateCommandFrequencyLimitMap(ti)}},{key:"_onCloudConfigUpdated",value:function(){var e=this.getCloudConfig("cmd_frequency_limit");at(e)||(e=JSON.parse(e),this._updateCommandFrequencyLimitMap(e))}},{key:"_updateCommandFrequencyLimitMap",value:function(e){var t=this;e.forEach((function(e){t._commandFrequencyLimitMap.set(e.cmd,{interval:e.interval,count:e.count})}))}},{key:"updateProtocolConfig",value:function(){this._protocolHandler.update()}},{key:"request",value:function(e){Ge.d("".concat(this._n,".request options:"),e);var t=e.protocolName,n=e.tjgID;if(!this._protocolHandler.has(t))return Ge.w("".concat(this._n,".request unknown protocol:").concat(t)),jn({code:qn.CANNOT_FIND_PROTOCOL});var r,o=this.getProtocolData(e),i=o.head.servcmd;if(this._isFrequencyOverLimit(i))return jn({code:r=qn.OVER_FREQUENCY_LIMIT,message:this.getErrorMessage(r,this._getCmd(i))});if(this._isServerOverload(i))return jn({code:r=qn.OPEN_SERVICE_OVERLOAD_ERROR,message:this.getErrorMessage(r,this._getCmd(i))});Qt(n)||(o.head.tjgID=n);var a=this.getModule(21);return Qo.includes(t)?a.simplySend(o):a.send(o)}},{key:"getKeyMap",value:function(e){return this._protocolHandler.getKeyMap(e)}},{key:"genCommonHead",value:function(){var e=this.getModule(12);return{ver:"v4",platform:this._platform,websdkappid:G,websdkversion:U,a2:e.getA2Key()||void 0,tinyid:e.getTinyID()||void 0,status_instid:e.getStatusInstanceID(),sdkappid:e.getSDKAppID(),contenttype:e.getContentType(),reqtime:0,identifier:e.getA2Key()?void 0:e.getUserID(),usersig:e.getA2Key()?void 0:e.getUserSig(),sdkability:192371,sdkability_ext:ai(""),cappid:e.getApplicationID(),tjgID:""}}},{key:"genCosSpecifiedHead",value:function(){var e=this.getModule(12);return{ver:"v4",platform:this._platform,websdkappid:G,websdkversion:U,sdkappid:e.getSDKAppID(),contenttype:e.getContentType(),reqtime:0,identifier:e.getUserID(),usersig:e.getUserSig(),status_instid:e.getStatusInstanceID(),sdkability:192371,sdkability_ext:ai(""),cappid:e.getApplicationID()}}},{key:"genSSOReportHead",value:function(){var e=this.getModule(12);return{ver:"v4",platform:this._platform,websdkappid:G,websdkversion:U,sdkappid:e.getSDKAppID(),contenttype:"",reqtime:0,identifier:"",usersig:"",status_instid:e.getStatusInstanceID(),sdkability:192371,sdkability_ext:ai(""),cappid:e.getApplicationID()}}},{key:"getProtocolData",value:function(e){return this._protocolHandler.getProtocolData(e)}},{key:"trans",value:function(e){var n=e.servcmd,r=e.data,o={head:t(t({},this.genCommonHead()),{},{servcmd:n}),body:r};return this.getModule(21).send(o)}},{key:"sendComboMessage",value:function(e){var n=e.servcmd,r=e.data,o={head:t(t({},this.genCommonHead()),{},{servcmd:n}),body:r};return this.getModule(21).send(o)}},{key:"onErrorCodeNotZero",value:function(e){var t=e.errorCode;if(t===qn.HELLO_ANSWER_KICKED_OUT){var n=e.kickType,r=e.newInstanceInfo,o=void 0===r?{}:r;1===n?this.onMultipleAccountKickedOut(o):2===n?this.onMultipleDeviceKickedOut(o):3===n&&this.onRestApiKickedOut(o)}t!==qn.MSG_A2KEY_EXPIRED&&t!==qn.ACCOUNT_A2KEY_EXPIRED||(this._onUserSigExpired(),this.getModule(21).reConnect())}},{key:"onMessage",value:function(e){var t=e.body,n=t.needAck,r=void 0===n?0:n,o=t.sessionData;1===r&&this._sendACK(o),this._messageDispatcher.onMessage(e)}},{key:"onReconnected",value:function(e){this._incrementalPullContactFlag=e<=300,this._reLoginOnReconnected()}},{key:"reLoginOnKickOther",value:function(){Ge.l("".concat(this._n,".reLoginOnKickOther")),this._reLogin()}},{key:"_reLoginOnReconnected",value:function(){Ge.l("".concat(this._n,"._reLoginOnReconnected")),this._reLogin()}},{key:"_reLogin",value:function(){var e=this,t="".concat(this._n,"._reLogin");if(this.isLoggedIn()){var n=0,r=this.getModule(28);r.canIUseOfflinePush()&&(n=r.getUniAppPlatform()),this.request({protocolName:Kn.LOGIN,requestData:{isWebUniapp:n}}).then((function(n){var r=n.data.instanceID;e.getModule(12).setStatusInstanceID(r),Ge.l("".concat(t," ok. instanceID:").concat(r)),e.getModule(11).syncConversationList(e._incrementalPullContactFlag).then((function(){Ge.l("".concat(t,", sync conversation list ok.")),e.getModule(25).start()}));var o=e.getModule(7);o&&o.updateLocalMainSequenceOnReconnected();var i=e.getModule(10);i.resetGetTopicTime(),i.getTopicListOnReconnected()}))}}},{key:"onMultipleAccountKickedOut",value:function(e){this.getModule(1).onMultipleAccountKickedOut(e)}},{key:"onMultipleDeviceKickedOut",value:function(e){this.getModule(1).onMultipleDeviceKickedOut(e)}},{key:"_onUserSigExpired",value:function(){this.getModule(1).onUserSigExpired()}},{key:"onRestApiKickedOut",value:function(e){this.getModule(1).onRestApiKickedOut(e)}},{key:"_sendACK",value:function(e){this.request({protocolName:Kn.MESSAGE_PUSH_ACK,requestData:{sessionData:e}})}},{key:"_isFrequencyOverLimit",value:function(e){var t=e.split(".")[1];if(!this._commandFrequencyLimitMap.has(t))return!1;if(!this._commandRequestInfoMap.has(t))return this._commandRequestInfoMap.set(t,{startTime:Date.now(),requestCount:1}),!1;var n=this._commandFrequencyLimitMap.get(t),r=n.count,o=n.interval,i=this._commandRequestInfoMap.get(t),a=i.startTime,s=i.requestCount;if(Date.now()-a>1e3*o)return this._commandRequestInfoMap.set(t,{startTime:Date.now(),requestCount:1}),!1;s+=1,this._commandRequestInfoMap.set(t,{startTime:a,requestCount:s});var u=!1;return s>r&&(u=!0),u}},{key:"_isServerOverload",value:function(e){if(!this._serverOverloadInfoMap.has(e))return!1;var t=this._serverOverloadInfoMap.get(e),n=t.overloadTime,r=t.waitingTime,o=!1;return Date.now()-n<=1e3*r?o=!0:(this._serverOverloadInfoMap.delete(e),o=!1),o}},{key:"_getCmd",value:function(e){var t="";if(!e.includes("."))return t;var n=e.split(".")[1];for(var r in Kn)if(Kn[r]===n){t=r;break}return t}},{key:"onPushedServerOverload",value:function(e){var t=e.overloadCommand,n=e.waitingTime;this._serverOverloadInfoMap.set(t,{overloadTime:Date.now(),waitingTime:n}),Ge.w("".concat(this._n,".onPushedServerOverload waitingTime:").concat(n,"s cmd:").concat(this._getCmd(t)))}},{key:"reset",value:function(){Ge.l("".concat(this._n,".reset")),this._updateCommandFrequencyLimitMap(ti),this._commandRequestInfoMap.clear(),this._serverOverloadInfoMap.clear(),this._incrementalPullContactFlag=!0}}]),r}(Hn),ui=function(e){d(n,e);var t=I(n);function n(e){var r;return a(this,n),(r=t.call(this,e))._n="CloudControlModule",r._cloudConfig=new Map,r._expiredTime=0,r._version=0,r._isFetching=!1,r}return c(n,[{key:"getCloudConfig",value:function(e){return at(e)?this._cloudConfig:this._cloudConfig.has(e)?this._cloudConfig.get(e):void 0}},{key:"getServerConfig",value:function(e){var t={code:0,data:""};return!at(e)&&this._cloudConfig.has(e)&&(t.data=this._cloudConfig.get(e)),Promise.resolve(t)}},{key:"_canFetchConfig",value:function(){return this.isLoggedIn()&&!this._isFetching&&Date.now()>=this._expiredTime}},{key:"fetchConfig",value:function(){var e=this,t=this._canFetchConfig();if(Ge.l("".concat(this._n,".fetchConfig canFetchConfig:").concat(t)),t){var n=new ar("fetchCloudControlConfig"),r=this.getModule(12).getSDKAppID();this._isFetching=!0,this.request({protocolName:Kn.FETCH_CLOUD_CONTROL_CONFIG,requestData:{SDKAppID:r,version:this._version}}).then((function(t){e._isFetching=!1,n.setMessage("version:".concat(e._version," newVersion:").concat(t.data.version," config:").concat(t.data.cloudControlConfig)).setNetworkType(e.getNetworkType()).end(),Ge.l("".concat(e._n,".fetchConfig ok")),e._parseCloudControlConfig(t.data)})).catch((function(t){e._isFetching=!1,e.probeNetwork().then((function(e){var r=M(e,2),o=r[0],i=r[1];n.setError(t,o,i).end()})),Ge.l("".concat(e._n,".fetchConfig failed. error:"),t),e._setExpiredTimeOnResponseError(12e4)}))}}},{key:"onPushedCloudControlConfig",value:function(e){Ge.l("".concat(this._n,".onPushedCloudControlConfig")),new ar("pushedCloudControlConfig").setNetworkType(this.getNetworkType()).setMessage("newVersion:".concat(e.version," config:").concat(e.cloudControlConfig)).end(),this._parseCloudControlConfig(e)}},{key:"onCheckTimer",value:function(e){this._canFetchConfig()&&this.fetchConfig()}},{key:"_parseCloudControlConfig",value:function(e){var t=this,n="".concat(this._n,"._parseCloudControlConfig"),r=e.errorCode,o=e.errorMessage,i=e.cloudControlConfig,a=e.version,s=e.expiredTime;if(0===r){if(this._version!==a){var u=null;try{u=JSON.parse(i)}catch(p){this.isPrivateNetWork()||Ge.e("".concat(n," JSON parse error. cloudControlConfig:"),i)}u&&(this._cloudConfig.clear(),Object.keys(u).forEach((function(e){t._cloudConfig.set(e,u[e])})),this._version=a,this.emitInnerEvent(Cr.CLOUD_CONFIG_UPDATED))}this._expiredTime=Date.now()+1e3*s}else at(r)?(Ge.l("".concat(n," failed. Invalid message format:"),e),this._setExpiredTimeOnResponseError(36e5)):(Ge.e("".concat(n," errorCode:").concat(r," errorMessage:").concat(o)),this._setExpiredTimeOnResponseError(12e4))}},{key:"_setExpiredTimeOnResponseError",value:function(e){this._expiredTime=Date.now()+e}},{key:"reset",value:function(){Ge.l("".concat(this._n,".reset")),this._cloudConfig.clear(),this._expiredTime=0,this._version=0,this._isFetching=!1}}]),n}(Hn),ci=function(e){d(n,e);var t=I(n);function n(e){var r;return a(this,n),(r=t.call(this,e))._n="RecoverMessageModule",r.PULL_LIMIT_COUNT=15,r}return c(n,[{key:"start",value:function(){this._recoverGroupChat(),this._recoverC2CChat()}},{key:"_recoverGroupChat",value:function(){var e,t,n=this,r=this._getLocalConversationList().filter((function(e){return e.type===O.CONV_GROUP&&e.groupProfile.type!==O.GRP_AVCHATROOM})),o=this.getModule(11),i=0,a=0,s=0,u=[];r.forEach((function(r){var c=r.conversationID,l=r.lastMessage;t=c.replace(O.CONV_GROUP,""),e=o.getLocalLastMessage(c),l&&0!==l.lastSequence&&e?(a=l.lastSequence,i=e.sequence,s=a-i,i>0&&s>=1&&s<300?n._recoverGroupMessage({groupID:t,localLastMessageSequence:i,remoteLastMessageSequence:a}):u.push(t)):u.push(t)})),this._getGroupNotify(u)}},{key:"_recoverC2CChat",value:function(){var e,t=this,n=this._getLocalConversationList().filter((function(e){return e.type===O.CONV_C2C})),r=this.getModule(11),o=0,i=0,a=0,s=[Promise.resolve()];n.forEach((function(n){var u=n.conversationID,c=n.lastMessage;e=r.getLocalLastMessage(u),c&&0!==c.lastTime&&e&&(i=c.lastTime,o=e.time,a=i-o,o>0&&a>=1&&a<=600&&s.push(t._recoverC2CMessage({conversationID:u,localLastMessageTime:o,remoteLastMessageTime:i})))})),Promise.all(s).then((function(){Ge.l("".concat(t._n,"._recoverC2CChat all promise fulfilled, start to sync unread messages")),t.getModule(19).startSyncOnReconnected()}))}},{key:"_getLocalConversationList",value:function(){return this.getModule(11).getLocalConversationList()}},{key:"_recoverGroupMessage",value:function(e){var t=this,n="".concat(this._n,"._recoverGroupMessage");Ge.l("".concat(n," options:"),e);var r=e.groupID,o=e.localLastMessageSequence,i=e.remoteLastMessageSequence;this._getGroupRoamingMessage({groupID:r,sequence:o}).then((function(e){var o=e.data,a=o.complete,s=o.messageList;if(!at(s)){var u=s[0].sequence,c="groupID:".concat(r," pkgLastSequence:").concat(u," remoteLastSequence:").concat(i," complete:").concat(a," count:").concat(s.length);Ge.l("".concat(n," ").concat(c)),u<i&&2!==a&&t._recoverGroupMessage({groupID:r,localLastMessageSequence:u,remoteLastMessageSequence:i}),new ar("recoverMessage").setNetworkType(t.getNetworkType()).setMessage(c).end();var l=t.getModule(7);s.length>1&&s.sort((function(e,t){return e.sequence-t.sequence}));for(var d=0;d<s.length;d++){var f=s[d];f.from!==O.CONV_SYSTEM?l.onNewGroupMessage({dataList:[f],isInstantMessage:!1,updateUnreadCount:!1}):l.onNewGroupTips({event:f.event,dataList:[f]})}t._getGroupNotify([r])}}))}},{key:"_genMultiGroupIDList",value:function(e,t){var n=t&&t>1?t:1,r=e.length,o=[];if(r>0)for(var i=0;i<r;i+=n)o.push(e.slice(i,i+n));return o}},{key:"_getGroupNotify",value:function(e){var t=this._genMultiGroupIDList(e,10);if(t.length>0)for(var n=this.getModule(7),r=0,o=t.length;r<o;r++)n.getGroupNotify(t[r])}},{key:"_getGroupRoamingMessage",value:function(e){var t=e.groupID,n=e.sequence;return this.request({protocolName:Kn.GET_GROUP_ROAMING_MESSAGE,requestData:{groupID:t,count:this.PULL_LIMIT_COUNT,sequence:n+this.PULL_LIMIT_COUNT-1}})}},{key:"_recoverC2CMessage",value:function(e){var t=this,n="".concat(this._n,"._recoverC2CMessage");Ge.l("".concat(n," options:"),e);var r=e.conversationID,o=e.localLastMessageTime,i=e.remoteLastMessageTime;return this._getC2CRoamingMessage({conversationID:r,time:o}).then((function(e){var o=e.data,a=o.complete,s=o.messageList;if(!at(s)){var u=s.length;t.getModule(6).onNewC2CMessage({dataList:s,isInstantMessage:!0});var c=s[u-1].time,l=r.replace(O.CONV_C2C,""),d="peerAccount:".concat(l," pkgLastTime:").concat(c," remoteLastTime:").concat(i," complete:").concat(a," count:").concat(u);if(Ge.l("".concat(n," ").concat(d)),new ar("recoverMessage").setNetworkType(t.getNetworkType()).setMessage(d).end(),c<i&&1!==a)return t._recoverC2CMessage({conversationID:r,localLastMessageTime:c,remoteLastMessageTime:i})}}))}},{key:"_getC2CRoamingMessage",value:function(e){var t=e.conversationID,n=e.time;return this.request({protocolName:Kn.GET_C2C_ROAMING_MESSAGE,requestData:{peerAccount:t.replace(O.CONV_C2C,""),count:this.PULL_LIMIT_COUNT+1,lastMessageTime:n,direction:1}})}},{key:"reset",value:function(){Ge.l("".concat(this._n,".reset"))}}]),n}(Hn),li=function(){function e(){a(this,e),this._n="AvgE2EDelay",this._e2eDelayArray=[]}return c(e,[{key:"addMessageDelay",value:function(e){var t=we()-e;t>=0&&this._e2eDelayArray.push(t)}},{key:"_calcAvg",value:function(e,t){if(0===t)return 0;var n=0;return e.forEach((function(e){n+=e})),xt(n/t,1)}},{key:"_calcCountWithLimit",value:function(e){var t=e.e2eDelayArray,n=e.min,r=e.max;return t.filter((function(e){return n<=e&&e<r})).length}},{key:"_calcPercent",value:function(e,t){var n=xt(e/t*100,2);return n>100&&(n=100),n}},{key:"_checkE2EDelayException",value:function(e,t){var n=e.filter((function(e){return e>t}));if(n.length>0){var r=n.length,o=Math.min.apply(Math,T(n)),i=Math.max.apply(Math,T(n)),a=this._calcAvg(n,r),s=xt(r/e.length*100,2);s>50&&new ar("messageE2EDelayException").setMessage("count:".concat(r," min:").concat(o," max:").concat(i," avg:").concat(a," percent:").concat(s)).setLevel("warning").end()}}},{key:"getStatResult",value:function(){var e=this._e2eDelayArray.length;if(0===e)return null;var t=T(this._e2eDelayArray),n=this._calcCountWithLimit({e2eDelayArray:t,min:0,max:1}),r=this._calcCountWithLimit({e2eDelayArray:t,min:1,max:3}),o=this._calcPercent(n,e),i=this._calcPercent(r,e),a=this._calcAvg(t,e);return this._checkE2EDelayException(t,3),t.length=0,this.reset(),{totalCount:e,countLessThan1Second:n,percentOfCountLessThan1Second:o,countLessThan3Second:r,percentOfCountLessThan3Second:i,avgDelay:a}}},{key:"reset",value:function(){this._e2eDelayArray.length=0}}]),e}(),di=function(){function e(){a(this,e),this._n="AvgRTT",this._requestCount=0,this._rttArray=[]}return c(e,[{key:"addRequestCount",value:function(){this._requestCount+=1}},{key:"addRTT",value:function(e){this._rttArray.push(e)}},{key:"_calcTotalCount",value:function(){return this._requestCount}},{key:"_calcRTTCount",value:function(e){return e.length}},{key:"_calcSuccessRateOfRequest",value:function(e,t){if(0===t)return 0;var n=xt(e/t*100,2);return n>100&&(n=100),n}},{key:"_calcAvg",value:function(e,t){if(0===t)return 0;var n=0;return e.forEach((function(e){n+=e})),parseInt(n/t)}},{key:"_calcMax",value:function(){return Math.max.apply(Math,T(this._rttArray))}},{key:"_calcMin",value:function(){return Math.min.apply(Math,T(this._rttArray))}},{key:"getStatResult",value:function(){var e=this._calcTotalCount(),t=T(this._rttArray);if(0===e)return null;var n=this._calcRTTCount(t),r=this._calcSuccessRateOfRequest(n,e),o=this._calcAvg(t,n);return Ge.l("".concat(this._n,".getStatResult max:").concat(this._calcMax()," min:").concat(this._calcMin()," avg:").concat(o)),this.reset(),{totalCount:e,rttCount:n,successRateOfRequest:r,avgRTT:o}}},{key:"reset",value:function(){this._requestCount=0,this._rttArray.length=0}}]),e}(),fi=function(){function e(){a(this,e),this._map=new Map}return c(e,[{key:"initMap",value:function(e){var t=this;e.forEach((function(e){t._map.set(e,{totalCount:0,successCount:0,failedCountOfUserSide:0,costArray:[],fileSizeArray:[]})}))}},{key:"addTotalCount",value:function(e){return!(at(e)||!this._map.has(e))&&(this._map.get(e).totalCount+=1,!0)}},{key:"addSuccessCount",value:function(e){return!(at(e)||!this._map.has(e))&&(this._map.get(e).successCount+=1,!0)}},{key:"addFailedCountOfUserSide",value:function(e){return!(at(e)||!this._map.has(e))&&(this._map.get(e).failedCountOfUserSide+=1,!0)}},{key:"addCost",value:function(e,t){return!(at(e)||!this._map.has(e))&&(this._map.get(e).costArray.push(t),!0)}},{key:"addFileSize",value:function(e,t){return!(at(e)||!this._map.has(e))&&(this._map.get(e).fileSizeArray.push(t),!0)}},{key:"_calcSuccessRateOfBusiness",value:function(e){if(at(e)||!this._map.has(e))return-1;var t=this._map.get(e),n=xt(t.successCount/t.totalCount*100,2);return n>100&&(n=100),n}},{key:"_calcSuccessRateOfPlatform",value:function(e){if(at(e)||!this._map.has(e))return-1;var t=this._map.get(e),n=this._calcSuccessCountOfPlatform(e)/t.totalCount*100;return(n=xt(n,2))>100&&(n=100),n}},{key:"_calcTotalCount",value:function(e){return at(e)||!this._map.has(e)?-1:this._map.get(e).totalCount}},{key:"_calcSuccessCountOfBusiness",value:function(e){return at(e)||!this._map.has(e)?-1:this._map.get(e).successCount}},{key:"_calcSuccessCountOfPlatform",value:function(e){if(at(e)||!this._map.has(e))return-1;var t=this._map.get(e);return t.successCount+t.failedCountOfUserSide}},{key:"_calcAvg",value:function(e){return at(e)||!this._map.has(e)?-1:e===Zn?this._calcAvgSpeed(e):this._calcAvgCost(e)}},{key:"_calcAvgCost",value:function(e){var t=this._map.get(e).costArray.length;if(0===t)return 0;var n=0;return this._map.get(e).costArray.forEach((function(e){n+=e})),parseInt(n/t)}},{key:"_calcAvgSpeed",value:function(e){var t=0,n=0;return this._map.get(e).costArray.forEach((function(e){t+=e})),this._map.get(e).fileSizeArray.forEach((function(e){n+=e})),parseInt(1e3*n/t)}},{key:"getStatResult",value:function(e){var t=this._calcTotalCount(e);if(0===t)return null;var n=this._calcSuccessCountOfBusiness(e),r=this._calcSuccessRateOfBusiness(e),o=this._calcSuccessCountOfPlatform(e),i=this._calcSuccessRateOfPlatform(e),a=this._calcAvg(e);return this.reset(e),{totalCount:t,successCountOfBusiness:n,successRateOfBusiness:r,successCountOfPlatform:o,successRateOfPlatform:i,avgValue:a}}},{key:"reset",value:function(e){at(e)?this._map.clear():this._map.set(e,{totalCount:0,successCount:0,failedCountOfUserSide:0,costArray:[],fileSizeArray:[]})}}]),e}(),pi=function(){function e(){a(this,e),this._lastMap=new Map,this._currentMap=new Map}return c(e,[{key:"initMap",value:function(e){var t=this;e.forEach((function(e){t._lastMap.set(e,new Map),t._currentMap.set(e,new Map)}))}},{key:"addMessageSequence",value:function(e){var t=e.key,n=e.message;if(at(t)||!this._lastMap.has(t)||!this._currentMap.has(t))return!1;var r=n.conversationID,o=n.sequence,i=r.replace(O.CONV_GROUP,"");if(0===this._lastMap.get(t).size)this._addCurrentMap(e);else if(this._lastMap.get(t).has(i)){var a=this._lastMap.get(t).get(i),s=a.length-1;o>a[0]&&o<a[s]?(a.push(o),a.sort(),this._lastMap.get(t).set(i,a)):this._addCurrentMap(e)}else this._addCurrentMap(e);return!0}},{key:"_addCurrentMap",value:function(e){var t=e.key,n=e.message,r=n.conversationID,o=n.sequence,i=r.replace(O.CONV_GROUP,"");this._currentMap.get(t).has(i)||this._currentMap.get(t).set(i,[]),this._currentMap.get(t).get(i).push(o)}},{key:"_copyData",value:function(e){if(!at(e)){this._lastMap.set(e,new Map);var t,n=this._lastMap.get(e),r=D(this._currentMap.get(e));try{for(r.s();!(t=r.n()).done;){var o=M(t.value,2),i=o[0],a=o[1];n.set(i,a)}}catch(d){r.e(d)}finally{r.f()}n=null,this._currentMap.set(e,new Map)}}},{key:"getStatResult",value:function(e){if(at(this._currentMap.get(e))||at(this._lastMap.get(e)))return null;if(0===this._lastMap.get(e).size)return this._copyData(e),null;var t=0,n=0;if(this._lastMap.get(e).forEach((function(e,r){var o=T(e.values()),i=o.length,a=o[i-1]-o[0]+1;t+=a,n+=i})),0===t)return null;var r=xt(n/t*100,2);return r>100&&(r=100),this._copyData(e),{totalCount:t,successCountOfMessageReceived:n,successRateOfMessageReceived:r}}},{key:"reset",value:function(){this._currentMap.clear(),this._lastMap.clear()}}]),e}(),hi=function(e){d(r,e);var n=I(r);function r(e){var t;a(this,r),(t=n.call(this,e))._n="QualityStatModule",t.TAG="im-ssolog-quality-stat",t.reportIndex=0,t.wholePeriod=!1,t._qualityItems=[Wn,Yn,zn,Jn,Xn,$n,Zn,Qn,er,tr],t._messageSentItems=[zn,Jn,Xn,$n,Zn],t._messageReceivedItems=[Qn,er,tr],t.REPORT_INTERVAL=120,t.REPORT_SDKAPPID_BLACKLIST=[],t.REPORT_TINYID_WHITELIST=[],t._statInfoArr=[],t._avgRTT=new di,t._avgE2EDelay=new li,t._rateMessageSent=new fi,t._rateMessageReceived=new pi;var o=t.getInnerEmitterInstance();return o.on(Cr.A2KEY_AND_TINYID_UPDATED,t._onLoginSuccess,m(t)),o.on(Cr.CLOUD_CONFIG_UPDATED,t._onCloudConfigUpdated,m(t)),t}return c(r,[{key:"_onLoginSuccess",value:function(){var e=this;this._rateMessageSent.initMap(this._messageSentItems),this._rateMessageReceived.initMap(this._messageReceivedItems);var t=this.getModule(13),n=t.getItem(this.TAG,!1);!Qt(n)&&ut(n.forEach)&&(Ge.l("".concat(this._n,"._onLoginSuccess. logs count:").concat(n.length)),n.forEach((function(t){e._statInfoArr.push(t)})),t.removeItem(this.TAG,!1))}},{key:"_onCloudConfigUpdated",value:function(){var e=this.getCloudConfig("q_rpt_interval"),t=this.getCloudConfig("q_rpt_sdkappid_bl"),n=this.getCloudConfig("q_rpt_tinyid_wl");at(e)||(this.REPORT_INTERVAL=Number(e)),at(t)||(this.REPORT_SDKAPPID_BLACKLIST=t.split(",").map((function(e){return Number(e)}))),at(n)||(this.REPORT_TINYID_WHITELIST=n.split(","))}},{key:"onCheckTimer",value:function(e){this.isLoggedIn()&&e%this.REPORT_INTERVAL==0&&(this.wholePeriod=!0,this._report())}},{key:"addRequestCount",value:function(){this._avgRTT.addRequestCount()}},{key:"addRTT",value:function(e){this._avgRTT.addRTT(e)}},{key:"addMessageDelay",value:function(e){this._avgE2EDelay.addMessageDelay(e)}},{key:"addTotalCount",value:function(e){this._rateMessageSent.addTotalCount(e)||Ge.w("".concat(this._n,".addTotalCount invalid key:"),e)}},{key:"addSuccessCount",value:function(e){this._rateMessageSent.addSuccessCount(e)||Ge.w("".concat(this._n,".addSuccessCount invalid key:"),e)}},{key:"addFailedCountOfUserSide",value:function(e){this._rateMessageSent.addFailedCountOfUserSide(e)||Ge.w("".concat(this._n,".addFailedCountOfUserSide invalid key:"),e)}},{key:"addCost",value:function(e,t){this._rateMessageSent.addCost(e,t)||Ge.w("".concat(this._n,".addCost invalid key or cost:"),e,t)}},{key:"addFileSize",value:function(e,t){this._rateMessageSent.addFileSize(e,t)||Ge.w("".concat(this._n,".addFileSize invalid key or size:"),e,t)}},{key:"addMessageSequence",value:function(e){this._rateMessageReceived.addMessageSequence(e)||Ge.w("".concat(this._n,".addMessageSequence invalid key:"),e.key)}},{key:"_getQualityItem",value:function(e){var n={},r=or[this.getNetworkType()];at(r)&&(r=8);var o={qualityType:nr[e],timestamp:Re(),networkType:r,extension:""};switch(e){case Wn:n=this._avgRTT.getStatResult();break;case Yn:n=this._avgE2EDelay.getStatResult();break;case zn:case Jn:case Xn:case $n:case Zn:n=this._rateMessageSent.getStatResult(e);break;case Qn:case er:case tr:n=this._rateMessageReceived.getStatResult(e)}return null===n?null:t(t({},o),n)}},{key:"_report",value:function(e){var t=this,n=[],r=null;at(e)?this._qualityItems.forEach((function(e){null!==(r=t._getQualityItem(e))&&(r.reportIndex=t.reportIndex,r.wholePeriod=t.wholePeriod,n.push(r))})):null!==(r=this._getQualityItem(e))&&(r.reportIndex=this.reportIndex,r.wholePeriod=this.wholePeriod,n.push(r)),Ge.d("".concat(this._n,"._report"),n),this._statInfoArr.length>0&&(n=n.concat(this._statInfoArr),this._statInfoArr=[]);var o=this.getModule(12),i=o.getSDKAppID(),a=o.getTinyID();Ft(this.REPORT_SDKAPPID_BLACKLIST,i)&&!qt(this.REPORT_TINYID_WHITELIST,a)&&(n=[]),n.length>0&&this._doReport(n)}},{key:"_doReport",value:function(e){var n=this,r={header:ho(this),quality:e};this.request({protocolName:Kn.SSO_STAT,requestData:t({},r)}).then((function(){n.reportIndex++,n.wholePeriod=!1})).catch((function(t){Ge.w("".concat(n._n,"._doReport failed. networkType:").concat(n.getNetworkType()," error:"),t),n._statInfoArr=n._statInfoArr.concat(e),n._flushAtOnce()}))}},{key:"_flushAtOnce",value:function(){var e=this.getModule(13),t=e.getItem(this.TAG,!1),n=this._statInfoArr,r="".concat(this._n,"._flushAtOnce");if(Qt(t))Ge.l("".concat(r," count:").concat(n.length)),e.setItem(this.TAG,n,!0,!1);else{var o=n.concat(t);o.length>10&&(o=o.slice(0,10)),Ge.l("".concat(r," count:").concat(o.length)),e.setItem(this.TAG,o,!0,!1)}this._statInfoArr=[]}},{key:"reset",value:function(){Ge.l("".concat(this._n,".reset")),this._report(),this.reportIndex=0,this.wholePeriod=!1,this.REPORT_SDKAPPID_BLACKLIST=[],this.REPORT_TINYID_WHITELIST=[],this._avgRTT.reset(),this._avgE2EDelay.reset(),this._rateMessageSent.reset(),this._rateMessageReceived.reset()}}]),r}(Hn),gi=c((function e(t){a(this,e),Qt(t)||(this.userID=t.userID||"",this.nick=t.nick||"",this.avatar=t.avatar||"",this.time=t.time||0,this.source=t.source||"",this.wording=t.wording||"",this.type=t.type||"")})),vi=function(){function e(t){a(this,e),this._snsModule=t,this._n="FriendApplicationHandler",this._startTime=0,this._maxLimited=100,this._currentSequence=0,this._friendApplicationMap=new Map,this._unreadCount=0}return c(e,[{key:"getLocalFriendApplicationList",value:function(){return{friendApplicationList:T(this._friendApplicationMap.values()),unreadCount:this._unreadCount}}},{key:"_onFriendApplicationListUpdated",value:function(){this._snsModule.emitOuterEvent(A.FRIEND_APPLICATION_LIST_UPDATED,{friendApplicationList:T(this._friendApplicationMap.values()),unreadCount:this._unreadCount})}},{key:"onFriendApplicationRead",value:function(){this._unreadCount=0,this._onFriendApplicationListUpdated()}},{key:"onFriendApplicationAdded",value:function(e,n){var r=this;if(!Qt(e)){var o;o=n===this._snsModule.getMyUserID()?O.SNS_APPLICATION_SENT_BY_ME:O.SNS_APPLICATION_SENT_TO_ME;var i=!1;e.forEach((function(e){var n="".concat(e.userID,"_").concat(o);o!==O.SNS_APPLICATION_SENT_TO_ME||r._friendApplicationMap.has(n)||(r._unreadCount+=1),r._friendApplicationMap.set(n,new gi(t(t({},e),{},{type:o}))),i=!0})),i&&this._onFriendApplicationListUpdated()}}},{key:"onFriendApplicationDeleted",value:function(e){Qt(e)||(this._startTime=0,this._currentSequence=0,this.getFriendApplicationList())}},{key:"getFriendApplicationList",value:function(){var e=this,t="".concat(this._n,".").concat("getFriendApplicationList"),n=new ar("getFriendApplicationList");return this._snsModule.request({protocolName:Kn.GET_FRIEND_APPLICATION_LIST,requestData:{applicationType:O.SNS_APPLICATION_TYPE_BOTH,fromAccount:this._snsModule.getMyUserID(),maxLimited:this._maxLimited,startTime:this._startTime,lastSequence:this._currentSequence}}).then((function(r){var o=r.data,i=o.resultList,a=o.unreadCount,s=o.startTime,u=o.currentSequence;e._startTime=s,e._currentSequence=u,e._unreadCount=a;var c=it(i)?i.length:0,l="applicationCount:".concat(c," unreadCount:").concat(a," startTime:").concat(s," currentSequence:").concat(u);n.setNetworkType(e._snsModule.getNetworkType()).setMessage(l).end(),Ge.i("".concat(t," ok. ").concat(l)),e._friendApplicationMap.clear(),it(i)&&i.forEach((function(t){var n=t.userID,r=t.type,o=new gi(t);e._friendApplicationMap.set("".concat(n,"_").concat(r),o)})),e._onFriendApplicationListUpdated()})).catch((function(r){return e._snsModule.probeNetwork().then((function(e){var t=M(e,2),o=t[0],i=t[1];n.setError(r,o,i).end()})),Ge.w("".concat(t," failed. error:"),r),jn(r)}))}},{key:"deleteFriendApplication",value:function(e){var t=this,n="".concat(this._n,".").concat("deleteFriendApplication"),r=e.userID,o=e.type;if((!o||o!==O.SNS_APPLICATION_SENT_BY_ME&&o!==O.SNS_APPLICATION_SENT_TO_ME)&&(o=O.SNS_APPLICATION_SENT_TO_ME),!this._friendApplicationMap.has("".concat(r,"_").concat(o)))return jn({code:qn.FRIEND_APPLICATION_NOT_EXIST});var i=new ar("deleteFriendApplication");return i.setMessage("userID:".concat(r," type:").concat(o)),this._snsModule.request({protocolName:Kn.DELETE_FRIEND_APPLICATION,requestData:{fromAccount:this._snsModule.getMyUserID(),userIDList:[r],type:o}}).then((function(e){var a=e.data.resultList,s=a[0],u=s.to,c=s.resultCode,l=s.resultInfo;return i.setNetworkType(t._snsModule.getNetworkType()).setMoreMessage("resultList:".concat(JSON.stringify(a))).end(),Ge.i("".concat(n," ok. userID:").concat(r," type:").concat(o)),0===c?xn():jn({userID:u,code:c,message:l})})).catch((function(e){return t._snsModule.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];i.setError(e,r,o).end()})),Ge.w("".concat(n," failed. error:"),e),jn(e)}))}},{key:"acceptFriendApplication",value:function(e){var t=this,n="".concat(this._n,".").concat("acceptFriendApplication"),r=e.userID,o=e.remark,i=e.tag,a=e.type;(!a||a!==O.SNS_APPLICATION_AGREE&&a!==O.SNS_APPLICATION_AGREE_AND_ADD)&&(a=O.SNS_APPLICATION_AGREE_AND_ADD);var s=new ar("acceptFriendApplication");return s.setMessage("userID:".concat(r," type:").concat(a)),this._snsModule.request({protocolName:Kn.RESPOND_FRIEND_APPLICATION,requestData:{fromAccount:this._snsModule.getMyUserID(),responseFriendItem:[{userID:r,remark:o,tag:i,action:a}]}}).then((function(e){s.setNetworkType(t._snsModule.getNetworkType()).end();var o=e.data.resultList[0],i=o.resultCode,u=o.resultInfo;if(0!==i)return jn({code:i,message:u});Ge.i("".concat(n," ok. userID:").concat(r," type:").concat(a))})).catch((function(e){return t._snsModule.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];s.setError(e,r,o).end()})),Ge.w("".concat(n," failed. error:"),e),jn(e)}))}},{key:"refuseFriendApplication",value:function(e){var t=this,n="".concat(this._n,".").concat("refuseFriendApplication"),r=e.userID,o=new ar("refuseFriendApplication");return o.setMessage("userID:".concat(r)),this._snsModule.request({protocolName:Kn.RESPOND_FRIEND_APPLICATION,requestData:{fromAccount:this._snsModule.getMyUserID(),responseFriendItem:[{userID:r,action:"Response_Action_Reject"}]}}).then((function(e){o.setNetworkType(t._snsModule.getNetworkType()).end();var i=e.data.resultList[0],a=i.resultCode,s=i.resultInfo;if(0!==a)return jn({code:a,message:s});Ge.i("".concat(n," ok. userID:").concat(r))})).catch((function(e){return t._snsModule.probeNetwork().then((function(t){var n=M(t,2),r=n[0],i=n[1];o.setError(e,r,i).end()})),Ge.w("".concat(n," failed. error:"),e),jn(e)}))}},{key:"_onFriendApplicationProcessed",value:function(e){var t=this;if(0!==e.length){var n=!1;e.forEach((function(e){var r="".concat(e.to,"_").concat(O.SNS_APPLICATION_SENT_TO_ME);t._friendApplicationMap.has(r)&&(t._friendApplicationMap.delete(r),t._unreadCount-=1,n=!0)})),this._unreadCount<0&&(this._unreadCount=0),n&&this._onFriendApplicationListUpdated()}}},{key:"setFriendApplicationRead",value:function(){var e=this,t="".concat(this._n,".").concat("setFriendApplicationRead"),n=new ar("setFriendApplicationRead");return this._snsModule.request({protocolName:Kn.REPORT_FRIEND_APPLICATION,requestData:{fromAccount:this._snsModule.getMyUserID(),latestTimeStamp:xt(Re()/1e3,0)}}).then((function(r){n.setNetworkType(e._snsModule.getNetworkType()).end(),Ge.i("".concat(t," ok")),e._unreadCount=0})).catch((function(r){return e._snsModule.probeNetwork().then((function(e){var t=M(e,2),o=t[0],i=t[1];n.setError(r,o,i).end()})),Ge.w("".concat(t," failed. error:"),r),jn(r)}))}},{key:"reset",value:function(){this._startIndex=0,this._maxLimited=100,this._currentSequence=0,this._unreadCount=0,this._friendApplicationMap.clear()}}]),e}(),_i=function(){function e(n,r){a(this,e),this.userID=n,this.remark="",this.groupList=[],this.source="",this.addTime=0,this.friendCustomField=[],this.timestamp=0;var o={},i=[];if(o.userID=n,!Qt(r))for(var s="",u="",c=0,l=r.length;c<l;c++)if(s=r[c].tag,u=r[c].value,s.indexOf("Tag_SNS_Custom")>-1)this.friendCustomField.push({key:s,value:u});else if(s.indexOf("Tag_Profile_Custom")>-1)i.push({key:s,value:u});else switch(s){case Fe.NICK:o.nick=u;break;case Fe.GENDER:o.gender=u;break;case Fe.BIRTHDAY:o.birthday=u;break;case Fe.LOCATION:o.location=u;break;case Fe.SELFSIGNATURE:o.selfSignature=u;break;case Fe.ALLOWTYPE:o.allowType=u;break;case Fe.LANGUAGE:o.language=u;break;case Fe.AVATAR:o.avatar=u;break;case Fe.MESSAGESETTINGS:o.messageSettings=u;break;case Fe.ADMINFORBIDTYPE:o.adminForbidType=u;break;case Fe.LEVEL:o.level=u;break;case Fe.ROLE:o.role=u;break;case Ve:this.remark=u;break;case He:this.addTime=u;break;case qe:this.groupList=JSON.parse(JSON.stringify(u));break;case Be:this.source=u;break;case je:break;default:Ge.l("snsProfileItem unknown tag->",r[c].tag)}this.profile=new Ar(t(t({},o),{},{profileCustomField:i}))}return c(e,[{key:"validate",value:function(e){var t=!0,n="";if(Qt(e))return{valid:!1,tips:"empty options"};if(e.profileCustomField)for(var r=e.profileCustomField.length,o=null,i=0;i<r;i++){if(o=e.profileCustomField[i],!nt(o.key)||-1===o.key.indexOf("Tag_Profile_Custom"))return{valid:!1,tips:"The prefix of keys of the custom profile key-value pairs (which is profileCustomField) must be Tag_Profile_Custom"};if(!nt(o.value))return{valid:!1,tips:"The type of values of the custom profile key-value pairs (which is profileCustomField) must be String"}}for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if("profileCustomField"===a)continue;if(Qt(e[a])&&!nt(e[a])&&!et(e[a])){n="key:"+a+", invalid value:"+e[a],t=!1;continue}switch(a){case"nick":nt(e[a])||(n="nick must be a string",t=!1),gt(e[a])>500&&(n="nick name limited: must less than or equal to ".concat(500," bytes, current size: ").concat(gt(e[a])," bytes"),t=!1);break;case"gender":yt(Ke,e.gender)||(n="key:gender, invalid value:"+e.gender,t=!1);break;case"birthday":et(e.birthday)||(n="birthday must be a number",t=!1);break;case"location":nt(e.location)||(n="location must be a string",t=!1);break;case"selfSignature":nt(e.selfSignature)||(n="selfSignature must be a string",t=!1);break;case"allowType":yt(Ye,e.allowType)||(n="key:allowType, invalid value:"+e.allowType,t=!1);break;case"language":et(e.language)||(n="language must be a number",t=!1);break;case"avatar":nt(e.avatar)||(n="avatar must be a string",t=!1);break;case"messageSettings":0!==e.messageSettings&&1!==e.messageSettings&&(n="messageSettings must be 0 or 1",t=!1);break;case"adminForbidType":yt(We,e.adminForbidType)||(n="key:adminForbidType, invalid value:"+e.adminForbidType,t=!1);break;case"level":et(e.level)||(n="level must be a number",t=!1);break;case"role":et(e.role)||(n="role must be a number",t=!1);break;default:n="unknown key:"+a+"  "+e[a],t=!1}}return{valid:t,tips:n}}},{key:"update",value:function(e){var t="",n="",r=[];this.friendCustomField.forEach((function(e){r.push(e.key)}));for(var o=0,i=e.length;o<i;o++)if(t=e[o].tag,n=e[o].value,t.indexOf("Tag_SNS_Custom")>-1)r.indexOf(t)>-1?this.friendCustomField.forEach((function(e){e.key===t&&(e.value=n)})):this.friendCustomField.push({key:t,value:n});else if(t.indexOf("Tag_Profile_Custom")>-1){var a=!1;this.profile.profileCustomField.forEach((function(e){e.key===t&&(e.value=n,a=!0)})),a||this.profile.profileCustomField.push({key:t,value:n})}else switch(t){case Fe.NICK:this.profile.nick=n;break;case Fe.GENDER:this.profile.gender=n;break;case Fe.BIRTHDAY:this.profile.birthday=n;break;case Fe.LOCATION:this.profile.location=n;break;case Fe.SELFSIGNATURE:this.profile.selfSignature=n;break;case Fe.ALLOWTYPE:this.profile.allowType=n;break;case Fe.LANGUAGE:this.profile.language=n;break;case Fe.AVATAR:this.profile.avatar=n;break;case Fe.MESSAGESETTINGS:this.profile.messageSettings=n;break;case Fe.ADMINFORBIDTYPE:this.profile.adminForbidType=n;break;case Fe.LEVEL:this.profile.level=n;break;case Fe.ROLE:this.profile.role=n;break;case Ve:this.remark=n;break;case He:this.addTime=n;break;case qe:this.groupList=JSON.parse(JSON.stringify(n));break;case Be:this.source=n;break;case je:break;default:Ge.d("snsProfileItem unkown tag->",e[o].tag)}this.timestamp=Date.now(),r.length=0}},{key:"updateProfile",value:function(e){this.profile=JSON.parse(JSON.stringify(e)),this.timestamp=Date.now()}},{key:"addToGroupList",value:function(e){-1===this.groupList.indexOf(e)&&(this.groupList.push(e),this.count=this.groupList.length)}},{key:"removeFromGroupList",value:function(e){var t=this.groupList.indexOf(e);t>-1&&(this.groupList.splice(t,1),this.count=this.groupList.length)}}]),e}(),mi=function(){function e(t){a(this,e),this._snsModule=t,this._n="FriendHandler",this._friendMap=new Map,this._startIndex=0,this._standardSequence=0,this._customSequence=0,this._expirationTime=18e4}return c(e,[{key:"getLocalFriendList",value:function(){return T(this._friendMap.values())}},{key:"getFriendRemark",value:function(e){return this._friendMap.has(e)?this._friendMap.get(e).remark:""}},{key:"onFriendProfileModified",value:function(e){var t=this,n=e.dataList;if(!Qt(n)){var r=this._snsModule.getModule(11);n.forEach((function(e){var n=e.userID,o=e.profileList;if(t.isMyFriend(n)){Ge.l("".concat(t._n,".onFriendProfileModified. friend account:").concat(n,", profileList:").concat(JSON.stringify(o)));var i=t._friendMap.get(n);i.update(o),r.modifyMessageSentByPeer({conversationID:"".concat(O.CONV_C2C).concat(n),latestNick:i.profile.nick,latestAvatar:i.profile.avatar})}})),this._onFriendListUpdated()}}},{key:"onFriendAdded",value:function(e){var t=this;0!==e.length&&(Ge.l("".concat(this._n,".onFriendAdded userIDList:").concat(e)),e.forEach((function(e){t._friendMap.set(e,new _i(e))})),this.getFriendProfile({userIDList:e}).then((function(n){e.forEach((function(e){var n=t._friendMap.get(e);n.groupList.length>0&&t._snsModule.updateWhenFriendAdded({nameList:n.groupList,userID:e})})),t._onFriendListUpdated()})))}},{key:"onFriendDeleted",value:function(e){var t=this;0!==e.length&&(Ge.l("".concat(this._n,".onFriendDeleted userIDList:").concat(e)),e.forEach((function(e){var n=t._friendMap.get(e);n.groupList.length>0&&t._snsModule.updateWhenFriendDeleted({nameList:n.groupList,userID:e}),t._friendMap.delete(e)})),this._onFriendListUpdated())}},{key:"_onFriendListUpdated",value:function(){this._snsModule.emitOuterEvent(A.FRIEND_LIST_UPDATED),this._snsModule.getModule(11).checkAndPatchRemark()}},{key:"getFriendProfile",value:function(e){var t=this,n="".concat(this._n,".").concat("getFriendProfile"),r=e.userIDList,o=[],i=[],a=[];if(r.forEach((function(e){if(t._friendMap.has(e)){var n=t._friendMap.get(e);Date.now()-n.timestamp<t._expirationTime?i.push(n):a.push(e)}else o.push({userID:e,code:qn.NOT_MY_FRIEND,message:t._snsModule.getErrorMessage(qn.NOT_MY_FRIEND)})})),0===a.length)return Ge.i("".concat(n," newUserIDList is empty")),Bn({friendList:i,failureUserIDList:o});var s=new ar("getFriendProfile");return s.setMessage("userIDList:".concat(a)),Ge.i("".concat(n," userIDList:").concat(a)),this._snsModule.request({protocolName:Kn.GET_FRIEND_PROFILE,requestData:{fromAccount:this._snsModule.getMyUserID(),userIDList:a}}).then((function(e){return s.setNetworkType(t._snsModule.getNetworkType()).end(),Ge.i("".concat(n," ok")),e.data.resultList.forEach((function(e){var n,r=e.to,a=e.resultCode,s=e.resultInfo,u=e.tagValueList;at(a)||0===a?(t._friendMap.has(r)?(n=t._friendMap.get(r)).update(u):(n=new _i(r,u),t._friendMap.set(r,n)),i.push(n)):o.push({userID:r,code:a,message:s})})),xn({friendList:i,failureUserIDList:o})})).catch((function(e){return t._snsModule.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];s.setError(e,r,o).end()})),Ge.w("".concat(n," failed. error:"),e),jn(e)}))}},{key:"isMyFriend",value:function(e){return this._friendMap.has(e)}},{key:"pagingGetFriendList",value:function(){var e=this,t="".concat(this._n,".").concat("getFriendList"),n=new ar("getFriendList"),r=Date.now();this._snsModule.request({protocolName:Kn.GET_FRIEND_LIST,requestData:{fromAccount:this._snsModule.getMyUserID(),startIndex:this._startIndex,standardSequence:this._standardSequence,customSequence:this._customSequence}}).then((function(o){var i=o.data,a=i.friendCount,s=i.resultList,u=i.nextStartIndex,c=i.standardSequence,l=i.customSequence,d=i.completeFlag;e._startIndex=u,e._standardSequence=c,e._customSequence=l;var f="friendCount:".concat(a," nextStartIndex:").concat(u," standardSequence:").concat(c," ")+"customSequence:".concat(l," completeFlag:").concat(d," cost:").concat(Xt(r));n.setNetworkType(e._snsModule.getNetworkType()).setMessage(f).end(),Ge.i("".concat(t," ok."),f),Qt(s)||s.forEach((function(t){var n=t.to,r=t.tagValueList;e._friendMap.set(n,new _i(n,r))})),0===d?e.pagingGetFriendList():(e._snsModule.emitOuterEvent(A.FRIEND_LIST_UPDATED),e._pagingGetFriendProfile())})).catch((function(r){return e._snsModule.probeNetwork().then((function(e){var t=M(e,2),o=t[0],i=t[1];n.setError(r,o,i).end()})),Ge.w("".concat(t," failed. error:"),r),jn(r)}))}},{key:"_pagingGetFriendProfile",value:function(){var e=this,t=T(this._friendMap.keys()),n=this._snsModule.getModule(4),r=t.length,o=r<=100?1:Math.ceil(r/100);Ge.l("".concat(this._n,"._pagingGetFriendProfile friendCount:").concat(r," pageCount:").concat(o));for(var i=0;i<o;i++)n.getUserProfile({userIDList:t.slice(100*i,100*(i+1))}).then((function(t){t.data.forEach((function(t){var n=e._friendMap.get(t.userID);n&&n.updateProfile(t)})),e._onFriendListUpdated()}))}},{key:"addFriend",value:function(e){var t=this,n="".concat(this._n,".").concat("addFriend");if(this._friendMap.has(e.to))return jn({code:qn.ALREADY_MY_FRIEND});if(e.wording&&!1===this._snsModule.filterProfanity("wording",e))return jn({code:qn.PROFANITY_FOUND});var r=e.to,o=e.source,i=e.type,a=e.wording,s=e.remark,u=e.groupName,c=i;(!c||c!==O.SNS_ADD_TYPE_SINGLE&&c!==O.SNS_ADD_TYPE_BOTH)&&(c=O.SNS_ADD_TYPE_BOTH);var l=new ar("addFriend");return l.setMessage("to:".concat(r," source:").concat(o," type:").concat(c)),this._snsModule.request({protocolName:Kn.ADD_FRIEND,requestData:{fromAccount:this._snsModule.getMyUserID(),addFriendItem:[{to:r,source:o,wording:a,remark:s,groupName:u}],type:c}}).then((function(e){var r=e.data.resultList;l.setNetworkType(t._snsModule.getNetworkType()).setMoreMessage("resultList:".concat(JSON.stringify(r))).end();var o=r[0],i=o.to,a=o.resultCode,s=o.resultInfo;return Ge.i("".concat(n," ok. to:").concat(i," type:").concat(c," code:").concat(a)),at(a)||0===a?xn({userID:i,code:0}):30539===a?xn({userID:i,code:a,message:t._snsModule.getErrorMessage(a)}):jn({userID:i,code:a,message:t._snsModule.getErrorMessage(a)||s})})).catch((function(e){return t._snsModule.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];l.setError(e,r,o).end()})),Ge.w("".concat(n," failed. error:"),e),jn(e)}))}},{key:"deleteFriend",value:function(e){var t=this,n="".concat(this._n,".").concat("deleteFriend"),r=e.userIDList,o=e.type;r.length>1e3&&(Ge.w("".concat(n," ").concat(Wt(1e3))),r.length=1e3);var i=[],a=[],s=[];if(r.forEach((function(e){t._friendMap.has(e)?s.push(e):i.push({userID:e,code:qn.NOT_MY_FRIEND,message:t._snsModule.getErrorMessage(qn.NOT_MY_FRIEND)})})),0===s.length)return Bn({successUserIDList:a,failureUserIDList:i});var u=o;(!u||u!==O.SNS_DELETE_TYPE_SINGLE&&u!==O.SNS_DELETE_TYPE_BOTH)&&(u=O.SNS_DELETE_TYPE_BOTH);var c=new ar("deleteFriend");return c.setMessage("userIDList:".concat(s," type:").concat(u)),this._snsModule.request({protocolName:Kn.DELETE_FRIEND,requestData:{fromAccount:this._snsModule.getMyUserID(),userIDList:s,type:u}}).then((function(e){c.setNetworkType(t._snsModule.getNetworkType()).end(),Ge.i("".concat(n," ok"));var r=e.data.resultList;return Qt(r)||r.forEach((function(e){var t=e.to,n=e.resultCode,r=e.resultInfo;at(n)||0===n?a.push({userID:t}):i.push({userID:t,code:n,message:r})})),xn({successUserIDList:a,failureUserIDList:i})})).catch((function(e){return t._snsModule.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];c.setError(e,r,o).end()})),Ge.w("".concat(n," error:"),e),jn(e)}))}},{key:"updateFriend",value:function(e){var t=this,n=e.userID,r=e.remark,o=e.friendCustomField;if(!this._friendMap.has(n))return jn({code:qn.NOT_MY_FRIEND});var i="".concat(this._n,".").concat("updateFriend"),a=new ar("updateFriend");a.setMessage("userID:".concat(n," remark:").concat(r," friendCustomField:").concat(o));var s=[];return at(r)||s.push({tag:Ve,value:r}),it(o)&&o.length>0&&o.forEach((function(e){s.push({tag:e.key,value:e.value})})),this._snsModule.request({protocolName:Kn.UPDATE_FRIEND,requestData:{fromAccount:this._snsModule.getMyUserID(),updateItem:[{to:n,snsItem:s}]}}).then((function(e){a.setNetworkType(t._snsModule.getNetworkType()).end(),Ge.i("".concat(i," ok"));var n=e.data.resultList[0],s=n.to,u=n.resultCode,c=n.resultInfo;if(at(u)||0===u){var l=t._friendMap.get(s);return l&&(at(r)||(l.remark=r),it(o)&&o.length>0&&St(l.friendCustomField,o),t._onFriendListUpdated()),xn(l)}return jn({code:u,message:c})})).catch((function(e){return t._snsModule.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];a.setError(e,r,o).end()})),Ge.w("".concat(i," failed. error:"),e),jn(e)}))}},{key:"checkFriend",value:function(e){var t=this,n="".concat(this._n,".").concat("checkFriend"),r=e.userIDList,o=e.type;(!o||o!==O.SNS_CHECK_TYPE_SINGLE&&o!==O.SNS_CHECK_TYPE_BOTH)&&(o=O.SNS_CHECK_TYPE_BOTH);var i=new ar("checkFriend");return i.setMessage("userIDList:".concat(r," type:").concat(o)),this._snsModule.request({protocolName:Kn.CHECK_FRIEND,requestData:{fromAccount:this._snsModule.getMyUserID(),userIDList:r,type:o}}).then((function(e){i.setNetworkType(t._snsModule.getNetworkType()).end(),Ge.i("".concat(n," ok. userIDList:").concat(r," type:").concat(o));var a=[],s=[],u=e.data.resultList;return it(u)&&u.forEach((function(e){var t=e.to,n=e.relation,r=e.resultCode,o=e.resultInfo;at(r)||0===r?a.push({userID:t,code:0,relation:n}):s.push({userID:t,code:r,message:o})})),xn({successUserIDList:a,failureUserIDList:s})})).catch((function(e){return t._snsModule.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];i.setError(e,r,o).end()})),Ge.w("".concat(n," failed. error:"),e),jn(e)}))}},{key:"updateWhenAddedToFriendGroup",value:function(e){var t=this,n=e.name,r=e.userIDList;Ge.l("".concat(this._n,".updateWhenAddedToFriendGroup groupName:").concat(n," userIDList:").concat(r)),n&&!Qt(r)&&r.forEach((function(e){t._friendMap.has(e)&&t._friendMap.get(e).addToGroupList(n)}))}},{key:"updateWhenRemovedFromFriendGroup",value:function(e){var t=this,n=e.name,r=e.userIDList;Ge.l("".concat(this._n,".updateWhenRemovedFromFriendGroup groupName:").concat(n," userIDList:").concat(r)),n&&!Qt(r)&&r.forEach((function(e){t._friendMap.has(e)&&t._friendMap.get(e).removeFromGroupList(n)}))}},{key:"reset",value:function(){this._friendMap.clear(),this._startIndex=0,this._standardSequence=0,this._customSequence=0}}]),e}(),yi=function(){function e(t){a(this,e),Qt(t)||(this.name=t.name||"",this.userIDList=t.userIDList||[],this.count=this.userIDList.length||0)}return c(e,[{key:"addToUserIDList",value:function(e){-1===this.userIDList.indexOf(e)&&(this.userIDList.push(e),this.count=this.userIDList.length)}},{key:"removeFromUserIDList",value:function(e){var t=this.userIDList.indexOf(e);t>-1&&(this.userIDList.splice(t,1),this.count=this.userIDList.length)}}]),e}(),Ii=function(){function e(t){a(this,e),this._snsModule=t,this._n="FriendGroupHandler",this._friendGroupMap=new Map}return c(e,[{key:"getLocalFriendGroupList",value:function(){return T(this._friendGroupMap.values())}},{key:"_emitFriendGroupListUpdated",value:function(){var e=T(this._friendGroupMap.values());this._snsModule.emitOuterEvent(A.FRIEND_GROUP_LIST_UPDATED,e)}},{key:"getFriendGroupList",value:function(){var e=this,t="".concat(this._n,".").concat("getFriendGroupList"),n=new ar("getFriendGroupList");return this._snsModule.request({protocolName:Kn.GET_FRIEND_GROUP_LIST,requestData:{fromAccount:this._snsModule.getMyUserID()}}).then((function(r){n.setNetworkType(e._snsModule.getNetworkType()).end();var o=r.data.resultList;Qt(o)?Ge.i("".concat(t," ok. friend group count:0")):(Ge.i("".concat(t," ok. friend group count:").concat(o.length)),e._friendGroupMap.clear(),o.forEach((function(t){var n=new yi(t);e._friendGroupMap.set(t.name,n)})),e._emitFriendGroupListUpdated())})).catch((function(r){return e._snsModule.probeNetwork().then((function(e){var t=M(e,2),o=t[0],i=t[1];n.setError(r,o,i).end()})),Ge.w("".concat(t," error:"),r),jn(r)}))}},{key:"createFriendGroup",value:function(e){var t=this,n="".concat(this._n,".").concat("createFriendGroup"),r=e.name,o=e.userIDList;if(this._friendGroupMap.has(r))return jn({code:qn.FRIEND_GRP_EXISTED});var i=new ar("createFriendGroup");return i.setMessage("name:".concat(r," userIDList:").concat(o)),this._snsModule.request({protocolName:Kn.CREATE_FRIEND_GROUP,requestData:{fromAccount:this._snsModule.getMyUserID(),groupName:[r],userIDList:it(o)?o:void 0}}).then((function(e){i.setNetworkType(t._snsModule.getNetworkType()).end(),Ge.l("".concat(n," ok. name:").concat(r," userIDList:").concat(o));var a=e.data.resultList,s=[],u=[];a&&a.forEach((function(e){var t=e.to,n=e.resultCode,r=e.resultInfo;if(at(n)||0===n)s.push(t);else{var o={userID:e.to,code:n,message:r};u.push(o)}}));var c=new yi({name:r,userIDList:s});return t._friendGroupMap.set(r,c),t._snsModule.updateWhenAddedToFriendGroup({name:r,userIDList:s}),t._emitFriendGroupListUpdated(),xn({friendGroup:c,failureUserIDList:u})})).catch((function(e){return t._snsModule.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];i.setError(e,r,o).end()})),Ge.w("".concat(n," failed. error:"),e),jn(e)}))}},{key:"deleteFriendGroup",value:function(e){var t=this,n="".concat(this._n,".").concat("deleteFriendGroup"),r=e.name;if(!this._friendGroupMap.has(r))return jn({code:qn.FRIEND_GRP_NOT_EXIST});var o=new ar("deleteFriendGroup");return o.setMessage("name:".concat(r)),this._snsModule.request({protocolName:Kn.DELETE_FRIEND_GROUP,requestData:{fromAccount:this._snsModule.getMyUserID(),nameList:[r]}}).then((function(e){o.setNetworkType(t._snsModule.getNetworkType()).end(),Ge.l("".concat(n," ok. name:").concat(r));var i=t._friendGroupMap.get(r);return i&&(t._snsModule.updateWhenRemovedFromFriendGroup({name:r,userIDList:i.userIDList}),t._friendGroupMap.delete(r),i.userIDList.length=0),t._emitFriendGroupListUpdated(),xn(i)})).catch((function(e){return t._snsModule.probeNetwork().then((function(t){var n=M(t,2),r=n[0],i=n[1];o.setError(e,r,i).end()})),Ge.w("".concat(n," failed. error:"),e),jn(e)}))}},{key:"renameFriendGroup",value:function(e){var t=this,n="".concat(this._n,".").concat("renameFriendGroup"),r=e.oldName,o=e.newName;if(!this._friendGroupMap.has(r))return jn({code:qn.FRIEND_GRP_NOT_EXIST});var i=new ar("renameFriendGroup");return i.setMessage("oldName:".concat(r," newName:").concat(o)),this._snsModule.request({protocolName:Kn.UPDATE_FRIEND_GROUP,requestData:{fromAccount:this._snsModule.getMyUserID(),oldName:r,newName:o}}).then((function(){if(i.setNetworkType(t._snsModule.getNetworkType()).end(),Ge.l("".concat(n," ok. oldName:").concat(r," newName:").concat(o)),t._friendGroupMap.has(r)){var e=t._friendGroupMap.get(r);return e.name=o,t._friendGroupMap.delete(r),t._friendGroupMap.set(o,e),t._snsModule.updateWhenRemovedFromFriendGroup({name:r,userIDList:e.userIDList}),t._snsModule.updateWhenAddedToFriendGroup({name:o,userIDList:e.userIDList}),t._emitFriendGroupListUpdated(),xn(e)}return xn()})).catch((function(e){return t._snsModule.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];i.setError(e,r,o).end()})),Ge.w("".concat(n," failed. error:"),e),jn(e)}))}},{key:"addToFriendGroup",value:function(e){var t=this,n="".concat(this._n,".").concat("addToFriendGroup"),r=e.name,o=e.userIDList;if(!this._friendGroupMap.has(r))return this._onFriendGroupNotExist(r);var i=new ar("addToFriendGroup");return i.setMessage("name:".concat(r," userIDList:").concat(o)),Ge.l("".concat(n," name:").concat(r," userIDList:").concat(o)),this._snsModule.request({protocolName:Kn.UPDATE_FRIEND_GROUP,requestData:{fromAccount:this._snsModule.getMyUserID(),oldName:r,updateGroupItem:o.filter((function(e){return t._snsModule.isMyFriend(e)})).map((function(e){return{to:e,updateType:"Update_Type_Add"}}))}}).then((function(e){return i.setNetworkType(t._snsModule.getNetworkType()).end(),t._onFriendGroupUpdated(r,e)})).catch((function(e){return t._snsModule.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];i.setError(e,r,o).end()})),Ge.w("".concat(n," failed. error:"),e),jn(e)}))}},{key:"removeFromFriendGroup",value:function(e){var t=this,n="".concat(this._n,".").concat("removeFromFriendGroup"),r=e.name,o=e.userIDList;if(!this._friendGroupMap.has(r))return this._onFriendGroupNotExist(r);var i=new ar("removeFromFriendGroup");return i.setMessage("name:".concat(r," userIDList:").concat(o)),Ge.l("".concat(n," name:").concat(r," userIDList:").concat(o)),this._snsModule.request({protocolName:Kn.UPDATE_FRIEND_GROUP,requestData:{fromAccount:this._snsModule.getMyUserID(),oldName:r,updateGroupItem:o.filter((function(e){return t._snsModule.isMyFriend(e)})).map((function(e){return{to:e,updateType:"Update_Type_Delete"}}))}}).then((function(e){return i.setNetworkType(t._snsModule.getNetworkType()).end(),t._onFriendGroupUpdated(r,e)})).catch((function(e){return t._snsModule.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];i.setError(e,r,o).end()})),Ge.w("".concat(n," failed. error:"),e),jn(e)}))}},{key:"_onFriendGroupUpdated",value:function(e,t){var n=t.data.resultList,r=this._friendGroupMap.get(e),o=[],i=[],a=[];return it(n)&&n.forEach((function(e){var t=e.to,n=e.resultCode,s=e.resultInfo,u=e.type;0===n?"Update_Type_Add"===u?r&&(r.addToUserIDList(t),i.push(t)):"Update_Type_Delete"===u&&r&&(r.removeFromUserIDList(t),a.push(t)):o.push({to:e.to,code:n,message:s})})),Ge.l("".concat(this._n,"._onFriendGroupUpdated name:").concat(e," userIDList:").concat(r.userIDList)),i.length>0&&this._snsModule.updateWhenAddedToFriendGroup({name:e,userIDList:i}),a.length>0&&this._snsModule.updateWhenRemovedFromFriendGroup({name:e,userIDList:a}),xn({friendGroup:r,failureUserIDList:o})}},{key:"updateWhenFriendAdded",value:function(e){var t=this,n=e.nameList,r=e.userID;Ge.l("".concat(this._n,".updateWhenFriendAdded userID:").concat(r," nameList:").concat(n)),Qt(n)||n.forEach((function(e){t._friendGroupMap.has(e)&&t._friendGroupMap.get(e).addToUserIDList(r)}))}},{key:"updateWhenFriendDeleted",value:function(e){var t=this,n=e.nameList,r=e.userID;Ge.l("".concat(this._n,".updateWhenFriendDeleted userID:").concat(r," nameList:").concat(n)),Qt(n)||n.forEach((function(e){t._friendGroupMap.has(e)&&t._friendGroupMap.get(e).removeFromUserIDList(r)}))}},{key:"reset",value:function(){this._friendGroupMap.clear()}}]),e}(),Mi=function(e){d(n,e);var t=I(n);function n(e){var r;return a(this,n),(r=t.call(this,e))._n="SnsModule",r._friendHandler=new mi(m(r)),r._friendApplicationHandler=new vi(m(r)),r._friendGroupHandler=new Ii(m(r)),r.getInnerEmitterInstance().on(Cr.A2KEY_AND_TINYID_UPDATED,r.onContextUpdated,m(r)),r}return c(n,[{key:"onContextUpdated",value:function(e){this._friendHandler.pagingGetFriendList(),this._friendGroupHandler.getFriendGroupList(),this._friendApplicationHandler.getFriendApplicationList()}},{key:"onRelationChainModified",value:function(e){var t=this,n=e.dataList;if(!Qt(n)){var r=[],o=[],i=[],a=[],s=!1,u="";n.forEach((function(e){if(3!==e.pushType&&4!==e.pushType||!e.from||(u=e.from),e.friendAddAccount&&(r.push.apply(r,T(e.friendAddAccount)),a.push.apply(a,T(e.friendAddAccount))),e.friendDelAccount&&o.push.apply(o,T(e.friendDelAccount)),e.friendApplicationAdded&&i.push.apply(i,T(e.friendApplicationAdded)),e.friendApplicationDeletedUserIDList&&a.push.apply(a,T(e.friendApplicationDeletedUserIDList)),e.reportTime&&7===e.pushType&&(s=!0),e.friendUpInfo){var n={dataList:[]};e.friendUpInfo.forEach((function(e){n.dataList.push({userID:e.friendAccount,profileList:T(e.sns)})})),t.onFriendProfileModified(n)}})),s&&this._friendApplicationHandler.onFriendApplicationRead(),this._friendApplicationHandler.onFriendApplicationAdded(i,u),this._friendApplicationHandler.onFriendApplicationDeleted(a),this._friendHandler.onFriendAdded(r),this._friendHandler.onFriendDeleted(o)}}},{key:"isMyFriend",value:function(e){return this._friendHandler.isMyFriend(e)}},{key:"filterProfanity",value:function(e,t){var n=this.getModule(29);if(!n)return!0;var r=n.filterText(t[e],"sns"),o=r.isAllowedToSend,i=r.modifiedText;return!0===o&&(t[e]=i,!0)}},{key:"onFriendProfileModified",value:function(e){this._friendHandler.onFriendProfileModified(e)}},{key:"getLocalFriendList",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this._friendHandler.getLocalFriendList();return e?Bn(t):t}},{key:"getFriendRemark",value:function(e){return this._friendHandler.getFriendRemark(e)}},{key:"getFriendList",value:function(){return this._friendHandler.pagingGetFriendList()}},{key:"addFriend",value:function(e){return this._friendHandler.addFriend(e)}},{key:"deleteFriend",value:function(e){return this._friendHandler.deleteFriend(e)}},{key:"checkFriend",value:function(e){return this._friendHandler.checkFriend(e)}},{key:"getFriendProfile",value:function(e){return this._friendHandler.getFriendProfile(e)}},{key:"updateFriend",value:function(e){return this._friendHandler.updateFriend(e)}},{key:"updateWhenAddedToFriendGroup",value:function(e){this._friendHandler.updateWhenAddedToFriendGroup(e)}},{key:"updateWhenRemovedFromFriendGroup",value:function(e){this._friendHandler.updateWhenRemovedFromFriendGroup(e)}},{key:"getLocalFriendApplicationList",value:function(){var e=this._friendApplicationHandler.getLocalFriendApplicationList();return Bn(e)}},{key:"deleteFriendApplication",value:function(e){return this._friendApplicationHandler.deleteFriendApplication(e)}},{key:"refuseFriendApplication",value:function(e){return this._friendApplicationHandler.refuseFriendApplication(e)}},{key:"acceptFriendApplication",value:function(e){return this._friendApplicationHandler.acceptFriendApplication(e)}},{key:"setFriendApplicationRead",value:function(e){return this._friendApplicationHandler.setFriendApplicationRead(e)}},{key:"getLocalFriendGroupList",value:function(){var e=this._friendGroupHandler.getLocalFriendGroupList();return Bn(e)}},{key:"createFriendGroup",value:function(e){return this._friendGroupHandler.createFriendGroup(e)}},{key:"deleteFriendGroup",value:function(e){return this._friendGroupHandler.deleteFriendGroup(e)}},{key:"addToFriendGroup",value:function(e){return this._friendGroupHandler.addToFriendGroup(e)}},{key:"removeFromFriendGroup",value:function(e){return this._friendGroupHandler.removeFromFriendGroup(e)}},{key:"renameFriendGroup",value:function(e){return this._friendGroupHandler.renameFriendGroup(e)}},{key:"onAddToFriendGroup",value:function(e){return this._friendGroupHandler.onAddToFriendGroup(e)}},{key:"updateWhenFriendAdded",value:function(e){this._friendGroupHandler.updateWhenFriendAdded(e)}},{key:"updateWhenFriendDeleted",value:function(e){this._friendGroupHandler.updateWhenFriendDeleted(e)}},{key:"reset",value:function(){Ge.l("".concat(this._n,".reset")),this._friendHandler.reset(),this._friendGroupHandler.reset(),this._friendApplicationHandler.reset()}}]),n}(Hn),Ti=function(e){d(n,e);var t=I(n);function n(e){var r;return a(this,n),(r=t.call(this,e))._n="WorkerTimerModule",r._isWorkerEnabled=!0,r._workerTimer=null,r._timerID=-1,r._init(),r.getInnerEmitterInstance().on(Cr.CLOUD_CONFIG_UPDATED,r._onCloudConfigUpdated,m(r)),r}return c(n,[{key:"isWorkerEnabled",value:function(){return this._isWorkerEnabled&&Te}},{key:"startWorkerTimer",value:function(){Ge.l("".concat(this._n,".startWorkerTimer")),this._workerTimer&&this._workerTimer.postMessage("start")}},{key:"stopWorkerTimer",value:function(){Ge.l("".concat(this._n,".stopWorkerTimer")),this._workerTimer&&this._workerTimer.postMessage("stop")}},{key:"_init",value:function(){if(Te){var e=URL.createObjectURL(new Blob(['let interval = -1;onmessage = function(event) {  if (event.data === "start") {    if (interval > 0) {      clearInterval(interval);    }    interval = setInterval(() => {      postMessage("");    }, 1000);    postMessage(interval);  } else if (event.data === "stop") {    clearInterval(interval);    interval = -1;  }};'],{type:"application/javascript; charset=utf-8"}));this._workerTimer=new Worker(e);var t=this;this._workerTimer.onmessage=function(e){e.data?(t._timerID=e.data,Ge.l("".concat(t._n,"._init seed:").concat(t._timerID))):t._m.onCheckTimer()}}}},{key:"_onCloudConfigUpdated",value:function(){var e=this.getCloudConfig("enable_worker");Ge.l("".concat(this._n,"._onCloudConfigUpdated enableWorker:").concat(e)),at(e)||"1"===e?!this._isWorkerEnabled&&Te&&(this._isWorkerEnabled=!0,this.startWorkerTimer(),this._m.onWorkerTimerEnabled()):this._isWorkerEnabled&&Te&&(this._isWorkerEnabled=!1,this.stopWorkerTimer(),this._m.onWorkerTimerDisabled())}},{key:"terminate",value:function(){Ge.l("".concat(this._n,".terminate")),this._workerTimer&&(this._workerTimer.terminate(),this._workerTimer=null,this._timerID=-1)}},{key:"getTimerID",value:function(){return this._timerID}},{key:"reset",value:function(){Ge.l("".concat(this._n,".reset"))}}]),n}(Hn),Si=function(){function e(){a(this,e),this._n="PurchasedFeatureHandler",this._purchasedFeatureMap=new Map}return c(e,[{key:"isValidPurchaseBits",value:function(e){return e&&"string"==typeof e&&e.length>=1&&e.length<=64&&/[01]{1,64}/.test(e)}},{key:"parsePurchaseBits",value:function(e){if(this.isValidPurchaseBits(e)){this._purchasedFeatureMap.clear();for(var t=null,n=e.length-1,r=0;n>=0;n--,r++)t=r<32?new w(0,Math.pow(2,r)).toString():new w(Math.pow(2,r-32),0).toString(),"1"===e[n]?this._purchasedFeatureMap.set(t,!0):this._purchasedFeatureMap.set(t,!1)}else Ge.w("".concat(this._n,".parsePurchaseBits invalid purchasebits:").concat(e))}},{key:"hasPurchasedFeature",value:function(e){return!!this._purchasedFeatureMap.get(e)}},{key:"isFeatureEnabled",value:function(e){for(var t=parseInt(e).toString(2),n=void 0,r=!0,o=t.length-1,i=0;o>=0;o--,i++)if("1"===t.charAt(o)&&(n=i<32?new w(0,Math.pow(2,i)).toString():new w(Math.pow(2,i-32),0).toString(),!this._purchasedFeatureMap.get(n))){r=!1;break}return Ge.l("".concat(this._n,".isFeatureEnabled decimalNumber:").concat(e," binaryString:").concat(t," ret:").concat(r)),Bn({enabled:r})}},{key:"clear",value:function(){this._purchasedFeatureMap.clear()}}]),e}(),Ei=function(){function e(t){a(this,e),this._m=t,this._n="CommercialConfigModule",this._expiredTime=0,this._isFetching=!1,this._purchasedFeatureHandler=new Si}return c(e,[{key:"_canFetch",value:function(){return this._getModule(12).isLoggedIn()?!this._isFetching&&Date.now()>=this._expiredTime:(this._expiredTime=Date.now()+2e3,!1)}},{key:"onCheckTimer",value:function(e){this._canFetch()&&this.fetchConfig()}},{key:"fetchConfig",value:function(){var e=this,t=this._canFetch(),n="".concat(this._n,".fetchConfig");if(Ge.l("".concat(n," canFetch:").concat(t)),t){var r=this._getModule(15),o=new ar("fetchCommercialConfig");o.setNetworkType(r.getNetworkType());var i=this._getModule(12).getSDKAppID(),a=this._getModule(20);this._isFetching=!0,a.request({protocolName:Kn.FETCH_COMMERCIAL_CONFIG,requestData:{SDKAppID:i}}).then((function(t){o.setMessage("purchaseBits:".concat(t.data.purchaseBits)).end(),Ge.l("".concat(n," ok.")),e._parseConfig(t.data),e._isFetching=!1})).catch((function(t){r.probe().then((function(e){var n=M(e,2),r=n[0],i=n[1];o.setError(t,r,i).end()})),e._isFetching=!1}))}}},{key:"onPushedConfig",value:function(e){var t="".concat(this._n,".onPushedConfig data:").concat(JSON.stringify(e));Ge.l("".concat(t)),new ar("pushedCommercialConfig").setNetworkType(this._getModule(15).getNetworkType()).setMessage("purchaseBits:".concat(e.purchaseBits)).end(),this._parseConfig(e)}},{key:"_parseConfig",value:function(e){var t="".concat(this._n,"._parseConfig"),n=e.errorCode,r=e.errorMessage,o=e.purchaseBits,i=e.expiredTime;0===n?(this._purchasedFeatureHandler.parsePurchaseBits(o),this._expiredTime=Date.now()+1e3*i):at(n)?(Ge.l("".concat(t," failed. Invalid message format:"),e),this._setExpiredTimeOnResponseError(36e5)):(Ge.e("".concat(t," errorCode:").concat(n," errorMessage:").concat(r)),this._setExpiredTimeOnResponseError(12e4))}},{key:"_setExpiredTimeOnResponseError",value:function(e){this._expiredTime=Date.now()+e}},{key:"canIUse",value:function(e){return this._purchasedFeatureHandler.hasPurchasedFeature(e)}},{key:"isFeatureEnabled",value:function(e){return this._purchasedFeatureHandler.isFeatureEnabled(e)}},{key:"_getModule",value:function(e){return this._m.getModule(e)}},{key:"reset",value:function(){Ge.l("".concat(this._n,".reset")),this._expiredTime=0,this._isFetching=!1,this._purchasedFeatureHandler.clear()}}]),e}(),Ci=function(e){d(n,e);var t=I(n);function n(e){var r;return a(this,n),(r=t.call(this,e))._m=e,r._n="OfflinePushModule",r._offlinePushPlugin=void 0,r._androidPushConfig={huaweiPushBussinessId:"",xiaomiPushBussinessId:"",xiaomiPushAppId:"",xiaomiPushAppKey:"",meizuPushBussinessId:"",meizuPushAppId:"",meizuPushAppKey:"",vivoPushBussinessId:"",fcmPushBussinessId:"",oppoPushBussinessId:"",oppoPushAppKey:"",oppoPushAppSecret:"",honorPushBussinessId:""},r._deviceToken="",r._businessID=0,r._iosBusinessID=0,r._c2cUnreadCount=0,r._groupUnreadCount=0,r._isWebUniapp=0,r}return c(n,[{key:"registerPlugin",value:function(e){if(J){this._offlinePushPlugin=e["tim-offline-push-plugin"];var t=e.offlinePushConfig||{},n=t.huaweiBusinessID,r=t.xiaomiBusinessID,o=t.xiaomiAppID,i=t.xiaomiAppKey,a=t.meizuBusinessID,s=t.meizuAppID,u=t.meizuAppKey,c=t.vivoBusinessID,l=t.oppoBusinessID,d=t.oppoAppKey,f=t.oppoAppSecret,p=t.honorBusinessID,h=t.iosBusinessID;this._androidPushConfig.huaweiPushBussinessId=n,this._androidPushConfig.xiaomiPushBussinessId=r,this._androidPushConfig.xiaomiPushAppId=o,this._androidPushConfig.xiaomiPushAppKey=i,this._androidPushConfig.meizuPushBussinessId=a,this._androidPushConfig.meizuPushAppId=s,this._androidPushConfig.meizuPushAppKey=u,this._androidPushConfig.vivoPushBussinessId=c,this._androidPushConfig.oppoPushBussinessId=l,this._androidPushConfig.oppoPushAppKey=d,this._androidPushConfig.oppoPushAppSecret=f,this._androidPushConfig.honorPushBussinessId=p,new ar("registerPlugin").setMessage("tim-offline-push-plugin").setMoreMessage("isExist:".concat(!at(this._offlinePushPlugin))).end(!0),Ge.l("".concat(this._n,".").concat("registerPlugin"," ok. offlinePushConfig:").concat(JSON.stringify(e.offlinePushConfig))),this._iosBusinessID=h,this._setAppShowListener()}else this.outputWarning("OfflinePushInUniapp")}},{key:"init",value:function(){this._isWebUniapp=this.getUniAppPlatform(),this._getDeviceToken()}},{key:"_getDeviceToken",value:function(){var e=this,t="".concat(this._n,".").concat("_getDeviceToken");if(ut(this._offlinePushPlugin.getDeviceToken)){var n="androidPushConfig:".concat(JSON.stringify(this._androidPushConfig),", iosBusinessID:").concat(this._iosBusinessID);Ge.l("".concat(t," start. ").concat(n)),new ar("_getDeviceToken").setMessage("".concat(n)).end(!0),this._offlinePushPlugin.getDeviceToken(this._androidPushConfig,(function(r){var o=new ar("getDeviceTokenRes"),i=r.code,a=r.msg;if(0===i){var s=r.data,u=s.deviceToken,c=s.deviceBrand,l=s.deviceType,d=s.bussinessId;e._deviceToken=u,e._businessID=d||e._iosBusinessID,n="deviceToken:".concat(u,", deviceBrand:").concat(c||l,", businessID:").concat(e._businessID),Ge.l("".concat(t," ok. ").concat(n)),o.setMessage(n).end(!0),e._setToken()}else o.setMessage("code:".concat(i,", msg:").concat(a)).end(!0),Ge.e("".concat(t," failed. error:"),r)}))}else Ge.e("".concat(t," getDeviceToken is not a function"))}},{key:"canIUseOfflinePush",value:function(){return J&&!at(this._offlinePushPlugin)}},{key:"_setAppShowListener",value:function(){var e=this,t="".concat(this._n,".").concat("_setAppShowListener");at(this._offlinePushPlugin)?Ge.e("".concat(t," offlinePushPlugin is undefined")):ut(this._offlinePushPlugin.setAppShowListener)?(new ar("_setAppShowListener").end(!0),Ge.l("".concat(t," start")),this._offlinePushPlugin.setAppShowListener((function(n){var r=(n||{}).appShow;new ar("setAppShowListenerRes").setMessage("appShow:".concat(r)).end(!0),Ge.l("".concat(t," ok. appShow:").concat(r)),e._m.isReady()&&(0===r?(e._getConvUnreadCount(),e._onBackground()):1===r&&e._onForeground())}))):Ge.e("".concat(t," setAppShowListener is not a function"))}},{key:"getDeviceBrand",value:function(){if(!at(this._offlinePushPlugin)&&ut(this._offlinePushPlugin.getDeviceType)){var e=(this._offlinePushPlugin.getDeviceType()||{}).deviceType;return Ge.l("".concat(this._n,".getDeviceBrand ok. deviceType:").concat(e)),e}}},{key:"_setToken",value:function(){var e,t=this,n="".concat(this._n,"._setToken"),r=this.getModule(12),o=1,i="",a="";Qt(this._deviceToken)&&(o=0);var s=this.getUniAppPlatform(),u=this.getDeviceBrand();s===P.IOS||s===P.IPAD||s===P.MAC?a=this._deviceToken:s===P.ANDROID&&(i=this._deviceToken);var c=new ar("offlinePushSetToken");return e="deviceToken:".concat(a||i,", businessID:").concat(this._businessID,", ")+"deviceBrand:".concat(u,", isWebUniapp:").concat(this._isWebUniapp,", pushMsg:").concat(o,", platform:").concat(s),c.setMessage("".concat(e)),Ge.l("".concat(n," ").concat(e)),this.request({protocolName:Kn.SET_TOKEN,requestData:{tokenID:i,pushMsg:o,sdkAppID:r.getSDKAppID(),businessID:parseInt(this._businessID),deviceBrand:u,deviceToken:a,isWebUniapp:this._isWebUniapp}}).then((function(e){return c.end(),Ge.l("".concat(n," ok")),e})).catch((function(e){return t.probeNetwork().then((function(t){var n=M(t,2),r=n[0],o=n[1];c.setError(e,r,o).end()})),Ge.e("".concat(n," failed. error:"),e),jn(e)}))}},{key:"_getConvUnreadCount",value:function(){var e=this;this._c2cUnreadCount=0,this._groupUnreadCount=0,this.getModule(11).getLocalConversationList().forEach((function(t){t.type===O.CONV_C2C&&(e._c2cUnreadCount+=t.unreadCount),t.type===O.CONV_GROUP&&(e._groupUnreadCount+=t.unreadCount)}))}},{key:"_onBackground",value:function(){var e=this,t="".concat(this._n,".").concat("_onBackground"),n=new ar("_onBackground");this.request({protocolName:Kn.STAT_BACKGROUND,requestData:{c2cUnreadCount:this._c2cUnreadCount,groupUnreadCount:this._groupUnreadCount,isWebUniapp:this._isWebUniapp}}).then((function(r){return n.setMessage("c2cUnreadCount: ".concat(e._c2cUnreadCount,", groupUnreadCount: ").concat(e._groupUnreadCount)).end(),Ge.l("".concat(t," ok")),r})).catch((function(r){e.probeNetwork().then((function(e){var t=M(e,2),o=t[0],i=t[1];n.setError(r,o,i).end()})),Ge.e("".concat(t," failed. error:"),r)}))}},{key:"_onForeground",value:function(){var e=this,t="".concat(this._n,".").concat("_onForeground"),n=new ar("_onForeground");this.request({protocolName:Kn.STAT_FOREGROUND,requestData:{isWebUniapp:this._isWebUniapp}}).then((function(e){return n.end(),Ge.l("".concat(t," ok")),e})).catch((function(r){e.probeNetwork().then((function(e){var t=M(e,2),o=t[0],i=t[1];n.setError(r,o,i).end()})),Ge.e("".concat(t," failed. error:"),r)}))}},{key:"getUniAppPlatform",value:function(){var e=o.getSystemInfoSync().platform,t=this.getDeviceBrand();return"ios"===e?P.IOS:"android"===e?P.ANDROID:1002===t?P.IPAD:1001===t?P.MAC:void 0}},{key:"reset",value:function(){this._deviceToken="",this._businessID=0,this._c2cUnreadCount=0,this._groupUnreadCount=0,this._isWebUniapp=0,Ge.l("".concat(this._n,".reset"))}}]),n}(Hn),ki=function(e){d(n,e);var t=I(n);function n(e){var r;return a(this,n),(r=t.call(this,e))._n="ProfanityFilterModule",r._plugin=null,r._filterConfigMap=new Map,r._startIndex=0,r._version=0,r._canIUseLexicon=!1,r._isFetching=!1,r._expiredTime=0,r}return c(n,[{key:"init",value:function(){var e=this.getModule(18).getPlugin("tim-profanity-filter-plugin");e?(this._plugin=new e({logger:Ge,isArray:it,isMap:Ze,isDevMode:this.isDevMode()}),this._getLexicon()):this.outputWarning("ProfanityPluginNotFound")}},{key:"onCheckTimer",value:function(){this._plugin&&this._canIUseLexicon&&this.isLoggedIn()&&!this._isFetching&&Date.now()>=this._expiredTime&&this._getLexicon()}},{key:"filterMessage",value:function(e,t){var n=!0;if(!this._plugin||!this._canIUseLexicon)return n;if(t&&t.messageControlInfo&&!0===t.messageControlInfo.excludedFromContentModeration)return n;var r=e.type,o=e.conversationType;if(r!==O.MSG_TEXT&&r!==O.MSG_CUSTOM)return n;var i,a="".concat(this._n,".filterMessage");if(Ge.l("".concat(a)),r===O.MSG_TEXT){if(o===O.CONV_C2C?i="c2c_text_message":o===O.CONV_GROUP&&(i="group_text_message"),!this._isConfigOn(i))return n;var s=this._plugin.filter(e.payload.text),u=s.type,c=s.modifiedText;1===u?n=!1:2===u&&(e.payload.text=c)}else if(r===O.MSG_CUSTOM){if(o===O.CONV_C2C?i="c2c_custom_message":o===O.CONV_GROUP&&(i="group_custom_message"),!this._isConfigOn(i))return n;var l=this._plugin.filter(e.payload.data),d=this._plugin.filter(e.payload.description),f=this._plugin.filter(e.payload.extension);1===l.type||1===d.type||1===f.type?n=!1:(2===l.type&&(e.payload.data=l.modifiedText),2===d.type&&(e.payload.description=d.modifiedText),2===f.type&&(e.payload.extension=f.modifiedText))}return Ge.l("".concat(a," done. isAllowedToSend:").concat(n)),n}},{key:"filterText",value:function(e,t){var n="".concat(this._n,".filterText"),r={isAllowedToSend:!0,modifiedText:e};if(!this._plugin||!this._canIUseLexicon)return r;if(!this._isConfigOn(t))return r;Ge.l("".concat(n));var o=this._plugin.filter(e),i=o.type,a=o.modifiedText;return 1===i?r.isAllowedToSend=!1:2===i&&(r.modifiedText=a),Ge.l("".concat(n," done. ret:"),r),r}},{key:"_getLexicon",value:function(){var e=this,t=new ar("profanityFilter"),n="".concat(this._n,"._getLexicon");this._isFetching=!0,this.request({protocolName:Kn.GET_PROFANITY_LIST,requestData:{startIndex:this._startIndex,version:this._version}}).then((function(r){var o=r.data,i=o.errorInfo,a=o.filterConfig,s=o.lexicon,u=o.strToken,c=o.completeFlag,l=o.nextStartIndex,d=o.version,f=o.expiredTime,p=i.errorCode,h=i.errorMessage;return 0!==p?(e._isFetching=!1,Ge.w("".concat(n," failed. error:"),i),void t.setCode(p).setMessage(h).end()):(e._onFilterConfig(a),e._getToken(u),1===c?(Ge.l("".concat(n," done. version:").concat(d," expiredTime:").concat(f)),e._version=d,e._canIUseLexicon=!0,e._isFetching=!1,e._expiredTime=Date.now()+1e3*f,void e._plugin.onLexiconCompleted(s)):(e._startIndex=l,e._plugin.onLexiconSliced(s),void e._getLexicon()))})).catch((function(r){e.probeNetwork().then((function(e){var n=M(e,2),o=n[0],i=n[1];t.setError(r,o,i).end()})),e._isFetching=!1,Ge.l("".concat(n," failed. error:"),r)}))}},{key:"_onFilterConfig",value:function(e){var t=this;Qt(e)||(this._filterConfigMap.clear(),Object.keys(e).forEach((function(n){t._filterConfigMap.set(n,e[n])})),Ge.l("".concat(this._n,"._onFilterConfig. keys:").concat(Array.from(this._filterConfigMap.keys())," values:").concat(Array.from(this._filterConfigMap.values()))))}},{key:"_isConfigOn",value:function(e){return 1===this._filterConfigMap.get(e)}},{key:"_getToken",value:function(e){if(nt(e)){var t=e.length,n="";if(t%2==0)for(var r=0;r<=t-1;r+=2)n+=e[r+1],n+=e[r];else{for(var o=0;o<t-1;o+=2)n+=e[o+1],n+=e[o];n+=e[t-1]}this._plugin.onToken(n)}}},{key:"reset",value:function(){Ge.l("".concat(this._n,".reset")),this._plugin&&(this._plugin.reset(),this._plugin=null),this._filterConfigMap.clear(),this._startIndex=0,this._version=0,this._canIUseLexicon=!1,this._isFetching=!1,this._expiredTime=0}}]),n}(Hn),bi=function(){function e(t){a(this,e),this._m=t,this._n="TransCmdModule",this._TRTCCommandList=["tui_room_svr.*","callkit_records_svr.*","room_engine_srv.*","room_engine_http_srv.*","room_engine_mic.*"],this._TRTCCommandMap=new Map,this._setTRTCCommandMap(),this._m.getInnerEmitterInstance().on(Cr.CLOUD_CONFIG_UPDATED,this._onCloudConfigUpdated,this)}return c(e,[{key:"_onCloudConfigUpdated",value:function(){var e=this,t=this._m.getModule(23).getCloudConfig("rtc_cmd");at(t)||((t=JSON.parse(t)).forEach((function(t){e._TRTCCommandList.includes(t)||e._TRTCCommandList.push(t)})),this._setTRTCCommandMap())}},{key:"_setTRTCCommandMap",value:function(){for(var e=null,t=0,n=this._TRTCCommandList.length;t<n;t++)e=this._TRTCCommandList[t].split(".")[0],this._TRTCCommandMap.set(e,1)}},{key:"onRoomCustomDataReceived",value:function(e){this._m.getOuterEmitterInstance().emit(A.ROOM_CUSTOM_DATA_RECEIVED,e)}},{key:"sendTRTCCustomData",value:function(e){var t=e.serviceCommand,n=e.data,r="".concat(F.NAME.TUIROOM_SVR,".*");return at(t)||(r=t),this._isValidServiceCommand(r)?this._trans({servcmd:r,data:n}):jn({code:qn.INVALID_TRTC_CMD})}},{key:"_trans",value:function(e){Ge.d("".concat(this._n,"._trans. options:").concat(JSON.stringify(e)));var t=e.servcmd,n=e.data;return this._m.getModule(20).trans({servcmd:t,data:nt(n)?JSON.parse(n):n})}},{key:"_isValidServiceCommand",value:function(e){if(e.endsWith(".*"))return this._TRTCCommandList.includes(e);var t=e.split(".")[0];return this._TRTCCommandMap.has(t)}},{key:"isTRTCCommand",value:function(e){var t=e.split(".")[0];return this._TRTCCommandMap.has(t)}},{key:"reset",value:function(){Ge.l("".concat(this._n,".reset"))}}]),e}(),Di=function(){function e(t){a(this,e),this._m=t,this._n="ErrorMessageModule",this.TIM_ERROR_ASSISTANCE="tim_error_assistance",this.STORAGE_EXPIRES_TIME=6048e5,this._map=new Map,this._init()}return c(e,[{key:"_init",value:function(){var e=this._getStorageModule().getItem(this.TIM_ERROR_ASSISTANCE,!1);if(e){var t;try{t=JSON.parse(e)}catch(n){this._getStorageModule().removeItem(this.TIM_ERROR_ASSISTANCE,!1),Ge.w("".concat(this._n,"._init error:"),n)}t&&(this._needToUpdate(t)?this._fetch():this._fillMap(t.message))}else this._fetch()}},{key:"_needToUpdate",value:function(e){var t=e.localSavedTime,n=e.localSavedVersion,r=t&&(new Date).getTime()-t>=this.STORAGE_EXPIRES_TIME,o=!n||"3.2.3"!==n;return Ge.l("".concat(this._n,"._needToUpdate isTimeout:").concat(r," isDifferentVersion:").concat(o)),r||o}},{key:"_fetch",value:function(){if(!this._m.getModule(12).isPrivateNetWork()){var e="https://web.sdk.qcloud.com/im/download/error-message/v3/0.0.4/tim-error-message.txt",t="application/x-www-form-urlencoded;charset=UTF-8",n="".concat(this._n,"._fetch ok in"),r=this;if($)Q.request({url:e,method:"GET",timeout:3e3,header:{"content-type":t},dataType:"text",success:function(e){r._fillAndSave(e.data),Ge.l("".concat(n," mini program"))},fail:function(){}});else{var o=new XMLHttpRequest,i=setTimeout((function(){o.abort()}),3e3);o.onreadystatechange=function(){4===o.readyState&&(clearTimeout(i),200!==o.status&&304!==o.status||(Ge.l("".concat(n," browser")),r._fillAndSave(o.responseText)))},o.open("GET",e,!0),o.setRequestHeader("Content-type",t),o.send()}}}},{key:"_fillAndSave",value:function(e){this._fillMap(e),this._getStorageModule().setItem(this.TIM_ERROR_ASSISTANCE,JSON.stringify({message:e,localSavedTime:(new Date).getTime(),localSavedVersion:"3.2.3"}),!0,!1)}},{key:"_getStorageModule",value:function(){return this._m.getModule(13)}},{key:"_fillMap",value:function(e){this._map.clear();for(var t,n,r,o=e.split(";\n"),i=o.length,a=new RegExp(/'/g),s=0;s<i;s++)if(t=o[s].indexOf(":"),n=o[s].slice(0,t),r=o[s].slice(t+1,o[s].length),!n.startsWith("//")){if(at(r))continue;this._map.set(n,r.replace(a,""))}}},{key:"get",value:function(e){var t=e.isIntl,n=e.key,r=e.replacement1,o=e.replacement2,i="".concat(n,t?"_en":"_cn");!this._map.has(i)&&this._map.has(n)&&(i=n);var a="";return this._map.has(i)?(a=this._map.get(i),at(r)||(a=a.replace("$replacement1",r)),at(o)||(a=a.replace("$replacement2",o)),a):a}},{key:"reset",value:function(){Ge.l("".concat(this._n,".reset"))}}]),e}(),Ai=function(){function e(t){a(this,e),this._n="RemoteSignalingHandler",this._signalingModule=t}return c(e,[{key:"onNewMessageList",value:function(e){var t=this,n=this._signalingModule.filterMessageList(e);n.length>0&&n.forEach((function(e){var n=t.getPayloadData(e);n&&t._handleActionType(n,e)}))}},{key:"onMessageModified",value:function(e){var t=this,n=this._signalingModule.filterMessageList(e);n.length>0&&n.forEach((function(e){var n=t.getPayloadData(e);n&&t._onInvitationModified(n,e)}))}},{key:"getPayloadData",value:function(e){var t="".concat(this._n,".getPayloadData"),n=e.payload.data;try{return JSON.parse(n)}catch(a){return Ge.e("".concat(t," JSON parse error. signalingData:").concat(n)),null}}},{key:"_handleActionType",value:function(e,t){switch(e.actionType){case R.ACTION_TYPE_INVITE:this._onNewInvitationReceived(e,t);break;case R.ACTION_TYPE_REJECT_INVITE:this._onInviteeRejected(e);break;case R.ACTION_TYPE_ACCEPT_INVITE:this._onInviteeAccepted(e);break;case R.ACTION_TYPE_CANCEL_INVITE:this._onInvitationCancelled(e);break;case R.ACTION_TYPE_INVITE_TIMEOUT:this._onInvitationTimeout(e)}}},{key:"_createDefaultEmitData",value:function(e){return{inviteID:e.inviteID,inviter:e.inviter,groupID:e.groupID,data:e.data||""}}},{key:"_onNewInvitationReceived",value:function(e,n){var r="".concat(this._n,"._onNewInvitationReceived"),o=e.inviteID,i=e.inviteeList,a=e.groupID,s=e.inviter,u=this._signalingModule.getMyUserID(),c=i.includes(u),l=Math.round(e.timeout-((new Date).getTime()-1e3*n.time)/1e3);if(Ge.l("".concat(r," myselfIncluded:").concat(c," groupID:").concat(a," timeout:").concat(l,"s signalObj:").concat(JSON.stringify(e))),a&&c||!a){var d=this._signalingModule.getInviteInfo(o);if(d&&d===e)return;d||this._signalingModule.setInviteInfo(o,t(t({},e),{},{message:n})),this._signalingModule.emitEvent(R.NEW_INVITATION_RECEIVED,t(t({},this._createDefaultEmitData(e)),{},{inviteeList:i})),s!==u&&this._signalingModule.startTimer(t(t({},e),{},{timeout:l}))}}},{key:"_onInviteeRejected",value:function(e){var n="".concat(this._n,"._onInviteeRejected"),r=e.inviteID,o=e.inviter,i=e.groupID,a=this._signalingModule.hasInviteInfo(r);Ge.l("".concat(n," inviteID:").concat(r," hasInviteID:").concat(a," inviter:").concat(o," groupID:").concat(i)),(i&&a||!i)&&(this._signalingModule.updateInviteInfo(e),this._signalingModule.emitEvent(R.INVITEE_REJECTED,t(t({},this._createDefaultEmitData(e)),{},{invitee:e.inviteeList[0]})))}},{key:"_onInviteeAccepted",value:function(e){var n="".concat(this._n,"._onInviteeAccepted"),r=e.inviteID,o=e.inviter,i=e.groupID,a=this._signalingModule.hasInviteInfo(r);Ge.l("".concat(n," inviteID:").concat(r," hasInviteID:").concat(a," inviter:").concat(o," groupID:").concat(i)),(i&&a||!i)&&(this._signalingModule.updateInviteInfo(e),this._signalingModule.emitEvent(R.INVITEE_ACCEPTED,t(t({},this._createDefaultEmitData(e)),{},{invitee:e.inviteeList[0]})))}},{key:"_onInvitationCancelled",value:function(e){var t="".concat(this._n,"._onInvitationCancelled"),n=e.inviteID,r=e.inviter,o=e.groupID,i=this._signalingModule.hasInviteInfo(n);Ge.l("".concat(t," inviteID:").concat(n," hasInviteID:").concat(i," inviter:").concat(r," groupID:").concat(o)),(o&&i||!o)&&(this._signalingModule.deleteInviteInfo(n),this._signalingModule.emitEvent(R.INVITATION_CANCELLED,this._createDefaultEmitData(e)))}},{key:"_onInvitationTimeout",value:function(e){var n="".concat(this._n,"._onInvitationTimeout"),r=e.inviteID,o=e.inviter,i=e.groupID,a=e.inviteeList,s=this._signalingModule.hasInviteInfo(r);Ge.l("".concat(n," inviteID:").concat(r," hasInviteID:").concat(s," inviter:").concat(o," groupID:").concat(i,"  data:").concat(e.data)),(i&&s||!i)&&(this._signalingModule.updateInviteInfo(e),this._signalingModule.emitEvent(R.INVITATION_TIMEOUT,t(t({},this._createDefaultEmitData(e)),{},{inviteeList:a,isSelfTimeout:!1})))}},{key:"_onInvitationModified",value:function(e,n){var r="".concat(this._n,"._onInvitationModified"),o=e.inviteID,i=e.data;Ge.l("".concat(r," inviteID:").concat(o," data:").concat(i)),this._signalingModule.setInviteInfo(o,t(t({},e),{},{message:n})),this._signalingModule.emitEvent(R.INVITATION_MODIFIED,{inviteID:o,data:i})}}]),e}(),Oi=function(e){if(e<0||e>53)return NaN;var t=0|1073741824*Math.random();return e>30?t+1073741824*(0|Math.random()*(1<<e-30)):t>>>30-e},Ri=function(e,t){for(var n=e.toString(16),r=t-n.length,o="0";r>0;r>>>=1,o+=o)1&r&&(n=o+n);return n},Ni=function(){function e(t){a(this,e),this._n="LocalSignalingHandler",this._signalingModule=t}return c(e,[{key:"generateInviteID",value:function(){var e,t,n=(t=Ri)((e=Oi)(32),8)+"-"+t(e(16),4)+"-"+t(16384|e(12),4)+"-"+t(32768|e(14),4)+"-"+t(e(48),12);return Ge.l("".concat(this._n,".generateInviteID inviteID:").concat(n)),n}},{key:"createInviteInfo",value:function(e){var n=this.generateInviteID(),r=this.createInviteCustomData(t(t({},e),{},{inviteID:n})),o=r.groupID,i=r.inviteeList,a=o||i[0];return{customData:r,message:this.createSignalingMessage(r,a),inviteID:n}}},{key:"_createDefaultCustomData",value:function(e){var t=e.data,n=void 0===t?"":t,r=e.inviteID,o=void 0===r?"":r,i=e.groupID;return{businessID:1,timeout:0,data:n,inviteID:o,groupID:void 0===i?"":i}}},{key:"createInviteCustomData",value:function(e){var n=e.userID,r=e.timeout,o=void 0===r?0:r,i=e.groupID,a=void 0===i?"":i,s=this._signalingModule.getMyUserID(),u=t(t({},this._createDefaultCustomData(e)),{},{actionType:R.ACTION_TYPE_INVITE,inviter:s,inviteeList:a?e.inviteeList:[n],timeout:o});return Ge.l("".concat(this._n,".createInviteCustomData customData:").concat(JSON.stringify(u))),u}},{key:"createCancelCustomData",value:function(e){var n,r="".concat(this._n,".createCancelCustomData"),o=e.inviteID,i=this._signalingModule.getMyUserID(),a=this._signalingModule.getInviteInfo(o),s=a.inviteeList,u=a.groupID,c=a.inviter;return c===i?n=t(t({},this._createDefaultCustomData(e)),{},{actionType:R.ACTION_TYPE_CANCEL_INVITE,groupID:u,inviter:i,inviteeList:s}):Ge.e("".concat(r," unmatched inviter:").concat(c," and my userID:").concat(i)),Ge.l("".concat(r," customData:").concat(JSON.stringify(n))),n}},{key:"createAcceptCustomData",value:function(e){var n,r="".concat(this._n,".createAcceptCustomData"),o=e.inviteID,i=this._signalingModule.getMyUserID(),a=this._signalingModule.getInviteInfo(o),s=a.inviter,u=a.groupID;return a.inviteeList.includes(i)?n=t(t({},this._createDefaultCustomData(e)),{},{actionType:R.ACTION_TYPE_ACCEPT_INVITE,groupID:u,inviter:s,inviteeList:[i]}):Ge.e("".concat(r," userID:").concat(i," not in inviteeList. inviteID:").concat(o," groupID:").concat(u)),Ge.l("".concat(r," customData:").concat(JSON.stringify(n))),n}},{key:"createRejectCustomData",value:function(e){var n,r="".concat(this._n,".createRejectCustomData"),o=e.inviteID,i=this._signalingModule.getMyUserID(),a=this._signalingModule.getInviteInfo(o),s=a.inviter,u=a.groupID;return a.inviteeList.includes(i)?n=t(t({},this._createDefaultCustomData(e)),{},{actionType:R.ACTION_TYPE_REJECT_INVITE,groupID:u,inviter:s,inviteeList:[i]}):Ge.e("".concat(r," userID:").concat(i," not in inviteeList. inviteID:").concat(o," groupID:").concat(u)),Ge.l("".concat(r," customData:").concat(JSON.stringify(n))),n}},{key:"createTimeoutCustomData",value:function(e){var n="".concat(this._n,".createTimeoutCustomData"),r=e.inviteeList,o=e.inviter,i=e.isInviter,a=void 0!==i&&i,s=this._signalingModule.getMyUserID(),u=t(t({},this._createDefaultCustomData(e)),{},{actionType:R.ACTION_TYPE_INVITE_TIMEOUT,inviter:o,inviteeList:a?r:[s]});return Ge.l("".concat(n," customData:").concat(JSON.stringify(u))),u}},{key:"createSignalingMessage",value:function(e,t){var n=e.groupID,r=e.inviter,o=this._signalingModule.getModule(2),i={to:t||n||r,conversationType:n?O.CONV_GROUP:O.CONV_C2C,priority:O.MSG_PRIORITY_HIGH,payload:{data:JSON.stringify(e)}},a=o.createCustomMessage(i);return Ge.d("".concat(this._n,".createSignalingMessage. message:").concat(JSON.stringify(a))),a}}]),e}(),wi=function(){function e(t){a(this,e),this._n="HistorySignalingHandler",this._signalingModule=t,this.EXPIRED_TIME=3e4,this.COUNT=20,this._signalingMap=new Map,this._signalingRelatedToMeMap=new Map}return c(e,[{key:"getHistorySignaling",value:function(){var e=this,t=this._signalingModule.getModule(11).getLocalConversationList();Qt(t)||this._getSignalingList(t).then((function(t){e._handleSignalingList(t)}))}},{key:"_getSignalingList",value:function(e){var t=this,n=this._getValidConversationList(e),r=this._createPromiseList(n);return Qt(r)?Promise.resolve([]):this._concurrentGetMessageList(r).then((function(e){var n=new Map;return e.forEach((function(e){var r=e.signalingList,o=t._getSignalingRelatedToMeMap(r);n=new Map([].concat(T(n),T(o)))})),t._sortSignaling(n)}))}},{key:"_handleSignalingList",value:function(e){Qt(e)||(Ge.d("".concat(this._n,"._handleSignalingList signalingList:").concat(JSON.stringify(e))),this._signalingModule.onNewMessageList(e))}},{key:"_isSignalingNotExpired",value:function(e,t){return e[t]&&1e3*e[t]>(new Date).getTime()-this.EXPIRED_TIME}},{key:"_getValidConversationList",value:function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n],o=r.type,i=r.unreadCount,a=r.lastMessage,s=this._isSignalingNotExpired(a,"lastTime");o!==O.CONV_SYSTEM&&i>0&&s&&t.push(e[n])}return t}},{key:"_createPromiseList",value:function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n],o=r.conversationID,i=r.unreadCount,a=r.type===O.CONV_C2C?i:this.COUNT;this._signalingMap.set(o,{needMessageCount:a,signalingList:[]});var s=this._signalingModule.getModule(11).getMessageList({conversationID:o});t.push(s)}return t}},{key:"_concurrentGetMessageList",value:function(e){var t=this,n=[];return Promise.all(e).then((function(e){for(var r=0;r<e.length;r++){var o=e[r],i=o.code,a=o.data;if(0===i&&0!==a.messageList.length){t._handleMessageList(a.messageList);var s=t._relayGetMessageList(a);s&&n.push(s)}}return n.length>0?t._concurrentGetMessageList(n):t._signalingMap}))}},{key:"_relayGetMessageList",value:function(e){var t=e.messageList,n=e.nextReqMessageID,r=e.isCompleted,o=t.length;if(0===o)return null;var i=t[0],a=i.conversationID,s=i.conversationType,u=this._signalingMap.get(a).needMessageCount,c=s===O.CONV_GROUP,l=0===u||r,d=this._isSignalingNotExpired(t[o-1],"time");return c||l||!d?null:this._signalingModule.getModule(11).getMessageList({conversationID:a,nextReqMessageID:n,count:u})}},{key:"_handleMessageList",value:function(e){for(var t=e.length,n=e[0].conversationID,r=this._signalingMap.get(n),o=r.needMessageCount,i=r.signalingList,a=o-t>0?o-t:0,s=[],u=0;u<e.length;u++){var c=e[u];this._isSignalingNotExpired(c,"time")&&s.push(c)}var l=this._signalingModule.filterMessageList(s);this._signalingMap.set(n,{needMessageCount:a,signalingList:i.concat(l)})}},{key:"_getSignalingRelatedToMeMap",value:function(e){for(var t=0;t<e.length;t++){var n=e[t];this._saveSignalingRelatedToMe(n)}return this._signalingRelatedToMeMap}},{key:"_saveSignalingRelatedToMe",value:function(e){var n=this._signalingModule.getRemoteSignalingHandler().getPayloadData(e)||{},r=n.actionType,o=void 0===r?"":r,i=n.inviteID,a=void 0===i?"":i,s=n.inviteeList,u=void 0===s?[]:s,c=this._signalingModule.getMyUserID();switch(o){case R.ACTION_TYPE_INVITE:u.includes(c)&&this._signalingRelatedToMeMap.set(a,t(t({},n),{},{messageList:[e]}));break;case R.ACTION_TYPE_REJECT_INVITE:case R.ACTION_TYPE_ACCEPT_INVITE:this.updateHistoryInviteInfo(e);break;case R.ACTION_TYPE_CANCEL_INVITE:this.deleteHistoryInviteInfo(a);break;case R.ACTION_TYPE_INVITE_TIMEOUT:this.updateHistoryInviteInfo(e)}}},{key:"deleteHistoryInviteInfo",value:function(e){this._signalingRelatedToMeMap.has(e)&&this._signalingRelatedToMeMap.delete(e)}},{key:"updateHistoryInviteInfo",value:function(e){var t=this._signalingModule.getRemoteSignalingHandler().getPayloadData(e)||{},n=t.inviteID,r=void 0===n?"":n,o=t.inviteeList,i=void 0===o?[]:o;if(this._signalingRelatedToMeMap.has(r)){for(var a=this._signalingRelatedToMeMap.get(r),s=a.inviteeList,u=a.messageList,c=0;c<i.length;c++){var l=i[c];s.includes(l)&&s.splice(s.indexOf(l),1)}0===s.length?this.deleteHistoryInviteInfo(r):u.push(e)}else this.deleteHistoryInviteInfo(r)}},{key:"_sortSignaling",value:function(e){var t=[];return e.forEach((function(e){t=[].concat(T(t),T(e.messageList))})),t.sort((function(e,t){return(e.time?e.time:0)-(t.time?t.time:0)}))}},{key:"reset",value:function(){this._signalingMap.clear(),this._signalingRelatedToMeMap.clear()}}]),e}(),Li=c((function e(t,n){a(this,e),this.businessID=t.businessID||1,this.inviteID=t.inviteID,this.groupID=t.groupID||"",this.inviter=t.inviter||"",this.inviteeList=t.inviteeList||[],this.data=t.data||"",this.actionType=t.actionType||R.ACTION_TYPE_INVITE,this.timeout=t.timeout||0})),Pi=["message"],Ui=["message"],Gi=function(e){d(r,e);var n=I(r);function r(e){var t;return a(this,r),(t=n.call(this,e))._n="SignalingModule",t._inviteInfoMap=new Map,t._outerEmitter=new Io,t._outerEmitter._emit=t._outerEmitter.emit,t._outerEmitter.emit=function(){var e=arguments.length<=0?void 0:arguments[0],t=[e,{name:arguments.length<=0?void 0:arguments[0],data:arguments.length<=1?void 0:arguments[1]}];this._outerEmitter._emit.apply(this._outerEmitter,[].concat(t))}.bind(m(t)),t._canIUseSignaling=!1,t._isHandling=!1,t._remoteSignalingHandler=new Ai(m(t)),t._localSignalingHandler=new Ni(m(t)),t._historySignalingHandler=new wi(m(t)),t._isC2CUnreadHandleCompleted=!1,t._isConvSyncCompleted=!1,t._isSyncCompleted=!1,t.getInnerEmitterInstance().on(Cr.C2C_UNREAD_HANDLE_COMPLETED,t.onC2CUnreadHandleCompleted,m(t)),t.getInnerEmitterInstance().on(Cr.CONV_SYNC_COMPLETED,t.onConvSyncCompleted,m(t)),t}return c(r,[{key:"onC2CUnreadHandleCompleted",value:function(){this._isC2CUnreadHandleCompleted=!0,this._isC2CUnreadHandleCompleted&&this._isConvSyncCompleted&&!this._isSyncCompleted&&this.onReady()}},{key:"onConvSyncCompleted",value:function(){this._isConvSyncCompleted=!0,this._isC2CUnreadHandleCompleted&&this._isConvSyncCompleted&&!this._isSyncCompleted&&this.onReady()}},{key:"onReady",value:function(){Ge.l("".concat(this._n,".onReady")),this._isSyncCompleted=!0,this._historySignalingHandler.getHistorySignaling()}},{key:"onNewMessageList",value:function(e){return this._remoteSignalingHandler.onNewMessageList(e)}},{key:"onMessageModified",value:function(e){return this._remoteSignalingHandler.onMessageModified(e)}},{key:"hasInviteInfo",value:function(e){return this._inviteInfoMap.has(e)}},{key:"getInviteInfo",value:function(e){return this._inviteInfoMap.get(e)}},{key:"setInviteInfo",value:function(e,n){var r=n.message,o=_(n,Pi);Ge.l("".concat(this._n,".setInviteInfo inviteID:").concat(e," data:").concat(JSON.stringify(o))),this._inviteInfoMap.set(e,t(t({},o),{},{message:r}))}},{key:"deleteInviteInfo",value:function(e){this.hasInviteInfo(e)&&(Ge.l("".concat(this._n,".deleteInviteInfo inviteID:").concat(e,".")),this._inviteInfoMap.delete(e))}},{key:"updateInviteInfo",value:function(e){var t="".concat(this._n,".updateInviteInfo"),n=e.inviteID,r=e.inviter,o=e.inviteeList,i=e.groupID;if(Ge.l("".concat(t," inviteID:").concat(n," inviter:").concat(r," groupID:").concat(i)),i&&this.hasInviteInfo(n)){var a=o[0],s=this.getInviteInfo(n).inviteeList;s.includes(a)&&(s.splice(s.indexOf(a),1),Ge.l("".concat(t," remove ").concat(a,". localInviteeList.length:").concat(s.length))),0===s.length&&this.deleteInviteInfo(n)}else this.deleteInviteInfo(n)}},{key:"getLocalSignalingHandler",value:function(){return this._localSignalingHandler}},{key:"getRemoteSignalingHandler",value:function(){return this._remoteSignalingHandler}},{key:"canIUseSignaling",value:function(){return this._canIUseSignaling}},{key:"emitEvent",value:function(e,t){this._outerEmitter.emit(e,t)}},{key:"addSignalingListener",value:function(e,t,n){this._canIUseSignaling||(this._canIUseSignaling=!0),this._outerEmitter.on(e,t,n)}},{key:"removeSignalingListener",value:function(e,t,n){this._outerEmitter.off(e,t,n),0===this._outerEmitter.eventNames().length&&(this._canIUseSignaling=!1)}},{key:"invite",value:function(e){var n=this,r="".concat(this._n,".").concat("invite"),o=this._localSignalingHandler.createInviteInfo(e),i=o.message,a=o.customData,s=o.inviteID;return Ge.l("".concat(r," options:").concat(JSON.stringify(e)," inviteID:").concat(s)),this.sendSignaling(i,e).then((function(e){return e&&0===e.code?(n.setInviteInfo(s,t(t({},a),{},{message:i})),n.startTimer(t(t({},a),{},{inviteID:s})),t(t({},e),{},{inviteID:s})):e})).catch((function(e){return jn(e)}))}},{key:"inviteSync",value:function(e,n,r){var o=this,i="".concat(this._n,".").concat("inviteSync"),a=this._localSignalingHandler.createInviteInfo(e),s=a.message,u=a.customData,c=a.inviteID;return Ge.l("".concat(i," options:").concat(JSON.stringify(e)," inviteID:").concat(c)),this.sendSignaling(s,e).then((function(e){if(e&&0===e.code)return o.setInviteInfo(c,t(t({},u),{},{message:s})),o.startTimer(t(t({},u),{},{inviteID:c})),n&&n({inviteID:c}),{inviteID:c};r&&r(0===e.code,e.message||"")})).catch((function(e){return r&&r(e.code,e.message),jn(e)})),c}},{key:"_handleImResponse",value:function(e,t,n){t&&0===t.code&&(this._isHandling=!1,n?this.deleteInviteInfo(e.inviteID):this.updateInviteInfo(e))}},{key:"cancel",value:function(e){var n=this,r="".concat(this._n,".").concat("cancel");if(Ge.l("".concat(r," options:").concat(JSON.stringify(e))),!this.hasInviteInfo(e.inviteID)||this._isHandling)return jn({code:qn.INVALID_CANCEL_MESSAGE});this._isHandling=!0;var o=this._localSignalingHandler.createCancelCustomData(e);if(!o)return this._isHandling=!1,jn({code:qn.SIGNALING_NO_PERMISSION});var i=o.groupID,a=o.inviteeList,s=i||a[0],u=this._localSignalingHandler.createSignalingMessage(o,s);return this.sendSignaling(u,e).then((function(r){return n._handleImResponse(o,r,!0),0===r.code?t(t({},r),{},{inviteID:e.inviteID}):r})).catch((function(e){return jn(e)}))}},{key:"accept",value:function(e){var n=this,r="".concat(this._n,".").concat("accept");if(Ge.l("".concat(r," options:").concat(JSON.stringify(e))),!this.hasInviteInfo(e.inviteID)||this._isHandling)return jn({code:qn.SIGNALING_INVALID_INVITE_ID});this._isHandling=!0;var o=this._localSignalingHandler.createAcceptCustomData(e);if(!o)return this._isHandling=!1,jn({code:qn.SIGNALING_NO_PERMISSION});var i=this._localSignalingHandler.createSignalingMessage(o);return this.sendSignaling(i,e).then((function(r){return n._handleImResponse(o,r),0===r.code?t(t({},r),{},{inviteID:e.inviteID}):r})).catch((function(e){return jn(e)}))}},{key:"reject",value:function(e){var n=this,r="".concat(this._n,".").concat("reject");if(Ge.l("".concat(r," options:").concat(JSON.stringify(e))),!this.hasInviteInfo(e.inviteID)||this._isHandling)return jn({code:qn.SIGNALING_INVALID_INVITE_ID});this._isHandling=!0;var o=this._localSignalingHandler.createRejectCustomData(e);if(!o)return this._isHandling=!1,jn({code:qn.SIGNALING_NO_PERMISSION});var i=this._localSignalingHandler.createSignalingMessage(o);return this.sendSignaling(i,e).then((function(r){return n._handleImResponse(o,r,!0),0===r.code?t(t({},r),{},{inviteID:e.inviteID}):r})).catch((function(e){return jn(e)}))}},{key:"getSignalingInfo",value:function(e){var t="".concat(this._n,".getSignalingInfo"),n=e.ID,r=e.from,o=e.to,i=this._filterSignalingMessage(e),a=null;if(i){var s=this._remoteSignalingHandler.getPayloadData(e);a=new Li(s)}var u=i?"actionType:".concat(a.actionType):"";return Ge.l("".concat(t," messageID:").concat(n," from:").concat(r," to:").concat(o," ")+"".concat(u," isSignaling:").concat(i)),a}},{key:"modifyInvitation",value:function(e){var n=this,r=e.inviteID,o=e.data;if(!this.hasInviteInfo(e.inviteID)||this._isHandling)return jn({code:qn.SIGNALING_INVALID_INVITE_ID});this._isHandling=!0;var i=this.getInviteInfo(r),a=i.message,s=_(i,Ui),u=a.payload.data;return s.data=o,a.payload.data=JSON.stringify(s),this.getModule(2).modifyRemoteMessage(a).then((function(e){return n.setInviteInfo(r,t(t({},s),{},{message:a})),n._isHandling=!1,e})).catch((function(e){return n._isHandling=!1,a.payload.data=u,jn(e)}))}},{key:"_genMessageControlInfo",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.data,n=void 0===t?"":t,r=e.onlineUserOnly,o=e.inviteID,i=void 0===o?"":o,a=e.offlinePushInfo,s=e.actionType,u={_onlineOnlyFlag:!1};i&&this.getInviteInfo(i)&&(u=this.getInviteInfo(i).message);var c={onlineUserOnly:u._onlineOnlyFlag||r||!1,offlinePushInfo:a,messageControlInfo:{excludedFromContentModeration:!0,excludedFromUnreadCount:!1,excludedFromLastMessage:!1}};if(s===R.ACTION_TYPE_INVITE_TIMEOUT){var l=!!n.match(/excludeTimeoutSignalingFromHistoryMessage/);return c.messageControlInfo.excludedFromUnreadCount=l,c.messageControlInfo.excludedFromLastMessage=l,c}var d=!!n.match(/excludeFromHistoryMessage/),f=!!n.match(/excludeOriginalSignalingFromHistoryMessage/);return c.messageControlInfo.excludedFromUnreadCount=d||f,c.messageControlInfo.excludedFromLastMessage=d||f,c}},{key:"sendSignaling",value:function(e,t){var n=this;return this.getModule(2).sendMessageInstance(e,this._genMessageControlInfo(t)).catch((function(e){return n._isHandling=!1,jn(e)}))}},{key:"filterMessageList",value:function(e){var t=this;return e.filter((function(e){return t._filterSignalingMessage(e)}))}},{key:"_filterSignalingMessage",value:function(e){var t=!1;if(e.type&&e.type===O.MSG_CUSTOM){var n=e.cloudCustomData,r=void 0===n?"":n,o=e.payload.data,i=void 0===o?"":o,a=r.match(/"type":"tsignaling"/),s=i.match(/inviteID/),u=i.match(/actionType/);t=a||s&&u}return!!t}},{key:"startTimer",value:function(e){var t=this,n="".concat(this._n,".startTimer"),r=e.timeout,o=e.inviteID,i=e.inviter,a=e.groupID,s=i===this.getMyUserID();if(Ge.l("".concat(n," timeout:").concat(r," isInviter:").concat(s," groupID:").concat(a)),!(r<=0))var u=s?r+5:r,c=1,l=setInterval((function(){var r=t._hasLocalInviteInfo(e,s);c<u&&r?++c:(r&&t._sendTimeoutNotice(o,s),Ge.l("".concat(n," end.")),clearInterval(l))}),1e3)}},{key:"_hasLocalInviteInfo",value:function(e,t){var n=e.inviteID,r=e.groupID;if(!this.hasInviteInfo(n))return!1;var o="".concat(this._n,"._hasLocalInviteInfo"),i=this.getInviteInfo(n).inviteeList;return Ge.l("".concat(o," inviteID:").concat(n," inviteeList:").concat(i," groupID:").concat(r)),!r||(t?i.length>0:i.length>0&&i.includes(this.getMyUserID()))}},{key:"_getReceiver",value:function(e,t){var n=t.groupID,r=t.inviteeList,o=t.inviter;return e?n||r[0]:n||o}},{key:"_sendTimeoutNotice",value:function(e,n){var r=this,o=this.getInviteInfo(e),i=this._getReceiver(n,o);Ge.l("".concat(this._n,"._sendTimeoutNotice inviteID:").concat(e," to:").concat(i," isInviter:").concat(n));var a=this._localSignalingHandler.createTimeoutCustomData(t(t({},o),{},{isInviter:n})),s=this._localSignalingHandler.createSignalingMessage(a,i);return this.sendSignaling(s,a).then((function(t){if(t&&0===t.code){var o=a.data,i=a.groupID,u=a.inviteeList,c=a.inviter;r.emitEvent(R.INVITATION_TIMEOUT,{data:o,groupID:i,inviteID:e,inviteeList:u,inviter:c,isSelfTimeout:!0,message:s}),n?r.deleteInviteInfo(e):r.updateInviteInfo(a)}}))}},{key:"reset",value:function(){Ge.l("".concat(this._n,".reset")),this._inviteInfoMap.clear(),this._canIUseSignaling=!1,this._isHandling=!1,this._historySignalingHandler.reset(),this._isC2CUnreadHandleCompleted=!1,this._isConvSyncCompleted=!1,this._isSyncCompleted=!1}}]),r}(Hn),xi=function(){function e(t){var n=this;a(this,e);var r,o=new ar("sdkConstruct");this._n="ModuleManager",this._isReady=!1,this._reason=qn.USER_NOT_LOGGED_IN,this._startLoginTs=0,this._moduleMap=new Map,this._innerEmitter=null,this._outerEmitter=null,this._checkCount=0,this._checkTimer=-1,this._moduleMap.set(12,new so(this,t)),this._moduleMap.set(27,new Ei(this)),this._moduleMap.set(23,new ui(this)),this._moduleMap.set(24,new Ti(this)),this._moduleMap.set(26,new hi(this)),this._moduleMap.set(21,new Jo(this)),this._moduleMap.set(20,new si(this)),this._moduleMap.set(1,new co(this)),this._moduleMap.set(2,new Ao(this)),this._moduleMap.set(3,new Oo(this)),this._moduleMap.set(34,new Ro(this)),this._moduleMap.set(31,new No(this)),this._moduleMap.set(4,new ao(this)),this._moduleMap.set(6,new Sr(this)),this._moduleMap.set(11,new xr(this)),this._moduleMap.set(7,new Xr(this)),this._moduleMap.set(10,new eo(this)),this._moduleMap.set(13,new fo(this)),this._moduleMap.set(32,new Di(this)),this._moduleMap.set(14,new go(this)),this._moduleMap.set(15,new yo(this)),this._moduleMap.set(17,new To(this)),this._moduleMap.set(18,new wo(this)),this._moduleMap.set(19,new Lo(this)),this._moduleMap.set(25,new ci(this)),this._moduleMap.set(8,new Mi(this)),this._moduleMap.set(28,new Ci(this)),this._moduleMap.set(29,new ki(this)),this._moduleMap.set(30,new bi(this)),this._moduleMap.set(33,new Gi(this)),this._eventThrottleMap=new Map,ot(t.modules)?(Object.keys(t.modules).forEach((function(e){r=t.modules[e],"group-module"===e?n._moduleMap.set(7,new r(n)):"relationship-module"===e?n._moduleMap.set(8,new r(n)):"signaling-module"===e&&n._moduleMap.set(33,new r(n))})),this._moduleMap.get(12).setUsingChatCore(!0)):this._moduleMap.has(7)||this._moduleMap.get(12).setUsingChatCore(!0);var i=t.instanceID,s=t.SDKAppID,u=this._moduleMap.get(12).isIntl(),c=this._moduleMap.get(12).isUsingChatCore(),l="instanceID:".concat(i," SDKAppID:").concat(s," isIntl:").concat(u," isUsingChatCore:").concat(c," host:").concat(wt()," isIOSWebView:").concat(Ce)+" inBrowser:".concat(Z," inMiniApp:").concat($)+" workerAvailable:".concat(Te," UserAgent:").concat(ee);ar.bindEventStatModule(this._moduleMap.get(14)),o.setMessage("".concat(l," ").concat(function(){var e="";if($)try{var t=Q.getSystemInfoSync(),n=t.model,r=t.version,o=t.system,i=t.platform,a=t.SDKVersion;e="model:".concat(n," version:").concat(r," system:").concat(o," platform:").concat(i," SDKVersion:").concat(a)}catch(s){e=""}return e}())).end(),Ge.i("SDK ".concat(l)),Fn.prototype._getErrorMessage=this.getErrorMessage.bind(this),this._readyList=void 0,this._ssoLogForReady=null,this._initReadyList()}return c(e,[{key:"_startTimer",value:function(){var e=this._moduleMap.get(24),t=e.isWorkerEnabled();Ge.l("".concat(this._n,".startTimer isWorkerEnabled:").concat(t," seed:").concat(this._checkTimer)),t?e.startWorkerTimer():this._startMainThreadTimer()}},{key:"_startMainThreadTimer",value:function(){this._checkTimer<0&&(this._checkTimer=setInterval(this.onCheckTimer.bind(this),1e3)),Ge.l("".concat(this._n,"._startMainThreadTimer seed:").concat(this._checkTimer))}},{key:"stopTimer",value:function(){var e=this._moduleMap.get(24),t=e.isWorkerEnabled();Ge.l("".concat(this._n,".stopTimer isWorkerEnabled:").concat(t," seed:").concat(this._checkTimer)),t?e.stopWorkerTimer():this._stopMainThreadTimer()}},{key:"_stopMainThreadTimer",value:function(){Ge.l("".concat(this._n,"._stopMainThreadTimer")),this._checkTimer>0&&(clearInterval(this._checkTimer),this._checkTimer=-1,this._checkCount=0)}},{key:"_stopMainThreadSocket",value:function(){Ge.l("".concat(this._n,"._stopMainThreadSocket"));var e=this._moduleMap.get(21);e.setIsWorkerEnabled(!0),e.reConnect()}},{key:"_startMainThreadSocket",value:function(){Ge.l("".concat(this._n,"._startMainThreadSocket"));var e=this._moduleMap.get(21);e.setIsWorkerEnabled(!1),e.reConnect()}},{key:"onWorkerTimerEnabled",value:function(){Ge.l("".concat(this._n,".onWorkerTimerEnabled, disable main thread timer and socket")),this._stopMainThreadTimer(),this._stopMainThreadSocket()}},{key:"onWorkerTimerDisabled",value:function(){Ge.l("".concat(this._n,".onWorkerTimerDisabled, enable main thread timer and socket")),this._startMainThreadTimer(),this._startMainThreadSocket()}},{key:"onCheckTimer",value:function(){this._checkCount+=1;var e,t=D(this._moduleMap);try{for(t.s();!(e=t.n()).done;){var n=M(e.value,2)[1];n.onCheckTimer&&n.onCheckTimer(this._checkCount)}}catch(a){t.e(a)}finally{t.f()}}},{key:"_initReadyList",value:function(){var e=this;this._readyList=[this._moduleMap.get(1)],this._readyList.forEach((function(t){t.ready((function(){return e._onModuleReady()}))}))}},{key:"_onModuleReady",value:function(){var e=!0;if(this._readyList.forEach((function(t){t.isReady()||(e=!1)})),e&&!this._isReady){this._isReady=!0,this._outerEmitter.emit(A.SDK_READY);var t=Date.now()-this._startLoginTs;Ge.w("SDK is ready. cost ".concat(t," ms")),this._startLoginTs=Date.now();var n=this._moduleMap.get(15).getNetworkType(),r=this._ssoLogForReady.getStartTs()+Oe;this._ssoLogForReady.setNetworkType(n).setMessage(t).start(r).end()}}},{key:"login",value:function(){0===this._startLoginTs&&(Ne(),this._startLoginTs=Date.now(),this._startTimer(),this._moduleMap.get(15).start(),this._ssoLogForReady=new ar("sdkReady"),this._reason=qn.LOGGING_IN)}},{key:"onLoginFailed",value:function(){this._startLoginTs=0}},{key:"getOuterEmitterInstance",value:function(){return null===this._outerEmitter&&(this._outerEmitter=new Io,function(e){Vn=e}(this._outerEmitter),this._outerEmitter._emit=this._outerEmitter.emit,this._outerEmitter.emit=function(e,t){var n=this;if(this._canIUseSignaling()){if(e===A.MESSAGE_RECEIVED){var r=this.getModule(33);r.onNewMessageList(t)}if(e===A.MESSAGE_MODIFIED){var o=this.getModule(33);o.onMessageModified(t)}}if(e===A.CONVERSATION_LIST_UPDATED||e===A.FRIEND_LIST_UPDATED||e===A.GROUP_LIST_UPDATED||e===A.TOTAL_UNREAD_MESSAGE_COUNT_UPDATED)if(this._eventThrottleMap.has(e)){var i=Date.now(),a=this._eventThrottleMap.get(e);i-a.last<=1e3?(a.timeoutID&&clearTimeout(a.timeoutID),a.timeoutID=setTimeout((function(){a.last=Date.now(),n._outerEmitter._emit.apply(n._outerEmitter,[e,{name:e,data:n._getEventData(e)}])}),1e3)):(a.last=i,this._outerEmitter._emit.apply(this._outerEmitter,[e,{name:e,data:this._getEventData(e)}]))}else this._eventThrottleMap.set(e,{last:Date.now(),timeoutID:-1}),this._outerEmitter._emit.apply(this._outerEmitter,[e,{name:e,data:this._getEventData(e)}]);else this._outerEmitter._emit.apply(this._outerEmitter,[e,{name:e,data:arguments[1]}])}.bind(this)),this._outerEmitter}},{key:"_canIUseSignaling",value:function(){var e=this.getModule(33);return!!e&&e.canIUseSignaling()}},{key:"_getEventData",value:function(e){return e===A.CONVERSATION_LIST_UPDATED?this._moduleMap.get(11).getLocalConversationList():e===A.FRIEND_LIST_UPDATED?this._moduleMap.get(8).getLocalFriendList(!1):e===A.GROUP_LIST_UPDATED?this._moduleMap.get(7).getLocalGroupList():e===A.TOTAL_UNREAD_MESSAGE_COUNT_UPDATED?this._moduleMap.get(11).getTotalUnreadMessageCount():void 0}},{key:"getInnerEmitterInstance",value:function(){return null===this._innerEmitter&&(this._innerEmitter=new Io,this._innerEmitter._emit=this._innerEmitter.emit,this._innerEmitter.emit=function(e,t){var n;n=ot(arguments[1])&&arguments[1].data?[e,{name:arguments[0],data:arguments[1].data}]:[e,{name:arguments[0],data:arguments[1]}],this._innerEmitter._emit.apply(this._innerEmitter,n)}.bind(this)),this._innerEmitter}},{key:"hasModule",value:function(e){return this._moduleMap.has(e)}},{key:"getModule",value:function(e){return this._moduleMap.get(e)}},{key:"isReady",value:function(){return this._isReady}},{key:"isIntl",value:function(){return this.getModule(12).isIntl()}},{key:"getNotReadyReason",value:function(){return this._reason}},{key:"setNotReadyReason",value:function(e){this._reason=e}},{key:"getErrorMessage",value:function(e,t,n){return this._moduleMap.get(32).get({key:e,replacement1:t,replacement2:n,isIntl:this.isIntl()})}},{key:"outputWarning",value:function(e,t,n){var r=this.getErrorMessage(e,t,n);r&&Ge.w(r)}},{key:"onError",value:function(e){var t="code:".concat(e.code," message:").concat(e.message);Ge.w("Oops! ".concat(t)),new ar("error").setMessage(t).setNetworkType(this.getModule(15).getNetworkType()).setLevel("error").end(),this.getOuterEmitterInstance().emit(A.ERROR,e)}},{key:"restartTimer",value:function(){Ge.l("".concat(this._n,".restartTimer")),this.stopTimer(),this._startTimer();var e=this.getModule(7);e&&e.restartPolling()}},{key:"getTimerID",value:function(){var e=this._moduleMap.get(24);return e.isWorkerEnabled()?e.getTimerID():this._checkTimer}},{key:"getPollingTimerID",value:function(e){return this._moduleMap.get(7).getPollingTimerID(e)}},{key:"reset",value:function(){Ge.l("".concat(this._n,".reset")),Ne();var e,t=D(this._moduleMap);try{for(t.s();!(e=t.n()).done;){var n=M(e.value,2)[1];n.reset&&n.reset()}}catch(l){t.e(l)}finally{t.f()}this._startLoginTs=0,this._initReadyList(),this._isReady=!1,this.stopTimer(),this._outerEmitter.emit(A.SDK_NOT_READY);var r,o=D(this._eventThrottleMap);try{for(o.s();!(r=o.n()).done;){var i=M(r.value,2)[1];i.timeoutID&&clearTimeout(i.timeoutID)}}catch(l){o.e(l)}finally{o.f()}this._eventThrottleMap.clear()}}]),e}(),Fi=function(){function e(t){a(this,e),this._funcMap=new Map,this._m=t,this._n="SafetyCallback",this._reportCount=0}return c(e,[{key:"defense",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;if("string"!=typeof e)return null;if(0===e.length)return null;if("function"!=typeof t)return null;if(this._funcMap.has(e)&&this._funcMap.get(e).has(t))return this._funcMap.get(e).get(t);this._funcMap.has(e)||this._funcMap.set(e,new Map);var r=null;return this._funcMap.get(e).has(t)?r=this._funcMap.get(e).get(t):(r=this._pack(e,t,n),this._funcMap.get(e).set(t,r)),r}},{key:"defenseOnce",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;return"function"!=typeof t?null:this._pack(e,t,n)}},{key:"find",value:function(e,t){return"string"!=typeof e||0===e.length||"function"!=typeof t?null:this._funcMap.has(e)&&this._funcMap.get(e).has(t)?this._funcMap.get(e).get(t):(this._m.outputWarning("ListenerFnNotFound",e),null)}},{key:"delete",value:function(e,t){return"function"==typeof t&&!!this._funcMap.has(e)&&!!this._funcMap.get(e).has(t)&&(this._funcMap.get(e).delete(t),0===this._funcMap.get(e).size&&this._funcMap.delete(e),!0)}},{key:"_pack",value:function(e,t,n){var r=this;return function(){try{t.apply(n,Array.from(arguments))}catch(f){var o=Object.values(A).indexOf(e),i="CallbackError";if(-1!==o){var a=Object.keys(A)[o];r._m.outputWarning(i,a,f)}if(r._reportCount<5){var s=new ar(i);s.setMessage("eventName:".concat(e)).setMoreMessage(f.message).end(),r._reportCount+=1}}}}},{key:"destroy",value:function(){this._funcMap.clear()}},{key:"reset",value:function(){Ge.l("".concat(this._n,".reset")),this._reportCount=0}}]),e}(),qi=function(){function e(t){a(this,e);var n={SDKAppID:t.SDKAppID,unlimitedAVChatRoom:t.unlimitedAVChatRoom||!1,scene:t.scene||"",oversea:t.oversea||!1,instanceID:Nt(),devMode:t.devMode||!1,proxyServer:t.proxyServer||void 0,fileUploadProxy:t.fileUploadProxy||void 0,fileDownloadProxy:t.fileDownloadProxy||t.fileUploadProxy||void 0,modules:t.modules||void 0};this._m=new xi(n),this._vendorMap=new Map,this._safetyCallbackFactory=new Fi(this._m)}return c(e,[{key:"onError",value:function(e){this._m.onError(e)}},{key:"login",value:function(e){return this._m.login(),this._getModule(1).login(e)}},{key:"logout",value:function(){var e=this;return this._getModule(1).logout().then((function(t){return e._safetyCallbackFactory.reset(),e._m.reset(),t}))}},{key:"getLoginUser",value:function(){return this._getModule(1).getLoginUser()}},{key:"isReady",value:function(){return this._m.isReady()}},{key:"isIntl",value:function(){return this._m.isIntl()}},{key:"getNotReadyReason",value:function(){return this._m.getNotReadyReason()}},{key:"getErrorMessage",value:function(e,t,n){return this._m.getErrorMessage(e,t,n)}},{key:"_getModule",value:function(e){return this._m.getModule(e)}},{key:"destroy",value:function(){var e=this;return this.logout().finally((function(){e._safetyCallbackFactory.destroy(),e._m.stopTimer(),e._getModule(24).terminate(),e._getModule(21).dealloc();var t=e._m.getOuterEmitterInstance(),n=e._getModule(12);t.emit(A.SDK_DESTROY,{SDKAppID:n.getSDKAppID()})}))}},{key:"on",value:function(e,t,n){Ge.d("on","eventName:".concat(e)),this._m.getOuterEmitterInstance().on(e,this._safetyCallbackFactory.defense(e,t,n),n)}},{key:"once",value:function(e,t,n){Ge.d("once","eventName:".concat(e)),this._m.getOuterEmitterInstance().once(e,this._safetyCallbackFactory.defenseOnce(e,t,n),n||this)}},{key:"off",value:function(e,t,n,r){Ge.d("off","eventName:".concat(e));var o=this._safetyCallbackFactory.find(e,t);null!==o&&(this._m.getOuterEmitterInstance().off(e,o,n,r),this._safetyCallbackFactory.delete(e,t))}},{key:"registerPlugin",value:function(e){at(e["tim-offline-push-plugin"])?this._getModule(18).registerPlugin(e):this._getModule(28).registerPlugin(e)}},{key:"setLogLevel",value:function(e){if(e<=0){var t=this.getErrorMessage("TIM_ASCII_ART");t&&console.log(t);var n=this.getErrorMessage("API_REFER");n&&(Kt()?console.log("%c ".concat("IM SDK API ->"," %c"),"background:#ff9d00; padding:1px; border-radius:3px; color: #fff","background:transparent",n):console.log("IM SDK API ->",n));var r=this.getErrorMessage("DOCS_GUIDE");r&&console.log(r);var o=this.getErrorMessage("IOS_WEBVIEW_WARNING");Ce&&o&&console.warn(o)}Ge.setLevel(e)}},{key:"createTextMessage",value:function(e){return this._getModule(2).createTextMessage(e)}},{key:"createTextAtMessage",value:function(e){return this._getModule(2).createTextMessage(e)}},{key:"createImageMessage",value:function(e){return this._getModule(2).createImageMessage(e)}},{key:"createAudioMessage",value:function(e){return this._getModule(2).createAudioMessage(e)}},{key:"createVideoMessage",value:function(e){return this._getModule(2).createVideoMessage(e)}},{key:"createCustomMessage",value:function(e){return this._getModule(2).createCustomMessage(e)}},{key:"createFaceMessage",value:function(e){return this._getModule(2).createFaceMessage(e)}},{key:"createFileMessage",value:function(e){return this._getModule(2).createFileMessage(e)}},{key:"createLocationMessage",value:function(e){return this._getModule(2).createLocationMessage(e)}},{key:"createMergerMessage",value:function(e){return this._getModule(2).createMergerMessage(e)}},{key:"downloadMergerMessage",value:function(e){return e.type!==O.MSG_MERGER?jn({code:qn.MSG_MERGER_TYPE_INVALID}):Qt(e.payload.downloadKey)?jn({code:qn.MSG_MERGER_KEY_INVALID}):this._getModule(2).downloadMergerMessage(e).catch((function(e){return jn({code:qn.MSG_MERGER_DOWNLOAD_FAIL})}))}},{key:"createForwardMessage",value:function(e){return this._getModule(2).createForwardMessage(e)}},{key:"sendMessage",value:function(e,t){return e instanceof Tr?this._getModule(2).sendMessageInstance(e,t):jn({code:qn.MSG_INSTANCE_REQUIRED})}},{key:"searchCloudMessages",value:function(e){return this._getModule(2).searchCloudMessages(e)}},{key:"callExperimentalAPI",value:function(e,t){return"sendComboMessage"===e?this._getModule(31).sendMessage(t):"handleGroupInvitation"===e?this._getModule(7).handleGroupInvitation(t):"isCommercialAbilityEnabled"===e?this._getModule(27).isFeatureEnabled(t):"isIntl"===e?this.isIntl():"sendTRTCCustomData"===e||"sendRoomCustomData"===e?this._getModule(30).sendTRTCCustomData(t):"getTimerID"===e?this._m.getTimerID():"getPollingTimerID"===e?this._m.getPollingTimerID(t):"setApplicationID"===e?(this._getModule(12).setApplicationID(t),void this._getModule(20).updateProtocolConfig()):"getServerConfig"===e?this._getModule(23).getServerConfig(t):jn({code:qn.INVALID_OPERATION})}},{key:"revokeMessage",value:function(e){return this._getModule(2).revokeMessage(e)}},{key:"resendMessage",value:function(e,t){return e instanceof Tr?this._getModule(2).resendMessage(e,t):jn({code:qn.MSG_INSTANCE_REQUIRED})}},{key:"deleteMessage",value:function(e){return this._getModule(2).deleteMessage(e)}},{key:"translateText",value:function(e){return this._getModule(2).translateText(e)}},{key:"convertVoiceToText",value:function(e){return this._getModule(2).convertVoiceToText(e)}},{key:"setMessageExtensions",value:function(e,t){return this._getModule(3).setMessageExtensions(e,t)}},{key:"getMessageExtensions",value:function(e){return this._getModule(3).getMessageExtensions(e)}},{key:"deleteMessageExtensions",value:function(e,t){return this._getModule(3).deleteMessageExtensions(e,t)}},{key:"addMessageReaction",value:function(e,t){return this._getModule(34).addMessageReaction(e,t)}},{key:"removeMessageReaction",value:function(e,t){return this._getModule(34).removeMessageReaction(e,t)}},{key:"getMessageReactions",value:function(e){return this._getModule(34).getMessageReactions(e)}},{key:"getAllUserListOfMessageReaction",value:function(e){return this._getModule(34).getAllUserListOfMessageReaction(e)}},{key:"modifyMessage",value:function(e){return this._getModule(2).modifyRemoteMessage(e)}},{key:"getMessageList",value:function(e){return this._getModule(11).getMessageList(e)}},{key:"getMessageListHopping",value:function(e){return this._getModule(11).getMessageListHopping(e)}},{key:"sendMessageReadReceipt",value:function(e){return this._getModule(11).sendReadReceipt(e)}},{key:"getMessageReadReceiptList",value:function(e){return this._getModule(11).getReadReceiptList(e)}},{key:"getGroupMessageReadMemberList",value:function(e){var t=this._getModule(7);return t?t.getReadReceiptDetail(e):jn({code:qn.CANNOT_FIND_MODULE})}},{key:"findMessage",value:function(e){return this._getModule(11).findMessage(e)}},{key:"setMessageRead",value:function(e){return this._getModule(11).setMessageRead(e)}},{key:"getConversationList",value:function(e){return this._getModule(11).getConversationList(e)}},{key:"getConversationProfile",value:function(e){return this._getModule(11).getConversationProfile(e)}},{key:"deleteConversation",value:function(e){return this._getModule(11).deleteConversation(e)}},{key:"setConversationDraft",value:function(e){return this._getModule(11).setConversationDraft(e)}},{key:"clearHistoryMessage",value:function(e){return this._getModule(11).clearHistoryMessage(e)}},{key:"pinConversation",value:function(e){return this._getModule(11).pinConversation(e)}},{key:"setAllMessageRead",value:function(e){return this._getModule(11).setAllMessageRead(e)}},{key:"setMessageRemindType",value:function(e){return this._getModule(11).setMessageRemindType(e)}},{key:"getTotalUnreadMessageCount",value:function(){return this._getModule(11).getTotalUnreadMessageCount()}},{key:"setConversationCustomData",value:function(e){return this._getModule(11).setConversationCustomData(e)}},{key:"markConversation",value:function(e){return this._getModule(11).markConversation(e)}},{key:"getConversationGroupList",value:function(){return this._getModule(11).getConversationGroupList()}},{key:"createConversationGroup",value:function(e){return this._getModule(11).createConversationGroup(e)}},{key:"deleteConversationGroup",value:function(e){return this._getModule(11).deleteConversationGroup(e)}},{key:"renameConversationGroup",value:function(e){return this._getModule(11).renameConversationGroup(e)}},{key:"addConversationsToGroup",value:function(e){return this._getModule(11).addConversationsToGroup(e)}},{key:"deleteConversationsFromGroup",value:function(e){return this._getModule(11).deleteConversationsFromGroup(e)}},{key:"getMyProfile",value:function(){return this._getModule(4).getMyProfile()}},{key:"getUserProfile",value:function(e){return this._getModule(4).getUserProfile(e)}},{key:"updateMyProfile",value:function(e){return this._getModule(4).updateMyProfile(e)}},{key:"getBlacklist",value:function(){return this._getModule(4).getLocalBlacklist()}},{key:"addToBlacklist",value:function(e){return this._getModule(4).addBlacklist(e)}},{key:"removeFromBlacklist",value:function(e){return this._getModule(4).deleteBlacklist(e)}},{key:"setSelfStatus",value:function(e){return this._getModule(4).setSelfStatus(e)}},{key:"getUserStatus",value:function(e){return this._getModule(4).getUserStatus(e)}},{key:"subscribeUserStatus",value:function(e){return this._getModule(4).subscribeUserStatus(e)}},{key:"unsubscribeUserStatus",value:function(e){return this._getModule(4).unsubscribeUserStatus(e)}},{key:"getFriendList",value:function(){var e=this._getModule(8);return e?e.getLocalFriendList():jn({code:qn.CANNOT_FIND_MODULE})}},{key:"addFriend",value:function(e){var t=this._getModule(8);return t?t.addFriend(e):jn({code:qn.CANNOT_FIND_MODULE})}},{key:"deleteFriend",value:function(e){var t=this._getModule(8);return t?t.deleteFriend(e):jn({code:qn.CANNOT_FIND_MODULE})}},{key:"checkFriend",value:function(e){var t=this._getModule(8);return t?t.checkFriend(e):jn({code:qn.CANNOT_FIND_MODULE})}},{key:"getFriendProfile",value:function(e){var t=this._getModule(8);return t?t.getFriendProfile(e):jn({code:qn.CANNOT_FIND_MODULE})}},{key:"updateFriend",value:function(e){var t=this._getModule(8);return t?t.updateFriend(e):jn({code:qn.CANNOT_FIND_MODULE})}},{key:"getFriendApplicationList",value:function(){var e=this._getModule(8);return e?e.getLocalFriendApplicationList():jn({code:qn.CANNOT_FIND_MODULE})}},{key:"acceptFriendApplication",value:function(e){var t=this._getModule(8);return t?t.acceptFriendApplication(e):jn({code:qn.CANNOT_FIND_MODULE})}},{key:"refuseFriendApplication",value:function(e){var t=this._getModule(8);return t?t.refuseFriendApplication(e):jn({code:qn.CANNOT_FIND_MODULE})}},{key:"deleteFriendApplication",value:function(e){var t=this._getModule(8);return t?t.deleteFriendApplication(e):jn({code:qn.CANNOT_FIND_MODULE})}},{key:"setFriendApplicationRead",value:function(){var e=this._getModule(8);return e?e.setFriendApplicationRead():jn({code:qn.CANNOT_FIND_MODULE})}},{key:"getFriendGroupList",value:function(){var e=this._getModule(8);return e?e.getLocalFriendGroupList():jn({code:qn.CANNOT_FIND_MODULE})}},{key:"createFriendGroup",value:function(e){var t=this._getModule(8);return t?t.createFriendGroup(e):jn({code:qn.CANNOT_FIND_MODULE})}},{key:"deleteFriendGroup",value:function(e){var t=this._getModule(8);return t?t.deleteFriendGroup(e):jn({code:qn.CANNOT_FIND_MODULE})}},{key:"addToFriendGroup",value:function(e){var t=this._getModule(8);return t?t.addToFriendGroup(e):jn({code:qn.CANNOT_FIND_MODULE})}},{key:"removeFromFriendGroup",value:function(e){var t=this._getModule(8);return t?t.removeFromFriendGroup(e):jn({code:qn.CANNOT_FIND_MODULE})}},{key:"renameFriendGroup",value:function(e){var t=this._getModule(8);return t?t.renameFriendGroup(e):jn({code:qn.CANNOT_FIND_MODULE})}},{key:"getGroupList",value:function(){var e=this._getModule(7);return e?e.getGroupList():jn({code:qn.CANNOT_FIND_MODULE})}},{key:"getGroupProfile",value:function(e){var t=this._getModule(7);return t?t.getGroupProfile(e):jn({code:qn.CANNOT_FIND_MODULE})}},{key:"createGroup",value:function(e){var t=this._getModule(7);return t?t.createGroup(e):jn({code:qn.CANNOT_FIND_MODULE})}},{key:"dismissGroup",value:function(e){var t=this._getModule(7);return t?t.dismissGroup(e):jn({code:qn.CANNOT_FIND_MODULE})}},{key:"updateGroupProfile",value:function(e){var t=this._getModule(7);return t?t.updateGroupProfile(e):jn({code:qn.CANNOT_FIND_MODULE})}},{key:"joinGroup",value:function(e){var t=this._getModule(7);return t?t.joinGroup(e):jn({code:qn.CANNOT_FIND_MODULE})}},{key:"quitGroup",value:function(e){var t=this._getModule(7);return t?t.quitGroup(e):jn({code:qn.CANNOT_FIND_MODULE})}},{key:"searchGroupByID",value:function(e){var t=this._getModule(7);return t?t.searchGroupByID(e):jn({code:qn.CANNOT_FIND_MODULE})}},{key:"getGroupOnlineMemberCount",value:function(e){var t=this._getModule(7);return t?t.getGroupOnlineMemberCount(e):jn({code:qn.CANNOT_FIND_MODULE})}},{key:"changeGroupOwner",value:function(e){var t=this._getModule(7);return t?t.changeGroupOwner(e):jn({code:qn.CANNOT_FIND_MODULE})}},{key:"getGroupApplicationList",value:function(){var e=this._getModule(7);return e?e.getGroupApplicationList():jn({code:qn.CANNOT_FIND_MODULE})}},{key:"handleGroupApplication",value:function(e){var t=this._getModule(7);return t?t.handleGroupApplication(e):jn({code:qn.CANNOT_FIND_MODULE})}},{key:"initGroupAttributes",value:function(e){var t=this._getModule(7);return t?t.initGroupAttributes(e):jn({code:qn.CANNOT_FIND_MODULE})}},{key:"setGroupAttributes",value:function(e){var t=this._getModule(7);return t?t.setGroupAttributes(e):jn({code:qn.CANNOT_FIND_MODULE})}},{key:"deleteGroupAttributes",value:function(e){var t=this._getModule(7);return t?t.deleteGroupAttributes(e):jn({code:qn.CANNOT_FIND_MODULE})}},{key:"getGroupAttributes",value:function(e){var t=this._getModule(7);return t?t.getGroupAttributes(e):jn({code:qn.CANNOT_FIND_MODULE})}},{key:"setGroupCounters",value:function(e){var t=this._getModule(7);return t?t.setGroupCounters(e):jn({code:qn.CANNOT_FIND_MODULE})}},{key:"increaseGroupCounter",value:function(e){var t=this._getModule(7);return t?t.increaseGroupCounter(e):jn({code:qn.CANNOT_FIND_MODULE})}},{key:"decreaseGroupCounter",value:function(e){var t=this._getModule(7);return t?t.decreaseGroupCounter(e):jn({code:qn.CANNOT_FIND_MODULE})}},{key:"getGroupCounters",value:function(e){var t=this._getModule(7);return t?t.getGroupCounters(e):jn({code:qn.CANNOT_FIND_MODULE})}},{key:"getGroupMemberList",value:function(e){var t=this._getModule(7);return t?t.getGroupMemberList(e):jn({code:qn.CANNOT_FIND_MODULE})}},{key:"getGroupMemberProfile",value:function(e){var t=this._getModule(7);return t?t.getGroupMemberProfile(e):jn({code:qn.CANNOT_FIND_MODULE})}},{key:"addGroupMember",value:function(e){var t=this._getModule(7);return t?t.addGroupMember(e):jn({code:qn.CANNOT_FIND_MODULE})}},{key:"deleteGroupMember",value:function(e){var t=this._getModule(7);return t?t.deleteGroupMember(e):jn({code:qn.CANNOT_FIND_MODULE})}},{key:"setGroupMemberMuteTime",value:function(e){var t=this._getModule(7);return t?t.setGroupMemberMuteTime(e):jn({code:qn.CANNOT_FIND_MODULE})}},{key:"setGroupMemberRole",value:function(e){var t=this._getModule(7);return t?t.setGroupMemberRole(e):jn({code:qn.CANNOT_FIND_MODULE})}},{key:"setGroupMemberNameCard",value:function(e){var t=this._getModule(7);return t?t.setGroupMemberNameCard(e):jn({code:qn.CANNOT_FIND_MODULE})}},{key:"setGroupMemberCustomField",value:function(e){var t=this._getModule(7);return t?t.setGroupMemberCustomField(e):jn({code:qn.CANNOT_FIND_MODULE})}},{key:"markGroupMemberList",value:function(e){var t=this._getModule(7);return t?t.markGroupMemberList(e):jn({code:qn.CANNOT_FIND_MODULE})}},{key:"getJoinedCommunityList",value:function(){return this._getModule(10).getJoinedCommunityList()}},{key:"createTopicInCommunity",value:function(e){return this._getModule(10).createTopicInCommunity(e)}},{key:"deleteTopicFromCommunity",value:function(e){return this._getModule(10).deleteTopicFromCommunity(e)}},{key:"updateTopicProfile",value:function(e){return this._getModule(10).updateTopicProfile(e)}},{key:"getTopicList",value:function(e){return this._getModule(10).getTopicList(e)}},{key:"addSignalingListener",value:function(e,t,n){var r=this._getModule(33);r&&r.addSignalingListener(e,this._safetyCallbackFactory.defense(e,t,n),n)}},{key:"removeSignalingListener",value:function(e,t,n){var r=this._safetyCallbackFactory.find(e,t);if(null!==r){var o=this._getModule(33);o&&(o.removeSignalingListener(e,r,n),this._safetyCallbackFactory.delete(e,t))}}},{key:"invite",value:function(e){var t=this._getModule(33);return t?t.invite(e):jn({code:qn.CANNOT_FIND_MODULE})}},{key:"inviteSync",value:function(e,t,n){var r=this._getModule(33);return r?r.inviteSync(e,t,n):""}},{key:"inviteInGroup",value:function(e){var t=this._getModule(33);return t?t.invite(e):jn({code:qn.CANNOT_FIND_MODULE})}},{key:"inviteInGroupSync",value:function(e,t,n){var r=this._getModule(33);return r?r.inviteSync(e,t,n):""}},{key:"cancel",value:function(e){var t=this._getModule(33);return t?t.cancel(e):jn({code:qn.CANNOT_FIND_MODULE})}},{key:"accept",value:function(e){var t=this._getModule(33);return t?t.accept(e):jn({code:qn.CANNOT_FIND_MODULE})}},{key:"reject",value:function(e){var t=this._getModule(33);return t?t.reject(e):jn({code:qn.CANNOT_FIND_MODULE})}},{key:"getSignalingInfo",value:function(e){var t=this._getModule(33);return t?t.getSignalingInfo(e):null}},{key:"modifyInvitation",value:function(e){var t=this._getModule(33);return t?t.modifyInvitation(e):jn({code:qn.CANNOT_FIND_MODULE})}}]),e}(),Vi={login:1,logout:1,getLoginUser:1,destroy:1,on:1,off:1,ready:1,setLogLevel:1,joinGroup:1,quitGroup:1,registerPlugin:1,getGroupOnlineMemberCount:1,isReady:1,addSignalingListener:1,removeSignalingListener:1,callExperimentalAPI:1};function Bi(e,t){if(e.isReady()||1===Vi[t])return!0;var n=e.getNotReadyReason(),r={code:n,message:"".concat(e.getErrorMessage(n)," | ").concat(t," | ").concat(e.getErrorMessage(qn.SDK_IS_NOT_READY))};return e.onError(r),r}var ji={},Hi={create:function(e){var n="TencentCloudChat.create",r=0,o=e.SDKAppID;if(et(o))r=o;else if(r=parseInt(o),isNaN(o))return Ge.e("".concat(n," failed. Failed to parse the SDKAppID, please check the arguments")),null;if(r&&ji[r])return ji[r];Ge.l("".concat(n));var i=new qi(t(t({},e),{},{SDKAppID:r}));i.on(A.SDK_DESTROY,(function(e){ji[e.data.SDKAppID]=null,delete ji[e.data.SDKAppID]}));var a=function(e){var t=Object.create(null);return Object.keys(Gn).forEach((function(n){if(e[n]){var r=new N;t[n]=function(){var t=Array.from(arguments);return r.use((function(t,r){var o=Bi(e,n);return!0===o?r():jn(o)})).use((function(e,t){if(!0===en(e,Un[n],n))return t()})).use((function(t,r){return e[n].apply(e,t)})),r.run(t)}}})),t}(i);return ji[r]=a,Un.hookGetAPITips(i.getErrorMessage.bind(i)),Ge.l("".concat(n," ok")),a}};return Hi.TYPES=O,Hi.EVENT=A,Hi.TSignaling=R,Hi.VERSION="3.2.3",Ge.l("TencentCloudChat.VERSION:".concat(Hi.VERSION)),Hi}))}).call(this,n("bc2e")["default"],n("543d")["default"],n("c8ba"))},1823:function(e){e.exports=JSON.parse('{"uni-popup.cancel":"cancel","uni-popup.ok":"ok","uni-popup.placeholder":"pleace enter","uni-popup.title":"Hint","uni-popup.shareTitle":"Share to"}')},"195c":function(e,t,n){"use strict";(function(e){var r=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n("9523")),i=r(n("5c0c")),a=r(n("146c"));function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){(0,o.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var c={common:{method:"GET",header:{"content-type":"application/json"},data:{},loading:{show:!1,text:"加载中"}},request:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n.url=i.default.webUrl+n.url,n.method=n.method||this.common.method,n.header=n.header||this.common.header;var r=u(u({},n),{},{header:{"content-type":"application/json",Token:a.default.getters.token}});return new Promise((function(n,o){t.common.loading.show&&e.showLoading({title:t.common.loading.text}),e.request(u(u({},r),{},{success:function(r){return 401===r.data.Code?(e.hideLoading(),t.$U.gotoPageAndClosePage("/pages/login/index"),o(r.data)):200!==r.data.Code?(e.hideLoading(),e.showToast({title:r.data.Message||"请求失败",icon:"none"}),o(r.data)):(n(r.data),void e.hideLoading())},fail:function(t){return e.showToast({title:"请求失败",icon:"none"}),e.hideLoading(),o()}}))}))},get:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return n.url=e,n.data=t,n.method="GET",r.show&&(this.common.loading.show=r.show),n.text&&(this.common.loading.text=r.text),this.request(n)},post:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return n.url=e,n.data=t,n.method="POST",r.show&&(this.common.loading.show=r.show),n.text&&(this.common.loading.text=r.text),this.request(n)},upload:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n.url=i.default.webUrl+t,n.header=n.header||this.common.header,n.header.Token=a.default.getters.token||"",console.log("options：",n),new Promise((function(t,r){e.uploadFile(u(u({},n),{},{success:function(n){if(200!==n.statusCode)return e.showToast({title:"上传图片失败",icon:"none"});var r=JSON.parse(n.data);t(r),console.log("uploadFileRes:",n)},fail:function(e){console.log("err:",e),r(e)}}))}))}};t.default=c}).call(this,n("543d")["default"])},"1a99":function(e,t,n){"use strict";var r=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"TUIChat",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"TUIContact",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"TUIConversation",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"TUIGroup",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"TUISearch",{enumerable:!0,get:function(){return a.default}}),t.default=void 0;var o=r(n("40cd")),i=r(n("2bcf")),a=r(n("f4b4")),s=r(n("9547")),u=r(n("1d1e")),c={TUIChat:o.default,TUIConversation:i.default,TUIContact:s.default,TUISearch:a.default,TUIGroup:u.default},l=c;t.default=l},"1d1e":function(e,t,n){"use strict";var r=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n("23da")),i=r(n("b4fc"));i.default.getInstance();var a=o.default;t.default=a},"1e3e":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.enableSampleTaskStatus=function(e){var t=r.TUIStore.getData(r.StoreName.APP,"tasks");e in t&&!t[e]&&(t[e]=!0,r.TUIStore.update(r.StoreName.APP,"tasks",t))};var r=n("a6ed")},"1eb1":function(e,t,n){"use strict";var r=n("4ea4"),o=n("7037");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n("2eee")),a=r(n("c973")),s=r(n("970b")),u=r(n("5bc3")),c=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==o(e)&&"function"!==typeof e)return{default:e};var n=f(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(r,a,s):r[a]=e[a]}r.default=e,n&&n.set(e,r);return r}(n("e16a")),l=n("a6ed"),d=n("d31c");function f(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(f=function(e){return e?n:t})(e)}var p=function(){function e(){(0,s.default)(this,e),c.default.registerService(c.TUIConstants.TUISearch.SERVICE.NAME,this),c.default.registerExtension(c.TUIConstants.TUIChat.EXTENSION.INPUT_MORE.EXT_ID,this)}return(0,u.default)(e,[{key:"onCall",value:function(e,t){switch(e){case c.TUIConstants.TUISearch.SERVICE.METHOD.SEARCH_GROUP:return this.searchGroup(null===t||void 0===t?void 0:t.groupID);case c.TUIConstants.TUISearch.SERVICE.METHOD.SEARCH_USER:return this.searchUser(null===t||void 0===t?void 0:t.userID);case c.TUIConstants.TUISearch.SERVICE.METHOD.SEARCH_FRIEND:return this.searchFriend(null===t||void 0===t?void 0:t.userID);case c.TUIConstants.TUISearch.SERVICE.METHOD.SEARCH_GROUP_MEMBER:return this.searchGroupMember(null===t||void 0===t?void 0:t.groupID,null===t||void 0===t?void 0:t.userID)}}},{key:"onGetExtension",value:function(e,t){if(e===c.TUIConstants.TUIChat.EXTENSION.INPUT_MORE.EXT_ID){if(d.isUniFrameWork)return[];var n={weight:3e3,text:"搜索",icon:"https://web.sdk.qcloud.com/component/TUIKit/assets/message-search.svg",data:{name:"search"},listener:{onClicked:function(e){l.TUIStore.update(l.StoreName.CUSTOM,"isShowInConversationSearch",!0)}}};return[n]}}},{key:"searchFriend",value:function(){var e=(0,a.default)(i.default.mark((function e(t){return i.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",l.TUIFriendService.getFriendProfile({userIDList:[t]}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"searchUser",value:function(){var e=(0,a.default)(i.default.mark((function e(t){return i.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",l.TUIUserService.getUserProfile({userIDList:[t]}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"searchGroup",value:function(){var e=(0,a.default)(i.default.mark((function e(t){return i.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",l.TUIGroupService.searchGroupByID(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"searchGroupMember",value:function(){var e=(0,a.default)(i.default.mark((function e(t,n){return i.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",l.TUIGroupService.getGroupMemberProfile({groupID:t,userIDList:[n]}));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}();t.default=p},2011:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;var r=n("66fd");function o(e,t,n){if(n)if(n.lifecycles)n.lifecycles.forEach((function(e){t.includes(e)||t.push(e)}));else{var r=n.toString();e.forEach((function(e){!t.includes(e)&&new RegExp("\\b(".concat(e,")\\b")).test(r)&&t.push(e)}))}}t.init=function(e){var t=r.default.config.optionMergeStrategies.setup,n=r.default.extend;r.default.extend=function(){var e=n.apply(this,arguments),t=e.options,r=t.setup;return r&&r.lifecycles&&r.lifecycles.forEach((function(e){t[e]=t[e]||[function(){}]})),e},Object.defineProperty(r.default.config.optionMergeStrategies,"setup",{set:function(e){t=e},get:function(){return function(n,r){if("function"===typeof t){var i=t.apply(this,arguments);return i.lifecycles=i.lifecycles||[],o(e,i.lifecycles,r),o(e,i.lifecycles,n),i}}}})}},2236:function(e,t,n){var r=n("5a43");e.exports=function(e){if(Array.isArray(e))return r(e)},e.exports.__esModule=!0,e.exports["default"]=e.exports},"24ef":function(e,t,n){e.exports=n.p+"static/img/start-group.d788a01c.svg"},"25d1":function(e,t,n){},"26cb":function(e,t,n){"use strict";(function(t){var n="undefined"!==typeof window?window:"undefined"!==typeof t?t:{},r=n.__VUE_DEVTOOLS_GLOBAL_HOOK__;function o(e,t){if(void 0===t&&(t=[]),null===e||"object"!==typeof e)return e;var n=function(e,t){return e.filter(t)[0]}(t,(function(t){return t.original===e}));if(n)return n.copy;var r=Array.isArray(e)?[]:{};return t.push({original:e,copy:r}),Object.keys(e).forEach((function(n){r[n]=o(e[n],t)})),r}function i(e,t){Object.keys(e).forEach((function(n){return t(e[n],n)}))}function a(e){return null!==e&&"object"===typeof e}var s=function(e,t){this.runtime=t,this._children=Object.create(null),this._rawModule=e;var n=e.state;this.state=("function"===typeof n?n():n)||{}},u={namespaced:{configurable:!0}};u.namespaced.get=function(){return!!this._rawModule.namespaced},s.prototype.addChild=function(e,t){this._children[e]=t},s.prototype.removeChild=function(e){delete this._children[e]},s.prototype.getChild=function(e){return this._children[e]},s.prototype.hasChild=function(e){return e in this._children},s.prototype.update=function(e){this._rawModule.namespaced=e.namespaced,e.actions&&(this._rawModule.actions=e.actions),e.mutations&&(this._rawModule.mutations=e.mutations),e.getters&&(this._rawModule.getters=e.getters)},s.prototype.forEachChild=function(e){i(this._children,e)},s.prototype.forEachGetter=function(e){this._rawModule.getters&&i(this._rawModule.getters,e)},s.prototype.forEachAction=function(e){this._rawModule.actions&&i(this._rawModule.actions,e)},s.prototype.forEachMutation=function(e){this._rawModule.mutations&&i(this._rawModule.mutations,e)},Object.defineProperties(s.prototype,u);var c=function(e){this.register([],e,!1)};c.prototype.get=function(e){return e.reduce((function(e,t){return e.getChild(t)}),this.root)},c.prototype.getNamespace=function(e){var t=this.root;return e.reduce((function(e,n){return t=t.getChild(n),e+(t.namespaced?n+"/":"")}),"")},c.prototype.update=function(e){(function e(t,n,r){0;if(n.update(r),r.modules)for(var o in r.modules){if(!n.getChild(o))return void 0;e(t.concat(o),n.getChild(o),r.modules[o])}})([],this.root,e)},c.prototype.register=function(e,t,n){var r=this;void 0===n&&(n=!0);var o=new s(t,n);if(0===e.length)this.root=o;else{var a=this.get(e.slice(0,-1));a.addChild(e[e.length-1],o)}t.modules&&i(t.modules,(function(t,o){r.register(e.concat(o),t,n)}))},c.prototype.unregister=function(e){var t=this.get(e.slice(0,-1)),n=e[e.length-1],r=t.getChild(n);r&&r.runtime&&t.removeChild(n)},c.prototype.isRegistered=function(e){var t=this.get(e.slice(0,-1)),n=e[e.length-1];return!!t&&t.hasChild(n)};var l;var d=function(e){var t=this;void 0===e&&(e={}),!l&&"undefined"!==typeof window&&window.Vue&&y(window.Vue);var n=e.plugins;void 0===n&&(n=[]);var o=e.strict;void 0===o&&(o=!1),this._committing=!1,this._actions=Object.create(null),this._actionSubscribers=[],this._mutations=Object.create(null),this._wrappedGetters=Object.create(null),this._modules=new c(e),this._modulesNamespaceMap=Object.create(null),this._subscribers=[],this._watcherVM=new l,this._makeLocalGettersCache=Object.create(null);var i=this,a=this.dispatch,s=this.commit;this.dispatch=function(e,t){return a.call(i,e,t)},this.commit=function(e,t,n){return s.call(i,e,t,n)},this.strict=o;var u=this._modules.root.state;v(this,u,[],this._modules.root),g(this,u),n.forEach((function(e){return e(t)}));var d=void 0!==e.devtools?e.devtools:l.config.devtools;d&&function(e){r&&(e._devtoolHook=r,r.emit("vuex:init",e),r.on("vuex:travel-to-state",(function(t){e.replaceState(t)})),e.subscribe((function(e,t){r.emit("vuex:mutation",e,t)}),{prepend:!0}),e.subscribeAction((function(e,t){r.emit("vuex:action",e,t)}),{prepend:!0}))}(this)},f={state:{configurable:!0}};function p(e,t,n){return t.indexOf(e)<0&&(n&&n.prepend?t.unshift(e):t.push(e)),function(){var n=t.indexOf(e);n>-1&&t.splice(n,1)}}function h(e,t){e._actions=Object.create(null),e._mutations=Object.create(null),e._wrappedGetters=Object.create(null),e._modulesNamespaceMap=Object.create(null);var n=e.state;v(e,n,[],e._modules.root,!0),g(e,n,t)}function g(e,t,n){var r=e._vm;e.getters={},e._makeLocalGettersCache=Object.create(null);var o=e._wrappedGetters,a={};i(o,(function(t,n){a[n]=function(e,t){return function(){return e(t)}}(t,e),Object.defineProperty(e.getters,n,{get:function(){return e._vm[n]},enumerable:!0})}));var s=l.config.silent;l.config.silent=!0,e._vm=new l({data:{$$state:t},computed:a}),l.config.silent=s,e.strict&&function(e){e._vm.$watch((function(){return this._data.$$state}),(function(){0}),{deep:!0,sync:!0})}(e),r&&(n&&e._withCommit((function(){r._data.$$state=null})),l.nextTick((function(){return r.$destroy()})))}function v(e,t,n,r,o){var i=!n.length,a=e._modules.getNamespace(n);if(r.namespaced&&(e._modulesNamespaceMap[a],e._modulesNamespaceMap[a]=r),!i&&!o){var s=_(t,n.slice(0,-1)),u=n[n.length-1];e._withCommit((function(){l.set(s,u,r.state)}))}var c=r.context=function(e,t,n){var r=""===t,o={dispatch:r?e.dispatch:function(n,r,o){var i=m(n,r,o),a=i.payload,s=i.options,u=i.type;return s&&s.root||(u=t+u),e.dispatch(u,a)},commit:r?e.commit:function(n,r,o){var i=m(n,r,o),a=i.payload,s=i.options,u=i.type;s&&s.root||(u=t+u),e.commit(u,a,s)}};return Object.defineProperties(o,{getters:{get:r?function(){return e.getters}:function(){return function(e,t){if(!e._makeLocalGettersCache[t]){var n={},r=t.length;Object.keys(e.getters).forEach((function(o){if(o.slice(0,r)===t){var i=o.slice(r);Object.defineProperty(n,i,{get:function(){return e.getters[o]},enumerable:!0})}})),e._makeLocalGettersCache[t]=n}return e._makeLocalGettersCache[t]}(e,t)}},state:{get:function(){return _(e.state,n)}}}),o}(e,a,n);r.forEachMutation((function(t,n){var r=a+n;(function(e,t,n,r){var o=e._mutations[t]||(e._mutations[t]=[]);o.push((function(t){n.call(e,r.state,t)}))})(e,r,t,c)})),r.forEachAction((function(t,n){var r=t.root?n:a+n,o=t.handler||t;(function(e,t,n,r){var o=e._actions[t]||(e._actions[t]=[]);o.push((function(t){var o=n.call(e,{dispatch:r.dispatch,commit:r.commit,getters:r.getters,state:r.state,rootGetters:e.getters,rootState:e.state},t);return function(e){return e&&"function"===typeof e.then}(o)||(o=Promise.resolve(o)),e._devtoolHook?o.catch((function(t){throw e._devtoolHook.emit("vuex:error",t),t})):o}))})(e,r,o,c)})),r.forEachGetter((function(t,n){var r=a+n;(function(e,t,n,r){if(e._wrappedGetters[t])return void 0;e._wrappedGetters[t]=function(e){return n(r.state,r.getters,e.state,e.getters)}})(e,r,t,c)})),r.forEachChild((function(r,i){v(e,t,n.concat(i),r,o)}))}function _(e,t){return t.reduce((function(e,t){return e[t]}),e)}function m(e,t,n){return a(e)&&e.type&&(n=t,t=e,e=e.type),{type:e,payload:t,options:n}}function y(e){l&&e===l||(l=e,
/*!
 * vuex v3.6.2
 * (c) 2021 Evan You
 * @license MIT
 */
function(e){var t=Number(e.version.split(".")[0]);if(t>=2)e.mixin({beforeCreate:r});else{var n=e.prototype._init;e.prototype._init=function(e){void 0===e&&(e={}),e.init=e.init?[r].concat(e.init):r,n.call(this,e)}}function r(){var e=this.$options;e.store?this.$store="function"===typeof e.store?e.store():e.store:e.parent&&e.parent.$store&&(this.$store=e.parent.$store)}}(l))}f.state.get=function(){return this._vm._data.$$state},f.state.set=function(e){0},d.prototype.commit=function(e,t,n){var r=this,o=m(e,t,n),i=o.type,a=o.payload,s=(o.options,{type:i,payload:a}),u=this._mutations[i];u&&(this._withCommit((function(){u.forEach((function(e){e(a)}))})),this._subscribers.slice().forEach((function(e){return e(s,r.state)})))},d.prototype.dispatch=function(e,t){var n=this,r=m(e,t),o=r.type,i=r.payload,a={type:o,payload:i},s=this._actions[o];if(s){try{this._actionSubscribers.slice().filter((function(e){return e.before})).forEach((function(e){return e.before(a,n.state)}))}catch(c){0}var u=s.length>1?Promise.all(s.map((function(e){return e(i)}))):s[0](i);return new Promise((function(e,t){u.then((function(t){try{n._actionSubscribers.filter((function(e){return e.after})).forEach((function(e){return e.after(a,n.state)}))}catch(c){0}e(t)}),(function(e){try{n._actionSubscribers.filter((function(e){return e.error})).forEach((function(t){return t.error(a,n.state,e)}))}catch(c){0}t(e)}))}))}},d.prototype.subscribe=function(e,t){return p(e,this._subscribers,t)},d.prototype.subscribeAction=function(e,t){var n="function"===typeof e?{before:e}:e;return p(n,this._actionSubscribers,t)},d.prototype.watch=function(e,t,n){var r=this;return this._watcherVM.$watch((function(){return e(r.state,r.getters)}),t,n)},d.prototype.replaceState=function(e){var t=this;this._withCommit((function(){t._vm._data.$$state=e}))},d.prototype.registerModule=function(e,t,n){void 0===n&&(n={}),"string"===typeof e&&(e=[e]),this._modules.register(e,t),v(this,this.state,e,this._modules.get(e),n.preserveState),g(this,this.state)},d.prototype.unregisterModule=function(e){var t=this;"string"===typeof e&&(e=[e]),this._modules.unregister(e),this._withCommit((function(){var n=_(t.state,e.slice(0,-1));l.delete(n,e[e.length-1])})),h(this)},d.prototype.hasModule=function(e){return"string"===typeof e&&(e=[e]),this._modules.isRegistered(e)},d.prototype[[104,111,116,85,112,100,97,116,101].map((function(e){return String.fromCharCode(e)})).join("")]=function(e){this._modules.update(e),h(this,!0)},d.prototype._withCommit=function(e){var t=this._committing;this._committing=!0,e(),this._committing=t},Object.defineProperties(d.prototype,f);var I=C((function(e,t){var n={};return E(t).forEach((function(t){var r=t.key,o=t.val;n[r]=function(){var t=this.$store.state,n=this.$store.getters;if(e){var r=k(this.$store,"mapState",e);if(!r)return;t=r.context.state,n=r.context.getters}return"function"===typeof o?o.call(this,t,n):t[o]},n[r].vuex=!0})),n})),M=C((function(e,t){var n={};return E(t).forEach((function(t){var r=t.key,o=t.val;n[r]=function(){var t=[],n=arguments.length;while(n--)t[n]=arguments[n];var r=this.$store.commit;if(e){var i=k(this.$store,"mapMutations",e);if(!i)return;r=i.context.commit}return"function"===typeof o?o.apply(this,[r].concat(t)):r.apply(this.$store,[o].concat(t))}})),n})),T=C((function(e,t){var n={};return E(t).forEach((function(t){var r=t.key,o=t.val;o=e+o,n[r]=function(){if(!e||k(this.$store,"mapGetters",e))return this.$store.getters[o]},n[r].vuex=!0})),n})),S=C((function(e,t){var n={};return E(t).forEach((function(t){var r=t.key,o=t.val;n[r]=function(){var t=[],n=arguments.length;while(n--)t[n]=arguments[n];var r=this.$store.dispatch;if(e){var i=k(this.$store,"mapActions",e);if(!i)return;r=i.context.dispatch}return"function"===typeof o?o.apply(this,[r].concat(t)):r.apply(this.$store,[o].concat(t))}})),n}));function E(e){return function(e){return Array.isArray(e)||a(e)}(e)?Array.isArray(e)?e.map((function(e){return{key:e,val:e}})):Object.keys(e).map((function(t){return{key:t,val:e[t]}})):[]}function C(e){return function(t,n){return"string"!==typeof t?(n=t,t=""):"/"!==t.charAt(t.length-1)&&(t+="/"),e(t,n)}}function k(e,t,n){var r=e._modulesNamespaceMap[n];return r}function b(e,t,n){var r=n?e.groupCollapsed:e.group;try{r.call(e,t)}catch(o){e.log(t)}}function D(e){try{e.groupEnd()}catch(t){e.log("—— log end ——")}}function A(){var e=new Date;return" @ "+O(e.getHours(),2)+":"+O(e.getMinutes(),2)+":"+O(e.getSeconds(),2)+"."+O(e.getMilliseconds(),3)}function O(e,t){return function(e,t){return new Array(t+1).join(e)}("0",t-e.toString().length)+e}var R={Store:d,install:y,version:"3.6.2",mapState:I,mapMutations:M,mapGetters:T,mapActions:S,createNamespacedHelpers:function(e){return{mapState:I.bind(null,e),mapGetters:T.bind(null,e),mapMutations:M.bind(null,e),mapActions:S.bind(null,e)}},createLogger:function(e){void 0===e&&(e={});var t=e.collapsed;void 0===t&&(t=!0);var n=e.filter;void 0===n&&(n=function(e,t,n){return!0});var r=e.transformer;void 0===r&&(r=function(e){return e});var i=e.mutationTransformer;void 0===i&&(i=function(e){return e});var a=e.actionFilter;void 0===a&&(a=function(e,t){return!0});var s=e.actionTransformer;void 0===s&&(s=function(e){return e});var u=e.logMutations;void 0===u&&(u=!0);var c=e.logActions;void 0===c&&(c=!0);var l=e.logger;return void 0===l&&(l=console),function(e){var d=o(e.state);"undefined"!==typeof l&&(u&&e.subscribe((function(e,a){var s=o(a);if(n(e,d,s)){var u=A(),c=i(e),f="mutation "+e.type+u;b(l,f,t),l.log("%c prev state","color: #9E9E9E; font-weight: bold",r(d)),l.log("%c mutation","color: #03A9F4; font-weight: bold",c),l.log("%c next state","color: #4CAF50; font-weight: bold",r(s)),D(l)}d=s})),c&&e.subscribeAction((function(e,n){if(a(e,n)){var r=A(),o=s(e),i="action "+e.type+r;b(l,i,t),l.log("%c action","color: #03A9F4; font-weight: bold",o),D(l)}})))}}};e.exports=R}).call(this,n("c8ba"))},"278c":function(e,t,n){var r=n("c135"),o=n("9b42"),i=n("6613"),a=n("c240");e.exports=function(e,t){return r(e)||o(e,t)||i(e,t)||a()},e.exports.__esModule=!0,e.exports["default"]=e.exports},"2ab0":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={vueVersion:!0};t.vueVersion=void 0;var o,i=n("fd0e");Object.keys(i).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(r,e)||e in t&&t[e]===i[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}}))})),t.vueVersion=o,t.vueVersion=o=2,console.warn("[adapter-vue]: vue version is ".concat(o))},"2bcf":function(e,t,n){"use strict";var r=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n("45d9")),i=r(n("0ccb"));new i.default;var a=o.default;t.default=a},"2bd8":function(e,t,n){"use strict";(function(e){var r=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;r(n("5c0c"));var o=r(n("146c"));var i={userInfo:function(){var t="";try{if(o.default&&o.default.getters.userInfoDoctor)t=o.default.getters.userInfoDoctor;else{var n=e.getStorageSync("doctor-userinfo");n&&(t=n)}}catch(r){console.log(r)}return t}()},a={namespaced:!0,state:i,mutations:{SET_USER_INFO:function(e,t){e.userInfo=t}},actions:{setUserInfo:function(e,t){var n=e.commit;n("SET_USER_INFO",t)}}};t.default=a}).call(this,n("543d")["default"])},"2e55":function(e,t,n){"use strict";var r=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.EXPIRETIME=void 0,t.genTestUserSig=function(e){var t=e.SDKAppID,n=e.secretKey,r=e.userID,i=new o.default(t,n,604800),a=i.genTestUserSig(r);return{SDKAppID:t,userSig:a}};var o=r(n("a107"));t.EXPIRETIME=604800},"2e5d":function(e){e.exports=JSON.parse('{"uni-load-more.contentdown":"Pull up to show more","uni-load-more.contentrefresh":"loading...","uni-load-more.contentnomore":"No more data"}')},"2eee":function(e,t,n){var r=n("7ec2")();e.exports=r},"32e2":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={"常用语-快捷回复工具":"常用语-快捷回复工具","在吗？在吗？在吗？重要的话说三遍。":"在吗？在吗？在吗？重要的话说三遍。","好久没聊天了，快来和我说说话～":"好久没聊天了，快来和我说说话～","好的，就这么说定了。":"好的，就这么说定了。","感恩的心，感谢有你。":"感恩的心，感谢有你。","糟糕！是心动的感觉！":"糟糕！是心动的感觉！","心疼地抱抱自己，我太难了！":"心疼地抱抱自己，我太难了！","没关系，别在意，事情过去就过去了。":"没关系，别在意，事情过去就过去了。","早上好，今天也是让人期待的一天呢！":"早上好，今天也是让人期待的一天呢！","熬夜有什么用，又没人陪你聊天，早点休息吧。":"熬夜有什么用，又没人陪你聊天，早点休息吧。"};t.default=r},"32ed":function(e,t,n){"use strict";var r=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n("7210")),i=r(n("6cde")),a=r(n("fba4")),s=r(n("43d8")),u=r(n("9c82")),c=r(n("d085")),l=r(n("d782")),d=r(n("67ae")),f=r(n("ef7d")),p=r(n("ff45")),h={en:{"取消":"Cancel","发送":"Send","系统通知":"System notification","关闭":"Close","确定":"Save","开始时间":"Start Date","结束时间":"End Date",TUIChat:o.default,TUIConversation:i.default,TUIGroup:a.default,TUIContact:s.default,message:c.default,component:l.default,time:d.default,Evaluate:p.default,Words:f.default,TUISearch:u.default}},g=h;t.default=g},"36c6":function(e,t){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},e.exports.__esModule=!0,e.exports["default"]=e.exports,n(t)}e.exports=n,e.exports.__esModule=!0,e.exports["default"]=e.exports},"37dc":function(e,t,n){"use strict";(function(e,r){var o=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.LOCALE_ZH_HANT=t.LOCALE_ZH_HANS=t.LOCALE_FR=t.LOCALE_ES=t.LOCALE_EN=t.I18n=t.Formatter=void 0,t.compileI18nJsonStr=function(e,t){var n=t.locale,r=t.locales,o=t.delimiters;if(!C(e,o))return e;S||(S=new d);var i=[];Object.keys(r).forEach((function(e){e!==n&&i.push({locale:e,values:r[e]})})),i.unshift({locale:n,values:r[n]});try{return JSON.stringify(b(JSON.parse(e),i,o),null,2)}catch(a){}return e},t.hasI18nJson=function e(t,n){S||(S=new d);return D(t,(function(t,r){var o=t[r];return E(o)?!!C(o,n)||void 0:e(o,n)}))},t.initVueI18n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if("string"!==typeof e){var o=[t,e];e=o[0],t=o[1]}"string"!==typeof e&&(e=T());"string"!==typeof n&&(n="undefined"!==typeof __uniConfig&&__uniConfig.fallbackLocale||"en");var i=new I({locale:e,fallbackLocale:n,messages:t,watcher:r}),a=function(e,t){if("function"!==typeof getApp)a=function(e,t){return i.t(e,t)};else{var n=!1;a=function(e,t){var r=getApp().$vm;return r&&(r.$locale,n||(n=!0,M(r,i))),i.t(e,t)}}return a(e,t)};return{i18n:i,f:function(e,t,n){return i.f(e,t,n)},t:function(e,t){return a(e,t)},add:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return i.add(e,t,n)},watch:function(e){return i.watchLocale(e)},getLocale:function(){return i.getLocale()},setLocale:function(e){return i.setLocale(e)}}},t.isI18nStr=C,t.isString=void 0,t.normalizeLocale=y,t.parseI18nJson=function e(t,n,r){S||(S=new d);return D(t,(function(t,o){var i=t[o];E(i)?C(i,r)&&(t[o]=k(i,n,r)):e(i,n,r)})),t},t.resolveLocale=function(e){return function(t){return t?(t=y(t)||t,function(e){var t=[],n=e.split("-");while(n.length)t.push(n.join("-")),n.pop();return t}(t).find((function(t){return e.indexOf(t)>-1}))):t}};var i=o(n("278c")),a=o(n("970b")),s=o(n("5bc3")),u=o(n("7037")),c=function(e){return null!==e&&"object"===(0,u.default)(e)},l=["{","}"],d=function(){function e(){(0,a.default)(this,e),this._caches=Object.create(null)}return(0,s.default)(e,[{key:"interpolate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l;if(!t)return[e];var r=this._caches[e];return r||(r=h(e,n),this._caches[e]=r),g(r,t)}}]),e}();t.Formatter=d;var f=/^(?:\d)+/,p=/^(?:\w)+/;function h(e,t){var n=(0,i.default)(t,2),r=n[0],o=n[1],a=[],s=0,u="";while(s<e.length){var c=e[s++];if(c===r){u&&a.push({type:"text",value:u}),u="";var l="";c=e[s++];while(void 0!==c&&c!==o)l+=c,c=e[s++];var d=c===o,h=f.test(l)?"list":d&&p.test(l)?"named":"unknown";a.push({value:l,type:h})}else u+=c}return u&&a.push({type:"text",value:u}),a}function g(e,t){var n=[],r=0,o=Array.isArray(t)?"list":c(t)?"named":"unknown";if("unknown"===o)return n;while(r<e.length){var i=e[r];switch(i.type){case"text":n.push(i.value);break;case"list":n.push(t[parseInt(i.value,10)]);break;case"named":"named"===o&&n.push(t[i.value]);break;case"unknown":0;break}r++}return n}t.LOCALE_ZH_HANS="zh-Hans";t.LOCALE_ZH_HANT="zh-Hant";t.LOCALE_EN="en";t.LOCALE_FR="fr";t.LOCALE_ES="es";var v=Object.prototype.hasOwnProperty,_=function(e,t){return v.call(e,t)},m=new d;function y(e,t){if(e){if(e=e.trim().replace(/_/g,"-"),t&&t[e])return e;if(e=e.toLowerCase(),"chinese"===e)return"zh-Hans";if(0===e.indexOf("zh"))return e.indexOf("-hans")>-1?"zh-Hans":e.indexOf("-hant")>-1||function(e,t){return!!t.find((function(t){return-1!==e.indexOf(t)}))}(e,["-tw","-hk","-mo","-cht"])?"zh-Hant":"zh-Hans";var n=["en","fr","es"];t&&Object.keys(t).length>0&&(n=Object.keys(t));var r=function(e,t){return t.find((function(t){return 0===e.indexOf(t)}))}(e,n);return r||void 0}}var I=function(){function e(t){var n=t.locale,r=t.fallbackLocale,o=t.messages,i=t.watcher,s=t.formater;(0,a.default)(this,e),this.locale="en",this.fallbackLocale="en",this.message={},this.messages={},this.watchers=[],r&&(this.fallbackLocale=r),this.formater=s||m,this.messages=o||{},this.setLocale(n||"en"),i&&this.watchLocale(i)}return(0,s.default)(e,[{key:"setLocale",value:function(e){var t=this,n=this.locale;this.locale=y(e,this.messages)||this.fallbackLocale,this.messages[this.locale]||(this.messages[this.locale]={}),this.message=this.messages[this.locale],n!==this.locale&&this.watchers.forEach((function(e){e(t.locale,n)}))}},{key:"getLocale",value:function(){return this.locale}},{key:"watchLocale",value:function(e){var t=this,n=this.watchers.push(e)-1;return function(){t.watchers.splice(n,1)}}},{key:"add",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this.messages[e];r?n?Object.assign(r,t):Object.keys(t).forEach((function(e){_(r,e)||(r[e]=t[e])})):this.messages[e]=t}},{key:"f",value:function(e,t,n){return this.formater.interpolate(e,t,n).join("")}},{key:"t",value:function(e,t,n){var r=this.message;return"string"===typeof t?(t=y(t,this.messages),t&&(r=this.messages[t])):n=t,_(r,e)?this.formater.interpolate(r[e],n).join(""):(console.warn("Cannot translate the value of keypath ".concat(e,". Use the value of keypath as default.")),e)}}]),e}();function M(e,t){e.$watchLocale?e.$watchLocale((function(e){t.setLocale(e)})):e.$watch((function(){return e.$locale}),(function(e){t.setLocale(e)}))}function T(){return"undefined"!==typeof e&&e.getLocale?e.getLocale():"undefined"!==typeof r&&r.getLocale?r.getLocale():"en"}t.I18n=I;var S,E=function(e){return"string"===typeof e};function C(e,t){return e.indexOf(t[0])>-1}function k(e,t,n){return S.interpolate(e,t,n).join("")}function b(e,t,n){return D(e,(function(e,r){(function(e,t,n,r){var o=e[t];if(E(o)){if(C(o,r)&&(e[t]=k(o,n[0].values,r),n.length>1)){var i=e[t+"Locales"]={};n.forEach((function(e){i[e.locale]=k(o,e.values,r)}))}}else b(o,n,r)})(e,r,t,n)})),e}function D(e,t){if(Array.isArray(e)){for(var n=0;n<e.length;n++)if(t(e,n))return!0}else if(c(e))for(var r in e)if(t(e,r))return!0;return!1}t.isString=E}).call(this,n("543d")["default"],n("c8ba"))},3939:function(e,t,n){"use strict";var r=n("4ea4"),o=n("7037");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n("2eee")),a=r(n("c973")),s=r(n("970b")),u=r(n("5bc3")),c=r(n("9523")),l=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==o(e)&&"function"!==typeof e)return{default:e};var n=h(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(r,a,s):r[a]=e[a]}r.default=e,n&&n.set(e,r);return r}(n("e16a")),d=n("a6ed"),f=n("d31c"),p=n("8e85");function h(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(h=function(e){return e?n:t})(e)}var g=function(){function e(){(0,s.default)(this,e),(0,c.default)(this,"onCallParamsMap",void 0),(0,c.default)(this,"onCallCallbackMap",void 0),(0,c.default)(this,"constants",void 0),l.default.registerService(l.TUIConstants.TUIContact.SERVICE.NAME,this),this.onCallParamsMap=new Map,this.onCallCallbackMap=new Map,this.constants=l.TUIConstants}return(0,u.default)(e,[{key:"getOnCallParams",value:function(e){return this.onCallParamsMap.get(e)}},{key:"getOnCallCallback",value:function(e){return this.onCallCallbackMap.get(e)}},{key:"onCall",value:function(){var e=(0,a.default)(i.default.mark((function e(t,n,r){return i.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.onCallParamsMap.set(t,n),this.onCallCallbackMap.set(t,r),console.log("method:",t),console.log("params:",n),console.log("onCall:",r),t===l.TUIConstants.TUIContact.SERVICE.METHOD.SELECT_FRIEND&&(d.TUIStore.update(d.StoreName.CUSTOM,"isShowSelectFriendComponent",!0),f.isUniFrameWork&&(null===p.TUIGlobal||void 0===p.TUIGlobal||p.TUIGlobal.reLaunch({url:"/TUIKit/components/TUIContact/index"})));case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();t.default=g,(0,c.default)(g,"instance",void 0)},"3c96":function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.__esModule=!0,e.exports["default"]=e.exports},"3d07":function(e,t,n){"use strict";var r=n("4ea4"),o=n("7037");Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"TUIChat",{enumerable:!0,get:function(){return u.TUIChat}}),Object.defineProperty(t,"TUIChatEngine",{enumerable:!0,get:function(){return i.default}}),t.TUIChatKit=void 0,Object.defineProperty(t,"TUIComponents",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"TUIContact",{enumerable:!0,get:function(){return u.TUIContact}}),Object.defineProperty(t,"TUIConversation",{enumerable:!0,get:function(){return u.TUIConversation}}),Object.defineProperty(t,"TUIGroup",{enumerable:!0,get:function(){return u.TUIGroup}}),Object.defineProperty(t,"TUISearch",{enumerable:!0,get:function(){return u.TUISearch}}),Object.defineProperty(t,"genTestUserSig",{enumerable:!0,get:function(){return a.genTestUserSig}});var i=r(n("a6ed")),a=n("fde7"),s=r(n("0af7")),u=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==o(e)&&"function"!==typeof e)return{default:e};var n=c(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(r,a,s):r[a]=e[a]}r.default=e,n&&n.set(e,r);return r}(n("1a99"));function c(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(c=function(e){return e?n:t})(e)}var l=new s.default;t.TUIChatKit=l},"405a":function(e,t,n){"use strict";(function(e){var t=n("3d07"),r=n("2ab0"),o=n("e16a");t.TUIChatKit&&(t.TUIChatKit.init(),e.$chat_userSig=(0,t.genTestUserSig)({userID:e.$chat_userID,SDKAppID:e.$chat_SDKAppID,secretKey:e.$chat_secretKey}).userSig,o.TUILogin.login({SDKAppID:e.$chat_SDKAppID,userID:e.$chat_userID,userSig:e.$chat_userSig,useUploadPlugin:!0,useProfanityFilterPlugin:!1,framework:"vue".concat(r.vueVersion)}).then((function(){e.showToast({title:"login success"})})))}).call(this,n("543d")["default"])},"40cd":function(e,t,n){"use strict";var r=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n("0443")),i=r(n("77bc"));new i.default;var a=o.default;t.default=a},"43d8":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={"群聊通知":"Group Chat Notifications","系统通知":"System Notifications","我的群聊":"My Group Chats","输入ID":"Enter a groupID/userID","群名称":"Group name","群ID":"Group ID","加入群聊":"Join group chat","解散群聊":"Disband group chat","退出群聊":"Quit group chat","进入群聊":"Enter group chat","群类型":"Group type","请填写验证信息":"Enter the verification info","申请加入":"Request to join","已申请":"Requested","接受":"Accept","拒绝":"Refuse","已处理":"Handled","添加群聊":"add group chat","已加入":"joined","该群组不存在":"The group does not exist","加群":"join","我的好友":"Friend","发送消息":"Send Message","个性签名":"Signature","等待管理员同意":"Successful application, waiting for the administrator to agree to join the group application","加群成功":"Join the group successfully","您已是群成员":"You are already a group member","新的联系人":"New Contacts","黑名单":"Blocked List","无搜索结果":"No Result","客服号":"Customer Service List",ID:"ID","联系人":"User","群聊":"Group","添加好友/群聊":"Add friend/group","备注名":"remark","加入黑名单":"block","删除好友":"Delete friend","等待验证":"waiting for verification","验证信息":"verification info","发送申请":"Send application","加入直播群":"Join AVChatRoom","同意":"Agree","删除好友成功":"Delete friend success","删除好友失败":"Delete friend failed","申请已发送":"Application has been sent","申请发送失败":"Application failed to send","进入会话失败":"Failed to enter session","添加好友成功":"Add friend success","同意好友申请失败":"Failed to agree to friend request","拒绝成功":"Reject friend request success","拒绝好友申请失败":"Failed to reject friend request","解散群聊成功":"Dismissed group success","解散群聊失败":"Dismissed group failed","退出群组成功":"Quit group success","退出群组失败":"Quit group failed","申请入群失败":"Application to join the group failed","加入黑名单失败":"Add to blocklist failed","移除黑名单失败":"Remove from blocklist failed","修改备注失败: 备注长度不得超过 96 字节":"Failed to modify the remark: the length of the remark cannot exceed 96 bytes","修改备注成功":"Remark modified success","修改备注失败":"Remark modified failed"};t.default=r},4481:function(e,t,n){"use strict";(function(e){var r=n("4ea4"),o=n("7037");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n("970b")),a=r(n("5bc3")),s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==o(e)&&"function"!==typeof e)return{default:e};var n=u(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(r,a,s):r[a]=e[a]}r.default=e,n&&n.set(e,r);return r}(n("e16a"));function u(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(u=function(e){return e?n:t})(e)}var c=function(){function t(){(0,i.default)(this,t),s.default.registerEvent(s.TUIConstants.TUILogin.EVENT.LOGIN_STATE_CHANGED,s.TUIConstants.TUILogin.EVENT_SUB_KEY.USER_LOGIN_SUCCESS,this),s.default.registerService(s.TUIConstants.TUICalling.SERVICE.NAME,this),s.default.registerExtension(s.TUIConstants.TUIChat.EXTENSION.INPUT_MORE.EXT_ID,this)}return(0,a.default)(t,[{key:"onNotifyEvent",value:function(t,n){if(t===s.TUIConstants.TUILogin.EVENT.LOGIN_STATE_CHANGED)switch(n){case s.TUIConstants.TUILogin.EVENT_SUB_KEY.USER_LOGIN_SUCCESS:var r=s.TUILogin.getContext(),o=r.SDKAppID,i=r.userID,a=r.userSig;e.$TUICallKit&&e.$TUICallKit.login({SDKAppID:o,userID:i,userSig:a},(function(t){0===t.code?(console.log("TUICallkit login success!"),e.$TUICallKit.enableFloatWindow(!0)):console.error("TUICallkit login failed,".concat(t.msg))}));break}}},{key:"onGetExtension",value:function(t,n){var r=this;if(e.$TUICallKit){if(t===s.TUIConstants.TUIChat.EXTENSION.INPUT_MORE.EXT_ID){var o=[],i={weight:1e3,text:"语音通话",icon:"https://web.sdk.qcloud.com/component/TUIKit/assets/call.png",data:{name:"voiceCall"},listener:{onClicked:function(e){r.setCallExtension(e)}}},a={weight:900,text:"视频通话",icon:"https://web.sdk.qcloud.com/component/TUIKit/assets/call-video-reverse.svg",data:{name:"videoCall"},listener:{onClicked:function(e){r.setCallExtension(e)}}};return null!==n&&void 0!==n&&n.filterVoice||o.push(i),null!==n&&void 0!==n&&n.filterVideo||o.push(a),o}}else console.warn("请检查原生插件 TencentCloud-TUICallKit 是否已集成")}},{key:"onCall",value:function(t,n){if(e.$TUICallKit){if(t===s.TUIConstants.TUICalling.SERVICE.METHOD.START_CALL){var r=n.groupID,o=void 0===r?void 0:r,i=n.userIDList,a=void 0===i?[]:i,u=n.type;o?e.$TUICallKit.groupCall({groupID:o,userIDList:a,callMediaType:u},(function(e){0===e.code?console.log("TUICallkit groupCall success"):console.error("TUICallkit groupCall failed,".concat(e.msg))})):1===a.length&&e.$TUICallKit.call({userID:a[0],callMediaType:u},(function(e){0===e.code?console.log("TUICallkit call success"):console.log("TUICallkit call failed,".concat(e.msg))}))}}else console.warn("请检查原生插件 TencentCloud-TUICallKit 是否已集成")}},{key:"setCallExtension",value:function(t){var n=t.groupID,r=void 0===n?void 0:n,o=t.userIDList,i=void 0===o?[]:o,a=t.type;try{r?e.$TUICallKit.groupCall({groupID:r,userIDList:i,callMediaType:a},(function(e){0===e.code?console.log("TUICallkit groupCall success"):console.log("TUICallkit groupCall failed,".concat(e.msg))})):1===i.length&&e.$TUICallKit.call({userID:i[0],callMediaType:a},(function(e){0===e.code?console.log("TUICallkit call success"):console.log("TUICallkit call failed,".concat(e.msg))}))}catch(s){e.showToast({title:"拨打失败！",icon:"error"})}}}]),t}();t.default=c}).call(this,n("543d")["default"])},"448a":function(e,t,n){var r=n("2236"),o=n("11b0"),i=n("6613"),a=n("0676");e.exports=function(e){return r(e)||o(e)||i(e)||a()},e.exports.__esModule=!0,e.exports["default"]=e.exports},"4a2a":function(e,t,n){(function(e,t){var r=n("ed6d"),o=n("6b58"),i=n("36c6"),a=n("970b"),s=n("5bc3"),u=n("7037"),c=n("9523");function l(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=i(e);if(t){var a=i(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return o(this,n)}}var d=e.getSystemInfoSync(),f="__UNI__B5B1A99",p=function(t,n){var r=e.getStorageSync("$$STAT__DBDATA:"+f)||{};r||(r={}),r[t]=n,e.setStorageSync("$$STAT__DBDATA:"+f,r)},h=function(t){var n=e.getStorageSync("$$STAT__DBDATA:"+f)||{};if(!n[t]){var r=e.getStorageSync("$$STAT__DBDATA:"+f);if(r||(r={}),!r[t])return;n[t]=r[t]}return n[t]},g=function(t){var n=e.getStorageSync("$$STAT__DBDATA:"+f)||{};n[t]?(delete n[t],e.setStorageSync("$$STAT__DBDATA:"+f,n)):(n=e.getStorageSync("$$STAT__DBDATA:"+f),n[t]&&(delete n[t],e.setStorageSync("$$STAT__DBDATA:"+f,n)))},v={version:"2",enable:!0},_={},m=n("e56c").default,y=m.pages;for(var I in y){var M,T=y[I],S=T.navigationBarTitleText||T.defaultTitle||(null===(M=T.navigationBar)||void 0===M?void 0:M.titleText)||"";S&&(_[I]=S)}function E(){var t="";if("n"===k()){try{t=plus.runtime.getDCloudId()}catch(n){t=""}return t}try{t=e.getStorageSync("__DC_STAT_UUID")}catch(n){t="__DC_UUID_VALUE"}if(!t){t=Date.now()+""+Math.floor(1e7*Math.random());try{e.setStorageSync("__DC_STAT_UUID",t)}catch(n){e.setStorageSync("__DC_STAT_UUID","__DC_UUID_VALUE")}}return t}var C={appid:"__UNI__B5B1A99"},k=function(){var e,t=(e={app:"n","app-plus":"n",h5:"h5","mp-weixin":"wx"},c(e,["y","a","p","mp-ali"].reverse().join(""),"ali"),c(e,"mp-baidu","bd"),c(e,"mp-toutiao","tt"),c(e,"mp-qq","qq"),c(e,"quickapp-native","qn"),c(e,"mp-kuaishou","ks"),c(e,"mp-lark","lark"),c(e,"quickapp-webview","qw"),e);if("ali"===t["mp-weixin"]&&my&&my.env){var n=my.env.clientName;if("ap"===n)return"ali";if("dingtalk"===n)return"dt"}return t["mp-weixin"]},b=function(t){var n=k(),r="";return t||("wx"===n&&(r=e.getLaunchOptionsSync().scene),r)},D=function(e){var t=e||O();if("bd"===k()){var n=t.$mp&&t.$mp.page&&t.$mp.page.is,r=t.$scope&&t.$scope.is;return n||r||""}return t.route||t.$scope&&t.$scope.route||t.$mp&&t.$mp.page.route},A=function(t){var n=t&&(t.$page||t.$scope&&t.$scope.$page),r=e.getStorageSync("_STAT_LAST_PAGE_ROUTE");return n?"/"===n.fullPath?n.route:n.fullPath||n.route:r||""},O=function(){var e=getCurrentPages(),t=e[e.length-1];return t?t.$vm:null},R=function(e){return"page"===e.mpType||"page"===e.$mpType||e.$mp&&"page"===e.$mp.mpType||"page"===e.$options.mpType?"page":"app"===e.mpType||"app"===e.$mpType||e.$mp&&"app"===e.$mp.mpType||"app"===e.$options.mpType?"app":null},N=function(e){var t=[],n=[],r=[],o=function(o){var i=e[o];i.forEach((function(e){var i;i=e,0===o?t.push(i):3===o?r.push(i):n.push(i)}))};for(var i in e)o(i);return t.push.apply(t,n.concat(r)),JSON.stringify(t)},w=function(e){return _&&_[e]||""},L=function(t){var n={usv:"3.98",conf:JSON.stringify({ak:"__UNI__B5B1A99"})};e.request({url:"https://tongji.dcloud.io/uni/stat",method:"GET",data:n,success:function(e){var n=e.data;0===n.ret&&"function"===typeof t&&t({enable:n.enable})},fail:function(n){var r=1;try{r=e.getStorageSync("Report_Status")}catch(n){r=1}""===r&&(r=1),"function"===typeof t&&t({enable:r})}})},P=function(){if(v.collectItems){var e=v.collectItems.uniStatPageLog;return void 0===e||("boolean"!==typeof e||e)}return!0},U=function(){return parseInt((new Date).getTime()/1e3)},G=function(){var e=h("__first__visit__time"),t=0;return e?t=e:(t=U(),p("__first__visit__time",t),g("__last__visit__time")),t},x=0,F=0,q=function(){return x=U(),p("__page__residence__time",x),x},V=function(){var e=h("__total__visit__count"),t=1;return e&&(t=e,t++),p("__total__visit__count",t),t},B=function(){var e=U(),t=p("__first_time",e);return t},j=function(e){var t=0,n=h("__first_time"),r=U();if(0!==n&&(t=r-n),t=t<1?1:t,"app"===e){var o=t>300;return{residenceTime:t,overtime:o}}if("page"===e){var i=t>1800;return{residenceTime:t,overtime:i}}return{residenceTime:t}},H=function(e){var t=v.reportInterval;if(0===Number(t))return 0;t=t||e;return/(^[1-9]\d*$)/.test(t)?Number(t):e}(10),K={uuid:function(e){return d.deviceId||E()}(),ak:C.appid,p:"android"===d.platform?"a":"i",ut:k(),mpn:function(){var t="";return"wx"!==k()&&"qq"!==k()||e.canIUse("getAccountInfoSync")&&(t=e.getAccountInfoSync().miniProgram.appId||""),k(),t}(),usv:"3.98",v:function(){return"n"===k()?plus.runtime.version:""}(),ch:function(){var e=k(),t="";return"n"===e&&(t=plus.runtime.channel),t}(),cn:"",pn:"",ct:"",t:U(),tt:"",brand:d.brand||"",md:d.model,sv:d.system.replace(/(Android|iOS)\s/,""),mpsdk:d.SDKVersion||"",mpv:d.version||"",lang:d.language,pr:d.pixelRatio,ww:d.windowWidth,wh:d.windowHeight,sw:d.screenWidth,sh:d.screenHeight},W=function(){"use strict";function t(){a(this,t),this.self="",this.__licationShow=!1,this.__licationHide=!1,this.statData=K,this._navigationBarTitle={config:"",page:"",report:"",lt:""},this._query={};var n="function"===typeof e.addInterceptor;n&&(this.addInterceptorInit(),this.interceptLogin(),this.interceptShare(!0),this.interceptRequestPayment())}return s(t,[{key:"addInterceptorInit",value:function(){var t=this;e.addInterceptor("setNavigationBarTitle",{invoke:function(e){t._navigationBarTitle.page=e.title}})}},{key:"interceptLogin",value:function(){var t=this;e.addInterceptor("login",{complete:function(){t._login()}})}},{key:"interceptShare",value:function(t){var n=this;t?e.addInterceptor("share",{success:function(){n._share()},fail:function(){n._share()}}):n._share()}},{key:"interceptRequestPayment",value:function(){var t=this;e.addInterceptor("requestPayment",{success:function(){t._payment("pay_success")},fail:function(){t._payment("pay_fail")}})}},{key:"_login",value:function(){this.sendEventRequest({key:"login"},0)}},{key:"_share",value:function(){this.sendEventRequest({key:"share"},0)}},{key:"_payment",value:function(e){this.sendEventRequest({key:e},0)}},{key:"applicationShow",value:function(){if(this.__licationHide){var t=j("app");if(t.overtime){var n=e.getStorageSync("_STAT_LAST_PAGE_ROUTE"),r={path:n,scene:this.statData.sc,cst:2};this.sendReportRequest(r)}this.__licationHide=!1}}},{key:"applicationHide",value:function(t,n){t||(t=O()),this.__licationHide=!0;var r=j(),o=A(t);e.setStorageSync("_STAT_LAST_PAGE_ROUTE",o),this.sendHideRequest({urlref:o,urlref_ts:r.residenceTime},n),B()}},{key:"pageShow",value:function(t){this._navigationBarTitle={config:"",page:"",report:"",lt:""};var n=A(t),r=D(t);if(this._navigationBarTitle.config=w(r),this.__licationShow)return B(),e.setStorageSync("_STAT_LAST_PAGE_ROUTE",n),void(this.__licationShow=!1);var o=j("page");if(o.overtime){var i={path:n,scene:this.statData.sc,cst:3};this.sendReportRequest(i)}B()}},{key:"pageHide",value:function(t){if(!this.__licationHide){var n=j("page"),r=A(t),o=e.getStorageSync("_STAT_LAST_PAGE_ROUTE");return o||(o=r),e.setStorageSync("_STAT_LAST_PAGE_ROUTE",r),void this.sendPageRequest({url:r,urlref:o,urlref_ts:n.residenceTime})}}},{key:"sendReportRequest",value:function(e,t){this._navigationBarTitle.lt="1",this._navigationBarTitle.config=w(e.path);var n=e.query&&"{}"!==JSON.stringify(e.query),r=n?"?"+JSON.stringify(e.query):"",o=function(){var e=h("__last__visit__time"),t=0;return e&&(t=e),p("__last__visit__time",U()),t}();if(0!==o||!o){var i=function(e){var t="";if("n"===k()){try{t=plus.device.uuid}catch(n){t=""}return t}return d.deviceId||E()}(),a=function(){var e=h("is_handle_device_id")||"";return p("is_handle_device_id","1"),"1"===e}();a||(this.statData.odid=i)}Object.assign(this.statData,{lt:"1",url:e.path+r||"",t:U(),sc:b(e.scene),fvts:G(),lvts:o,tvc:V(),cst:e.cst||1}),"n"===k()?this.getProperty(t):this.getNetworkInfo(t)}},{key:"sendPageRequest",value:function(e){var t=e.url,n=e.urlref,r=e.urlref_ts;this._navigationBarTitle.lt="11";var o={ak:this.statData.ak,uuid:this.statData.uuid,p:this.statData.p,lt:"11",ut:this.statData.ut,url:t,tt:this.statData.tt,urlref:n,urlref_ts:r,ch:this.statData.ch,usv:this.statData.usv,t:U()};this.request(o)}},{key:"sendHideRequest",value:function(e,t){var n=e.urlref,r=e.urlref_ts,o={ak:this.statData.ak,uuid:this.statData.uuid,p:this.statData.p,lt:"3",ut:this.statData.ut,urlref:n,urlref_ts:r,ch:this.statData.ch,usv:this.statData.usv,t:U()};this.request(o,t)}},{key:"sendEventRequest",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.key,n=void 0===t?"":t,r=e.value,o=void 0===r?"":r,i="";try{i=D()}catch(c){var a=h("__launch_options");i=a.path}this._navigationBarTitle.config=w(i),this._navigationBarTitle.lt="21";var s={ak:this.statData.ak,uuid:this.statData.uuid,p:this.statData.p,lt:"21",ut:this.statData.ut,url:i,ch:this.statData.ch,e_n:n,e_v:"object"===u(o)?JSON.stringify(o):o.toString(),usv:this.statData.usv,t:U()};this.request(s)}},{key:"sendPushRequest",value:function(e,t){var n=this,r=U(),o={lt:"101",cid:t,t:r,ut:this.statData.ut};var i=N({101:[o]}),a={usv:"3.98",t:r,requests:i};"n"!==k()||"a"!==this.statData.p?this.sendRequest(a):setTimeout((function(){n.sendRequest(a)}),200)}},{key:"getProperty",value:function(e){var t=this;plus.runtime.getProperty(plus.runtime.appid,(function(n){t.statData.v=n.version||"",t.getNetworkInfo(e)}))}},{key:"getNetworkInfo",value:function(t){var n=this;e.getNetworkType({success:function(e){n.statData.net=e.networkType,n.getLocation(t)}})}},{key:"getLocation",value:function(t){var n=this;C.getLocation?e.getLocation({type:"wgs84",geocode:!0,success:function(e){e.address&&(n.statData.cn=e.address.country,n.statData.pn=e.address.province,n.statData.ct=e.address.city),n.statData.lat=e.latitude,n.statData.lng=e.longitude,n.request(n.statData,t)}}):(this.statData.lat=0,this.statData.lng=0,this.request(this.statData,t))}},{key:"request",value:function(e,t){var n=this,r=U(),o=this._navigationBarTitle;Object.assign(e,{ttn:o.page,ttpj:o.config,ttc:o.report});var i=h("__UNI__STAT__DATA")||{};i[e.lt]||(i[e.lt]=[]),i[e.lt].push(e),p("__UNI__STAT__DATA",i);var a=function(){return F=U(),x=h("__page__residence__time"),F-x}();if(!(a<H)||t){q();var s=N(i),u={usv:"3.98",t:r,requests:s};g("__UNI__STAT__DATA"),"n"!==k()||"a"!==this.statData.p?this.sendRequest(u):setTimeout((function(){n.sendRequest(u)}),200)}}},{key:"getIsReportData",value:function(){return function(){return new Promise((function(t,n){var r="",o=(new Date).getTime(),i=1;try{r=e.getStorageSync("Report_Data_Time"),i=e.getStorageSync("Report_Status")}catch(a){r="",i=1}""!==i?(1===i&&t(),r||(e.setStorageSync("Report_Data_Time",o),r=o),o-r>864e5&&L((function(t){var n=t.enable;e.setStorageSync("Report_Data_Time",o),e.setStorageSync("Report_Status",n)}))):L((function(n){var r=n.enable;e.setStorageSync("Report_Data_Time",o),e.setStorageSync("Report_Status",r),1===r&&t()}))}))}()}},{key:"sendRequest",value:function(t){if(e.__stat_uniCloud_space){var n=e.__stat_uniCloud_space.importObject("uni-stat-receiver",{customUI:!0});n.report(t).then((function(){0})).catch((function(e){0}))}else console.error("应用未关联服务空间，统计上报失败，请在uniCloud目录右键关联服务空间.")}},{key:"imageRequest",value:function(e){this.getIsReportData().then((function(){var t=new Image,n=function(e){var t=Object.keys(e),n=t.sort(),r={},o="";for(var i in n)r[n[i]]=e[n[i]],o+=n[i]+"="+e[n[i]]+"&";return{sign:"",options:o.substr(0,o.length-1)}}(function(e){var t={};for(var n in e)t[n]=encodeURIComponent(e[n]);return t}(e)).options;t.src="https://tongji.dcloud.io/uni/stat.gif?"+n}))}},{key:"sendEvent",value:function(e,t){(function(e,t){return e?"string"!==typeof e?(console.error("uni.report [eventName] Parameter type error, it can only be of type String"),!0):e.length>255?(console.error("uni.report [eventName] Parameter length cannot be greater than 255"),!0):"string"!==typeof t&&"object"!==u(t)?(console.error("uni.report [options] Parameter type error, Only supports String or Object type"),!0):"string"===typeof t&&t.length>255?(console.error("uni.report [options] Parameter length cannot be greater than 255"),!0):"title"===e&&"string"!==typeof t?(console.error("uni.report [eventName] When the parameter is title, the [options] parameter can only be of type String"),!0):void 0:(console.error("uni.report Missing [eventName] parameter"),!0)})(e,t)||("title"!==e?this.sendEventRequest({key:e,value:"object"===u(t)?JSON.stringify(t):t},1):this._navigationBarTitle.report=t)}}]),t}(),Y=function(n){"use strict";r(i,n);var o=l(i);function i(){return a(this,i),o.call(this)}return s(i,[{key:"pushEvent",value:function(t){var n=this,r=function(){if(v.collectItems){var e=v.collectItems.uniPushClientID;return"boolean"===typeof e&&e}return!1}();e.getPushClientId&&r&&e.getPushClientId({success:function(e){var r=e.cid||!1;r&&n.sendPushRequest(t,r)}})}},{key:"launch",value:function(e,t){q(),this.__licationShow=!0,p("__launch_options",e),e.cst=1,this.sendReportRequest(e,!0)}},{key:"load",value:function(e,t){this.self=t,this._query=e}},{key:"appHide",value:function(e){this.applicationHide(e,!0)}},{key:"appShow",value:function(e){this.applicationShow(e)}},{key:"show",value:function(e){if(this.self=e,"page"===R(e)){var t=P();t&&this.pageShow(e)}"app"===R(e)&&this.appShow()}},{key:"hide",value:function(e){if(this.self=e,"page"===R(e)){var t=P();t&&this.pageHide(e)}"app"===R(e)&&this.appHide()}},{key:"error",value:function(e){var t="";t=e.message?e.stack:JSON.stringify(e);var n="";try{n=get_route()}catch(o){n=""}var r={ak:this.statData.ak,uuid:this.statData.uuid,p:this.statData.p,lt:"31",url:n,ut:this.statData.ut,ch:this.statData.ch,mpsdk:this.statData.mpsdk,mpv:this.statData.mpv,v:this.statData.v,em:t,usv:this.statData.usv,t:parseInt((new Date).getTime()/1e3)};this.request(r)}}],[{key:"getInstance",value:function(){e.__stat_instance||(e.__stat_instance=new i);var n=function(e){var t=function(){return{}||{}}(),n=t.spaceId,r=t.provider,o=t.clientSecret,i=t.secretKey,a=t.secretId,s=-1!==["tcb","tencent","aliyun","alipay"].indexOf(r),u="aliyun"===r&&n&&o,c=("tcb"===r||"tencent"===r)&&n,l="alipay"===r&&n&&i&&a;return s&&(u||c||l)?t:e&&e.spaceId?e:null}(t.config);if(!e.__stat_uniCloud_space)if(n&&0!==Object.keys(n).length){var r={provider:n.provider,spaceId:n.spaceId,clientSecret:n.clientSecret};n.endpoint&&(r.endpoint=n.endpoint),"alipay"===n.provider&&(r.secretKey=n.secretKey,r.accessKey=n.accessKey||n.secretId,r.spaceAppId=n.spaceAppId||n.appId),e.__stat_uniCloud_space=t.init(r)}else console.error("应用未关联服务空间，请在uniCloud目录右键关联服务空间");return e.__stat_instance}}]),i}(W),z=Y,J=z.getInstance(),X=!1,$={onLaunch:function(e){J.launch(e,this),J.pushEvent(e)},onLoad:function(e){if(J.load(e,this),this.$scope&&this.$scope.onShareAppMessage){var t=this.$scope.onShareAppMessage;this.$scope.onShareAppMessage=function(e){return J.interceptShare(!1),t.call(this,e)}}},onShow:function(){X=!1,J.show(this)},onHide:function(){X=!0,J.hide(this)},onUnload:function(){X?X=!1:J.hide(this)},onError:function(e){J.error(e)}};function Z(){var t=n("66fd");(t.default||t).mixin($),e.report=function(e,t){J.sendEvent(e,t)}}(function(){Z()})()}).call(this,n("543d")["default"],n("a9ff")["default"])},"4a4b":function(e,t){function n(t,r){return e.exports=n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},e.exports.__esModule=!0,e.exports["default"]=e.exports,n(t,r)}e.exports=n,e.exports.__esModule=!0,e.exports["default"]=e.exports},"4e94":function(e,t,n){"use strict";var r=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n("2eee")),i=r(n("ed6d")),a=r(n("6b58")),s=r(n("36c6")),u=r(n("c973")),c=r(n("970b")),l=r(n("5bc3")),d=r(n("7037"));function f(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,s.default)(e);if(t){var o=(0,s.default)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(0,a.default)(this,n)}}var p={email:/^\S+?@\S+?\.\S+?$/,idcard:/^[1-9]\d{5}(18|19|([23]\d))\d{2}((0[1-9])|(10|11|12))(([0-2][1-9])|10|20|30|31)\d{3}[0-9Xx]$/,url:new RegExp("^(?!mailto:)(?:(?:http|https|ftp)://|//)(?:\\S+(?::\\S*)?@)?(?:(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[0-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]+-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]+-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))|localhost)(?::\\d{2,5})?(?:(/|\\?|#)[^\\s]*)?$","i")},h={int:"integer",bool:"boolean",double:"number",long:"number",password:"string"};function g(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=["label"];n.forEach((function(t){void 0===e[t]&&(e[t]="")}));var r=t;for(var o in e){var i=new RegExp("{"+o+"}");r=r.replace(i,e[o])}return r}var v={integer:function(e){return v.number(e)&&parseInt(e,10)===e},string:function(e){return"string"===typeof e},number:function(e){return!isNaN(e)&&"number"===typeof e},boolean:function(e){return"boolean"===typeof e},float:function(e){return v.number(e)&&!v.integer(e)},array:function(e){return Array.isArray(e)},object:function(e){return"object"===(0,d.default)(e)&&!v.array(e)},date:function(e){return e instanceof Date},timestamp:function(e){return!(!this.integer(e)||Math.abs(e).toString().length>16)},file:function(e){return"string"===typeof e.url},email:function(e){return"string"===typeof e&&!!e.match(p.email)&&e.length<255},url:function(e){return"string"===typeof e&&!!e.match(p.url)},pattern:function(e,t){try{return new RegExp(e).test(t)}catch(n){return!1}},method:function(e){return"function"===typeof e},idcard:function(e){return"string"===typeof e&&!!e.match(p.idcard)},"url-https":function(e){return this.url(e)&&e.startsWith("https://")},"url-scheme":function(e){return e.startsWith("://")},"url-web":function(e){return!1}},_=function(){function e(t){(0,c.default)(this,e),this._message=t}return(0,l.default)(e,[{key:"validateRule",value:function(){var e=(0,u.default)(o.default.mark((function e(t,n,r,i,a){var s,u,c,l,d,f,p,h,g;return o.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(s=null,u=n.rules,c=u.findIndex((function(e){return e.required})),!(c<0)){e.next=8;break}if(null!==r&&void 0!==r){e.next=6;break}return e.abrupt("return",s);case 6:if("string"!==typeof r||r.length){e.next=8;break}return e.abrupt("return",s);case 8:if(l=this._message,void 0!==u){e.next=11;break}return e.abrupt("return",l["default"]);case 11:d=0;case 12:if(!(d<u.length)){e.next=35;break}if(f=u[d],p=this._getValidateType(f),Object.assign(f,{label:n.label||'["'.concat(t,'"]')}),!m[p]){e.next=20;break}if(s=m[p](f,r,l),null==s){e.next=20;break}return e.abrupt("break",35);case 20:if(!f.validateExpr){e.next=26;break}if(h=Date.now(),g=f.validateExpr(r,a,h),!1!==g){e.next=26;break}return s=this._getMessage(f,f.errorMessage||this._message["default"]),e.abrupt("break",35);case 26:if(!f.validateFunction){e.next=32;break}return e.next=29,this.validateFunction(f,r,i,a,p);case 29:if(s=e.sent,null===s){e.next=32;break}return e.abrupt("break",35);case 32:d++,e.next=12;break;case 35:return null!==s&&(s=l.TAG+s),e.abrupt("return",s);case 37:case"end":return e.stop()}}),e,this)})));return function(t,n,r,o,i){return e.apply(this,arguments)}}()},{key:"validateFunction",value:function(){var e=(0,u.default)(o.default.mark((function e(t,n,r,i,a){var s,u,c;return o.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s=null,e.prev=1,u=null,e.next=5,t.validateFunction(t,n,i||r,(function(e){u=e}));case 5:c=e.sent,(u||"string"===typeof c&&c||!1===c)&&(s=this._getMessage(t,u||c,a)),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](1),s=this._getMessage(t,e.t0.message,a);case 12:return e.abrupt("return",s);case 13:case"end":return e.stop()}}),e,this,[[1,9]])})));return function(t,n,r,o,i){return e.apply(this,arguments)}}()},{key:"_getMessage",value:function(e,t,n){return g(e,t||e.errorMessage||this._message[n]||t["default"])}},{key:"_getValidateType",value:function(e){var t="";return e.required?t="required":e.format?t="format":e.arrayType?t="arrayTypeFormat":e.range?t="range":void 0!==e.maximum||void 0!==e.minimum?t="rangeNumber":void 0!==e.maxLength||void 0!==e.minLength?t="rangeLength":e.pattern?t="pattern":e.validateFunction&&(t="validateFunction"),t}}]),e}(),m={required:function(e,t,n){return e.required&&function(e,t){return void 0===e||null===e||("string"===typeof e&&!e||(!(!Array.isArray(e)||e.length)||"object"===t&&!Object.keys(e).length))}(t,e.format||(0,d.default)(t))?g(e,e.errorMessage||n.required):null},range:function(e,t,n){for(var r=e.range,o=e.errorMessage,i=new Array(r.length),a=0;a<r.length;a++){var s=r[a];v.object(s)&&void 0!==s.value?i[a]=s.value:i[a]=s}var u=!1;return Array.isArray(t)?u=new Set(t.concat(i)).size===i.length:i.indexOf(t)>-1&&(u=!0),u?null:g(e,o||n["enum"])},rangeNumber:function(e,t,n){if(!v.number(t))return g(e,e.errorMessage||n.pattern.mismatch);var r=e.minimum,o=e.maximum,i=e.exclusiveMinimum,a=e.exclusiveMaximum,s=i?t<=r:t<r,u=a?t>=o:t>o;return void 0!==r&&s?g(e,e.errorMessage||n["number"][i?"exclusiveMinimum":"minimum"]):void 0!==o&&u?g(e,e.errorMessage||n["number"][a?"exclusiveMaximum":"maximum"]):void 0!==r&&void 0!==o&&(s||u)?g(e,e.errorMessage||n["number"].range):null},rangeLength:function(e,t,n){if(!v.string(t)&&!v.array(t))return g(e,e.errorMessage||n.pattern.mismatch);var r=e.minLength,o=e.maxLength,i=t.length;return void 0!==r&&i<r?g(e,e.errorMessage||n["length"].minLength):void 0!==o&&i>o?g(e,e.errorMessage||n["length"].maxLength):void 0!==r&&void 0!==o&&(i<r||i>o)?g(e,e.errorMessage||n["length"].range):null},pattern:function(e,t,n){return v["pattern"](e.pattern,t)?null:g(e,e.errorMessage||n.pattern.mismatch)},format:function(e,t,n){var r=Object.keys(v),o=h[e.format]?h[e.format]:e.format||e.arrayType;return r.indexOf(o)>-1&&!v[o](t)?g(e,e.errorMessage||n.typeError):null},arrayTypeFormat:function(e,t,n){if(!Array.isArray(t))return g(e,e.errorMessage||n.typeError);for(var r=0;r<t.length;r++){var o=t[r],i=this.format(e,o,n);if(null!==i)return i}return null}},y=function(e){(0,i.default)(n,e);var t=f(n);function n(e,r){var o;return(0,c.default)(this,n),o=t.call(this,n.message),o._schema=e,o._options=r||null,o}return(0,l.default)(n,[{key:"updateSchema",value:function(e){this._schema=e}},{key:"validate",value:function(){var e=(0,u.default)(o.default.mark((function e(t,n){var r;return o.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=this._checkFieldInSchema(t),r){e.next=5;break}return e.next=4,this.invokeValidate(t,!1,n);case 4:r=e.sent;case 5:return e.abrupt("return",r.length?r[0]:null);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"validateAll",value:function(){var e=(0,u.default)(o.default.mark((function e(t,n){var r;return o.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=this._checkFieldInSchema(t),r){e.next=5;break}return e.next=4,this.invokeValidate(t,!0,n);case 4:r=e.sent;case 5:return e.abrupt("return",r);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"validateUpdate",value:function(){var e=(0,u.default)(o.default.mark((function e(t,n){var r;return o.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=this._checkFieldInSchema(t),r){e.next=5;break}return e.next=4,this.invokeValidateUpdate(t,!1,n);case 4:r=e.sent;case 5:return e.abrupt("return",r.length?r[0]:null);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"invokeValidate",value:function(){var e=(0,u.default)(o.default.mark((function e(t,n,r){var i,a,s,u,c;return o.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:i=[],a=this._schema,e.t0=o.default.keys(a);case 3:if((e.t1=e.t0()).done){e.next=15;break}return s=e.t1.value,u=a[s],e.next=8,this.validateRule(s,u,t[s],t,r);case 8:if(c=e.sent,null==c){e.next=13;break}if(i.push({key:s,errorMessage:c}),n){e.next=13;break}return e.abrupt("break",15);case 13:e.next=3;break;case 15:return e.abrupt("return",i);case 16:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"invokeValidateUpdate",value:function(){var e=(0,u.default)(o.default.mark((function e(t,n,r){var i,a,s;return o.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:i=[],e.t0=o.default.keys(t);case 2:if((e.t1=e.t0()).done){e.next=13;break}return a=e.t1.value,e.next=6,this.validateRule(a,this._schema[a],t[a],t,r);case 6:if(s=e.sent,null==s){e.next=11;break}if(i.push({key:a,errorMessage:s}),n){e.next=11;break}return e.abrupt("break",13);case 11:e.next=2;break;case 13:return e.abrupt("return",i);case 14:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"_checkFieldInSchema",value:function(e){var t=Object.keys(e),r=Object.keys(this._schema);if(new Set(t.concat(r)).size===r.length)return"";var o=t.filter((function(e){return r.indexOf(e)<0})),i=g({field:JSON.stringify(o)},n.message.TAG+n.message["defaultInvalid"]);return[{key:"invalid",errorMessage:i}]}}]),n}(_);y.message=new function(){return{TAG:"",default:"验证错误",defaultInvalid:"提交的字段{field}在数据库中并不存在",validateFunction:"验证无效",required:"{label}必填",enum:"{label}超出范围",timestamp:"{label}格式无效",whitespace:"{label}不能为空",typeError:"{label}类型无效",date:{format:"{label}日期{value}格式无效",parse:"{label}日期无法解析,{value}无效",invalid:"{label}日期{value}无效"},length:{minLength:"{label}长度不能少于{minLength}",maxLength:"{label}长度不能超过{maxLength}",range:"{label}必须介于{minLength}和{maxLength}之间"},number:{minimum:"{label}不能小于{minimum}",maximum:"{label}不能大于{maximum}",exclusiveMinimum:"{label}不能小于等于{minimum}",exclusiveMaximum:"{label}不能大于等于{maximum}",range:"{label}必须介于{minimum}and{maximum}之间"},pattern:{mismatch:"{label}格式不匹配"}}};var I=y;t.default=I},"4e95":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={"周":"周","天":"天","小时":"小时","分钟":"分钟","刚刚":"刚刚","前":"前","昨天":"昨天","星期一":"星期一","星期二":"星期二","星期三":"星期三","星期四":"星期四","星期五":"星期五","星期六":"星期六","星期日":"星期日","一月":"一月","二月":"二月","三月":"三月","四月":"四月","五月":"五月","六月":"六月","七月":"七月","八月":"八月","九月":"九月","十月":"十月","十一月":"十一月","十二月":"十二月","一":"一","二":"二","三":"三","四":"四","五":"五","六":"六","日":"日"};t.default=r},"4ea4":function(e,t){e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.__esModule=!0,e.exports["default"]=e.exports},5297:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={"输入groupID搜索":"输入groupID搜索","群名称":"群名称","群ID":"群ID","加入群聊":"加入群聊","解散群聊":"解散群聊","退出群聊":"退出群聊","群类型":"群类型","请填写验证信息":"请填写验证信息","申请加入":"申请加入","已申请":"已申请","群公告":"群公告","群成员":"群成员","群管理":"群管理","好友工作群":"好友工作群","陌生人社交群":"陌生人社交群","临时会议群":"临时会议群","直播群":"直播群","社群":"社群","自由加入":"自由加入","需要验证":"需要验证","禁止加群":"禁止加群","人":"人","群头像":"群头像","加群方式":"加群方式","转让群组":"转让群组","退出群组":"退出群组","群管理员":"群管理员","全员禁言":"全员禁言","全员禁言开启后，只允许群主和管理员发言。":"全员禁言开启后，只允许群主和管理员发言。","单独禁言人员":"单独禁言人员","删除成员":"删除成员","确定从群聊中删除该成员？":"确定从群聊中删除该成员？","确定从群聊中删除所选成员？":"确定从群聊中删除所选成员？","暂无公告":"暂无公告","发布":"发布","编辑":"编辑","查看更多":"查看更多","管理员":"管理员","群主":"群主","我":"我","确认":"确认","添加成员":"添加成员","新增管理员":"新增管理员","移除管理员":"移除管理员","新增禁言用户":"新增禁言用户","移除禁言用户":"移除禁言用户","修改群聊名称":"修改群聊名称","修改群聊名称后，将在群内通知其他成员":"修改群聊名称后，将在群内通知其他成员","仅限中文、字母、数字和下划线，2-20个字":"仅限中文、字母、数字和下划线，2-20个字","请先注册 TUIGroup 模块":"请先注册 TUIGroup 模块","该用户不存在":"该用户不存在","该用户不在群组内":"该用户不在群组内","添加群聊":"添加群聊","该群组不存在":"该群组不存在","创建群聊，请注册 TUIGroup 模块":"创建群聊，请注册 TUIGroup 模块","创建成功":"创建成功","发起多人会话（群聊）":"发起多人会话（群聊）","选填":"选填","取消":"取消","创建":"创建","类似普通微信群，创建后仅支持已在群内的好友邀请加群，且无需被邀请方同意或群主神奇。详见":"类似普通微信群，创建后仅支持已在群内的好友邀请加群，且无需被邀请方同意或群主神奇。详见","类似 QQ 群，创建后群主可以指定群管理员，用户搜索群 ID 发起加群申请后，需要群主或管理员审批通过才能入群。详见":"类似 QQ 群，创建后群主可以指定群管理员，用户搜索群 ID 发起加群申请后，需要群主或管理员审批通过才能入群。详见","创建后可以随意进出，且支持查看入群前消息；适合用于音视频会议场景、在线教育场景等与实时音视频产品结合的场景。详见":"创建后可以随意进出，且支持查看入群前消息；适合用于音视频会议场景、在线教育场景等与实时音视频产品结合的场景。详见","创建后可以随意进出，没有群成员数量上限，但不支持历史消息存储；适合与直播产品结合，用于弹幕聊天场景。详见":"创建后可以随意进出，没有群成员数量上限，但不支持历史消息存储；适合与直播产品结合，用于弹幕聊天场景。详见","创建后可以随意进出，最多支持100000人，支持历史消息存储，用户搜索群 ID 发起加群申请后，无需管理员审批即可进群。详见":"创建后可以随意进出，最多支持100000人，支持历史消息存储，用户搜索群 ID 发起加群申请后，无需管理员审批即可进群。详见","产品文档":"产品文档","设置群名称":"设置群名称","请输入群名称":"请输入群名称","设置群ID":"设置群ID","请输入群ID":"请输入群ID","选择群类型":"选择群类型","陌生人社交群（Public）":"陌生人社交群（Public）","临时会议群（Meeting）":"临时会议群（Meeting）","好友工作群（Work）":"好友工作群（Work）","直播群（AVChatroom）":"直播群（AVChatroom）","社群（Community）":"社群（Community）","群组创建成功":"群组创建成功","群组解散成功":"群组解散成功","禁言设置成功":"禁言设置成功","取消禁言成功":"取消禁言成功","群名称不能为空":"群名称不能为空","群名称修改成功":"群名称修改成功","群公告字数超出限制，最大长度为150":"群公告字数超出限制，最大长度为150"};t.default=r},"543d":function(e,t,n){"use strict";(function(e,r){var o=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.createApp=Rt,t.createComponent=Vt,t.createPage=qt,t.createPlugin=jt,t.createSubpackageApp=Bt,t.default=void 0;var i,a=o(n("278c")),s=o(n("9523")),u=o(n("b17c")),c=o(n("448a")),l=o(n("7037")),d=n("37dc"),f=o(n("66fd"));function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){(0,s.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",v=/^(?:[A-Za-z\d+/]{4})*?(?:[A-Za-z\d+/]{2}(?:==)?|[A-Za-z\d+/]{3}=?)?$/;function _(){var t,n=e.getStorageSync("uni_id_token")||"",r=n.split(".");if(!n||3!==r.length)return{uid:null,role:[],permission:[],tokenExpired:0};try{t=JSON.parse(function(e){return decodeURIComponent(i(e).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""))}(r[1]))}catch(o){throw new Error("获取当前用户信息出错，详细错误信息为："+o.message)}return t.tokenExpired=1e3*t.exp,delete t.exp,delete t.iat,t}i="function"!==typeof atob?function(e){if(e=String(e).replace(/[\t\n\f\r ]+/g,""),!v.test(e))throw new Error("Failed to execute 'atob' on 'Window': The string to be decoded is not correctly encoded.");var t;e+="==".slice(2-(3&e.length));for(var n,r,o="",i=0;i<e.length;)t=g.indexOf(e.charAt(i++))<<18|g.indexOf(e.charAt(i++))<<12|(n=g.indexOf(e.charAt(i++)))<<6|(r=g.indexOf(e.charAt(i++))),o+=64===n?String.fromCharCode(t>>16&255):64===r?String.fromCharCode(t>>16&255,t>>8&255):String.fromCharCode(t>>16&255,t>>8&255,255&t);return o}:atob;var m=Object.prototype.toString,y=Object.prototype.hasOwnProperty;function I(e){return"function"===typeof e}function M(e){return"string"===typeof e}function T(e){return"[object Object]"===m.call(e)}function S(e,t){return y.call(e,t)}function E(){}function C(e){var t=Object.create(null);return function(n){var r=t[n];return r||(t[n]=e(n))}}var k=/-(\w)/g,b=C((function(e){return e.replace(k,(function(e,t){return t?t.toUpperCase():""}))}));function D(e){var t={};return T(e)&&Object.keys(e).sort().forEach((function(n){t[n]=e[n]})),Object.keys(t)?t:e}var A=["invoke","success","fail","complete","returnValue"],O={},R={};function N(e,t){Object.keys(t).forEach((function(n){-1!==A.indexOf(n)&&I(t[n])&&(e[n]=function(e,t){var n=t?e?e.concat(t):Array.isArray(t)?t:[t]:e;return n?function(e){for(var t=[],n=0;n<e.length;n++)-1===t.indexOf(e[n])&&t.push(e[n]);return t}(n):n}(e[n],t[n]))}))}function w(e,t){e&&t&&Object.keys(t).forEach((function(n){-1!==A.indexOf(n)&&I(t[n])&&function(e,t){var n=e.indexOf(t);-1!==n&&e.splice(n,1)}(e[n],t[n])}))}function L(e,t){return function(n){return e(n,t)||n}}function P(e){return!!e&&("object"===(0,l.default)(e)||"function"===typeof e)&&"function"===typeof e.then}function U(e,t,n){for(var r=!1,o=0;o<e.length;o++){var i=e[o];if(r)r=Promise.resolve(L(i,n));else{var a=i(t,n);if(P(a)&&(r=Promise.resolve(a)),!1===a)return{then:function(){}}}}return r||{then:function(e){return e(t)}}}function G(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return["success","fail","complete"].forEach((function(n){if(Array.isArray(e[n])){var r=t[n];t[n]=function(o){U(e[n],o,t).then((function(e){return I(r)&&r(e)||e}))}}})),t}function x(e,t){var n=[];Array.isArray(O.returnValue)&&n.push.apply(n,(0,c.default)(O.returnValue));var r=R[e];return r&&Array.isArray(r.returnValue)&&n.push.apply(n,(0,c.default)(r.returnValue)),n.forEach((function(e){t=e(t)||t})),t}function F(e){var t=Object.create(null);Object.keys(O).forEach((function(e){"returnValue"!==e&&(t[e]=O[e].slice())}));var n=R[e];return n&&Object.keys(n).forEach((function(e){"returnValue"!==e&&(t[e]=(t[e]||[]).concat(n[e]))})),t}function q(e,t,n){for(var r=arguments.length,o=new Array(r>3?r-3:0),i=3;i<r;i++)o[i-3]=arguments[i];var a=F(e);if(a&&Object.keys(a).length){if(Array.isArray(a.invoke)){var s=U(a.invoke,n);return s.then((function(n){return t.apply(void 0,[G(F(e),n)].concat(o))}))}return t.apply(void 0,[G(a,n)].concat(o))}return t.apply(void 0,[n].concat(o))}var V={returnValue:function(e){return P(e)?new Promise((function(t,n){e.then((function(e){e[0]?n(e[0]):t(e[1])}))})):e}},B=/^\$|Window$|WindowStyle$|sendHostEvent|sendNativeEvent|restoreGlobal|requireGlobal|getCurrentSubNVue|getMenuButtonBoundingClientRect|^report|interceptors|Interceptor$|getSubNVueById|requireNativePlugin|upx2px|hideKeyboard|canIUse|^create|Sync$|Manager$|base64ToArrayBuffer|arrayBufferToBase64|getLocale|setLocale|invokePushCallback|getWindowInfo|getDeviceInfo|getAppBaseInfo|getSystemSetting|getAppAuthorizeSetting|initUTS|requireUTS|registerUTS/,j=/^create|Manager$/,H=["createBLEConnection"],K=["createBLEConnection","createPushMessage"],W=/^on|^off/;function Y(e){return j.test(e)&&-1===H.indexOf(e)}function z(e){return B.test(e)&&-1===K.indexOf(e)}function J(e){return e.then((function(e){return[null,e]})).catch((function(e){return[e]}))}function X(e){return!(Y(e)||z(e)||function(e){return W.test(e)&&"onPush"!==e}(e))}function $(e,t){return X(e)&&I(t)?function(){for(var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length,o=new Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];return I(n.success)||I(n.fail)||I(n.complete)?x(e,q.apply(void 0,[e,t,n].concat(o))):x(e,J(new Promise((function(r,i){q.apply(void 0,[e,t,Object.assign({},n,{success:r,fail:i})].concat(o))}))))}:t}Promise.prototype.finally||(Promise.prototype.finally=function(e){var t=this.constructor;return this.then((function(n){return t.resolve(e()).then((function(){return n}))}),(function(n){return t.resolve(e()).then((function(){throw n}))}))});var Z=!1,Q=0,ee=0;var te,ne={};te=ie(e.getSystemInfoSync().language)||"en",function(){if(function(){return"undefined"!==typeof __uniConfig&&__uniConfig.locales&&!!Object.keys(__uniConfig.locales).length}()){var e=Object.keys(__uniConfig.locales);e.length&&e.forEach((function(e){var t=ne[e],n=__uniConfig.locales[e];t?Object.assign(t,n):ne[e]=n}))}}();var re=(0,d.initVueI18n)(te,{}),oe=re.t;re.mixin={beforeCreate:function(){var e=this,t=re.i18n.watchLocale((function(){e.$forceUpdate()}));this.$once("hook:beforeDestroy",(function(){t()}))},methods:{$$t:function(e,t){return oe(e,t)}}},re.setLocale,re.getLocale;function ie(e,t){if(e){if(e=e.trim().replace(/_/g,"-"),t&&t[e])return e;if(e=e.toLowerCase(),"chinese"===e)return"zh-Hans";if(0===e.indexOf("zh"))return e.indexOf("-hans")>-1?"zh-Hans":e.indexOf("-hant")>-1||function(e,t){return!!t.find((function(t){return-1!==e.indexOf(t)}))}(e,["-tw","-hk","-mo","-cht"])?"zh-Hant":"zh-Hans";var n=function(e,t){return t.find((function(t){return 0===e.indexOf(t)}))}(e,["en","fr","es"]);return n||void 0}}function ae(){if(I(getApp)){var t=getApp({allowDefault:!0});if(t&&t.$vm)return t.$vm.$locale}return ie(e.getSystemInfoSync().language)||"en"}var se=[];"undefined"!==typeof r&&(r.getLocale=ae);var ue={promiseInterceptor:V},ce=Object.freeze({__proto__:null,upx2px:function(t,n){if(0===Q&&function(){var t=e.getSystemInfoSync(),n=t.platform,r=t.pixelRatio,o=t.windowWidth;Q=o,ee=r,Z="ios"===n}(),t=Number(t),0===t)return 0;var r=t/750*(n||Q);return r<0&&(r=-r),r=Math.floor(r+1e-4),0===r&&(r=1!==ee&&Z?.5:1),t<0?-r:r},getLocale:ae,setLocale:function(e){var t=!!I(getApp)&&getApp();if(!t)return!1;var n=t.$vm.$locale;return n!==e&&(t.$vm.$locale=e,se.forEach((function(t){return t({locale:e})})),!0)},onLocaleChange:function(e){-1===se.indexOf(e)&&se.push(e)},addInterceptor:function(e,t){"string"===typeof e&&T(t)?N(R[e]||(R[e]={}),t):T(e)&&N(O,e)},removeInterceptor:function(e,t){"string"===typeof e?T(t)?w(R[e],t):delete R[e]:T(e)&&w(O,e)},interceptors:ue});var le,de={name:function(e){return"back"===e.exists&&e.delta?"navigateBack":"redirectTo"},args:function(e){if("back"===e.exists&&e.url){var t=function(e){var t=getCurrentPages(),n=t.length;while(n--){var r=t[n];if(r.$page&&r.$page.fullPath===e)return n}return-1}(e.url);if(-1!==t){var n=getCurrentPages().length-1-t;n>0&&(e.delta=n)}}}},fe={args:function(e){var t=parseInt(e.current);if(!isNaN(t)){var n=e.urls;if(Array.isArray(n)){var r=n.length;if(r)return t<0?t=0:t>=r&&(t=r-1),t>0?(e.current=n[t],e.urls=n.filter((function(e,r){return!(r<t)||e!==n[t]}))):e.current=n[0],{indicator:!1,loop:!1}}}}};function pe(t){le=le||e.getStorageSync("__DC_STAT_UUID"),le||(le=Date.now()+""+Math.floor(1e7*Math.random()),e.setStorage({key:"__DC_STAT_UUID",data:le})),t.deviceId=le}function he(e){if(e.safeArea){var t=e.safeArea;e.safeAreaInsets={top:t.top,left:t.left,right:e.windowWidth-t.right,bottom:e.screenHeight-t.bottom}}}function ge(e,t){for(var n=e.deviceType||"phone",r={ipad:"pad",windows:"pc",mac:"pc"},o=Object.keys(r),i=t.toLocaleLowerCase(),a=0;a<o.length;a++){var s=o[a];if(-1!==i.indexOf(s)){n=r[s];break}}return n}function ve(e){var t=e;return t&&(t=e.toLocaleLowerCase()),t}function _e(e){return ae?ae():e}function me(e){var t=e.hostName||"WeChat";return e.environment?t=e.environment:e.host&&e.host.env&&(t=e.host.env),t}var ye={returnValue:function(e){pe(e),he(e),function(e){var t,n=e.brand,r=void 0===n?"":n,o=e.model,i=void 0===o?"":o,a=e.system,s=void 0===a?"":a,u=e.language,c=void 0===u?"":u,l=e.theme,d=e.version,f=(e.platform,e.fontSizeSetting),p=e.SDKVersion,h=e.pixelRatio,g=e.deviceOrientation,v="";v=s.split(" ")[0]||"",t=s.split(" ")[1]||"";var _=d,m=ge(e,i),y=ve(r),I=me(e),M=g,T=h,S=p,E=c.replace(/_/g,"-"),C={appId:"__UNI__B5B1A99",appName:"familySign",appVersion:"1.0.0",appVersionCode:"100",appLanguage:_e(E),uniCompileVersion:"3.98",uniRuntimeVersion:"3.98",uniPlatform:"mp-weixin",deviceBrand:y,deviceModel:i,deviceType:m,devicePixelRatio:T,deviceOrientation:M,osName:v.toLocaleLowerCase(),osVersion:t,hostTheme:l,hostVersion:_,hostLanguage:E,hostName:I,hostSDKVersion:S,hostFontSizeSetting:f,windowTop:0,windowBottom:0,osLanguage:void 0,osTheme:void 0,ua:void 0,hostPackageName:void 0,browserName:void 0,browserVersion:void 0};Object.assign(e,C,{})}(e)}},Ie={args:function(e){"object"===(0,l.default)(e)&&(e.alertText=e.title)}},Me={returnValue:function(e){var t=e,n=t.version,r=t.language,o=t.SDKVersion,i=t.theme,a=me(e),s=r.replace("_","-");e=D(Object.assign(e,{appId:"__UNI__B5B1A99",appName:"familySign",appVersion:"1.0.0",appVersionCode:"100",appLanguage:_e(s),hostVersion:n,hostLanguage:s,hostName:a,hostSDKVersion:o,hostTheme:i}))}},Te={returnValue:function(e){var t=e,n=t.brand,r=t.model,o=ge(e,r),i=ve(n);pe(e),e=D(Object.assign(e,{deviceType:o,deviceBrand:i,deviceModel:r}))}},Se={returnValue:function(e){he(e),e=D(Object.assign(e,{windowTop:0,windowBottom:0}))}},Ee={redirectTo:de,previewImage:fe,getSystemInfo:ye,getSystemInfoSync:ye,showActionSheet:Ie,getAppBaseInfo:Me,getDeviceInfo:Te,getWindowInfo:Se,getAppAuthorizeSetting:{returnValue:function(e){var t=e.locationReducedAccuracy;e.locationAccuracy="unsupported",!0===t?e.locationAccuracy="reduced":!1===t&&(e.locationAccuracy="full")}},compressImage:{args:function(e){e.compressedHeight&&!e.compressHeight&&(e.compressHeight=e.compressedHeight),e.compressedWidth&&!e.compressWidth&&(e.compressWidth=e.compressedWidth)}}},Ce=["success","fail","cancel","complete"];function ke(e,t,n){return function(r){return t(De(e,r,n))}}function be(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(T(t)){var i=!0===o?t:{};for(var a in I(n)&&(n=n(t,i)||{}),t)if(S(n,a)){var s=n[a];I(s)&&(s=s(t[a],t,i)),s?M(s)?i[s]=t[a]:T(s)&&(i[s.name?s.name:a]=s.value):console.warn("The '".concat(e,"' method of platform '微信小程序' does not support option '").concat(a,"'"))}else-1!==Ce.indexOf(a)?I(t[a])&&(i[a]=ke(e,t[a],r)):o||(i[a]=t[a]);return i}return I(t)&&(t=ke(e,t,r)),t}function De(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return I(Ee.returnValue)&&(t=Ee.returnValue(e,t)),be(e,t,n,{},r)}function Ae(t,n){if(S(Ee,t)){var r=Ee[t];return r?function(n,o){var i=r;I(r)&&(i=r(n)),n=be(t,n,i.args,i.returnValue);var a=[n];"undefined"!==typeof o&&a.push(o),I(i.name)?t=i.name(n):M(i.name)&&(t=i.name);var s=e[t].apply(e,a);return z(t)?De(t,s,i.returnValue,Y(t)):s}:function(){console.error("Platform '微信小程序' does not support '".concat(t,"'."))}}return n}var Oe=Object.create(null);["onTabBarMidButtonTap","subscribePush","unsubscribePush","onPush","offPush","share"].forEach((function(e){Oe[e]=function(e){return function(t){var n=t.fail,r=t.complete,o={errMsg:"".concat(e,":fail method '").concat(e,"' not supported")};I(n)&&n(o),I(r)&&r(o)}}(e)}));var Re={oauth:["weixin"],share:["weixin"],payment:["wxpay"],push:["weixin"]};var Ne=Object.freeze({__proto__:null,getProvider:function(e){var t=e.service,n=e.success,r=e.fail,o=e.complete,i=!1;Re[t]?(i={errMsg:"getProvider:ok",service:t,provider:Re[t]},I(n)&&n(i)):(i={errMsg:"getProvider:fail service not found"},I(r)&&r(i)),I(o)&&o(i)}}),we=function(){var e;return function(){return e||(e=new f.default),e}}();function Le(e,t,n){return e[t].apply(e,n)}var Pe,Ue,Ge,xe=Object.freeze({__proto__:null,$on:function(){return Le(we(),"$on",Array.prototype.slice.call(arguments))},$off:function(){return Le(we(),"$off",Array.prototype.slice.call(arguments))},$once:function(){return Le(we(),"$once",Array.prototype.slice.call(arguments))},$emit:function(){return Le(we(),"$emit",Array.prototype.slice.call(arguments))}});function Fe(e){return function(){try{return e.apply(e,arguments)}catch(t){console.error(t)}}}function qe(e){try{return JSON.parse(e)}catch(t){}return e}var Ve=[];function Be(e,t){Ve.forEach((function(n){n(e,t)})),Ve.length=0}var je=[],He=e.getAppBaseInfo&&e.getAppBaseInfo();He||(He=e.getSystemInfoSync());var Ke=He?He.host:null,We=Ke&&"SAAASDK"===Ke.env?e.miniapp.shareVideoMessage:e.shareVideoMessage,Ye=Object.freeze({__proto__:null,shareVideoMessage:We,getPushClientId:function(e){T(e)||(e={});var t=function(e){var t={};for(var n in e){var r=e[n];I(r)&&(t[n]=Fe(r),delete e[n])}return t}(e),n=t.success,r=t.fail,o=t.complete,i=I(n),a=I(r),s=I(o);Promise.resolve().then((function(){"undefined"===typeof Ge&&(Ge=!1,Pe="",Ue="uniPush is not enabled"),Ve.push((function(e,t){var u;e?(u={errMsg:"getPushClientId:ok",cid:e},i&&n(u)):(u={errMsg:"getPushClientId:fail"+(t?" "+t:"")},a&&r(u)),s&&o(u)})),"undefined"!==typeof Pe&&Be(Pe,Ue)}))},onPushMessage:function(e){-1===je.indexOf(e)&&je.push(e)},offPushMessage:function(e){if(e){var t=je.indexOf(e);t>-1&&je.splice(t,1)}else je.length=0},invokePushCallback:function(e){if("enabled"===e.type)Ge=!0;else if("clientId"===e.type)Pe=e.cid,Ue=e.errMsg,Be(Pe,e.errMsg);else if("pushMsg"===e.type)for(var t={type:"receive",data:qe(e.message)},n=0;n<je.length;n++){var r=je[n];if(r(t),t.stopped)break}else"click"===e.type&&je.forEach((function(t){t({type:"click",data:qe(e.message)})}))}}),ze=["__route__","__wxExparserNodeId__","__wxWebviewId__"];function Je(e){return Behavior(e)}function Xe(){return!!this.route}function $e(e){this.triggerEvent("__l",e)}function Ze(e){var t=e.$scope,n={};Object.defineProperty(e,"$refs",{get:function(){var e={};(function e(t,n,r){var o=t.selectAllComponents(n)||[];o.forEach((function(t){var o=t.dataset.ref;r[o]=t.$vm||tt(t),"scoped"===t.dataset.vueGeneric&&t.selectAllComponents(".scoped-ref").forEach((function(t){e(t,n,r)}))}))})(t,".vue-ref",e);var r=t.selectAllComponents(".vue-ref-in-for")||[];return r.forEach((function(t){var n=t.dataset.ref;e[n]||(e[n]=[]),e[n].push(t.$vm||tt(t))})),function(e,t){var n=(0,u.default)(Set,(0,c.default)(Object.keys(e))),r=Object.keys(t);return r.forEach((function(r){var o=e[r],i=t[r];Array.isArray(o)&&Array.isArray(i)&&o.length===i.length&&i.every((function(e){return o.includes(e)}))||(e[r]=i,n.delete(r))})),n.forEach((function(t){delete e[t]})),e}(n,e)}})}function Qe(e){var t,n=e.detail||e.value,r=n.vuePid,o=n.vueOptions;r&&(t=function e(t,n){for(var r,o=t.$children,i=o.length-1;i>=0;i--){var a=o[i];if(a.$scope._$vueId===n)return a}for(var s=o.length-1;s>=0;s--)if(r=e(o[s],n),r)return r}(this.$vm,r)),t||(t=this.$vm),o.parent=t}function et(e){return Object.defineProperty(e,"__v_isMPComponent",{configurable:!0,enumerable:!1,value:!0}),e}function tt(e){return function(e){return null!==e&&"object"===(0,l.default)(e)}(e)&&Object.isExtensible(e)&&Object.defineProperty(e,"__ob__",{configurable:!0,enumerable:!1,value:(0,s.default)({},"__v_skip",!0)}),e}var nt=/_(.*)_worklet_factory_/;var rt=Page,ot=Component,it=/:/g,at=C((function(e){return b(e.replace(it,"-"))}));function st(e){var t=e.triggerEvent,n=function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];if(this.$vm||this.dataset&&this.dataset.comType)e=at(e);else{var i=at(e);i!==e&&t.apply(this,[i].concat(r))}return t.apply(this,[e].concat(r))};try{e.triggerEvent=n}catch(r){e._triggerEvent=n}}function ut(e,t,n){var r=t[e];t[e]=function(){if(et(this),st(this),r){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.apply(this,t)}}}rt.__$wrappered||(rt.__$wrappered=!0,Page=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return ut("onLoad",e),rt(e)},Page.after=rt.after,Component=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return ut("created",e),ot(e)});function ct(e,t,n){t.forEach((function(t){(function e(t,n){if(!n)return!0;if(f.default.options&&Array.isArray(f.default.options[t]))return!0;if(n=n.default||n,I(n))return!!I(n.extendOptions[t])||!!(n.super&&n.super.options&&Array.isArray(n.super.options[t]));if(I(n[t])||Array.isArray(n[t]))return!0;var r=n.mixins;return Array.isArray(r)?!!r.find((function(n){return e(t,n)})):void 0})(t,n)&&(e[t]=function(e){return this.$vm&&this.$vm.__call_hook(t,e)})}))}function lt(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];dt(t).forEach((function(t){return ft(e,t,n)}))}function dt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e&&Object.keys(e).forEach((function(n){0===n.indexOf("on")&&I(e[n])&&t.push(n)})),t}function ft(e,t,n){-1!==n.indexOf(t)||S(e,t)||(e[t]=function(e){return this.$vm&&this.$vm.__call_hook(t,e)})}function pt(e,t){var n;return t=t.default||t,n=I(t)?t:e.extend(t),t=n.options,[n,t]}function ht(e,t){if(Array.isArray(t)&&t.length){var n=Object.create(null);t.forEach((function(e){n[e]=!0})),e.$scopedSlots=e.$slots=n}}function gt(e,t){e=(e||"").split(",");var n=e.length;1===n?t._$vueId=e[0]:2===n&&(t._$vueId=e[0],t._$vuePid=e[1])}function vt(e,t){var n=e.data||{},r=e.methods||{};if("function"===typeof n)try{n=n.call(t)}catch(o){Object({VUE_APP_DARK_MODE:"false",VUE_APP_NAME:"familySign",VUE_APP_PLATFORM:"mp-weixin",NODE_ENV:"production",BASE_URL:"/"}).VUE_APP_DEBUG&&console.warn("根据 Vue 的 data 函数初始化小程序 data 失败，请尽量确保 data 函数中不访问 vm 对象，否则可能影响首次数据渲染速度。",n)}else try{n=JSON.parse(JSON.stringify(n))}catch(o){}return T(n)||(n={}),Object.keys(r).forEach((function(e){-1!==t.__lifecycle_hooks__.indexOf(e)||S(n,e)||(n[e]=r[e])})),n}var _t=[String,Number,Boolean,Object,Array,null];function mt(e){return function(t,n){this.$vm&&(this.$vm[e]=t)}}function yt(e,t){var n=e.behaviors,r=e.extends,o=e.mixins,i=e.props;i||(e.props=i=[]);var a=[];return Array.isArray(n)&&n.forEach((function(e){a.push(e.replace("uni://","wx".concat("://"))),"uni://form-field"===e&&(Array.isArray(i)?(i.push("name"),i.push("value")):(i.name={type:String,default:""},i.value={type:[String,Number,Boolean,Array,Object,Date],default:""}))})),T(r)&&r.props&&a.push(t({properties:Mt(r.props,!0)})),Array.isArray(o)&&o.forEach((function(e){T(e)&&e.props&&a.push(t({properties:Mt(e.props,!0)}))})),a}function It(e,t,n,r){return Array.isArray(t)&&1===t.length?t[0]:t}function Mt(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>3?arguments[3]:void 0,r={};return t||(r.vueId={type:String,value:""},n.virtualHost&&(r.virtualHostStyle={type:null,value:""},r.virtualHostClass={type:null,value:""}),r.scopedSlotsCompiler={type:String,value:""},r.vueSlots={type:null,value:[],observer:function(e,t){var n=Object.create(null);e.forEach((function(e){n[e]=!0})),this.setData({$slots:n})}}),Array.isArray(e)?e.forEach((function(e){r[e]={type:null,observer:mt(e)}})):T(e)&&Object.keys(e).forEach((function(t){var n=e[t];if(T(n)){var o=n.default;I(o)&&(o=o()),n.type=It(0,n.type),r[t]={type:-1!==_t.indexOf(n.type)?n.type:null,value:o,observer:mt(t)}}else{var i=It(0,n);r[t]={type:-1!==_t.indexOf(i)?i:null,observer:mt(t)}}})),r}function Tt(e,t,n,r){var o={};return Array.isArray(t)&&t.length&&t.forEach((function(t,i){"string"===typeof t?t?"$event"===t?o["$"+i]=n:"arguments"===t?o["$"+i]=n.detail&&n.detail.__args__||r:0===t.indexOf("$event.")?o["$"+i]=e.__get_value(t.replace("$event.",""),n):o["$"+i]=e.__get_value(t):o["$"+i]=e:o["$"+i]=function(e,t){var n=e;return t.forEach((function(t){var r=t[0],o=t[2];if(r||"undefined"!==typeof o){var i,a=t[1],s=t[3];Number.isInteger(r)?i=r:r?"string"===typeof r&&r&&(i=0===r.indexOf("#s#")?r.substr(3):e.__get_value(r,n)):i=n,Number.isInteger(i)?n=o:a?Array.isArray(i)?n=i.find((function(t){return e.__get_value(a,t)===o})):T(i)?n=Object.keys(i).find((function(t){return e.__get_value(a,i[t])===o})):console.error("v-for 暂不支持循环数据：",i):n=i[o],s&&(n=e.__get_value(s,n))}})),n}(e,t)})),o}function St(e){for(var t={},n=1;n<e.length;n++){var r=e[n];t[r[0]]=r[1]}return t}function Et(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0,a=!1,s=T(t.detail)&&t.detail.__args__||[t.detail];if(o&&(a=t.currentTarget&&t.currentTarget.dataset&&"wx"===t.currentTarget.dataset.comType,!n.length))return a?[t]:s;var u=Tt(e,r,t,s),c=[];return n.forEach((function(e){"$event"===e?"__set_model"!==i||o?o&&!a?c.push(s[0]):c.push(t):c.push(t.target.value):Array.isArray(e)&&"o"===e[0]?c.push(St(e)):"string"===typeof e&&S(u,e)?c.push(u[e]):c.push(e)})),c}function Ct(e){var t=this;e=function(e){try{e.mp=JSON.parse(JSON.stringify(e))}catch(t){}return e.stopPropagation=E,e.preventDefault=E,e.target=e.target||{},S(e,"detail")||(e.detail={}),S(e,"markerId")&&(e.detail="object"===(0,l.default)(e.detail)?e.detail:{},e.detail.markerId=e.markerId),T(e.detail)&&(e.target=Object.assign({},e.target,e.detail)),e}(e);var n=(e.currentTarget||e.target).dataset;if(!n)return console.warn("事件信息不存在");var r=n.eventOpts||n["event-opts"];if(!r)return console.warn("事件信息不存在");var o=e.type,i=[];return r.forEach((function(n){var r=n[0],a=n[1],s="^"===r.charAt(0);r=s?r.slice(1):r;var u="~"===r.charAt(0);r=u?r.slice(1):r,a&&function(e,t){return e===t||"regionchange"===t&&("begin"===e||"end"===e)}(o,r)&&a.forEach((function(n){var r=n[0];if(r){var o=t.$vm;if(o.$options.generic&&(o=function(e){var t=e.$parent;while(t&&t.$parent&&(t.$options.generic||t.$parent.$options.generic||t.$scope._$vuePid))t=t.$parent;return t&&t.$parent}(o)||o),"$emit"===r)return void o.$emit.apply(o,Et(t.$vm,e,n[1],n[2],s,r));var a=o[r];if(!I(a)){var c="page"===t.$vm.mpType?"Page":"Component",l=t.route||t.is;throw new Error("".concat(c,' "').concat(l,'" does not have a method "').concat(r,'"'))}if(u){if(a.once)return;a.once=!0}var d=Et(t.$vm,e,n[1],n[2],s,r);d=Array.isArray(d)?d:[],/=\s*\S+\.eventParams\s*\|\|\s*\S+\[['"]event-params['"]\]/.test(a.toString())&&(d=d.concat([,,,,,,,,,,e])),i.push(a.apply(o,d))}}))})),"input"===o&&1===i.length&&"undefined"!==typeof i[0]?i[0]:void 0}var kt={};var bt=["onShow","onHide","onError","onPageNotFound","onThemeChange","onUnhandledRejection"];function Dt(){f.default.prototype.getOpenerEventChannel=function(){return this.$scope.getOpenerEventChannel()};var e=f.default.prototype.__call_hook;f.default.prototype.__call_hook=function(t,n){return"onLoad"===t&&n&&n.__id__&&(this.__eventChannel__=function(e){var t=kt[e];return delete kt[e],t}(n.__id__),delete n.__id__),e.call(this,t,n)}}function At(t,n){var r=n.mocks,o=n.initRefs;Dt(),function(){var e={},t={};function n(e){var t=this.$options.propsData.vueId;if(t){var n=t.split(",")[0];e(n)}}f.default.prototype.$hasSSP=function(n){var r=e[n];return r||(t[n]=this,this.$on("hook:destroyed",(function(){delete t[n]}))),r},f.default.prototype.$getSSP=function(t,n,r){var o=e[t];if(o){var i=o[n]||[];return r?i:i[0]}},f.default.prototype.$setSSP=function(t,r){var o=0;return n.call(this,(function(n){var i=e[n],a=i[t]=i[t]||[];a.push(r),o=a.length-1})),o},f.default.prototype.$initSSP=function(){n.call(this,(function(t){e[t]={}}))},f.default.prototype.$callSSP=function(){n.call(this,(function(e){t[e]&&t[e].$forceUpdate()}))},f.default.mixin({destroyed:function(){var n=this.$options.propsData,r=n&&n.vueId;r&&(delete e[r],delete t[r])}})}(),t.$options.store&&(f.default.prototype.$store=t.$options.store),function(e){e.prototype.uniIDHasRole=function(e){var t=_(),n=t.role;return n.indexOf(e)>-1},e.prototype.uniIDHasPermission=function(e){var t=_(),n=t.permission;return this.uniIDHasRole("admin")||n.indexOf(e)>-1},e.prototype.uniIDTokenValid=function(){var e=_(),t=e.tokenExpired;return t>Date.now()}}(f.default),f.default.prototype.mpHost="mp-weixin",f.default.mixin({beforeCreate:function(){if(this.$options.mpType){if(this.mpType=this.$options.mpType,this.$mp=(0,s.default)({data:{}},this.mpType,this.$options.mpInstance),this.$scope=this.$options.mpInstance,delete this.$options.mpType,delete this.$options.mpInstance,"page"===this.mpType&&"function"===typeof getApp){var e=getApp();e.$vm&&e.$vm.$i18n&&(this._i18n=e.$vm.$i18n)}"app"!==this.mpType&&(o(this),function(e,t){var n=e.$mp[e.mpType];t.forEach((function(t){S(n,t)&&(e[t]=n[t])}))}(this,r))}}});var i={onLaunch:function(n){this.$vm||(e.canIUse&&!e.canIUse("nextTick")&&console.error("当前微信基础库版本过低，请将 微信开发者工具-详情-项目设置-调试基础库版本 更换为`2.3.0`以上"),this.$vm=t,this.$vm.$mp={app:this},this.$vm.$scope=this,this.$vm.globalData=this.globalData,this.$vm._isMounted=!0,this.$vm.__call_hook("mounted",n),this.$vm.__call_hook("onLaunch",n))}};i.globalData=t.$options.globalData||{};var a=t.$options.methods;return a&&Object.keys(a).forEach((function(e){i[e]=a[e]})),function(e,t,n){var r=e.observable({locale:n||re.getLocale()}),o=[];t.$watchLocale=function(e){o.push(e)},Object.defineProperty(t,"$locale",{get:function(){return r.locale},set:function(e){r.locale=e,o.forEach((function(t){return t(e)}))}})}(f.default,t,ie(e.getSystemInfoSync().language)||"en"),ct(i,bt),lt(i,t.$options),i}function Ot(e){return At(e,{mocks:ze,initRefs:Ze})}function Rt(e){return App(Ot(e)),e}var Nt=/[!'()*]/g,wt=function(e){return"%"+e.charCodeAt(0).toString(16)},Lt=/%2C/g,Pt=function(e){return encodeURIComponent(e).replace(Nt,wt).replace(Lt,",")};function Ut(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Pt,n=e?Object.keys(e).map((function(n){var r=e[n];if(void 0===r)return"";if(null===r)return t(n);if(Array.isArray(r)){var o=[];return r.forEach((function(e){void 0!==e&&(null===e?o.push(t(n)):o.push(t(n)+"="+t(e)))})),o.join("&")}return t(n)+"="+t(r)})).filter((function(e){return e.length>0})).join("&"):null;return n?"?".concat(n):""}function Gt(e,t){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.isPage,r=t.initRelation,o=arguments.length>2?arguments[2]:void 0,i=pt(f.default,e),s=(0,a.default)(i,2),u=s[0],c=s[1],l=h({multipleSlots:!0,addGlobalClass:!0},c.options||{});c["mp-weixin"]&&c["mp-weixin"].options&&Object.assign(l,c["mp-weixin"].options);var d={options:l,data:vt(c,f.default.prototype),behaviors:yt(c,Je),properties:Mt(c.props,!1,c.__file,l),lifetimes:{attached:function(){var e=this.properties,t={mpType:n.call(this)?"page":"component",mpInstance:this,propsData:e};gt(e.vueId,this),r.call(this,{vuePid:this._$vuePid,vueOptions:t}),this.$vm=new u(t),ht(this.$vm,e.vueSlots),this.$vm.$mount()},ready:function(){this.$vm&&(this.$vm._isMounted=!0,this.$vm.__call_hook("mounted"),this.$vm.__call_hook("onReady"))},detached:function(){this.$vm&&this.$vm.$destroy()}},pageLifetimes:{show:function(e){this.$vm&&this.$vm.__call_hook("onPageShow",e)},hide:function(){this.$vm&&this.$vm.__call_hook("onPageHide")},resize:function(e){this.$vm&&this.$vm.__call_hook("onPageResize",e)}},methods:{__l:Qe,__e:Ct}};return c.externalClasses&&(d.externalClasses=c.externalClasses),Array.isArray(c.wxsCallMethods)&&c.wxsCallMethods.forEach((function(e){d.methods[e]=function(t){return this.$vm[e](t)}})),o?[d,c,u]:n?d:[d,u]}(e,{isPage:Xe,initRelation:$e},t)}var xt=["onShow","onHide","onUnload"];function Ft(e){var t=Gt(e,!0),n=(0,a.default)(t,2),r=n[0],o=n[1];return ct(r.methods,xt,o),r.methods.onLoad=function(e){this.options=e;var t=Object.assign({},e);delete t.__id__,this.$page={fullPath:"/"+(this.route||this.is)+Ut(t)},this.$vm.$mp.query=e,this.$vm.__call_hook("onLoad",e)},lt(r.methods,e,["onReady"]),function(e,t){t&&Object.keys(t).forEach((function(n){var r=n.match(nt);if(r){var o=r[1];e[n]=t[n],e[o]=t[o]}}))}(r.methods,o.methods),r}function qt(e){return Component(function(e){return Ft(e)}(e))}function Vt(e){return Component(Gt(e))}function Bt(t){var n=Ot(t),r=getApp({allowDefault:!0});t.$scope=r;var o=r.globalData;if(o&&Object.keys(n.globalData).forEach((function(e){S(o,e)||(o[e]=n.globalData[e])})),Object.keys(n).forEach((function(e){S(r,e)||(r[e]=n[e])})),I(n.onShow)&&e.onAppShow&&e.onAppShow((function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];t.__call_hook("onShow",n)})),I(n.onHide)&&e.onAppHide&&e.onAppHide((function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];t.__call_hook("onHide",n)})),I(n.onLaunch)){var i=e.getLaunchOptionsSync&&e.getLaunchOptionsSync();t.__call_hook("onLaunch",i)}return t}function jt(t){var n=Ot(t);if(I(n.onShow)&&e.onAppShow&&e.onAppShow((function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];t.__call_hook("onShow",n)})),I(n.onHide)&&e.onAppHide&&e.onAppHide((function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];t.__call_hook("onHide",n)})),I(n.onLaunch)){var r=e.getLaunchOptionsSync&&e.getLaunchOptionsSync();t.__call_hook("onLaunch",r)}return t}xt.push.apply(xt,["onPullDownRefresh","onReachBottom","onAddToFavorites","onShareTimeline","onShareAppMessage","onPageScroll","onResize","onTabItemTap"]),["vibrate","preloadPage","unPreloadPage","loadSubPackage"].forEach((function(e){Ee[e]=!1})),[].forEach((function(t){var n=Ee[t]&&Ee[t].name?Ee[t].name:t;e.canIUse(n)||(Ee[t]=!1)}));var Ht={};"undefined"!==typeof Proxy?Ht=new Proxy({},{get:function(t,n){return S(t,n)?t[n]:ce[n]?ce[n]:Ye[n]?$(n,Ye[n]):Ne[n]?$(n,Ne[n]):Oe[n]?$(n,Oe[n]):xe[n]?xe[n]:$(n,Ae(n,e[n]))},set:function(e,t,n){return e[t]=n,!0}}):(Object.keys(ce).forEach((function(e){Ht[e]=ce[e]})),Object.keys(Oe).forEach((function(e){Ht[e]=$(e,Oe[e])})),Object.keys(Ne).forEach((function(e){Ht[e]=$(e,Ne[e])})),Object.keys(xe).forEach((function(e){Ht[e]=xe[e]})),Object.keys(Ye).forEach((function(e){Ht[e]=$(e,Ye[e])})),Object.keys(e).forEach((function(t){(S(e,t)||S(Ee,t))&&(Ht[t]=$(t,Ae(t,e[t])))}))),e.createApp=Rt,e.createPage=qt,e.createComponent=Vt,e.createSubpackageApp=Bt,e.createPlugin=jt;var Kt=Ht,Wt=Kt;t.default=Wt}).call(this,n("bc2e")["default"],n("c8ba"))},"54ab":function(e){e.exports=JSON.parse('{"uni-popup.cancel":"取消","uni-popup.ok":"确定","uni-popup.placeholder":"请输入","uni-popup.title":"提示","uni-popup.shareTitle":"分享到"}')},"568c":function(e,t,n){"use strict";var r=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.typeFilter=t.type=t.setDataValue=t.realName=t.rawData=t.objSet=t.objGet=t.name2arr=t.isRequiredField=t.isRealName=t.isNumber=t.isEqual=t.isBoolean=t.getValue=t.getDataValueType=t.getDataValue=t.deepCopy=void 0;var o=r(n("7037"));t.deepCopy=function(e){return JSON.parse(JSON.stringify(e))};var i=function(e){return"int"===e||"double"===e||"number"===e||"timestamp"===e};t.typeFilter=i;t.getValue=function(e,t,n){var r=n.find((function(e){return e.format&&i(e.format)})),o=n.find((function(e){return e.format&&"boolean"===e.format||"bool"===e.format}));return r&&(t=t||0===t?d(Number(t))?Number(t):t:null),o&&(t=!!f(t)&&t),t};t.setDataValue=function(e,t,n){return t[e]=n,n||""};var a=function(e,t){return l(t,e)};t.getDataValue=a;t.getDataValueType=function(e,t){var n=a(e,t);return{type:p(n),value:n}};t.realName=function(e){var t=c(e);if("object"===(0,o.default)(t)&&Array.isArray(t)&&t.length>1){var n=t.reduce((function(e,t){return e+"#".concat(t)}),"_formdata_");return n}return t[0]||e};t.isRealName=function(e){return/^_formdata_#*/.test(e)};t.rawData=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=JSON.parse(JSON.stringify(e)),n={};for(var r in t){var o=s(r);u(n,o,t[r])}return n};var s=function(e){var t=e.replace("_formdata_#","");return t=t.split("#").map((function(e){return d(e)?Number(e):e})),t};t.name2arr=s;var u=function(e,t,n){return"object"!==(0,o.default)(e)||c(t).reduce((function(e,t,r,o){return r===o.length-1?(e[t]=n,null):(t in e||(e[t]=/^[0-9]{1,}$/.test(o[r+1])?[]:{}),e[t])}),e),e};function c(e){return Array.isArray(e)?e:e.replace(/\[/g,".").replace(/\]/g,"").split(".")}t.objSet=u;var l=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"undefined",r=c(t),o=r.reduce((function(e,t){return(e||{})[t]}),e);return o&&void 0===o?n:o};t.objGet=l;var d=function(e){return!isNaN(Number(e))};t.isNumber=d;var f=function(e){return"boolean"===typeof e};t.isBoolean=f;t.isRequiredField=function(e){for(var t=!1,n=0;n<e.length;n++){var r=e[n];if(r.required){t=!0;break}}return t};var p=function(e){var t={};return"Boolean Number String Function Array Date RegExp Object Error".split(" ").map((function(e,n){t["[object "+e+"]"]=e.toLowerCase()})),null==e?e+"":"object"===(0,o.default)(e)||"function"===typeof e?t[Object.prototype.toString.call(e)]||"object":(0,o.default)(e)};t.type=p;t.isEqual=function(e,t){if(e===t)return 0!==e||1/e===1/t;if(null==e||null==t)return e===t;var n=toString.call(e),r=toString.call(t);if(n!==r)return!1;switch(n){case"[object RegExp]":case"[object String]":return""+e===""+t;case"[object Number]":return+e!==+e?+t!==+t:0===+e?1/+e===1/t:+e===+t;case"[object Date]":case"[object Boolean]":return+e===+t}if("[object Object]"==n){var o=Object.getOwnPropertyNames(e),i=Object.getOwnPropertyNames(t);if(o.length!=i.length)return!1;for(var a=0;a<o.length;a++){var s=o[a];if(e[s]!==t[s])return!1}return!0}return"[object Array]"==n?e.toString()==t.toString():void 0}},"577a":function(e,t,n){e.exports=n.p+"static/img/icon-c2c.b248b930.svg"},"589f":function(e,t,n){"use strict";var r=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;r(n("5c0c"));var o={namespaced:!0,state:{userInfo:{}},mutations:{SET_USER_INFO:function(e,t){e.userInfo=t}},actions:{setUserInfo:function(e,t){var n=e.commit;n("SET_USER_INFO",t)}}};t.default=o},"5a43":function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r},e.exports.__esModule=!0,e.exports["default"]=e.exports},"5bc3":function(e,t,n){var r=n("a395");function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,r(o.key),o)}}e.exports=function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports["default"]=e.exports},"5c0c":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={webUrl:"https://qyapi.cuixiaoler.com:1002"}},"5d05":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={"【安全提示】本 APP 仅用于体验腾讯云即时通信 IM 产品功能，不可用于业务洽谈与拓展。请勿轻信汇款、中奖等涉及钱款的信息，勿轻易拨打陌生电话，谨防上当受骗。":"【安全提示】本 APP 仅用于体验腾讯云即时通信 IM 产品功能，不可用于业务洽谈与拓展。请勿轻信汇款、中奖等涉及钱款的信息，勿轻易拨打陌生电话，谨防上当受骗。","按Enter发送，Ctrl+Enter换行":"按Enter发送，Ctrl+Enter换行","表情":"[表情]","查看更多":"查看更多","撤回":"撤回","撤回了一条消息":"撤回了一条消息","打开":"打开","单击下载":"单击下载","点此投诉":"点此投诉","点击处理":"点击处理","对方正在输入":"对方正在输入...","发起群视频":"发起群视频","发起群语音":"发起群语音","发起通话":"发起通话","发送失败":"发送失败","复制":"复制","该消息不存在":"该消息不存在","关闭阅读状态":"关闭","管理员开启全员禁言":"管理员开启全员禁言","欢迎使用TUICallKit":"欢迎使用腾讯云音视频通话组件TUICallKit ","回到最新位置":"回到最新位置","回复":"回复","回复详情":"回复详情","集成TUICallKit":"集成 TUICallKit ","检测到您暂未集成TUICallKit，无法体验音视频通话功能":"检测到您暂未集成TUICallKit，无法体验音视频通话功能。","结束群聊":"结束群聊","进行体验":"进行体验。","经度":"经度","拒绝":"拒绝","拒绝通话":"拒绝通话","开通腾讯实时音视频服务":"开通腾讯实时音视频服务","聊天记录":"[聊天记录]","描述":"描述","内容包含敏感词汇":"内容包含敏感词汇","您":"您","您当前购买使用的套餐包暂未开通此功能":"您当前购买使用的套餐包暂未开通此功能。","您当前购买使用的套餐包暂未开通群消息已读回执功能":"您当前购买使用的套餐包暂未开通【群消息已读回执】功能，请升级至旗舰版进行体验","您当前购买使用的套餐包暂未开通在线用户列表功能":"您当前购买使用的套餐包暂未开通【在线用户列表】功能，请升级至旗舰版进行体验","您已被管理员禁言":"您已被管理员禁言","您有":"您有","请点击":"请点击","请输入消息":"请输入消息","取消":"取消","取消通话":"取消通话","全部已读":"全部已读","确定":"确定","确认重发该消息？":"确认重发该消息？","人关闭阅读状态":"人关闭阅读状态","人未读":"人未读","人已读":"人已读","删除":"删除","涉及敏感内容":"涉及敏感内容","申请加入":"申请加入","视频":"[视频]","视频通话":"视频通话","条回复":"条回复","条入群申请":"条入群申请","条新消息":"条新消息","通话时长":"通话时长","同意":"同意","图片":"[图片]","图片消息失败,无效的图片格式":"图片消息失败,无效的图片格式","纬度":"纬度","未读":"未读","位置":"[位置]","文件":"[文件]","文件不存在,请检查文件路径是否正确":"文件不存在,请检查文件路径是否正确","文件大小超出了限制,如果上传文件,最大限制是100MB":"文件大小超出了限制,如果上传文件,最大限制是100MB","文件消息失败,禁止发送违规封禁的文件":"文件消息失败,禁止发送违规封禁的文件","我":"我","无法查看":"无法查看","无法定位到原消息":"无法定位到原消息","无法收听":"无法收听","正在加载":"正在加载...","加载结束":"加载结束","无应答":"无应答","系统消息":"系统消息","消息":"message","消息或者资料中文本存在敏感内容,发送失败":"消息或者资料中文本存在敏感内容,发送失败","消息详情":"消息详情","消息长度超出限制,消息长度不要超过12K":"消息长度超出限制,消息长度不要超过12K","消息中图片存在敏感内容,发送失败":"消息中图片存在敏感内容,发送失败","选择提醒的人":"选择提醒的人","已读":"已读","已过撤回时限":"已过撤回时限","已接听":"已接听","已拒绝":"已拒绝","已同意":"已同意","引用":"引用","引用失败":"引用失败","语音":"[语音]","语音通话":"语音通话","重新编辑":"重新编辑","重新发送":"重新发送","转发":"转发","转发给":"转发给","自定义":"[自定义消息]","自定义消息":"自定义消息","腾讯云 IM":"腾讯云 IM","空":"空","文本包含本地审核拦截词":"文本包含本地审核拦截词"};t.default=r},"5fe2":function(e,t,n){"use strict";(function(e){var r=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n("146c"));var i={token:function(){var t="";try{if(o.default&&o.default.getters.token)t=o.default.getters.token,console.log("$store：",o.default.getters.token);else{var n=e.getStorageSync("token");n.Token&&(t=n.Token),console.log("value：",n.token)}}catch(r){console.log(r)}return console.log("getToken：",t),t}(),userType:"user"},a={SET_TOKEN:function(e,t){e.token=t},CLEAR_TOKEN:function(t){e.removeStorage({key:"token"}),t.token=""},SET_USER_TYPE:function(e,t){e.userType=t}},s={namespaced:!0,state:i,mutations:a,actions:{setToken:function(e,t){var n=e.commit;n("SET_TOKEN",t)},clearToken:function(e){var t=e.commit;t("CLEAR_TOKEN")},setUserType:function(e,t){var n=e.commit;n("SET_USER_TYPE",t)}}};t.default=s}).call(this,n("543d")["default"])},6504:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={tip:{"群成员":"群成员","加入群组":"加入群组","退出群组":"退出群组","被":"被","踢出群组":"踢出群组","成为管理员":"成为管理员","被撤销管理员":"被撤销管理员","被禁言":"被禁言","被取消禁言":"被取消禁言","群提示消息":"群提示消息","管理员":"管理员","开启全员禁言":"开启全员禁言","取消全员禁言":"取消全员禁言","成为新的群主":"成为新的群主","修改群名为":"修改群名为","发布新公告":"发布新公告","申请加入群组":"申请加入群组","成功加入群组":"成功加入群组","被拒绝":"被拒绝","你被管理员":"你被管理员","群":"群","解散":"解散","创建群":"创建群","邀请你加群":"邀请你加群","你退出群组":"你退出群组","你被":"你被","设置为群":"设置为群","的管理员":"的管理员","撤销群":"撤销群","的管理员身份":"的管理员身份","同意加群":"同意加群","拒接加群":"拒接加群","自定义群系统通知":"自定义群系统通知"},custom:{"自定义消息":"自定义消息","通话时长":"通话时长","结束群聊":"结束群聊","切换语音通话":"切换语音通话","切换视频通话":"切换视频通话","发起通话":"发起通话","取消通话":"取消通话","已接听":"已接听","拒绝通话":"拒绝通话","无应答":"无应答","对本次服务评价":"对本次服务评价","查看详情>>":"查看详情>>"}};t.default=r},"658f":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={"群聊通知":"群聊通知","系统通知":"系统通知","我的群聊":"我的群聊","输入ID":"请输入用户/群聊 ID，回车搜索","群名称":"群名称","群ID":"群ID","加入群聊":"加入群聊","解散群聊":"解散群聊","退出群聊":"退出群聊","进入群聊":"进入群聊","群类型":"群类型","请填写验证信息":"请填写验证信息","申请加入":"申请加入","已申请":"已申请","接受":"接受","拒绝":"拒绝","已处理":"已处理","添加群聊":"添加群聊","已加入":"已加入","该群组不存在":"该群组不存在","加群":"加群","我的好友":"我的好友","发送消息":"发送消息","个性签名":"个性签名","等待管理员同意":"申请成功，等待管理员同意入群申请","加群成功":"加群成功","您已是群成员":"您已是群成员","新的联系人":"新的联系人","黑名单":"黑名单","无搜索结果":"无搜索结果","客服号":"客服号",ID:"ID","联系人":"联系人","群聊":"群聊","添加好友/群聊":"添加好友/群聊","备注名":"备注名","加入黑名单":"加入黑名单","删除好友":"删除好友","等待验证":"等待验证","验证信息":"验证信息","发送申请":"发送申请","加入直播群":"加入直播群","同意":"同意","删除好友成功":"删除好友成功","删除好友失败":"删除好友失败","申请已发送":"申请已发送","申请发送失败":"申请发送失败","进入会话失败":"进入会话失败","添加好友成功":"添加好友成功","同意好友申请失败":"同意好友申请失败","拒绝成功":"拒绝成功","拒绝好友申请失败":"拒绝好友申请失败","解散群聊成功":"解散群聊成功","解散群聊失败":"解散群聊失败","退出群组成功":"退出群组成功","退出群组失败":"退出群组失败","申请入群失败":"申请入群失败","加入黑名单失败":"加入黑名单失败","移除黑名单失败":"移除黑名单失败","修改备注失败: 备注长度不得超过 96 字节":"修改备注失败: 备注长度不得超过 96 字节","修改备注成功":"修改备注成功","修改备注失败":"修改备注失败"};t.default=r},6613:function(e,t,n){var r=n("5a43");e.exports=function(e,t){if(e){if("string"===typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}},e.exports.__esModule=!0,e.exports["default"]=e.exports},"66fd":function(e,t,n){"use strict";n.r(t),function(e){
/*!
 * Vue.js v2.6.11
 * (c) 2014-2023 Evan You
 * Released under the MIT License.
 */
var n=Object.freeze({});function r(e){return void 0===e||null===e}function o(e){return void 0!==e&&null!==e}function i(e){return!0===e}function a(e){return"string"===typeof e||"number"===typeof e||"symbol"===typeof e||"boolean"===typeof e}function s(e){return null!==e&&"object"===typeof e}var u=Object.prototype.toString;function c(e){return"[object Object]"===u.call(e)}function l(e){var t=parseFloat(String(e));return t>=0&&Math.floor(t)===t&&isFinite(e)}function d(e){return o(e)&&"function"===typeof e.then&&"function"===typeof e.catch}function f(e){return null==e?"":Array.isArray(e)||c(e)&&e.toString===u?JSON.stringify(e,null,2):String(e)}function p(e){var t=parseFloat(e);return isNaN(t)?e:t}function h(e,t){for(var n=Object.create(null),r=e.split(","),o=0;o<r.length;o++)n[r[o]]=!0;return t?function(e){return n[e.toLowerCase()]}:function(e){return n[e]}}h("slot,component",!0);var g=h("key,ref,slot,slot-scope,is");function v(e,t){if(e.length){var n=e.indexOf(t);if(n>-1)return e.splice(n,1)}}var _=Object.prototype.hasOwnProperty;function m(e,t){return _.call(e,t)}function y(e){var t=Object.create(null);return function(n){var r=t[n];return r||(t[n]=e(n))}}var I=/-(\w)/g,M=y((function(e){return e.replace(I,(function(e,t){return t?t.toUpperCase():""}))})),T=y((function(e){return e.charAt(0).toUpperCase()+e.slice(1)})),S=/\B([A-Z])/g,E=y((function(e){return e.replace(S,"-$1").toLowerCase()}));var C=Function.prototype.bind?function(e,t){return e.bind(t)}:function(e,t){function n(n){var r=arguments.length;return r?r>1?e.apply(t,arguments):e.call(t,n):e.call(t)}return n._length=e.length,n};function k(e,t){t=t||0;var n=e.length-t,r=new Array(n);while(n--)r[n]=e[n+t];return r}function b(e,t){for(var n in t)e[n]=t[n];return e}function D(e){for(var t={},n=0;n<e.length;n++)e[n]&&b(t,e[n]);return t}function A(e,t,n){}var O=function(e,t,n){return!1},R=function(e){return e};function N(e,t){if(e===t)return!0;var n=s(e),r=s(t);if(!n||!r)return!n&&!r&&String(e)===String(t);try{var o=Array.isArray(e),i=Array.isArray(t);if(o&&i)return e.length===t.length&&e.every((function(e,n){return N(e,t[n])}));if(e instanceof Date&&t instanceof Date)return e.getTime()===t.getTime();if(o||i)return!1;var a=Object.keys(e),u=Object.keys(t);return a.length===u.length&&a.every((function(n){return N(e[n],t[n])}))}catch(c){return!1}}function w(e,t){for(var n=0;n<e.length;n++)if(N(e[n],t))return n;return-1}function L(e){var t=!1;return function(){t||(t=!0,e.apply(this,arguments))}}var P=["component","directive","filter"],U=["beforeCreate","created","beforeMount","mounted","beforeUpdate","updated","beforeDestroy","destroyed","activated","deactivated","errorCaptured","serverPrefetch"],G={optionMergeStrategies:Object.create(null),silent:!1,productionTip:!1,devtools:!1,performance:!1,errorHandler:null,warnHandler:null,ignoredElements:[],keyCodes:Object.create(null),isReservedTag:O,isReservedAttr:O,isUnknownElement:O,getTagNamespace:A,parsePlatformTagName:R,mustUseProp:O,async:!0,_lifecycleHooks:U},x=/a-zA-Z\u00B7\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u037D\u037F-\u1FFF\u200C-\u200D\u203F-\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD/;function F(e){var t=(e+"").charCodeAt(0);return 36===t||95===t}function q(e,t,n,r){Object.defineProperty(e,t,{value:n,enumerable:!!r,writable:!0,configurable:!0})}var V=new RegExp("[^"+x.source+".$_\\d]");var B,j="__proto__"in{},H="undefined"!==typeof window,K="undefined"!==typeof WXEnvironment&&!!WXEnvironment.platform,W=K&&WXEnvironment.platform.toLowerCase(),Y=H&&window.navigator.userAgent.toLowerCase(),z=Y&&/msie|trident/.test(Y),J=(Y&&Y.indexOf("msie 9.0"),Y&&Y.indexOf("edge/")>0),X=(Y&&Y.indexOf("android"),Y&&/iphone|ipad|ipod|ios/.test(Y)||"ios"===W),$=(Y&&/chrome\/\d+/.test(Y),Y&&/phantomjs/.test(Y),Y&&Y.match(/firefox\/(\d+)/),{}.watch);if(H)try{var Z={};Object.defineProperty(Z,"passive",{get:function(){}}),window.addEventListener("test-passive",null,Z)}catch(Gn){}var Q=function(){return void 0===B&&(B=!H&&!K&&"undefined"!==typeof e&&(e["process"]&&"server"===e["process"].env.VUE_ENV)),B},ee=H&&window.__VUE_DEVTOOLS_GLOBAL_HOOK__;function te(e){return"function"===typeof e&&/native code/.test(e.toString())}var ne,re="undefined"!==typeof Symbol&&te(Symbol)&&"undefined"!==typeof Reflect&&te(Reflect.ownKeys);ne="undefined"!==typeof Set&&te(Set)?Set:function(){function e(){this.set=Object.create(null)}return e.prototype.has=function(e){return!0===this.set[e]},e.prototype.add=function(e){this.set[e]=!0},e.prototype.clear=function(){this.set=Object.create(null)},e}();var oe=A,ie=0,ae=function(){this.id=ie++,this.subs=[]};function se(e){ae.SharedObject.targetStack.push(e),ae.SharedObject.target=e,ae.target=e}function ue(){ae.SharedObject.targetStack.pop(),ae.SharedObject.target=ae.SharedObject.targetStack[ae.SharedObject.targetStack.length-1],ae.target=ae.SharedObject.target}ae.prototype.addSub=function(e){this.subs.push(e)},ae.prototype.removeSub=function(e){v(this.subs,e)},ae.prototype.depend=function(){ae.SharedObject.target&&ae.SharedObject.target.addDep(this)},ae.prototype.notify=function(){var e=this.subs.slice();for(var t=0,n=e.length;t<n;t++)e[t].update()},ae.SharedObject={},ae.SharedObject.target=null,ae.SharedObject.targetStack=[];var ce=function(e,t,n,r,o,i,a,s){this.tag=e,this.data=t,this.children=n,this.text=r,this.elm=o,this.ns=void 0,this.context=i,this.fnContext=void 0,this.fnOptions=void 0,this.fnScopeId=void 0,this.key=t&&t.key,this.componentOptions=a,this.componentInstance=void 0,this.parent=void 0,this.raw=!1,this.isStatic=!1,this.isRootInsert=!0,this.isComment=!1,this.isCloned=!1,this.isOnce=!1,this.asyncFactory=s,this.asyncMeta=void 0,this.isAsyncPlaceholder=!1},le={child:{configurable:!0}};le.child.get=function(){return this.componentInstance},Object.defineProperties(ce.prototype,le);var de=function(e){void 0===e&&(e="");var t=new ce;return t.text=e,t.isComment=!0,t};function fe(e){return new ce(void 0,void 0,void 0,String(e))}var pe=Array.prototype,he=Object.create(pe);["push","pop","shift","unshift","splice","sort","reverse"].forEach((function(e){var t=pe[e];q(he,e,(function(){var n=[],r=arguments.length;while(r--)n[r]=arguments[r];var o,i=t.apply(this,n),a=this.__ob__;switch(e){case"push":case"unshift":o=n;break;case"splice":o=n.slice(2);break}return o&&a.observeArray(o),a.dep.notify(),i}))}));var ge=Object.getOwnPropertyNames(he),ve=!0;function _e(e){ve=e}var me=function(e){this.value=e,this.dep=new ae,this.vmCount=0,q(e,"__ob__",this),Array.isArray(e)?(j?e.push!==e.__proto__.push?ye(e,he,ge):function(e,t){e.__proto__=t}(e,he):ye(e,he,ge),this.observeArray(e)):this.walk(e)};function ye(e,t,n){for(var r=0,o=n.length;r<o;r++){var i=n[r];q(e,i,t[i])}}function Ie(e,t){var n;if(s(e)&&!(e instanceof ce))return m(e,"__ob__")&&e.__ob__ instanceof me?n=e.__ob__:!ve||Q()||!Array.isArray(e)&&!c(e)||!Object.isExtensible(e)||e._isVue||e.__v_isMPComponent||(n=new me(e)),t&&n&&n.vmCount++,n}function Me(e,t,n,r,o){var i=new ae,a=Object.getOwnPropertyDescriptor(e,t);if(!a||!1!==a.configurable){var s=a&&a.get,u=a&&a.set;s&&!u||2!==arguments.length||(n=e[t]);var c=!o&&Ie(n);Object.defineProperty(e,t,{enumerable:!0,configurable:!0,get:function(){var t=s?s.call(e):n;return ae.SharedObject.target&&(i.depend(),c&&(c.dep.depend(),Array.isArray(t)&&Ee(t))),t},set:function(t){var r=s?s.call(e):n;t===r||t!==t&&r!==r||s&&!u||(u?u.call(e,t):n=t,c=!o&&Ie(t),i.notify())}})}}function Te(e,t,n){if(Array.isArray(e)&&l(t))return e.length=Math.max(e.length,t),e.splice(t,1,n),n;if(t in e&&!(t in Object.prototype))return e[t]=n,n;var r=e.__ob__;return e._isVue||r&&r.vmCount?n:r?(Me(r.value,t,n),r.dep.notify(),n):(e[t]=n,n)}function Se(e,t){if(Array.isArray(e)&&l(t))e.splice(t,1);else{var n=e.__ob__;e._isVue||n&&n.vmCount||m(e,t)&&(delete e[t],n&&n.dep.notify())}}function Ee(e){for(var t=void 0,n=0,r=e.length;n<r;n++)t=e[n],t&&t.__ob__&&t.__ob__.dep.depend(),Array.isArray(t)&&Ee(t)}me.prototype.walk=function(e){for(var t=Object.keys(e),n=0;n<t.length;n++)Me(e,t[n])},me.prototype.observeArray=function(e){for(var t=0,n=e.length;t<n;t++)Ie(e[t])};var Ce=G.optionMergeStrategies;function ke(e,t){if(!t)return e;for(var n,r,o,i=re?Reflect.ownKeys(t):Object.keys(t),a=0;a<i.length;a++)n=i[a],"__ob__"!==n&&(r=e[n],o=t[n],m(e,n)?r!==o&&c(r)&&c(o)&&ke(r,o):Te(e,n,o));return e}function be(e,t,n){return n?function(){var r="function"===typeof t?t.call(n,n):t,o="function"===typeof e?e.call(n,n):e;return r?ke(r,o):o}:t?e?function(){return ke("function"===typeof t?t.call(this,this):t,"function"===typeof e?e.call(this,this):e)}:t:e}function De(e,t){var n=t?e?e.concat(t):Array.isArray(t)?t:[t]:e;return n?function(e){for(var t=[],n=0;n<e.length;n++)-1===t.indexOf(e[n])&&t.push(e[n]);return t}(n):n}function Ae(e,t,n,r){var o=Object.create(e||null);return t?b(o,t):o}Ce.data=function(e,t,n){return n?be(e,t,n):t&&"function"!==typeof t?e:be(e,t)},U.forEach((function(e){Ce[e]=De})),P.forEach((function(e){Ce[e+"s"]=Ae})),Ce.watch=function(e,t,n,r){if(e===$&&(e=void 0),t===$&&(t=void 0),!t)return Object.create(e||null);if(!e)return t;var o={};for(var i in b(o,e),t){var a=o[i],s=t[i];a&&!Array.isArray(a)&&(a=[a]),o[i]=a?a.concat(s):Array.isArray(s)?s:[s]}return o},Ce.props=Ce.methods=Ce.inject=Ce.computed=function(e,t,n,r){if(!e)return t;var o=Object.create(null);return b(o,e),t&&b(o,t),o},Ce.provide=be;var Oe=function(e,t){return void 0===t?e:t};function Re(e,t,n){if("function"===typeof t&&(t=t.options),function(e,t){var n=e.props;if(n){var r,o,i,a={};if(Array.isArray(n)){r=n.length;while(r--)o=n[r],"string"===typeof o&&(i=M(o),a[i]={type:null})}else if(c(n))for(var s in n)o=n[s],i=M(s),a[i]=c(o)?o:{type:o};else 0;e.props=a}}(t),function(e,t){var n=e.inject;if(n){var r=e.inject={};if(Array.isArray(n))for(var o=0;o<n.length;o++)r[n[o]]={from:n[o]};else if(c(n))for(var i in n){var a=n[i];r[i]=c(a)?b({from:i},a):{from:a}}else 0}}(t),function(e){var t=e.directives;if(t)for(var n in t){var r=t[n];"function"===typeof r&&(t[n]={bind:r,update:r})}}(t),!t._base&&(t.extends&&(e=Re(e,t.extends,n)),t.mixins))for(var r=0,o=t.mixins.length;r<o;r++)e=Re(e,t.mixins[r],n);var i,a={};for(i in e)s(i);for(i in t)m(e,i)||s(i);function s(r){var o=Ce[r]||Oe;a[r]=o(e[r],t[r],n,r)}return a}function Ne(e,t,n,r){if("string"===typeof n){var o=e[t];if(m(o,n))return o[n];var i=M(n);if(m(o,i))return o[i];var a=T(i);if(m(o,a))return o[a];var s=o[n]||o[i]||o[a];return s}}function we(e,t,n,r){var o=t[e],i=!m(n,e),a=n[e],s=Ue(Boolean,o.type);if(s>-1)if(i&&!m(o,"default"))a=!1;else if(""===a||a===E(e)){var u=Ue(String,o.type);(u<0||s<u)&&(a=!0)}if(void 0===a){a=function(e,t,n){if(!m(t,"default"))return;var r=t.default;0;if(e&&e.$options.propsData&&void 0===e.$options.propsData[n]&&void 0!==e._props[n])return e._props[n];return"function"===typeof r&&"Function"!==Le(t.type)?r.call(e):r}(r,o,e);var c=ve;_e(!0),Ie(a),_e(c)}return a}function Le(e){var t=e&&e.toString().match(/^\s*function (\w+)/);return t?t[1]:""}function Pe(e,t){return Le(e)===Le(t)}function Ue(e,t){if(!Array.isArray(t))return Pe(t,e)?0:-1;for(var n=0,r=t.length;n<r;n++)if(Pe(t[n],e))return n;return-1}function Ge(e,t,n){se();try{if(t){var r=t;while(r=r.$parent){var o=r.$options.errorCaptured;if(o)for(var i=0;i<o.length;i++)try{var a=!1===o[i].call(r,e,t,n);if(a)return}catch(Gn){Fe(Gn,r,"errorCaptured hook")}}}Fe(e,t,n)}finally{ue()}}function xe(e,t,n,r,o){var i;try{i=n?e.apply(t,n):e.call(t),i&&!i._isVue&&d(i)&&!i._handled&&(i.catch((function(e){return Ge(e,r,o+" (Promise/async)")})),i._handled=!0)}catch(Gn){Ge(Gn,r,o)}return i}function Fe(e,t,n){if(G.errorHandler)try{return G.errorHandler.call(null,e,t,n)}catch(Gn){Gn!==e&&qe(Gn,null,"config.errorHandler")}qe(e,t,n)}function qe(e,t,n){if(!H&&!K||"undefined"===typeof console)throw e;console.error(e)}var Ve,Be=[],je=!1;function He(){je=!1;var e=Be.slice(0);Be.length=0;for(var t=0;t<e.length;t++)e[t]()}if("undefined"!==typeof Promise&&te(Promise)){var Ke=Promise.resolve();Ve=function(){Ke.then(He),X&&setTimeout(A)}}else if(z||"undefined"===typeof MutationObserver||!te(MutationObserver)&&"[object MutationObserverConstructor]"!==MutationObserver.toString())Ve="undefined"!==typeof setImmediate&&te(setImmediate)?function(){setImmediate(He)}:function(){setTimeout(He,0)};else{var We=1,Ye=new MutationObserver(He),ze=document.createTextNode(String(We));Ye.observe(ze,{characterData:!0}),Ve=function(){We=(We+1)%2,ze.data=String(We)}}function Je(e,t){var n;if(Be.push((function(){if(e)try{e.call(t)}catch(Gn){Ge(Gn,t,"nextTick")}else n&&n(t)})),je||(je=!0,Ve()),!e&&"undefined"!==typeof Promise)return new Promise((function(e){n=e}))}var Xe=new ne;function $e(e){(function e(t,n){var r,o,i=Array.isArray(t);if(!i&&!s(t)||Object.isFrozen(t)||t instanceof ce)return;if(t.__ob__){var a=t.__ob__.dep.id;if(n.has(a))return;n.add(a)}if(i){r=t.length;while(r--)e(t[r],n)}else{o=Object.keys(t),r=o.length;while(r--)e(t[o[r]],n)}})(e,Xe),Xe.clear()}var Ze=y((function(e){var t="&"===e.charAt(0);e=t?e.slice(1):e;var n="~"===e.charAt(0);e=n?e.slice(1):e;var r="!"===e.charAt(0);return e=r?e.slice(1):e,{name:e,once:n,capture:r,passive:t}}));function Qe(e,t){function n(){var e=arguments,r=n.fns;if(!Array.isArray(r))return xe(r,null,arguments,t,"v-on handler");for(var o=r.slice(),i=0;i<o.length;i++)xe(o[i],null,e,t,"v-on handler")}return n.fns=e,n}function et(e,t,n,i){var a=t.options.mpOptions&&t.options.mpOptions.properties;if(r(a))return n;var s=t.options.mpOptions.externalClasses||[],u=e.attrs,c=e.props;if(o(u)||o(c))for(var l in a){var d=E(l),f=tt(n,c,l,d,!0)||tt(n,u,l,d,!1);f&&n[l]&&-1!==s.indexOf(d)&&i[M(n[l])]&&(n[l]=i[M(n[l])])}return n}function tt(e,t,n,r,i){if(o(t)){if(m(t,n))return e[n]=t[n],i||delete t[n],!0;if(m(t,r))return e[n]=t[r],i||delete t[r],!0}return!1}function nt(e){return a(e)?[fe(e)]:Array.isArray(e)?function e(t,n){var s,u,c,l,d=[];for(s=0;s<t.length;s++)u=t[s],r(u)||"boolean"===typeof u||(c=d.length-1,l=d[c],Array.isArray(u)?u.length>0&&(u=e(u,(n||"")+"_"+s),rt(u[0])&&rt(l)&&(d[c]=fe(l.text+u[0].text),u.shift()),d.push.apply(d,u)):a(u)?rt(l)?d[c]=fe(l.text+u):""!==u&&d.push(fe(u)):rt(u)&&rt(l)?d[c]=fe(l.text+u.text):(i(t._isVList)&&o(u.tag)&&r(u.key)&&o(n)&&(u.key="__vlist"+n+"_"+s+"__"),d.push(u)));return d}(e):void 0}function rt(e){return o(e)&&o(e.text)&&function(e){return!1===e}(e.isComment)}function ot(e){var t=e.$options.provide;t&&(e._provided="function"===typeof t?t.call(e):t)}function it(e){var t=at(e.$options.inject,e);t&&(_e(!1),Object.keys(t).forEach((function(n){Me(e,n,t[n])})),_e(!0))}function at(e,t){if(e){for(var n=Object.create(null),r=re?Reflect.ownKeys(e):Object.keys(e),o=0;o<r.length;o++){var i=r[o];if("__ob__"!==i){var a=e[i].from,s=t;while(s){if(s._provided&&m(s._provided,a)){n[i]=s._provided[a];break}s=s.$parent}if(!s)if("default"in e[i]){var u=e[i].default;n[i]="function"===typeof u?u.call(t):u}else 0}}return n}}function st(e,t){if(!e||!e.length)return{};for(var n={},r=0,o=e.length;r<o;r++){var i=e[r],a=i.data;if(a&&a.attrs&&a.attrs.slot&&delete a.attrs.slot,i.context!==t&&i.fnContext!==t||!a||null==a.slot)i.asyncMeta&&i.asyncMeta.data&&"page"===i.asyncMeta.data.slot?(n["page"]||(n["page"]=[])).push(i):(n.default||(n.default=[])).push(i);else{var s=a.slot,u=n[s]||(n[s]=[]);"template"===i.tag?u.push.apply(u,i.children||[]):u.push(i)}}for(var c in n)n[c].every(ut)&&delete n[c];return n}function ut(e){return e.isComment&&!e.asyncFactory||" "===e.text}function ct(e,t,r){var o,i=Object.keys(t).length>0,a=e?!!e.$stable:!i,s=e&&e.$key;if(e){if(e._normalized)return e._normalized;if(a&&r&&r!==n&&s===r.$key&&!i&&!r.$hasNormal)return r;for(var u in o={},e)e[u]&&"$"!==u[0]&&(o[u]=lt(t,u,e[u]))}else o={};for(var c in t)c in o||(o[c]=dt(t,c));return e&&Object.isExtensible(e)&&(e._normalized=o),q(o,"$stable",a),q(o,"$key",s),q(o,"$hasNormal",i),o}function lt(e,t,n){var r=function(){var e=arguments.length?n.apply(null,arguments):n({});return e=e&&"object"===typeof e&&!Array.isArray(e)?[e]:nt(e),e&&(0===e.length||1===e.length&&e[0].isComment)?void 0:e};return n.proxy&&Object.defineProperty(e,t,{get:r,enumerable:!0,configurable:!0}),r}function dt(e,t){return function(){return e[t]}}function ft(e,t){var n,r,i,a,u;if(Array.isArray(e)||"string"===typeof e)for(n=new Array(e.length),r=0,i=e.length;r<i;r++)n[r]=t(e[r],r,r,r);else if("number"===typeof e)for(n=new Array(e),r=0;r<e;r++)n[r]=t(r+1,r,r,r);else if(s(e))if(re&&e[Symbol.iterator]){n=[];var c=e[Symbol.iterator](),l=c.next();while(!l.done)n.push(t(l.value,n.length,r,r++)),l=c.next()}else for(a=Object.keys(e),n=new Array(a.length),r=0,i=a.length;r<i;r++)u=a[r],n[r]=t(e[u],u,r,r);return o(n)||(n=[]),n._isVList=!0,n}function pt(e,t,n,r){var o,i=this.$scopedSlots[e];i?(n=n||{},r&&(n=b(b({},r),n)),o=i(n,this,n._i)||t):o=this.$slots[e]||t;var a=n&&n.slot;return a?this.$createElement("template",{slot:a},o):o}function ht(e){return Ne(this.$options,"filters",e)||R}function gt(e,t){return Array.isArray(e)?-1===e.indexOf(t):e!==t}function vt(e,t,n,r,o){var i=G.keyCodes[t]||n;return o&&r&&!G.keyCodes[t]?gt(o,r):i?gt(i,e):r?E(r)!==t:void 0}function _t(e,t,n,r,o){if(n)if(s(n)){var i;Array.isArray(n)&&(n=D(n));var a=function(a){if("class"===a||"style"===a||g(a))i=e;else{var s=e.attrs&&e.attrs.type;i=r||G.mustUseProp(t,s,a)?e.domProps||(e.domProps={}):e.attrs||(e.attrs={})}var u=M(a),c=E(a);if(!(u in i)&&!(c in i)&&(i[a]=n[a],o)){var l=e.on||(e.on={});l["update:"+a]=function(e){n[a]=e}}};for(var u in n)a(u)}else;return e}function mt(e,t){var n=this._staticTrees||(this._staticTrees=[]),r=n[e];return r&&!t||(r=n[e]=this.$options.staticRenderFns[e].call(this._renderProxy,null,this),It(r,"__static__"+e,!1)),r}function yt(e,t,n){return It(e,"__once__"+t+(n?"_"+n:""),!0),e}function It(e,t,n){if(Array.isArray(e))for(var r=0;r<e.length;r++)e[r]&&"string"!==typeof e[r]&&Mt(e[r],t+"_"+r,n);else Mt(e,t,n)}function Mt(e,t,n){e.isStatic=!0,e.key=t,e.isOnce=n}function Tt(e,t){if(t)if(c(t)){var n=e.on=e.on?b({},e.on):{};for(var r in t){var o=n[r],i=t[r];n[r]=o?[].concat(o,i):i}}else;return e}function St(e,t,n,r){t=t||{$stable:!n};for(var o=0;o<e.length;o++){var i=e[o];Array.isArray(i)?St(i,t,n):i&&(i.proxy&&(i.fn.proxy=!0),t[i.key]=i.fn)}return r&&(t.$key=r),t}function Et(e,t){for(var n=0;n<t.length;n+=2){var r=t[n];"string"===typeof r&&r&&(e[t[n]]=t[n+1])}return e}function Ct(e,t){return"string"===typeof e?t+e:e}function kt(e){e._o=yt,e._n=p,e._s=f,e._l=ft,e._t=pt,e._q=N,e._i=w,e._m=mt,e._f=ht,e._k=vt,e._b=_t,e._v=fe,e._e=de,e._u=St,e._g=Tt,e._d=Et,e._p=Ct}function bt(e,t,r,o,a){var s,u=this,c=a.options;m(o,"_uid")?(s=Object.create(o),s._original=o):(s=o,o=o._original);var l=i(c._compiled),d=!l;this.data=e,this.props=t,this.children=r,this.parent=o,this.listeners=e.on||n,this.injections=at(c.inject,o),this.slots=function(){return u.$slots||ct(e.scopedSlots,u.$slots=st(r,o)),u.$slots},Object.defineProperty(this,"scopedSlots",{enumerable:!0,get:function(){return ct(e.scopedSlots,this.slots())}}),l&&(this.$options=c,this.$slots=this.slots(),this.$scopedSlots=ct(e.scopedSlots,this.$slots)),c._scopeId?this._c=function(e,t,n,r){var i=Lt(s,e,t,n,r,d);return i&&!Array.isArray(i)&&(i.fnScopeId=c._scopeId,i.fnContext=o),i}:this._c=function(e,t,n,r){return Lt(s,e,t,n,r,d)}}function Dt(e,t,n,r,o){var i=function(e){var t=new ce(e.tag,e.data,e.children&&e.children.slice(),e.text,e.elm,e.context,e.componentOptions,e.asyncFactory);return t.ns=e.ns,t.isStatic=e.isStatic,t.key=e.key,t.isComment=e.isComment,t.fnContext=e.fnContext,t.fnOptions=e.fnOptions,t.fnScopeId=e.fnScopeId,t.asyncMeta=e.asyncMeta,t.isCloned=!0,t}(e);return i.fnContext=n,i.fnOptions=r,t.slot&&((i.data||(i.data={})).slot=t.slot),i}function At(e,t){for(var n in t)e[M(n)]=t[n]}kt(bt.prototype);var Ot={init:function(e,t){if(e.componentInstance&&!e.componentInstance._isDestroyed&&e.data.keepAlive){var n=e;Ot.prepatch(n,n)}else{var r=e.componentInstance=function(e,t){var n={_isComponent:!0,_parentVnode:e,parent:t},r=e.data.inlineTemplate;o(r)&&(n.render=r.render,n.staticRenderFns=r.staticRenderFns);return new e.componentOptions.Ctor(n)}(e,jt);r.$mount(t?e.elm:void 0,t)}},prepatch:function(e,t){var r=t.componentOptions,o=t.componentInstance=e.componentInstance;(function(e,t,r,o,i){0;var a=o.data.scopedSlots,s=e.$scopedSlots,u=!!(a&&!a.$stable||s!==n&&!s.$stable||a&&e.$scopedSlots.$key!==a.$key),c=!!(i||e.$options._renderChildren||u);e.$options._parentVnode=o,e.$vnode=o,e._vnode&&(e._vnode.parent=o);if(e.$options._renderChildren=i,e.$attrs=o.data.attrs||n,e.$listeners=r||n,t&&e.$options.props){_e(!1);for(var l=e._props,d=e.$options._propKeys||[],f=0;f<d.length;f++){var p=d[f],h=e.$options.props;l[p]=we(p,h,t,e)}_e(!0),e.$options.propsData=t}e._$updateProperties&&e._$updateProperties(e),r=r||n;var g=e.$options._parentListeners;e.$options._parentListeners=r,Bt(e,r,g),c&&(e.$slots=st(i,o.context),e.$forceUpdate());0})(o,r.propsData,r.listeners,t,r.children)},insert:function(e){var t=e.context,n=e.componentInstance;n._isMounted||(Wt(n,"onServiceCreated"),Wt(n,"onServiceAttached"),n._isMounted=!0,Wt(n,"mounted")),e.data.keepAlive&&(t._isMounted?function(e){e._inactive=!1,zt.push(e)}(n):Kt(n,!0))},destroy:function(e){var t=e.componentInstance;t._isDestroyed||(e.data.keepAlive?function e(t,n){if(n&&(t._directInactive=!0,Ht(t)))return;if(!t._inactive){t._inactive=!0;for(var r=0;r<t.$children.length;r++)e(t.$children[r]);Wt(t,"deactivated")}}(t,!0):t.$destroy())}},Rt=Object.keys(Ot);function Nt(e,t,a,u,c){if(!r(e)){var l=a.$options._base;if(s(e)&&(e=l.extend(e)),"function"===typeof e){var f;if(r(e.cid)&&(f=e,e=function(e,t){if(i(e.error)&&o(e.errorComp))return e.errorComp;if(o(e.resolved))return e.resolved;var n=Ut;n&&o(e.owners)&&-1===e.owners.indexOf(n)&&e.owners.push(n);if(i(e.loading)&&o(e.loadingComp))return e.loadingComp;if(n&&!o(e.owners)){var a=e.owners=[n],u=!0,c=null,l=null;n.$on("hook:destroyed",(function(){return v(a,n)}));var f=function(e){for(var t=0,n=a.length;t<n;t++)a[t].$forceUpdate();e&&(a.length=0,null!==c&&(clearTimeout(c),c=null),null!==l&&(clearTimeout(l),l=null))},p=L((function(n){e.resolved=Gt(n,t),u?a.length=0:f(!0)})),h=L((function(t){o(e.errorComp)&&(e.error=!0,f(!0))})),g=e(p,h);return s(g)&&(d(g)?r(e.resolved)&&g.then(p,h):d(g.component)&&(g.component.then(p,h),o(g.error)&&(e.errorComp=Gt(g.error,t)),o(g.loading)&&(e.loadingComp=Gt(g.loading,t),0===g.delay?e.loading=!0:c=setTimeout((function(){c=null,r(e.resolved)&&r(e.error)&&(e.loading=!0,f(!1))}),g.delay||200)),o(g.timeout)&&(l=setTimeout((function(){l=null,r(e.resolved)&&h(null)}),g.timeout)))),u=!1,e.loading?e.loadingComp:e.resolved}}(f,l),void 0===e))return function(e,t,n,r,o){var i=de();return i.asyncFactory=e,i.asyncMeta={data:t,context:n,children:r,tag:o},i}(f,t,a,u,c);t=t||{},hn(e),o(t.model)&&function(e,t){var n=e.model&&e.model.prop||"value",r=e.model&&e.model.event||"input";(t.attrs||(t.attrs={}))[n]=t.model.value;var i=t.on||(t.on={}),a=i[r],s=t.model.callback;o(a)?(Array.isArray(a)?-1===a.indexOf(s):a!==s)&&(i[r]=[s].concat(a)):i[r]=s}(e.options,t);var p=function(e,t,n,i){var a=t.options.props;if(r(a))return et(e,t,{},i);var s={},u=e.attrs,c=e.props;if(o(u)||o(c))for(var l in a){var d=E(l);tt(s,c,l,d,!0)||tt(s,u,l,d,!1)}return et(e,t,s,i)}(t,e,0,a);if(i(e.options.functional))return function(e,t,r,i,a){var s=e.options,u={},c=s.props;if(o(c))for(var l in c)u[l]=we(l,c,t||n);else o(r.attrs)&&At(u,r.attrs),o(r.props)&&At(u,r.props);var d=new bt(r,u,a,i,e),f=s.render.call(null,d._c,d);if(f instanceof ce)return Dt(f,r,d.parent,s,d);if(Array.isArray(f)){for(var p=nt(f)||[],h=new Array(p.length),g=0;g<p.length;g++)h[g]=Dt(p[g],r,d.parent,s,d);return h}}(e,p,t,a,u);var h=t.on;if(t.on=t.nativeOn,i(e.options.abstract)){var g=t.slot;t={},g&&(t.slot=g)}(function(e){for(var t=e.hook||(e.hook={}),n=0;n<Rt.length;n++){var r=Rt[n],o=t[r],i=Ot[r];o===i||o&&o._merged||(t[r]=o?wt(i,o):i)}})(t);var _=e.options.name||c,m=new ce("vue-component-"+e.cid+(_?"-"+_:""),t,void 0,void 0,void 0,a,{Ctor:e,propsData:p,listeners:h,tag:c,children:u},f);return m}}}function wt(e,t){var n=function(n,r){e(n,r),t(n,r)};return n._merged=!0,n}function Lt(e,t,n,u,c,l){return(Array.isArray(n)||a(n))&&(c=u,u=n,n=void 0),i(l)&&(c=2),function(e,t,n,a,u){if(o(n)&&o(n.__ob__))return de();o(n)&&o(n.is)&&(t=n.is);if(!t)return de();0;Array.isArray(a)&&"function"===typeof a[0]&&(n=n||{},n.scopedSlots={default:a[0]},a.length=0);2===u?a=nt(a):1===u&&(a=function(e){for(var t=0;t<e.length;t++)if(Array.isArray(e[t]))return Array.prototype.concat.apply([],e);return e}(a));var c,l;if("string"===typeof t){var d;l=e.$vnode&&e.$vnode.ns||G.getTagNamespace(t),c=G.isReservedTag(t)?new ce(G.parsePlatformTagName(t),n,a,void 0,void 0,e):n&&n.pre||!o(d=Ne(e.$options,"components",t))?new ce(t,n,a,void 0,void 0,e):Nt(d,n,e,a,t)}else c=Nt(t,n,e,a);return Array.isArray(c)?c:o(c)?(o(l)&&function e(t,n,a){t.ns=n,"foreignObject"===t.tag&&(n=void 0,a=!0);if(o(t.children))for(var s=0,u=t.children.length;s<u;s++){var c=t.children[s];o(c.tag)&&(r(c.ns)||i(a)&&"svg"!==c.tag)&&e(c,n,a)}}(c,l),o(n)&&function(e){s(e.style)&&$e(e.style);s(e.class)&&$e(e.class)}(n),c):de()}(e,t,n,u,c)}var Pt,Ut=null;function Gt(e,t){return(e.__esModule||re&&"Module"===e[Symbol.toStringTag])&&(e=e.default),s(e)?t.extend(e):e}function xt(e){return e.isComment&&e.asyncFactory}function Ft(e,t){Pt.$on(e,t)}function qt(e,t){Pt.$off(e,t)}function Vt(e,t){var n=Pt;return function r(){var o=t.apply(null,arguments);null!==o&&n.$off(e,r)}}function Bt(e,t,n){Pt=e,function(e,t,n,o,a,s){var u,c,l,d;for(u in e)c=e[u],l=t[u],d=Ze(u),r(c)||(r(l)?(r(c.fns)&&(c=e[u]=Qe(c,s)),i(d.once)&&(c=e[u]=a(d.name,c,d.capture)),n(d.name,c,d.capture,d.passive,d.params)):c!==l&&(l.fns=c,e[u]=l));for(u in t)r(e[u])&&(d=Ze(u),o(d.name,t[u],d.capture))}(t,n||{},Ft,qt,Vt,e),Pt=void 0}var jt=null;function Ht(e){while(e&&(e=e.$parent))if(e._inactive)return!0;return!1}function Kt(e,t){if(t){if(e._directInactive=!1,Ht(e))return}else if(e._directInactive)return;if(e._inactive||null===e._inactive){e._inactive=!1;for(var n=0;n<e.$children.length;n++)Kt(e.$children[n]);Wt(e,"activated")}}function Wt(e,t){se();var n=e.$options[t],r=t+" hook";if(n)for(var o=0,i=n.length;o<i;o++)xe(n[o],e,null,e,r);e._hasHookEvent&&e.$emit("hook:"+t),ue()}var Yt=[],zt=[],Jt={},Xt=!1,$t=!1,Zt=0;var Qt=Date.now;if(H&&!z){var en=window.performance;en&&"function"===typeof en.now&&Qt()>document.createEvent("Event").timeStamp&&(Qt=function(){return en.now()})}function tn(){var e,t;for(Qt(),$t=!0,Yt.sort((function(e,t){return e.id-t.id})),Zt=0;Zt<Yt.length;Zt++)e=Yt[Zt],e.before&&e.before(),t=e.id,Jt[t]=null,e.run();var n=zt.slice(),r=Yt.slice();(function(){Zt=Yt.length=zt.length=0,Jt={},Xt=$t=!1})(),function(e){for(var t=0;t<e.length;t++)e[t]._inactive=!0,Kt(e[t],!0)}(n),function(e){var t=e.length;while(t--){var n=e[t],r=n.vm;r._watcher===n&&r._isMounted&&!r._isDestroyed&&Wt(r,"updated")}}(r),ee&&G.devtools&&ee.emit("flush")}var nn=0,rn=function(e,t,n,r,o){this.vm=e,o&&(e._watcher=this),e._watchers.push(this),r?(this.deep=!!r.deep,this.user=!!r.user,this.lazy=!!r.lazy,this.sync=!!r.sync,this.before=r.before):this.deep=this.user=this.lazy=this.sync=!1,this.cb=n,this.id=++nn,this.active=!0,this.dirty=this.lazy,this.deps=[],this.newDeps=[],this.depIds=new ne,this.newDepIds=new ne,this.expression="","function"===typeof t?this.getter=t:(this.getter=function(e){if(!V.test(e)){var t=e.split(".");return function(e){for(var n=0;n<t.length;n++){if(!e)return;e=e[t[n]]}return e}}}(t),this.getter||(this.getter=A)),this.value=this.lazy?void 0:this.get()};rn.prototype.get=function(){var e;se(this);var t=this.vm;try{e=this.getter.call(t,t)}catch(Gn){if(!this.user)throw Gn;Ge(Gn,t,'getter for watcher "'+this.expression+'"')}finally{this.deep&&$e(e),ue(),this.cleanupDeps()}return e},rn.prototype.addDep=function(e){var t=e.id;this.newDepIds.has(t)||(this.newDepIds.add(t),this.newDeps.push(e),this.depIds.has(t)||e.addSub(this))},rn.prototype.cleanupDeps=function(){var e=this.deps.length;while(e--){var t=this.deps[e];this.newDepIds.has(t.id)||t.removeSub(this)}var n=this.depIds;this.depIds=this.newDepIds,this.newDepIds=n,this.newDepIds.clear(),n=this.deps,this.deps=this.newDeps,this.newDeps=n,this.newDeps.length=0},rn.prototype.update=function(){this.lazy?this.dirty=!0:this.sync?this.run():function(e){var t=e.id;if(null==Jt[t]){if(Jt[t]=!0,$t){var n=Yt.length-1;while(n>Zt&&Yt[n].id>e.id)n--;Yt.splice(n+1,0,e)}else Yt.push(e);Xt||(Xt=!0,Je(tn))}}(this)},rn.prototype.run=function(){if(this.active){var e=this.get();if(e!==this.value||s(e)||this.deep){var t=this.value;if(this.value=e,this.user)try{this.cb.call(this.vm,e,t)}catch(Gn){Ge(Gn,this.vm,'callback for watcher "'+this.expression+'"')}else this.cb.call(this.vm,e,t)}}},rn.prototype.evaluate=function(){this.value=this.get(),this.dirty=!1},rn.prototype.depend=function(){var e=this.deps.length;while(e--)this.deps[e].depend()},rn.prototype.teardown=function(){if(this.active){this.vm._isBeingDestroyed||v(this.vm._watchers,this);var e=this.deps.length;while(e--)this.deps[e].removeSub(this);this.active=!1}};var on={enumerable:!0,configurable:!0,get:A,set:A};function an(e,t,n){on.get=function(){return this[t][n]},on.set=function(e){this[t][n]=e},Object.defineProperty(e,n,on)}function sn(e){e._watchers=[];var t=e.$options;t.props&&function(e,t){var n=e.$options.propsData||{},r=e._props={},o=e.$options._propKeys=[],i=!e.$parent;i||_e(!1);var a=function(i){o.push(i);var a=we(i,t,n,e);Me(r,i,a),i in e||an(e,"_props",i)};for(var s in t)a(s);_e(!0)}(e,t.props),t.methods&&function(e,t){e.$options.props;for(var n in t)e[n]="function"!==typeof t[n]?A:C(t[n],e)}(e,t.methods),t.data?function(e){var t=e.$options.data;t=e._data="function"===typeof t?function(e,t){se();try{return e.call(t,t)}catch(Gn){return Ge(Gn,t,"data()"),{}}finally{ue()}}(t,e):t||{},c(t)||(t={});var n=Object.keys(t),r=e.$options.props,o=(e.$options.methods,n.length);while(o--){var i=n[o];0,r&&m(r,i)||F(i)||an(e,"_data",i)}Ie(t,!0)}(e):Ie(e._data={},!0),t.computed&&function(e,t){var n=e._computedWatchers=Object.create(null),r=Q();for(var o in t){var i=t[o],a="function"===typeof i?i:i.get;0,r||(n[o]=new rn(e,a||A,A,un)),o in e||cn(e,o,i)}}(e,t.computed),t.watch&&t.watch!==$&&function(e,t){for(var n in t){var r=t[n];if(Array.isArray(r))for(var o=0;o<r.length;o++)fn(e,n,r[o]);else fn(e,n,r)}}(e,t.watch)}var un={lazy:!0};function cn(e,t,n){var r=!Q();"function"===typeof n?(on.get=r?ln(t):dn(n),on.set=A):(on.get=n.get?r&&!1!==n.cache?ln(t):dn(n.get):A,on.set=n.set||A),Object.defineProperty(e,t,on)}function ln(e){return function(){var t=this._computedWatchers&&this._computedWatchers[e];if(t)return t.dirty&&t.evaluate(),ae.SharedObject.target&&t.depend(),t.value}}function dn(e){return function(){return e.call(this,this)}}function fn(e,t,n,r){return c(n)&&(r=n,n=n.handler),"string"===typeof n&&(n=e[n]),e.$watch(t,n,r)}var pn=0;function hn(e){var t=e.options;if(e.super){var n=hn(e.super),r=e.superOptions;if(n!==r){e.superOptions=n;var o=function(e){var t,n=e.options,r=e.sealedOptions;for(var o in n)n[o]!==r[o]&&(t||(t={}),t[o]=n[o]);return t}(e);o&&b(e.extendOptions,o),t=e.options=Re(n,e.extendOptions),t.name&&(t.components[t.name]=e)}}return t}function gn(e){this._init(e)}function vn(e){e.cid=0;var t=1;e.extend=function(e){e=e||{};var n=this,r=n.cid,o=e._Ctor||(e._Ctor={});if(o[r])return o[r];var i=e.name||n.options.name;var a=function(e){this._init(e)};return a.prototype=Object.create(n.prototype),a.prototype.constructor=a,a.cid=t++,a.options=Re(n.options,e),a["super"]=n,a.options.props&&function(e){var t=e.options.props;for(var n in t)an(e.prototype,"_props",n)}(a),a.options.computed&&function(e){var t=e.options.computed;for(var n in t)cn(e.prototype,n,t[n])}(a),a.extend=n.extend,a.mixin=n.mixin,a.use=n.use,P.forEach((function(e){a[e]=n[e]})),i&&(a.options.components[i]=a),a.superOptions=n.options,a.extendOptions=e,a.sealedOptions=b({},a.options),o[r]=a,a}}function _n(e){return e&&(e.Ctor.options.name||e.tag)}function mn(e,t){return Array.isArray(e)?e.indexOf(t)>-1:"string"===typeof e?e.split(",").indexOf(t)>-1:!!function(e){return"[object RegExp]"===u.call(e)}(e)&&e.test(t)}function yn(e,t){var n=e.cache,r=e.keys,o=e._vnode;for(var i in n){var a=n[i];if(a){var s=_n(a.componentOptions);s&&!t(s)&&In(n,i,r,o)}}}function In(e,t,n,r){var o=e[t];!o||r&&o.tag===r.tag||o.componentInstance.$destroy(),e[t]=null,v(n,t)}(function(e){e.prototype._init=function(e){var t=this;t._uid=pn++,t._isVue=!0,e&&e._isComponent?function(e,t){var n=e.$options=Object.create(e.constructor.options),r=t._parentVnode;n.parent=t.parent,n._parentVnode=r;var o=r.componentOptions;n.propsData=o.propsData,n._parentListeners=o.listeners,n._renderChildren=o.children,n._componentTag=o.tag,t.render&&(n.render=t.render,n.staticRenderFns=t.staticRenderFns)}(t,e):t.$options=Re(hn(t.constructor),e||{},t),t._renderProxy=t,t._self=t,function(e){var t=e.$options,n=t.parent;if(n&&!t.abstract){while(n.$options.abstract&&n.$parent)n=n.$parent;n.$children.push(e)}e.$parent=n,e.$root=n?n.$root:e,e.$children=[],e.$refs={},e._watcher=null,e._inactive=null,e._directInactive=!1,e._isMounted=!1,e._isDestroyed=!1,e._isBeingDestroyed=!1}(t),function(e){e._events=Object.create(null),e._hasHookEvent=!1;var t=e.$options._parentListeners;t&&Bt(e,t)}(t),function(e){e._vnode=null,e._staticTrees=null;var t=e.$options,r=e.$vnode=t._parentVnode,o=r&&r.context;e.$slots=st(t._renderChildren,o),e.$scopedSlots=n,e._c=function(t,n,r,o){return Lt(e,t,n,r,o,!1)},e.$createElement=function(t,n,r,o){return Lt(e,t,n,r,o,!0)};var i=r&&r.data;Me(e,"$attrs",i&&i.attrs||n,null,!0),Me(e,"$listeners",t._parentListeners||n,null,!0)}(t),Wt(t,"beforeCreate"),!t._$fallback&&it(t),sn(t),!t._$fallback&&ot(t),!t._$fallback&&Wt(t,"created"),t.$options.el&&t.$mount(t.$options.el)}})(gn),function(e){var t={get:function(){return this._data}},n={get:function(){return this._props}};Object.defineProperty(e.prototype,"$data",t),Object.defineProperty(e.prototype,"$props",n),e.prototype.$set=Te,e.prototype.$delete=Se,e.prototype.$watch=function(e,t,n){if(c(t))return fn(this,e,t,n);n=n||{},n.user=!0;var r=new rn(this,e,t,n);if(n.immediate)try{t.call(this,r.value)}catch(o){Ge(o,this,'callback for immediate watcher "'+r.expression+'"')}return function(){r.teardown()}}}(gn),function(e){var t=/^hook:/;e.prototype.$on=function(e,n){var r=this;if(Array.isArray(e))for(var o=0,i=e.length;o<i;o++)r.$on(e[o],n);else(r._events[e]||(r._events[e]=[])).push(n),t.test(e)&&(r._hasHookEvent=!0);return r},e.prototype.$once=function(e,t){var n=this;function r(){n.$off(e,r),t.apply(n,arguments)}return r.fn=t,n.$on(e,r),n},e.prototype.$off=function(e,t){var n=this;if(!arguments.length)return n._events=Object.create(null),n;if(Array.isArray(e)){for(var r=0,o=e.length;r<o;r++)n.$off(e[r],t);return n}var i,a=n._events[e];if(!a)return n;if(!t)return n._events[e]=null,n;var s=a.length;while(s--)if(i=a[s],i===t||i.fn===t){a.splice(s,1);break}return n},e.prototype.$emit=function(e){var t=this,n=t._events[e];if(n){n=n.length>1?k(n):n;for(var r=k(arguments,1),o='event handler for "'+e+'"',i=0,a=n.length;i<a;i++)xe(n[i],t,r,t,o)}return t}}(gn),function(e){e.prototype._update=function(e,t){var n=this,r=n.$el,o=n._vnode,i=function(e){var t=jt;return jt=e,function(){jt=t}}(n);n._vnode=e,n.$el=o?n.__patch__(o,e):n.__patch__(n.$el,e,t,!1),i(),r&&(r.__vue__=null),n.$el&&(n.$el.__vue__=n),n.$vnode&&n.$parent&&n.$vnode===n.$parent._vnode&&(n.$parent.$el=n.$el)},e.prototype.$forceUpdate=function(){this._watcher&&this._watcher.update()},e.prototype.$destroy=function(){var e=this;if(!e._isBeingDestroyed){Wt(e,"beforeDestroy"),e._isBeingDestroyed=!0;var t=e.$parent;!t||t._isBeingDestroyed||e.$options.abstract||v(t.$children,e),e._watcher&&e._watcher.teardown();var n=e._watchers.length;while(n--)e._watchers[n].teardown();e._data.__ob__&&e._data.__ob__.vmCount--,e._isDestroyed=!0,e.__patch__(e._vnode,null),Wt(e,"destroyed"),e.$off(),e.$el&&(e.$el.__vue__=null),e.$vnode&&(e.$vnode.parent=null)}}}(gn),function(e){kt(e.prototype),e.prototype.$nextTick=function(e){return Je(e,this)},e.prototype._render=function(){var e,t=this,n=t.$options,r=n.render,o=n._parentVnode;o&&(t.$scopedSlots=ct(o.data.scopedSlots,t.$slots,t.$scopedSlots)),t.$vnode=o;try{Ut=t,e=r.call(t._renderProxy,t.$createElement)}catch(Gn){Ge(Gn,t,"render"),e=t._vnode}finally{Ut=null}return Array.isArray(e)&&1===e.length&&(e=e[0]),e instanceof ce||(e=de()),e.parent=o,e}}(gn);var Mn=[String,RegExp,Array],Tn={name:"keep-alive",abstract:!0,props:{include:Mn,exclude:Mn,max:[String,Number]},created:function(){this.cache=Object.create(null),this.keys=[]},destroyed:function(){for(var e in this.cache)In(this.cache,e,this.keys)},mounted:function(){var e=this;this.$watch("include",(function(t){yn(e,(function(e){return mn(t,e)}))})),this.$watch("exclude",(function(t){yn(e,(function(e){return!mn(t,e)}))}))},render:function(){var e=this.$slots.default,t=function(e){if(Array.isArray(e))for(var t=0;t<e.length;t++){var n=e[t];if(o(n)&&(o(n.componentOptions)||xt(n)))return n}}(e),n=t&&t.componentOptions;if(n){var r=_n(n),i=this.include,a=this.exclude;if(i&&(!r||!mn(i,r))||a&&r&&mn(a,r))return t;var s=this.cache,u=this.keys,c=null==t.key?n.Ctor.cid+(n.tag?"::"+n.tag:""):t.key;s[c]?(t.componentInstance=s[c].componentInstance,v(u,c),u.push(c)):(s[c]=t,u.push(c),this.max&&u.length>parseInt(this.max)&&In(s,u[0],u,this._vnode)),t.data.keepAlive=!0}return t||e&&e[0]}},Sn={KeepAlive:Tn};(function(e){var t={get:function(){return G}};Object.defineProperty(e,"config",t),e.util={warn:oe,extend:b,mergeOptions:Re,defineReactive:Me},e.set=Te,e.delete=Se,e.nextTick=Je,e.observable=function(e){return Ie(e),e},e.options=Object.create(null),P.forEach((function(t){e.options[t+"s"]=Object.create(null)})),e.options._base=e,b(e.options.components,Sn),function(e){e.use=function(e){var t=this._installedPlugins||(this._installedPlugins=[]);if(t.indexOf(e)>-1)return this;var n=k(arguments,1);return n.unshift(this),"function"===typeof e.install?e.install.apply(e,n):"function"===typeof e&&e.apply(null,n),t.push(e),this}}(e),function(e){e.mixin=function(e){return this.options=Re(this.options,e),this}}(e),vn(e),function(e){P.forEach((function(t){e[t]=function(e,n){return n?("component"===t&&c(n)&&(n.name=n.name||e,n=this.options._base.extend(n)),"directive"===t&&"function"===typeof n&&(n={bind:n,update:n}),this.options[t+"s"][e]=n,n):this.options[t+"s"][e]}}))}(e)})(gn),Object.defineProperty(gn.prototype,"$isServer",{get:Q}),Object.defineProperty(gn.prototype,"$ssrContext",{get:function(){return this.$vnode&&this.$vnode.ssrContext}}),Object.defineProperty(gn,"FunctionalRenderContext",{value:bt}),gn.version="2.6.11";var En="[object Array]",Cn="[object Object]";function kn(e,t){var n={};return function e(t,n){if(t===n)return;var r=Dn(t),o=Dn(n);if(r==Cn&&o==Cn){if(Object.keys(t).length>=Object.keys(n).length)for(var i in n){var a=t[i];void 0===a?t[i]=null:e(a,n[i])}}else r==En&&o==En&&t.length>=n.length&&n.forEach((function(n,r){e(t[r],n)}))}(e,t),function e(t,n,r,o){if(t===n)return;var i=Dn(t),a=Dn(n);if(i==Cn)if(a!=Cn||Object.keys(t).length<Object.keys(n).length)bn(o,r,t);else{var s=function(i){var a=t[i],s=n[i],u=Dn(a),c=Dn(s);if(u!=En&&u!=Cn)a!==n[i]&&function(e,t){if(("[object Null]"===e||"[object Undefined]"===e)&&("[object Null]"===t||"[object Undefined]"===t))return!1;return!0}(u,c)&&bn(o,(""==r?"":r+".")+i,a);else if(u==En)c!=En||a.length<s.length?bn(o,(""==r?"":r+".")+i,a):a.forEach((function(t,n){e(t,s[n],(""==r?"":r+".")+i+"["+n+"]",o)}));else if(u==Cn)if(c!=Cn||Object.keys(a).length<Object.keys(s).length)bn(o,(""==r?"":r+".")+i,a);else for(var l in a)e(a[l],s[l],(""==r?"":r+".")+i+"."+l,o)};for(var u in t)s(u)}else i==En?a!=En||t.length<n.length?bn(o,r,t):t.forEach((function(t,i){e(t,n[i],r+"["+i+"]",o)})):bn(o,r,t)}(e,t,"",n),n}function bn(e,t,n){e[t]=n}function Dn(e){return Object.prototype.toString.call(e)}function An(e){if(e.__next_tick_callbacks&&e.__next_tick_callbacks.length){if(Object({VUE_APP_DARK_MODE:"false",VUE_APP_NAME:"familySign",VUE_APP_PLATFORM:"mp-weixin",NODE_ENV:"production",BASE_URL:"/"}).VUE_APP_DEBUG){var t=e.$scope;console.log("["+ +new Date+"]["+(t.is||t.route)+"]["+e._uid+"]:flushCallbacks["+e.__next_tick_callbacks.length+"]")}var n=e.__next_tick_callbacks.slice(0);e.__next_tick_callbacks.length=0;for(var r=0;r<n.length;r++)n[r]()}}function On(e,t){if(!e.__next_tick_pending&&!function(e){return Yt.find((function(t){return e._watcher===t}))}(e)){if(Object({VUE_APP_DARK_MODE:"false",VUE_APP_NAME:"familySign",VUE_APP_PLATFORM:"mp-weixin",NODE_ENV:"production",BASE_URL:"/"}).VUE_APP_DEBUG){var n=e.$scope;console.log("["+ +new Date+"]["+(n.is||n.route)+"]["+e._uid+"]:nextVueTick")}return Je(t,e)}if(Object({VUE_APP_DARK_MODE:"false",VUE_APP_NAME:"familySign",VUE_APP_PLATFORM:"mp-weixin",NODE_ENV:"production",BASE_URL:"/"}).VUE_APP_DEBUG){var r=e.$scope;console.log("["+ +new Date+"]["+(r.is||r.route)+"]["+e._uid+"]:nextMPTick")}var o;if(e.__next_tick_callbacks||(e.__next_tick_callbacks=[]),e.__next_tick_callbacks.push((function(){if(t)try{t.call(e)}catch(Gn){Ge(Gn,e,"nextTick")}else o&&o(e)})),!t&&"undefined"!==typeof Promise)return new Promise((function(e){o=e}))}function Rn(e,t){return t&&(t._isVue||t.__v_isMPComponent)?{}:t}function Nn(){}function wn(e){return Array.isArray(e)?function(e){for(var t,n="",r=0,i=e.length;r<i;r++)o(t=wn(e[r]))&&""!==t&&(n&&(n+=" "),n+=t);return n}(e):s(e)?function(e){var t="";for(var n in e)e[n]&&(t&&(t+=" "),t+=n);return t}(e):"string"===typeof e?e:""}var Ln=y((function(e){var t={},n=/:(.+)/;return e.split(/;(?![^(]*\))/g).forEach((function(e){if(e){var r=e.split(n);r.length>1&&(t[r[0].trim()]=r[1].trim())}})),t}));var Pn=["createSelectorQuery","createIntersectionObserver","selectAllComponents","selectComponent"];var Un=["onLaunch","onShow","onHide","onUniNViewMessage","onPageNotFound","onThemeChange","onError","onUnhandledRejection","onInit","onLoad","onReady","onUnload","onPullDownRefresh","onReachBottom","onTabItemTap","onAddToFavorites","onShareTimeline","onShareAppMessage","onResize","onPageScroll","onNavigationBarButtonTap","onBackPress","onNavigationBarSearchInputChanged","onNavigationBarSearchInputConfirmed","onNavigationBarSearchInputClicked","onUploadDouyinVideo","onNFCReadMessage","onPageShow","onPageHide","onPageResize"];gn.prototype.__patch__=function(e,t){var n=this;if(null!==t&&("page"===this.mpType||"component"===this.mpType)){var r=this.$scope,o=Object.create(null);try{o=function(e){var t=Object.create(null),n=[].concat(Object.keys(e._data||{}),Object.keys(e._computedWatchers||{}));n.reduce((function(t,n){return t[n]=e[n],t}),t);var r=e.__composition_api_state__||e.__secret_vfa_state__,o=r&&r.rawBindings;return o&&Object.keys(o).forEach((function(n){t[n]=e[n]})),Object.assign(t,e.$mp.data||{}),Array.isArray(e.$options.behaviors)&&-1!==e.$options.behaviors.indexOf("uni://form-field")&&(t["name"]=e.name,t["value"]=e.value),JSON.parse(JSON.stringify(t,Rn))}(this)}catch(s){console.error(s)}o.__webviewId__=r.data.__webviewId__;var i=Object.create(null);Object.keys(o).forEach((function(e){i[e]=r.data[e]}));var a=!1===this.$shouldDiffData?o:kn(o,i);Object.keys(a).length?(Object({VUE_APP_DARK_MODE:"false",VUE_APP_NAME:"familySign",VUE_APP_PLATFORM:"mp-weixin",NODE_ENV:"production",BASE_URL:"/"}).VUE_APP_DEBUG&&console.log("["+ +new Date+"]["+(r.is||r.route)+"]["+this._uid+"]差量更新",JSON.stringify(a)),this.__next_tick_pending=!0,r.setData(a,(function(){n.__next_tick_pending=!1,An(n)}))):An(this)}},gn.prototype.$mount=function(e,t){return function(e,t,n){return e.mpType?("app"===e.mpType&&(e.$options.render=Nn),e.$options.render||(e.$options.render=Nn),!e._$fallback&&Wt(e,"beforeMount"),new rn(e,(function(){e._update(e._render(),n)}),A,{before:function(){e._isMounted&&!e._isDestroyed&&Wt(e,"beforeUpdate")}},!0),n=!1,e):e}(this,0,t)},function(e){var t=e.extend;e.extend=function(e){e=e||{};var n=e.methods;return n&&Object.keys(n).forEach((function(t){-1!==Un.indexOf(t)&&(e[t]=n[t],delete n[t])})),t.call(this,e)};var n=e.config.optionMergeStrategies,r=n.created;Un.forEach((function(e){n[e]=r})),e.prototype.__lifecycle_hooks__=Un}(gn),function(e){e.config.errorHandler=function(t,n,r){e.util.warn("Error in "+r+': "'+t.toString()+'"',n),console.error(t);var o="function"===typeof getApp&&getApp();o&&o.onError&&o.onError(t)};var t=e.prototype.$emit;e.prototype.$emit=function(e){if(this.$scope&&e){var n=this.$scope["_triggerEvent"]||this.$scope["triggerEvent"];if(n)try{n.call(this.$scope,e,{__args__:k(arguments,1)})}catch(r){}}return t.apply(this,arguments)},e.prototype.$nextTick=function(e){return On(this,e)},Pn.forEach((function(t){e.prototype[t]=function(e){return this.$scope&&this.$scope[t]?this.$scope[t](e):"undefined"!==typeof my?"createSelectorQuery"===t?my.createSelectorQuery(e):"createIntersectionObserver"===t?my.createIntersectionObserver(e):void 0:void 0}})),e.prototype.__init_provide=ot,e.prototype.__init_injections=it,e.prototype.__call_hook=function(e,t){var n=this;se();var r,o=n.$options[e],i=e+" hook";if(o)for(var a=0,s=o.length;a<s;a++)r=xe(o[a],n,t?[t]:null,n,i);return n._hasHookEvent&&n.$emit("hook:"+e,t),ue(),r},e.prototype.__set_model=function(t,n,r,o){Array.isArray(o)&&(-1!==o.indexOf("trim")&&(r=r.trim()),-1!==o.indexOf("number")&&(r=this._n(r))),t||(t=this),e.set(t,n,r)},e.prototype.__set_sync=function(t,n,r){t||(t=this),e.set(t,n,r)},e.prototype.__get_orig=function(e){return c(e)&&e["$orig"]||e},e.prototype.__get_value=function(e,t){return function e(t,n){var r=n.split("."),o=r[0];return 0===o.indexOf("__$n")&&(o=parseInt(o.replace("__$n",""))),1===r.length?t[o]:e(t[o],r.slice(1).join("."))}(t||this,e)},e.prototype.__get_class=function(e,t){return function(e,t){return o(e)||o(t)?function(e,t){return e?t?e+" "+t:e:t||""}(e,wn(t)):""}(t,e)},e.prototype.__get_style=function(e,t){if(!e&&!t)return"";var n=function(e){return Array.isArray(e)?D(e):"string"===typeof e?Ln(e):e}(e),r=t?b(t,n):n;return Object.keys(r).map((function(e){return E(e)+":"+r[e]})).join(";")},e.prototype.__map=function(e,t){var n,r,o,i,a;if(Array.isArray(e)){for(n=new Array(e.length),r=0,o=e.length;r<o;r++)n[r]=t(e[r],r);return n}if(s(e)){for(i=Object.keys(e),n=Object.create(null),r=0,o=i.length;r<o;r++)a=i[r],n[a]=t(e[a],a,r);return n}if("number"===typeof e){for(n=new Array(e),r=0,o=e;r<o;r++)n[r]=t(r,r);return n}return[]}}(gn),t["default"]=gn}.call(this,n("c8ba"))},"67ae":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={"周":"week(s) ","天":"day(s)","小时":"hour(s) ","分钟":"minute(s)","刚刚":"Just now","前":" ago","昨天":"Yesterday","星期一":"Monday","星期二":"Tuesday","星期三":"Wednesday","星期四":"Thursday","星期五":"Friday","星期六":"Saturday","星期日":"Sunday","一月":"January","二月":"February","三月":"March","四月":"April","五月":"May","六月":"June","七月":"July","八月":"August","九月":"September","十月":"October","十一月":"November","十二月":"December","一":"Mon","二":"Tues","三":"Wed","四":"Thur","五":"Fri","六":"Sat","日":"Sun"};t.default=r},"6af2":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={pages:[{path:"pages/index/index","app-plus":{titleNView:!1},style:{navigationBarTitleText:"",enablePullDownRefresh:!1,backgroundColor:"#fdfdfd",navigationStyle:"custom"}},{path:"pages/msg/index"},{path:"pages/my/index","app-plus":{titleNView:!1},style:{navigationBarTitleText:"",backgroundColor:"#f8f8f8",navigationStyle:"custom"}},{path:"pages/user/my/index","app-plus":{titleNView:!1,bounce:"none"},style:{navigationBarTitleText:"",navigationStyle:"custom"}},{path:"pages/login/register","app-plus":{titleNView:!1},style:{navigationBarTitleText:"",navigationStyle:"custom"}},{path:"pages/login/register-doctor","app-plus":{titleNView:!1},style:{navigationBarTitleText:"",navigationStyle:"custom"}},{path:"pages/login/index","app-plus":{titleNView:!1},style:{navigationBarTitleText:"",navigationStyle:"custom"}},{path:"pages/login/login-doctor","app-plus":{titleNView:!1},style:{navigationBarTitleText:"",navigationStyle:"custom"}}],subPackages:[{root:"pages/sub-packages-doctor",pages:[{path:"my/statistics-manage/index","app-plus":{titleNView:!1,bounce:"none"},style:{navigationBarTitleText:"",navigationStyle:"custom"}},{path:"my/number-of-services/index","app-plus":{titleNView:!1},style:{navigationBarTitleText:"",navigationStyle:"custom"}},{path:"my/number-of-signatories/index","app-plus":{titleNView:!1},style:{navigationBarTitleText:"",navigationStyle:"custom"}},{path:"my/online-signing-list/index","app-plus":{titleNView:!1},style:{navigationBarTitleText:"",navigationStyle:"custom"}},{path:"my/put-on-record/index","app-plus":{titleNView:!1},style:{navigationBarTitleText:"",navigationStyle:"custom"}},{path:"my/user-detail/index","app-plus":{titleNView:!1},style:{navigationBarTitleText:"",navigationStyle:"custom"}}]},{root:"pages/sub-packages-user",pages:[{path:"my/about/index","app-plus":{titleNView:!1},style:{navigationBarTitleText:"",navigationStyle:"custom"}},{path:"my/add-file/index","app-plus":{titleNView:!1},style:{navigationBarTitleText:"",navigationStyle:"custom"}},{path:"my/change-user/index","app-plus":{titleNView:!1},style:{navigationBarTitleText:"",navigationStyle:"custom"}},{path:"my/contact-us/index","app-plus":{titleNView:!1},style:{navigationBarTitleText:"",navigationStyle:"custom"}},{path:"my/doctor-details/index","app-plus":{titleNView:!1},style:{navigationBarTitleText:"",navigationStyle:"custom"}},{path:"my/doctor-introduction/index","app-plus":{titleNView:!1,bounce:"none"},style:{navigationBarTitleText:"",navigationStyle:"custom"}},{path:"my/review-file/index","app-plus":{titleNView:!1},style:{navigationBarTitleText:"",navigationStyle:"custom"}},{path:"my/sign-tip/index","app-plus":{titleNView:!1},style:{navigationBarTitleText:"",navigationStyle:"custom"}},{path:"my/unbound-user/index","app-plus":{titleNView:!1},style:{navigationBarTitleText:"",navigationStyle:"custom"}},{path:"my/un-sign/index","app-plus":{titleNView:!1},style:{navigationBarTitleText:"",navigationStyle:"custom"}},{path:"my/upload-info/index","app-plus":{titleNView:!1},style:{navigationBarTitleText:"",navigationStyle:"custom"}},{path:"my/online-signing/index","app-plus":{titleNView:!1},style:{navigationBarTitleText:"",navigationStyle:"custom"}},{path:"index/news-info/index","app-plus":{titleNView:!1},style:{navigationBarTitleText:"",navigationStyle:"custom"}},{path:"my/signature/index","app-plus":{titleNView:!1},style:{enablePullDownRefresh:!1,pageOrientation:"landscape",navigationBarTitleText:"",navigationStyle:"custom"}}]},{root:"TUIKit",pages:[{path:"components/TUIConversation/index",style:{navigationBarTitleText:"消息列表"}},{path:"components/TUIChat/index",style:{navigationBarTitleText:"腾讯云 IM"}},{path:"components/TUIChat/video-play",style:{navigationBarTitleText:"腾讯云 IM"}},{path:"components/TUIChat/web-view",style:{navigationBarTitleText:"腾讯云 IM"}},{path:"components/TUIContact/index",style:{navigationBarTitleText:"腾讯云 IM"}},{path:"components/TUIGroup/index",style:{navigationBarTitleText:"腾讯云 IM"}}]}],preloadRule:{"pages/index/index":{network:"all",packages:["pages/sub-packages-doctor"]},"TUIKit/components/TUIConversation/index":{network:"all",packages:["TUIKit"]}},globalStyle:{navigationBarTextStyle:"black",navigationBarTitleText:"家庭签约",navigationBarBackgroundColor:"#FFFFFF",backgroundColor:"#FFFFFF"},tabBar:{color:"#333333",selectedColor:"#4EB4F8",backgroundColor:"#FFFFFF",borderStyle:"black",list:[{pagePath:"pages/index/index",text:"首页",iconPath:"static/tabbar/index.png",selectedIconPath:"static/tabbar/indexed.png"},{pagePath:"pages/msg/index",text:"消息",iconPath:"static/tabbar/news.png",selectedIconPath:"static/tabbar/newsed.png"},{pagePath:"pages/my/index",text:"我的",iconPath:"static/tabbar/home.png",selectedIconPath:"static/tabbar/homeed.png"}]}}},"6b1b":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={userInfo:function(e){return e.user.userInfo},userInfoDoctor:function(e){return e.userDoctor.userInfo},userType:function(e){return e.app.userType},signPath:function(e){return e.sign.signPath},token:function(e){return e.app.token}};t.default=r},"6b58":function(e,t,n){var r=n("7037")["default"],o=n("3c96");e.exports=function(e,t){if(t&&("object"===r(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return o(e)},e.exports.__esModule=!0,e.exports["default"]=e.exports},"6cde":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={"发起会话":"Start chat","发起单聊":"New one-to-one chat","发起群聊":"New group chat","请输入userID":"Enter a user ID","删除会话":"Delete","删除后，将清空该聊天的消息记录":"Once deleted, all chat messages will be cleared.","删除后，将清空该群聊的消息记录":"Once deleted, group chat history will be cleared.","系统通知":"System notification","置顶会话":"Pin","取消置顶":"Unpin","消息免打扰":"Mute Notifications","取消免打扰":"Enable Notifications","有人@我":"Someone @ me","@所有人":"@All","条":"strip","我":"me","网络异常，请您检查网络设置":"Network exception, please check the network settings","您已被群管理员移出群聊":"You have been removed from the group chat by the group administrator","该群聊已被解散":"The group chat has been disband","您已退出该群聊":"You have left the group chat"};t.default=r},"6f8f":function(e,t){e.exports=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}},e.exports.__esModule=!0,e.exports["default"]=e.exports},7037:function(e,t){function n(t){return e.exports=n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports["default"]=e.exports,n(t)}e.exports=n,e.exports.__esModule=!0,e.exports["default"]=e.exports},"707c":function(e,t,n){"use strict";var r=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.isUrl=t.isSymbol=t.isString=t.isSet=t.isPromise=t.isObject=t.isMap=t.isJSON=t.isFunction=t.isDate=t.isArray=t.JSONToObject=void 0;var o=r(n("7037")),i=Object.prototype.toString,a=function(e){return i.call(e)},s=Array.isArray;t.isArray=s;t.isMap=function(e){return"[object Map]"===a(e)};t.isSet=function(e){return"[object Set]"===a(e)};t.isDate=function(e){return e instanceof Date};var u=function(e){return"function"===typeof e};t.isFunction=u;t.isString=function(e){return"string"===typeof e};t.isSymbol=function(e){return"symbol"===(0,o.default)(e)};var c=function(e){return null!==e&&"object"===(0,o.default)(e)};t.isObject=c;t.isPromise=function(e){return c(e)&&u(e.then)&&u(e.catch)};t.isUrl=function(e){return/^(https?:\/\/(([a-zA-Z0-9]+-?)+[a-zA-Z0-9]+\.)+[a-zA-Z]+)(:\d+)?(\/.*)?(\?.*)?(#.*)?$/.test(e)};var l=function(e){if("string"===typeof e)try{var t=JSON.parse(e);return!!t}catch(n){return!1}return!1};t.isJSON=l;t.JSONToObject=function(e){return e&&l(e)?JSON.parse(e):e}},"719f":function(e,t,n){"use strict";var r=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n("0baf")),i=r(n("995e")),a=r(n("b012")),s={en:o.default,"zh-Hans":i.default,"zh-Hant":a.default};t.default=s},"71ba":function(e,t,n){},7210:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={"【安全提示】本 APP 仅用于体验腾讯云即时通信 IM 产品功能，不可用于业务洽谈与拓展。请勿轻信汇款、中奖等涉及钱款的信息，勿轻易拨打陌生电话，谨防上当受骗。":"【Security Tips】This APP is only used to experience the functions of Tencent Cloud Instant Messaging products, and cannot be used for business negotiation and expansion. Don't trust money-related information such as remittances and lottery wins, don't make unfamiliar phone calls easily, and beware of being deceived.","按Enter发送，Ctrl+Enter换行":"Press Enter to send a message and Ctrl+Enter to start a new line","表情":"[face]","查看更多":"View more","撤回":"Recall","撤回了一条消息":"recalled a message","打开":"Open","单击下载":"Click download","点此投诉":"Complain","点击处理":"Click action","对方正在输入":"Typing...","发起群视频":"Make group video call","发起群语音":"Make group voice call","发起通话":"Start Call","发送失败":"send failed","复制":"Copy","该消息不存在":"The message does not exist","关闭阅读状态":"Read status closed","管理员开启全员禁言":"The admin enables Mute All","欢迎使用TUICallKit":"Welcome to TUICallKit","回到最新位置":"Back to the latest location","回复":"Reply","回复详情":"Replies","集成TUICallKit":" Integrate TUICallKit ","检测到您暂未集成TUICallKit，无法体验音视频通话功能":"It is detected that you have not integrated TUI CallKit yet, so you cannot experience the audio and video call. ","结束群聊":"Edit Group Call","进行体验":"to experience.","经度":"Longitude","拒绝":"Reject","拒绝通话":"Decline Call","开通腾讯实时音视频服务":"Integration Tencent Real-Time Communication","聊天记录":"[chat record]","描述":"Description","内容包含敏感词汇":"Content contains sensitive words","您":"You","您当前购买使用的套餐包暂未开通此功能":"The package you purchased does not support this ability.","您当前购买使用的套餐包暂未开通群消息已读回执功能":"The package you purchased does not support the read receipt of group messages.","您当前购买使用的套餐包暂未开通在线用户列表功能":"The package you purchased does not support the online user list.","您已被管理员禁言":"You have been muted by the admin","您有":"You have","请点击":"Please click","请输入消息":"Enter a message","取消":"Cancel","取消通话":"Cancel Call","全部已读":"All read","确定":"Submit","确认重发该消息？":"Confirm to resend the message?","人关闭阅读状态":" read status closed","人未读":" unread","人已读":" read","删除":"Delete","涉及敏感内容":"Sensitive content","申请加入":"Application for join in","视频":"[video]","视频通话":"Video Call","条回复":"replies","条入群申请":"Item group application","条新消息":" new messages","通话时长":"Duration","同意":"Agree","图片":"[photo]","图片消息失败,无效的图片格式":"Image message failed, invalid image format.","纬度":"Latitude","未读":"Unread","位置":"[location]","文件":"[file]","文件不存在,请检查文件路径是否正确":"The file does not exist, please check if the file path is correct.","文件大小超出了限制,如果上传文件,最大限制是100MB":"The file size exceeds the limit; if uploading a file, the maximum limit is 100MB.","文件消息失败,禁止发送违规封禁的文件":"File message failed, sending prohibited and banned files is not allowed.","我":"I","无法查看":"unable to view","无法定位到原消息":"Unable to navigate to the original message","无法收听":"unable to listen","正在加载":"Loading...","加载结束":"Load end","无应答":"No Answer","系统消息":"System message","消息":"[message]","消息或者资料中文本存在敏感内容,发送失败":"Sensitive content found in the message or information text, sending failed.","消息详情":"Message Detail","消息长度超出限制,消息长度不要超过12K":"Message length exceeds the limit; please keep the message length under 12K.","消息中图片存在敏感内容,发送失败":" Sensitive content is found in the picture in the message, sending failed.","选择提醒的人":"Select Contact","已读":"Read","已过撤回时限":"Withdrawal deadline has passed","已接听":"Answered","已拒绝":"Rejected","已同意":"Approved","引用":"Reference","引用失败":"quote failed","语音":"[audio]","语音通话":"Voice Call","重新编辑":"Re-edit","重新发送":"Resend","转发":"Forward","转发给":"Forward to","自定义":"[custom message]","自定义消息":"Custom message","腾讯云 IM":"Tencent Cloud Chat","空":"Empty","文本包含本地审核拦截词":"Text contains local moderation blocking words"};t.default=r},"74ca":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACBCAYAAAAi0kPBAAAAAXNSR0IArs4c6QAAEs1JREFUeF7tnQl4VdW1gP9zM5IQJoHKJOoDAbEIjYwqkwyRQRClClhRnwhSeUpVBiVSMSJKECg++qxSptqiFRBQWxkES6UokxXwU7AtCDLJJBCSkOG8b92dQ26Se3PPvTnJvbnZ+9MPuOecPaz1n7XXXvucdQw8SkaW2R/oa5r5tXBheh7Tf9cS8CqBfAzDcJ3DYH1inPGedY4hfzFNM+liNjtjYml26ZLmSSMUuARiYw2ys83DZrzRtoZhnHKDdSEz/3sMGgZenb5CS6CoBEw4kxTvqmNkZJmPuKJ4PS9PWyoNSdkl4HIZ5OfzlHEhK38NMKDsVeoatASUBEyTTUZGtrnFNM3OWihaAo5JwDD2arAck6au6LIEDOMrDZbmwXkJaLCcl6muEdBgaQzKRQIarHIRq65Ug6UZKBcJaLDKRay6UifBinLBu58YREf7juCbpkGn603q19Kyr0gJiG7W7YCMrNJbTW4ODes60DMnwYqLgTtTDWpWh/gY753Ly4dHB5m0vtqBzusqbEsgJhpSf29w6kffl5y7qHTToaXtan2f6DRYg1MNHuhrcsfNvtvMzXOH/HWpYAlER0kUwHujsVEw8mWDB1NM2ocrWPf1goFdNDkVzE2ZmouNhofTNVhlEqK+uKQEIg4ssWs+rLPWvwMSsCvfiADLPUma7v/Un3ZH74Cgq1oV7pvWUL5VaTdwpQfLginfRB4G8+lMVjUAymO8ApLIW/53Gep/N2ReGqscYPWGgZ29O+9inQSqvDzIzDGJiQL3KrE8JFvF6xQrFe1SshU5R7sMDFclBEtiJVMXGvRsZ9LlBu9ataC6lGtSv6ariqu+Yoafm2dyNsMkJtpAAqXeQg4Sinj1HYO+7U1aXOVAv5yMY0l3pIMyxQlA3oocy8kz3VZKg+WAAm1WceJcPjEu2RUpmBK9XCe6kwC2IzFGp8HyN04BSu6grBxoVEdbLH/ycur40TP5yM5IdJSyWuVeQgGWWKxsDVa569azgSMCVjSXp8NybzwkYOWaZOdqi1XuyvVoQCyWrPwsP6vc29ZglbuIw6IBDVZYqCHyOqHBijydhsWINFhBqEH8tf0n4eg5OJ8NhgmJ8XBldWhWDxJ8PBsWRFOV9hINVgCqO5UBH30De46q6LJ7x8LaryiI8Ltc0KI+9GkBVyYFUHmEnarBsqnQDfth/T6IKthgLe0yCfhJ4O+Wa6H/9TYbiLDTNFh+FCoR/WW74Msjav8rkCJR/6ZXwCOdArkqMs7VYPnR48rd8Pl3anM1mCJwydR4f/tgrq6812iwStHdvh9gwWcgz2eXpci0OKQN3NTEdy3nsuDIufB+CDE+GprWsScJDZYPOeXmw8sbICvXniD9nSXTaGof3+AcOAWbD0KQhtFf82U+LouU2tUgpaU9+DVYPkT+r5PwxtbA/SpfGpQpcdBPoYOPR0QOnoZPBawwfm66TgL0vk6D5daxPN2QE8Re4eJtsP8HZ584bVwTRnfxjt53Z2DrofC1WNLr2gnQs5kGK2iwxCeauREyLpV5BilSgRijabd7r1NWnzL9hnORaVqeobJT9FToRUriV83YoGJRThYB54UU+8pxsu2KrkuD5UXimTkwfb3zqhCwnusN1WKdrzvcatRgedGI7AWKxXJ6ahJ/L62/it5HetFgedGw+DuzNsK5bGfVLyGH5/p4r/P4BfjmhD3H2Nle2azNgOqx0K6RvfM1WD7k9O4/YddhkE1lJ4psWjevCyN9ROAPnIYtB8MXLCuOJZvrdgyuBssHNfJIzNy/ORfHkoXAyA7Qop73Bq04lq/sLE7AXZY6BCYdx/KQYLBxLHlCYe5mOJlh7w4tTWlirZJiYeJtvs8SkHcfD+84VlKcCvBqi1WGAKkgcOICzNrkzF6hBEab1i6Lzahc1+qp0I++th6E93YHPyXKyrJnc7UVUpWKBsuGtjd9C3/9OnC4cvKgWzO43YmMdTb6GU6naLBsakNCAcu/BHm8xd8Df+KoV4tRm85tGthsIMJO02AFoFCxQJ8dhG2H4Ng59dC7Fex0p0ky1XPu7RpD56a+E+4G0GSlPVWDFYTqZJV3PguOnYcfs1RSixpx0KAGJMWH96MvQQw3qEs0WEGJTV/kTwIaLH8S0seDkoAGKyix6Yv8SUCD5U9C+nhQEtBgBSU2fZE/CWiw/ElIHw9KAhqsoMSmL/InAQ2WPwnp40FJQIPlRWySCPeLIwSVlDUuCto0LKz0wBnnX8oIStNlvEh2FeT1NdmqslM0WF6kJM9gpa0DeaU80CIPw03oqa6SCP2qPc6/RhZon5w4Pycfbm8BP7GZmkmD5UXqkgdrxsfBgSUvdf6qWyFY7++FjBwnVBvaOmSftO91UF+DpRQRzBOkYrFeXA/VArRYYqHEYj3doxCs1WKxIgSsFG2xCu/uYMCSTeVgv7VTJMtfwXQYdGWhNVIlW/fzRS/PC/RUGG7Ki5D+aLAiRJHhNgwNlheNnM1UKYzkkx2Blprxhe8OynQqjzXLK/uVveSacHNTuCLR3kg0WHpVaIsUCTf0ba5XhZeFFYzzLuEGSQoSbzMYaDUmTr+sCp8qtiq8mBP8YsCW1ivgJHnbSMINOo5VIOxgwJKPAqwK8pWvxDgYUJCCW6bCnYdxfyCqsheZCm9sADLV2yl6KrQjJX1OwBLQYAUsMn2BHQlosOxISZ8TsAQ0WAGLTF9gRwJVAyz96V47LDh6jny6V1bVEftN6DxJx51f8LHx2g5lUXNUBZFZ2bGz6tO9lRIsSVJ26ATUTISkBO8KypMvcRXkeq9fU4NVURifOp+Py2W403d7+yiCbNYfOQ21EqFanAO9cvKb0HExcPtEg/v7wJCu3p9HkKClxLJy802qxxvEx9hJG+bAQKtwFQKVaCMmynA/hestS6FYs1+8ZDCqv0knJz695zRYg1MN7usFA7v4BsudsCMfcsR86VJuEhCAcnJBbniXYRAVpaDydisLWA+nGzyYYtLeiTRPFQ2WSFFwMvNVNhixYNZv5SbhKlqxACTitT4Waoi18iGLiADLGpubKc+H+LQBc+4WKCDI/Yfn36sCWMXHqLlyhqtgvNaIsljOiFHX4oQEKg1Yd3QxI+bRcicUF+51hD1Yd6YadG1j0raZd1GapkHrq01q2XxtKdwVUln6J7Gr7d9Alo9P80ngdMGH8HD/MF0VShxLAmyy4vNWJNHs5OEmyVUsHXaoARSLNGa2wfEzvnsiMa5xQ0w6h1scS7qcYCNqm50TGa+5hxqWQNuPj/Wfj9Ux3TgZxwp0oPr8CJaABiuClRvKoWmwQin9CG5bgxXByg3l0DRYoZR+BLetwYpg5YZyaBqsUEo/gtvWYEWwckM5NA1WKKUfwW1rsCJYuaEcmgYrlNKP4LYFrJzc/C0YdI7gYeqhVbAETPjKGDvH3J6TZyZXcNu6uQiWQHycccgYnmbuyMnjZxE8Tj20CpZAQhzfa7AqWOhVoTkNVlXQcgjGqMEKgdCrQpMarKqg5RCMUYMVAqFXhSbDDiz5+FBMlD3RS16CGI/c75dycafqsVPk2W7JvCIvEPgr8gKInfP81RPMcSuJiuc4g6mnoq8JK7BEga+Mgid+C9ViSxdF9Xh4cihMXQwuFyTGw5QRMOEN3xBI/VaZPw5mLIPvflC/yOtR3rKwNK4L3W+EP2xQeSYGdIIPPoP+HeEvnxd9G0mOd20Dn3yp6hN4rdwUxUcjoFiwurPv5Klz5bd6NaFODWhcD/6rIbS6Cp5fAhezVS3RpeRgKN6OZFf21YfyhC2swBJrtfJ56DcZqlfzPWx5tezRAXD6fMHXxPKgRgL0aAerP1WJMOQ183U7QD6iKUV+++VASEpUSm/XHLZ9raAU4DZ9Adv3lWzz9fHw68Vw9DTceC3c3RVSF0HKTRAfB+99WniNJN94ZTTs/jcsWgu/GQtX1lXHVXYdlflFyrwVsHmP+vvdt8JdXXFng5Fy4gycOAuHf4D/HIN9h+H7k+qYwLpsCsgbN5eLCZLwwz3OYq/dTVsKew+UJ0Le666UYMkrZosmwh1T4N4eKlXP4Ftg4y44d1ENtARYJiydCI/Ph9hiHyLo3gaycmGVByRSh7Tz5pMwbLqq763JMHo2XMhSoLz7a/j5tKKCFcXPewxSFyrwrfcrb2gKQ7vC1KXqfAFMpmIpD/WFrw/B+l0KeoFd/vSVy8rbS6er02BQakmwxDWQ+iq6hCVYvZ6GpGIWy/Ix5I6cNQYuZqlpz/J/RLA9nyyajU6mNus9R7luyUT47kTJKa92EqzdURQsOX/BU/Dh57BiM3RoAQ+kwNi5hSp6eRSs3Q4bdqnfLIULXJLVUIpMcQJQqyYw+GaYvqxkKiELrHU7vatfIBMLZU3VV18JHVupcwXwJvWgWSPY9E8FlgVSRias3qLBck8VMhWK+fdMZyiKmvA7pSC564fcCvsOqfmt9bVKmN78I4Hv/hlKsHLO0knKwljTkaXGfh0hNhY27FBfrRALOKAj3N8X3t4IW/bA3HEwZKoCxSpS55oX1VS55wC8PUVZGbl+xEvKWqWOgJeWQYtGMKgLpP1R9dVzMSBgpXQs3aY8NBMuZKpzureFLtfDlr1wTw9Yuw3OXgBZvDx+F7y2Un0eZmh3eHBmoWWsSKsVlhZrzKuQ4PEpD1GQ+Bhy1y6dDI+/BmMGwuQFKp/pz7sp5/33HxUVnXWny6+WxTp1viSE4s+9/w8Y3gsm/Q4OHIe3U2HBB1A9Edo1g6MnoVtbZSmtvl3KgcV/heaNYf4a5VRLf96eqgAWayrT5fA0uK4RjB8K3x5W/tCc5cpfkvJAH9h/GK5pAEdOwftbC3NaNagN/zce7k0r7LeA1aQuLFkH6WPgTxuUTyYWc/4TcOdUqFkN5o2Dka9osC5brNKcd/F1GtaFR/rB1CVKMe88B5u/VJZCiihUQHr9A2UZBMzcXFj2LPSZVMzxBQZ3gbGDYf4qNZ1IEUhua6fAWvaxUqqA8MF0GPCsql+s0bufwIEThdONWLQVz3sHa8RtsHidquvbI2oakzL5XrUI2PUvkCl9WJoag1jwN38Fc1coH8wqnmDNHK2c/cxsZU1vS9ZglbDMdleFjTzAkunxZ80KnWRR+LghsG47vLVBNZHcHEb0Ust38bGsaVYWUFnZ6vdP9ygQPZOW9U1WYC3/W2FXBWLLYZ85CqYsKrQ8clZpYPnysV4bB1MWqunsnu5wbQNI+wPceQv0SYbHXisqquIW68W31AoyIws+ma3BcgQsq5IWjWHvQXhsMCTFK7/GWnUJLGKBrCJAifUZ0RP6dYaNO+F0RslVYXGwpI1f9FIwSVk0Af47vWiCEwusB1+B85nw56mFU6E3sMQyvfUMPDpHgSF+kixOjp2CDq1g5MtF/Tpp1xMsCW/IF87kppSbSm6SKj8VWlOWpXARzpo06D2h5KrQPT0VLM89LZb8Liu/9NHKD5NQwqQ3Szrocp4IXoCS4OYjA2DNP+CND+HuWyA6pnSwBBjxu8bMVsBIkX/LtOWZsknqX/WCOv4/85TTb/lY3sDKvgSr0uDeFwqn8NEDoEdbNf2lv6Pa83T2BaxGdWDhWpjzS5jxRzh8UgVQP06Hgc9CzQT47RNV0McSqCTIKZBYRVyO1lerAKOnhZHjZzNg1p+VL1McLGsKGt0fOt+gFGpFqeWYOLUtm0DvZOh9E6zfAUvWFi7hU9qrQOrKvxc1opbFWrYRpgxXdc57T1kIAW3pM3DPC0VjR2MHQsumMH6+Wr0O7abqvSIJWl5VGBQ9n6FCGWIBJbi7fDP0bQ/9O8FH22D+ahhyM4xMUYFc+U0ssshNwBrWA46dhhZN4OBxEEDlWOtr4KsD6iasXwseSq9izrtYj6b1Ic5GPi03OLnw72PKB/pJbRjWHeasLAqCCFYcbvGhPv5CHZNpb9I9uDMIinIkGi8RbrEAC59WDr9E1V99B84WBFetWnu2heoJ8J8jcFNLePNDdZ04zPLn33fDimIwtrkGduxXbcj1vhLNyrS39Wt4ZhjMXg7jBiuLK/VlXir0A2XccjP0bKe2dQToW38KMi3LlpK3MIv0XwKj4++CR39TxcAqikRg/yptY9bazvGs0dqHK76Ray33xQp62/i2pmq5+2W6s5x+a/Upv/tSrN0RWQFU+dNXpN2yyJYrIP2S/vjbrBdLXWTrx26nHDgvrOJYDoxHVxEmEnCDNeJFc8elXP0yRZjoJCK6kRDPYeO+6eam7By6RcSI9CDCQgIx0ewwHp5lTvvxAqlh0SPdiYiQQI1E5hqmacaMmE52Tq7PRUxEDFYPomIkEBMDKclUd6+IJ/yv2erQWfbmargqRvoR2oqsvBvVJXnmaGPn5VCLaZpRo9JJzcyha14e8o1U/d2kCAXA4WEZUVFkJsayZfAgpvVrbrgfov5/DaU4X497kU0AAAAASUVORK5CYII="},"755b":function(e,t,n){var r={"./app.js":"5fe2","./sign.js":"9725","./user.js":"589f","./userDoctor.js":"2bd8"};function o(e){var t=i(e);return n(t)}function i(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}o.keys=function(){return Object.keys(r)},o.resolve=i,e.exports=o,o.id="755b"},7679:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},o(e,t)},i=function(){return i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},i.apply(this,arguments)};function a(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function s(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}function u(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}var c=[],l=function(){function e(e){this.active=!0,this.effects=[],this.cleanups=[],this.vm=e}return e.prototype.run=function(e){if(this.active)try{return this.on(),e()}finally{this.off()}},e.prototype.on=function(){this.active&&(c.push(this),r=this)},e.prototype.off=function(){this.active&&(c.pop(),r=c[c.length-1])},e.prototype.stop=function(){this.active&&(this.vm.$destroy(),this.effects.forEach((function(e){return e.stop()})),this.cleanups.forEach((function(e){return e()})),this.active=!1)},e}(),d=function(e){function t(t){void 0===t&&(t=!1);var n,o=void 0;return function(e){var t=m;m=!1;try{(function(){o=V(I())})()}finally{m=t}}(),n=e.call(this,o)||this,t||function(e,t){var n;if((t=t||r)&&t.active)t.effects.push(e);else{var o=null===(n=S())||void 0===n?void 0:n.proxy;o&&o.$on("hook:destroyed",(function(){return e.stop()}))}}(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,e),t}(l);function f(){return r}function p(){var e,t;return(null===(e=f())||void 0===e?void 0:e.vm)||(null===(t=S())||void 0===t?void 0:t.proxy)}var h=void 0;try{var g=n("66fd");g&&y(g)?h=g:g&&"default"in g&&y(g.default)&&(h=g.default)}catch(o){}var v=null,_=null,m=!0;function y(e){return e&&F(e)&&"Vue"===e.name}function I(){return v}function M(){return v||h}function T(e){if(m){var t=_;null==t||t.scope.off(),null==(_=e)||_.scope.on()}}function S(){return _}var E=new WeakMap;function C(e){if(E.has(e))return E.get(e);var t={proxy:e,update:e.$forceUpdate,type:e.$options,uid:e._uid,emit:e.$emit.bind(e),parent:null,root:null};return function(e){if(!e.scope){var t=new l(e.proxy);e.scope=t,e.proxy.$on("hook:destroyed",(function(){return t.stop()}))}e.scope}(t),["data","props","attrs","refs","vnode","slots"].forEach((function(n){A(t,n,{get:function(){return e["$".concat(n)]}})})),A(t,"isMounted",{get:function(){return e._isMounted}}),A(t,"isUnmounted",{get:function(){return e._isDestroyed}}),A(t,"isDeactivated",{get:function(){return e._inactive}}),A(t,"emitted",{get:function(){return e._events}}),E.set(e,t),e.$parent&&(t.parent=C(e.$parent)),e.$root&&(t.root=C(e.$root)),t}function k(e){return"function"==typeof e&&/native code/.test(e.toString())}var b="undefined"!=typeof Symbol&&k(Symbol)&&"undefined"!=typeof Reflect&&k(Reflect.ownKeys),D=function(e){return e};function A(e,t,n){var r=n.get,o=n.set;Object.defineProperty(e,t,{enumerable:!0,configurable:!0,get:r||D,set:o||D})}function O(e,t,n,r){Object.defineProperty(e,t,{value:n,enumerable:!!r,writable:!0,configurable:!0})}function R(e,t){return Object.hasOwnProperty.call(e,t)}function N(e){return Array.isArray(e)}var w,L=Object.prototype.toString,P=function(e){return L.call(e)};function U(e){var t=parseFloat(String(e));return t>=0&&Math.floor(t)===t&&isFinite(e)&&t<=4294967295}function G(e){return null!==e&&"object"==typeof e}function x(e){return"[object Object]"===function(e){return Object.prototype.toString.call(e)}(e)}function F(e){return"function"==typeof e}function q(e,t){return t||S()}function V(e,t){void 0===t&&(t={});var n=e.config.silent;e.config.silent=!0;var r=new e(t);return e.config.silent=n,r}function B(e,t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];if(e.$scopedSlots[t])return e.$scopedSlots[t].apply(e,n)}}function j(e){return b?Symbol.for(e):e}var H=j("composition-api.preFlushQueue"),K=j("composition-api.postFlushQueue"),W="composition-api.refKey",Y=new WeakMap,z=new WeakMap,J=new WeakMap;function X(e,t,n){var r=I().util;r.warn;var o=r.defineReactive,i=e.__ob__;function a(){i&&G(n)&&!R(n,"__ob__")&&de(n)}if(N(e)){if(U(t))return e.length=Math.max(e.length,t),e.splice(t,1,n),a(),n;if("length"===t&&n!==e.length)return e.length=n,null==i||i.dep.notify(),n}return t in e&&!(t in Object.prototype)?(e[t]=n,a(),n):e._isVue||i&&i.vmCount?n:i?(o(i.value,t,n),ce(e,t,n),a(),i.dep.notify(),n):(e[t]=n,n)}var $=!1;function Z(e){$=e}var Q=function(e){A(this,"value",{get:e.get,set:e.set})};function ee(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!1);var r=new Q(e);n&&(r.effect=!0);var o=Object.seal(r);return t&&J.set(o,!0),o}function te(e){var t;if(ne(e))return e;var n=he(((t={})[W]=e,t));return ee({get:function(){return n[W]},set:function(e){return n[W]=e}})}function ne(e){return e instanceof Q}function re(e){return ne(e)?e.value:e}function oe(e){if(!x(e))return e;var t={};for(var n in e)t[n]=ie(e,n);return t}function ie(e,t){t in e||X(e,t,void 0);var n=e[t];return ne(n)?n:ee({get:function(){return e[t]},set:function(n){return e[t]=n}})}function ae(e){var t;return Boolean(e&&R(e,"__ob__")&&"object"==typeof e.__ob__&&(null===(t=e.__ob__)||void 0===t?void 0:t.__v_skip))}function se(e){var t;return Boolean(e&&R(e,"__ob__")&&"object"==typeof e.__ob__&&!(null===(t=e.__ob__)||void 0===t?void 0:t.__v_skip))}function ue(e){if(!(!x(e)||ae(e)||N(e)||ne(e)||(t=e,n=I(),n&&t instanceof n)||Y.has(e))){var t,n;Y.set(e,!0);for(var r=Object.keys(e),o=0;o<r.length;o++)ce(e,r[o])}}function ce(e,t,n){if("__ob__"!==t&&!ae(e[t])){var r,o,i=Object.getOwnPropertyDescriptor(e,t);if(i){if(!1===i.configurable)return;r=i.get,o=i.set,r&&!o||2!==arguments.length||(n=e[t])}ue(n),A(e,t,{get:function(){var o=r?r.call(e):n;return t!==W&&ne(o)?o.value:o},set:function(i){r&&!o||(t!==W&&ne(n)&&!ne(i)?n.value=i:o?(o.call(e,i),n=i):n=i,ue(i))}})}}function le(e){var t,n=M();return t=n.observable?n.observable(e):V(n,{data:{$$state:e}})._data.$$state,R(t,"__ob__")||de(t),t}function de(e,t){var n,r;if(void 0===t&&(t=new Set),!t.has(e)&&!R(e,"__ob__")&&Object.isExtensible(e)){O(e,"__ob__",function(e){return void 0===e&&(e={}),{value:e,dep:{notify:D,depend:D,addSub:D,removeSub:D}}}(e)),t.add(e);try{for(var o=a(Object.keys(e)),i=o.next();!i.done;i=o.next()){var s=e[i.value];(x(s)||N(s))&&!ae(s)&&Object.isExtensible(s)&&de(s,t)}}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}}}function fe(){return le({}).__ob__}function pe(e){var t,n;if(!G(e))return e;if(!x(e)&&!N(e)||ae(e)||!Object.isExtensible(e))return e;var r=le(N(e)?[]:{}),o=r.__ob__,i=function(t){var n,i,a=e[t],s=Object.getOwnPropertyDescriptor(e,t);if(s){if(!1===s.configurable)return"continue";n=s.get,i=s.set}A(r,t,{get:function(){var e;return null===(e=o.dep)||void 0===e||e.depend(),a},set:function(t){var r;n&&!i||($||a!==t)&&(i?i.call(e,t):a=t,null===(r=o.dep)||void 0===r||r.notify())}})};try{for(var s=a(Object.keys(e)),u=s.next();!u.done;u=s.next())i(u.value)}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}return r}function he(e){if(!G(e))return e;if(!x(e)&&!N(e)||ae(e)||!Object.isExtensible(e))return e;var t=le(e);return ue(t),t}function ge(e){return function(t,n){var r,o=q("on".concat((r=e)[0].toUpperCase()+r.slice(1)),n);return o&&function(e,t,n,r){var o=t.proxy.$options,i=e.config.optionMergeStrategies[n],a=function(e,t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=S();T(e);try{return t.apply(void 0,u([],s(n),!1))}finally{T(o)}}}(t,r);return o[n]=i(o[n],a),a}(I(),o,e,t)}}var ve,_e=ge("beforeMount"),me=ge("mounted"),ye=ge("beforeUpdate"),Ie=ge("updated"),Me=ge("beforeDestroy"),Te=ge("destroyed"),Se=ge("errorCaptured"),Ee=ge("activated"),Ce=ge("deactivated"),ke=ge("serverPrefetch");function be(){Oe(this,H)}function De(){Oe(this,K)}function Ae(){var e=p();return e?function(e){return void 0!==e[H]}(e)||function(e){e[H]=[],e[K]=[],e.$on("hook:beforeUpdate",be),e.$on("hook:updated",De)}(e):(ve||(ve=V(I())),e=ve),e}function Oe(e,t){for(var n=e[t],r=0;r<n.length;r++)n[r]();n.length=0}function Re(e,t,n){var r=function(){e.$nextTick((function(){e[H].length&&Oe(e,H),e[K].length&&Oe(e,K)}))};switch(n){case"pre":r(),e[H].push(t);break;case"post":r(),e[K].push(t);break;default:!function(e,t){throw new Error("[vue-composition-api] ".concat(t))}(0,'flush must be one of ["post", "pre", "sync"], but got '.concat(n))}}function Ne(e,t){var n=e.teardown;e.teardown=function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];n.apply(e,r),t()}}function we(e,t,n,r){var o,i,a=r.flush,c="sync"===a,l=function(e){i=function(){try{e()}catch(e){!function(e,t,n){if("undefined"==typeof window||"undefined"==typeof console)throw e;console.error(e)}(e)}}},d=function(){i&&(i(),i=null)},f=function(t){return c||e===ve?t:function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return Re(e,(function(){t.apply(void 0,u([],s(n),!1))}),a)}};if(null===n){var p=!1,h=function(e,t,n,r){var o=e._watchers.length;return e.$watch(t,n,{immediate:r.immediateInvokeCallback,deep:r.deep,lazy:r.noRun,sync:r.sync,before:r.before}),e._watchers[o]}(e,(function(){if(!p)try{p=!0,t(l)}finally{p=!1}}),D,{deep:r.deep||!1,sync:c,before:d});Ne(h,d),h.lazy=!1;var g=h.get.bind(h);return h.get=f(g),function(){h.teardown()}}var v,_=r.deep,m=!1;if(ne(t)?v=function(){return t.value}:se(t)?(v=function(){return t},_=!0):N(t)?(m=!0,v=function(){return t.map((function(e){return ne(e)?e.value:se(e)?Pe(e):F(e)?e():D}))}):v=F(t)?t:D,_){var y=v;v=function(){return Pe(y())}}var I=function(e,t){if(_||!m||!e.every((function(e,n){return r=e,o=t[n],r===o?0!==r||1/r==1/o:r!=r&&o!=o;var r,o})))return d(),n(e,t,l)},M=f(I);if(r.immediate){var T=M,S=function(e,t){return S=T,I(e,N(e)?[]:t)};M=function(e,t){return S(e,t)}}var E=e.$watch(v,M,{immediate:r.immediate,deep:_,sync:c}),C=e._watchers[e._watchers.length-1];return se(C.value)&&(null===(o=C.value.__ob__)||void 0===o?void 0:o.dep)&&_&&C.value.__ob__.dep.addSub({update:function(){C.run()}}),Ne(C,d),function(){E()}}function Le(e,t){var n=function(e){return i({flush:"pre"},e)}(t);return we(Ae(),e,null,n)}function Pe(e,t){if(void 0===t&&(t=new Set),!G(e)||t.has(e)||z.has(e))return e;if(t.add(e),ne(e))Pe(e.value,t);else if(N(e))for(var n=0;n<e.length;n++)Pe(e[n],t);else if("[object Set]"===P(e)||function(e){return"[object Map]"===P(e)}(e))e.forEach((function(e){Pe(e,t)}));else if(x(e))for(var r in e)Pe(e[r],t);return e}var Ue={};function Ge(e,t){for(var n=t;n;){if(n._provided&&R(n._provided,e))return n._provided[e];n=n.$parent}return Ue}var xe,Fe={},qe=function(e){var t;void 0===e&&(e="$style");var n=S();if(!n)return Fe;var r=null===(t=n.proxy)||void 0===t?void 0:t[e];return r||Fe},Ve=qe;function Be(){return S().setupContext}var je={set:function(e,t,n){(e.__composition_api_state__=e.__composition_api_state__||{})[t]=n},get:function(e,t){return(e.__composition_api_state__||{})[t]}};function He(e){var t=je.get(e,"rawBindings")||{};if(t&&Object.keys(t).length){for(var n=e.$refs,r=je.get(e,"refs")||[],o=0;o<r.length;o++){var i=t[u=r[o]];!n[u]&&i&&ne(i)&&(i.value=null)}var a=Object.keys(n),s=[];for(o=0;o<a.length;o++){var u;i=t[u=a[o]],n[u]&&i&&ne(i)&&(i.value=n[u],s.push(u))}je.set(e,"refs",s)}}function Ke(e){for(var t,n=[e._vnode];n.length;){var r=n.pop();if(r&&(r.context&&(He(r.context),t=!0),r.children))for(var o=0;o<r.children.length;++o)n.push(r.children[o])}t||He(e)}function We(e,t){var n,r;if(e){var o=je.get(e,"attrBindings");if(o||t){if(!o){var i=he({});o={ctx:t,data:i},je.set(e,"attrBindings",o),A(t,"attrs",{get:function(){return null==o?void 0:o.data},set:function(){}})}var s=e.$attrs,u=function(t){R(o.data,t)||A(o.data,t,{get:function(){return e.$attrs[t]}})};try{for(var c=a(Object.keys(s)),l=c.next();!l.done;l=c.next())u(l.value)}catch(e){n={error:e}}finally{try{l&&!l.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}}}}function Ye(e,t){var n=e.$options._parentVnode;if(n){for(var r=je.get(e,"slots")||[],o=function(e,t){var n;if(e){if(e._normalized)return e._normalized;for(var r in n={},e)e[r]&&"$"!==r[0]&&(n[r]=!0)}else n={};for(var r in t)r in n||(n[r]=!0);return n}(n.data.scopedSlots,e.$slots),i=0;i<r.length;i++)o[s=r[i]]||delete t[s];var a=Object.keys(o);for(i=0;i<a.length;i++){var s;t[s=a[i]]||(t[s]=B(e,s))}je.set(e,"slots",a)}}function ze(e,t,n){var r=S();T(e);try{return t(e)}catch(e){if(!n)throw e;n(e)}finally{T(r)}}function Je(e){e.mixin({beforeCreate:function(){var e=this,t=e.$options,n=t.setup,r=t.render;if(r&&(t.render=function(){for(var t=this,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];return ze(C(e),(function(){return r.apply(t,n)}))}),n&&F(n)){var o=t.data;t.data=function(){return function(e,t){void 0===t&&(t={});var n,r=e.$options.setup,o=function(e){var t={slots:{}};return["root","parent","refs","listeners","isServer","ssrContext"].forEach((function(n){var r="$".concat(n);A(t,n,{get:function(){return e[r]},set:function(){}})})),We(e,t),["emit"].forEach((function(n){var r="$".concat(n);A(t,n,{get:function(){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e[r].apply(e,t)}}})})),t}(e),i=C(e);if(i.setupContext=o,O(t,"__ob__",fe()),Ye(e,o.slots),ze(i,(function(){n=r(t,o)})),n)if(F(n)){var a=n;e.$options.render=function(){return Ye(e,o.slots),ze(i,(function(){return a()}))}}else if(G(n)){se(n)&&(n=oe(n)),je.set(e,"rawBindings",n);var s=n;Object.keys(s).forEach((function(t){var n=s[t];if(!ne(n))if(se(n))N(n)&&(n=te(n));else if(F(n)){var r=n;n=n.bind(e),Object.keys(r).forEach((function(e){n[e]=r[e]}))}else G(n)?function e(t,n){return void 0===n&&(n=new Map),n.has(t)?n.get(t):(n.set(t,!1),N(t)&&se(t)?(n.set(t,!0),!0):!(!x(t)||ae(t)||ne(t))&&Object.keys(t).some((function(r){return e(t[r],n)})))}(n)&&function e(t,n){if(void 0===n&&(n=new Set),!n.has(t)&&x(t)&&!ne(t)&&!se(t)&&!ae(t)){var r=I().util.defineReactive;Object.keys(t).forEach((function(o){var i=t[o];r(t,o,i),i&&(n.add(i),e(i,n))}))}}(n):n=te(n);!function(e,t,n){var r=e.$options.props;t in e||r&&R(r,t)||(ne(n)?A(e,t,{get:function(){return n.value},set:function(e){n.value=e}}):A(e,t,{get:function(){return se(n)&&n.__ob__.dep.depend(),n},set:function(e){n=e}}))}(e,t,n)}))}}(e,e.$props),F(o)?o.call(e,e):o||{}}}},mounted:function(){Ke(this)},beforeUpdate:function(){We(this)},updated:function(){Ke(this)}})}function Xe(e){(function(e){return v&&R(e,"__composition_api_installed__")})(e)||(e.config.optionMergeStrategies.setup=function(e,t){return function(n,r){return function e(t,n){if(!t)return n;if(!n)return t;for(var r,o,i,a=b?Reflect.ownKeys(t):Object.keys(t),s=0;s<a.length;s++)"__ob__"!==(r=a[s])&&(o=n[r],i=t[r],R(n,r)?o!==i&&x(o)&&!ne(o)&&x(i)&&!ne(i)&&e(i,o):n[r]=i);return n}(F(e)?e(n,r)||{}:void 0,F(t)?t(n,r)||{}:void 0)}},function(e){v=e,Object.defineProperty(e,"__composition_api_installed__",{configurable:!0,writable:!0,value:!0})}(e),Je(e))}var $e={install:function(e){return Xe(e)}};"undefined"!=typeof window&&window.Vue&&window.Vue.use($e),t.EffectScope=d,t.computed=function(e){var t,n,r,o,i=p();if(F(e)?t=e:(t=e.get,n=e.set),i&&!i.$isServer){var a,s=function(){if(!w){var e=V(I(),{computed:{value:function(){return 0}}}),t=e._computedWatchers.value.constructor,n=e._data.__ob__.dep.constructor;w={Watcher:t,Dep:n},e.$destroy()}return w}(),u=s.Watcher,c=s.Dep;o=function(){return a||(a=new u(i,t,D,{lazy:!0})),a.dirty&&a.evaluate(),c.target&&a.depend(),a.value},r=function(e){n&&n(e)}}else{var l=V(I(),{computed:{$$state:{get:t,set:n}}});i&&i.$on("hook:destroyed",(function(){return l.$destroy()})),o=function(){return l.$$state},r=function(e){l.$$state=e}}return ee({get:o,set:r},!n,!0)},t.createApp=function(e,t){void 0===t&&(t=void 0);var n=I(),r=void 0,o={},a={config:n.config,use:n.use.bind(n),mixin:n.mixin.bind(n),component:n.component.bind(n),provide:function(e,t){return o[e]=t,this},directive:function(e,t){return t?(n.directive(e,t),a):n.directive(e)},mount:function(a,s){return r||((r=new n(i(i({propsData:t},e),{provide:i(i({},o),e.provide)}))).$mount(a,s),r)},unmount:function(){r&&(r.$destroy(),r=void 0)}};return a},t.createLifeCycle=ge,t.createRef=ee,t.customRef=function(e){var t=te(0);return ee(e((function(){t.value}),(function(){++t.value})))},t.default=$e,t.defineAsyncComponent=function(e){F(e)&&(e={loader:e});var t=e.loader,n=e.loadingComponent,r=e.errorComponent,o=e.delay,i=void 0===o?200:o,a=e.timeout;e.suspensible;var s=e.onError,u=null,c=0,l=function(){var e;return u||(e=u=t().catch((function(e){if(e=e instanceof Error?e:new Error(String(e)),s)return new Promise((function(t,n){s(e,(function(){return t((c++,u=null,l()))}),(function(){return n(e)}),c+1)}));throw e})).then((function(t){return e!==u&&u?u:(t&&(t.__esModule||"Module"===t[Symbol.toStringTag])&&(t=t.default),t)})))};return function(){return{component:l(),delay:i,timeout:a,error:r,loading:n}}},t.defineComponent=function(e){return e},t.del=function(e,t){if(I().util.warn,N(e)&&U(t))e.splice(t,1);else{var n=e.__ob__;e._isVue||n&&n.vmCount||R(e,t)&&(delete e[t],n&&n.dep.notify())}},t.effectScope=function(e){return new d(e)},t.getCurrentInstance=S,t.getCurrentScope=f,t.h=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=(null==this?void 0:this.proxy)||(null===(e=S())||void 0===e?void 0:e.proxy);return r?r.$createElement.apply(r,t):(xe||(xe=V(I()).$createElement),xe.apply(xe,t))},t.inject=function(e,t,n){var r;void 0===n&&(n=!1);var o=null===(r=S())||void 0===r?void 0:r.proxy;if(o){if(!e)return t;var i=Ge(e,o);return i!==Ue?i:arguments.length>1?n&&F(t)?t():t:void 0}},t.isRaw=ae,t.isReactive=se,t.isReadonly=function(e){return J.has(e)},t.isRef=ne,t.markRaw=function(e){if(!x(e)&&!N(e)||!Object.isExtensible(e))return e;var t=fe();return t.__v_skip=!0,O(e,"__ob__",t),z.set(e,!0),e},t.nextTick=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return null===(e=I())||void 0===e?void 0:e.nextTick.apply(this,t)},t.onActivated=Ee,t.onBeforeMount=_e,t.onBeforeUnmount=Me,t.onBeforeUpdate=ye,t.onDeactivated=Ce,t.onErrorCaptured=Se,t.onMounted=me,t.onScopeDispose=function(e){r&&r.cleanups.push(e)},t.onServerPrefetch=ke,t.onUnmounted=Te,t.onUpdated=Ie,t.provide=function(e,t){var n,r=null===(n=q())||void 0===n?void 0:n.proxy;if(r){if(!r._provided){var o={};A(r,"_provided",{get:function(){return o},set:function(e){return Object.assign(o,e)}})}r._provided[e]=t}},t.proxyRefs=function(e){var t,n,r;if(se(e))return e;var o=he(((t={})[W]=e,t));O(o,W,o[W],!1);var i=function(e){A(o,e,{get:function(){return ne(o[W][e])?o[W][e].value:o[W][e]},set:function(t){if(ne(o[W][e]))return o[W][e].value=re(t);o[W][e]=re(t)}})};try{for(var s=a(Object.keys(e)),u=s.next();!u.done;u=s.next())i(u.value)}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return o},t.reactive=he,t.readonly=function(e){return J.set(e,!0),e},t.ref=te,t.set=X,t.shallowReactive=pe,t.shallowReadonly=function(e){var t,n;if(!G(e))return e;if(!x(e)&&!N(e)||!Object.isExtensible(e)&&!ne(e))return e;var r=ne(e)?new Q({}):se(e)?le({}):{},o=he({}).__ob__,i=function(t){var n,i=e[t],a=Object.getOwnPropertyDescriptor(e,t);if(a){if(!1===a.configurable&&!ne(e))return"continue";n=a.get}A(r,t,{get:function(){var t=n?n.call(e):i;return o.dep.depend(),t},set:function(e){}})};try{for(var s=a(Object.keys(e)),u=s.next();!u.done;u=s.next())i(u.value)}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}return J.set(r,!0),r},t.shallowRef=function(e){var t;if(ne(e))return e;var n=pe(((t={})[W]=e,t));return ee({get:function(){return n[W]},set:function(e){return n[W]=e}})},t.toRaw=function(e){var t;return ae(e)||!Object.isExtensible(e)?e:(null===(t=null==e?void 0:e.__ob__)||void 0===t?void 0:t.value)||e},t.toRef=ie,t.toRefs=oe,t.triggerRef=function(e){ne(e)&&(Z(!0),e.value=e.value,Z(!1))},t.unref=re,t.useAttrs=function(){return Be().attrs},t.useCSSModule=Ve,t.useCssModule=qe,t.useSlots=function(){return Be().slots},t.version="1.7.0",t.warn=function(e){var t,n,r,o;n=e,r=null===(t=S())||void 0===t?void 0:t.proxy,(o=M())&&o.util?o.util.warn(n,r):console.warn("[vue-composition-api] ".concat(n))},t.watch=function(e,t,n){var r=null;F(t)?r=t:(n=t,r=null);var o=function(e){return i({immediate:!1,deep:!1,flush:"pre"},e)}(n);return we(Ae(),e,r,o)},t.watchEffect=Le,t.watchPostEffect=function(e){return Le(e,{flush:"post"})},t.watchSyncEffect=function(e){return Le(e,{flush:"sync"})}},"77bc":function(e,t,n){"use strict";var r=n("4ea4"),o=n("7037");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n("448a")),a=r(n("970b")),s=r(n("5bc3")),u=r(n("9523")),c=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==o(e)&&"function"!==typeof e)return{default:e};var n=f(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(r,a,s):r[a]=e[a]}r.default=e,n&&n.set(e,r);return r}(n("e16a")),l=n("a6ed"),d=r(n("0f88"));function f(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(f=function(e){return e?n:t})(e)}var p=function(){function e(){var t=this;(0,a.default)(this,e),(0,u.default)(this,"currentConversationID",""),(0,u.default)(this,"currentMessageList",[]),c.default.registerService(c.TUIConstants.TUIChat.SERVICE.NAME,this),l.TUIStore.watch(l.StoreName.CONV,{currentConversationID:function(e){t.currentConversationID=e}}),l.TUIStore.watch(l.StoreName.CHAT,{messageList:function(e){t.currentMessageList=e}})}return(0,s.default)(e,[{key:"onCall",value:function(e,t,n){switch(e){case c.TUIConstants.TUIChat.SERVICE.METHOD.UPDATE_MESSAGE_LIST:var r=t.message;if((null===r||void 0===r?void 0:r.conversationID)===this.currentConversationID){var o=[].concat((0,i.default)(this.currentMessageList),[r]);l.TUIStore.update(l.StoreName.CHAT,"messageList",o)}break;case c.TUIConstants.TUIChat.SERVICE.METHOD.SEND_CUSTOM_MESSAGE:l.TUIChatService.sendCustomMessage(t).then((function(e){n&&n(e)}));break;case c.TUIConstants.TUIChat.SERVICE.METHOD.SEND_TEXT_MESSAGE:l.TUIChatService.sendTextMessage(t).then((function(e){n&&n(e)}));break;case c.TUIConstants.TUIChat.SERVICE.METHOD.SET_CHAT_TYPE:d.default.setChatType(null===t||void 0===t?void 0:t.chatType);break;default:break}}}]),e}();t.default=p},7850:function(e,t,n){"use strict";var r=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n("7037")),i=r(n("970b")),a=r(n("5bc3")),s=r(n("b1c5")),u=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(t.date,t.selected),r=t.startDate,o=t.endDate,a=t.range;(0,i.default)(this,e),this.date=this.getDate(new Date),this.selected=n||[],this.startDate=r,this.endDate=o,this.range=a,this.cleanMultipleStatus(),this.weeks={}}return(0,a.default)(e,[{key:"setDate",value:function(e){this.selectDate=this.getDate(e),this._getWeek(this.selectDate.fullDate)}},{key:"cleanMultipleStatus",value:function(){this.multipleStatus={before:"",after:"",data:[]}}},{key:"resetSatrtDate",value:function(e){this.startDate=e}},{key:"resetEndDate",value:function(e){this.endDate=e}},{key:"getDate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"day";e||(e=new Date),"object"!==(0,o.default)(e)&&(e=e.replace(/-/g,"/"));var r=new Date(e);switch(n){case"day":r.setDate(r.getDate()+t);break;case"month":31===r.getDate()?r.setDate(r.getDate()+t):r.setMonth(r.getMonth()+t);break;case"year":r.setFullYear(r.getFullYear()+t);break}var i=r.getFullYear(),a=r.getMonth()+1<10?"0"+(r.getMonth()+1):r.getMonth()+1,s=r.getDate()<10?"0"+r.getDate():r.getDate();return{fullDate:i+"-"+a+"-"+s,year:i,month:a,date:s,day:r.getDay()}}},{key:"_getLastMonthDays",value:function(e,t){for(var n=[],r=e;r>0;r--){var o=new Date(t.year,t.month-1,1-r).getDate();n.push({date:o,month:t.month-1,lunar:this.getlunar(t.year,t.month-1,o),disable:!0})}return n}},{key:"_currentMonthDys",value:function(e,t){for(var n=this,r=[],o=this.date.fullDate,i=function(e){var i=t.year+"-"+(t.month,t.month+"-")+(e<10?"0"+e:e),a=o===i,s=n.selected&&n.selected.find((function(e){if(n.dateEqual(i,e.date))return e})),u=!0,c=!0;n.startDate&&(u=n.dateCompare(n.startDate,i)),n.endDate&&(c=n.dateCompare(i,n.endDate));var l=n.multipleStatus.data,d=!1,f=-1;n.range&&(l&&(f=l.findIndex((function(e){return n.dateEqual(e,i)}))),-1!==f&&(d=!0));var p={fullDate:i,year:t.year,date:e,multiple:!!n.range&&d,beforeMultiple:n.dateEqual(n.multipleStatus.before,i),afterMultiple:n.dateEqual(n.multipleStatus.after,i),month:t.month,lunar:n.getlunar(t.year,t.month,e),disable:!(u&&c),isDay:a};s&&(p.extraInfo=s),r.push(p)},a=1;a<=e;a++)i(a);return r}},{key:"_getNextMonthDays",value:function(e,t){for(var n=[],r=1;r<e+1;r++)n.push({date:r,month:Number(t.month)+1,lunar:this.getlunar(t.year,Number(t.month)+1,r),disable:!0});return n}},{key:"getInfo",value:function(e){var t=this;e||(e=new Date);var n=this.canlender.find((function(n){return n.fullDate===t.getDate(e).fullDate}));return n}},{key:"dateCompare",value:function(e,t){return e=new Date(e.replace("-","/").replace("-","/")),t=new Date(t.replace("-","/").replace("-","/")),e<=t}},{key:"dateEqual",value:function(e,t){return e=new Date(e.replace("-","/").replace("-","/")),t=new Date(t.replace("-","/").replace("-","/")),e.getTime()-t.getTime()===0}},{key:"geDateAll",value:function(e,t){var n=[],r=e.split("-"),o=t.split("-"),i=new Date;i.setFullYear(r[0],r[1]-1,r[2]);var a=new Date;a.setFullYear(o[0],o[1]-1,o[2]);for(var s=i.getTime()-864e5,u=a.getTime()-864e5,c=s;c<=u;)c+=864e5,n.push(this.getDate(new Date(parseInt(c))).fullDate);return n}},{key:"getlunar",value:function(e,t,n){return s.default.solar2lunar(e,t,n)}},{key:"setSelectInfo",value:function(e,t){this.selected=t,this._getWeek(e)}},{key:"setMultiple",value:function(e){var t=this.multipleStatus,n=t.before,r=t.after;this.range&&(n&&r?(this.multipleStatus.before="",this.multipleStatus.after="",this.multipleStatus.data=[]):n?(this.multipleStatus.after=e,this.dateCompare(this.multipleStatus.before,this.multipleStatus.after)?this.multipleStatus.data=this.geDateAll(this.multipleStatus.before,this.multipleStatus.after):this.multipleStatus.data=this.geDateAll(this.multipleStatus.after,this.multipleStatus.before)):this.multipleStatus.before=e,this._getWeek(e))}},{key:"_getWeek",value:function(e){var t=this.getDate(e),n=t.year,r=t.month,o=new Date(n,r-1,1).getDay(),i=new Date(n,r,0).getDate(),a={lastMonthDays:this._getLastMonthDays(o,this.getDate(e)),currentMonthDys:this._currentMonthDys(i,this.getDate(e)),nextMonthDays:[],weeks:[]},s=[],u=42-(a.lastMonthDays.length+a.currentMonthDys.length);a.nextMonthDays=this._getNextMonthDays(u,this.getDate(e)),s=s.concat(a.lastMonthDays,a.currentMonthDys,a.nextMonthDays);for(var c={},l=0;l<s.length;l++)l%7===0&&(c[parseInt(l/7)]=new Array(7)),c[parseInt(l/7)][l%7]=s[l];this.canlender=s,this.weeks=c}}]),e}(),c=u;t.default=c},"7ec2":function(e,t,n){var r=n("7037")["default"];function o(){"use strict";
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */e.exports=o=function(){return t},e.exports.__esModule=!0,e.exports["default"]=e.exports;var t={},n=Object.prototype,i=n.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},s="function"==typeof Symbol?Symbol:{},u=s.iterator||"@@iterator",c=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag";function d(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(R){d=function(e,t,n){return e[t]=n}}function f(e,t,n,r){var o=t&&t.prototype instanceof g?t:g,i=Object.create(o.prototype),s=new D(r||[]);return a(i,"_invoke",{value:E(e,n,s)}),i}function p(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(R){return{type:"throw",arg:R}}}t.wrap=f;var h={};function g(){}function v(){}function _(){}var m={};d(m,u,(function(){return this}));var y=Object.getPrototypeOf,I=y&&y(y(A([])));I&&I!==n&&i.call(I,u)&&(m=I);var M=_.prototype=g.prototype=Object.create(m);function T(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){var n;a(this,"_invoke",{value:function(o,a){function s(){return new t((function(n,s){(function n(o,a,s,u){var c=p(e[o],e,a);if("throw"!==c.type){var l=c.arg,d=l.value;return d&&"object"==r(d)&&i.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,s,u)}),(function(e){n("throw",e,s,u)})):t.resolve(d).then((function(e){l.value=e,s(l)}),(function(e){return n("throw",e,s,u)}))}u(c.arg)})(o,a,n,s)}))}return n=n?n.then(s,s):s()}})}function E(e,t,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return O()}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=C(a,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=p(e,t,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===h)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}function C(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator["return"]&&(t.method="return",t.arg=void 0,C(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var o=p(r,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,h;var i=o.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,h):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function b(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function D(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function A(e){if(e){var t=e[u];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(i.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:O}}function O(){return{value:void 0,done:!0}}return v.prototype=_,a(M,"constructor",{value:_,configurable:!0}),a(_,"constructor",{value:v,configurable:!0}),v.displayName=d(_,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,d(e,l,"GeneratorFunction")),e.prototype=Object.create(M),e},t.awrap=function(e){return{__await:e}},T(S.prototype),d(S.prototype,c,(function(){return this})),t.AsyncIterator=S,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new S(f(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},T(M),d(M,l,"Generator"),d(M,u,(function(){return this})),d(M,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=A,D.prototype={constructor:D,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(b),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],a=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var s=i.call(o,"catchLoc"),u=i.call(o,"finallyLoc");if(s&&u){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,h):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),b(n),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;b(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:A(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},t}e.exports=o,e.exports.__esModule=!0,e.exports["default"]=e.exports},"823a":function(e,t){},"853d":function(e){e.exports=JSON.parse('{"uni-popup.cancel":"取消","uni-popup.ok":"確定","uni-popup.placeholder":"請輸入","uni-popup.title":"提示","uni-popup.shareTitle":"分享到"}')},8695:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACBCAYAAAAi0kPBAAAAAXNSR0IArs4c6QAAFPJJREFUeF7tnQl8VNX1x78vCyGCbIIUXAquKEoV3EAEZVdxAfxbrQpaUStV+nGlKhEQN8S1on/rWtGiuBT3BSyLra0LLgiKoriyCUQgIZD99fObO89MJjOZN8lkmEnu/cAnyXt3Pef3zj333HPPdQhJhdvdYx2n8hQc2oU+t79bCkSlQCWO42QUuW7Fv1rmZs3y8jn6ZYHrZh1e7P63eXPnsOIS11LRUiBuCmRlOZRXsKlsW3HPtm1zvwsAa2ux+wm4v4m7NlvAUqAmBcpb5DgtnaKi8uHNdsp8ucRKKguShFHAucMpKq54yMUZm7A6bUWWAg7LnaISd47ruqdaalgKJJACGy2wEkhNW1WQAi75FlgWDYmngAVW4mlqawQssCwMGoQCFlgNQlZbqQWWxUCDUMACq0HIaitNJLAyM+C5RQ5ZWdH3Gl3X4agDXXZtY2mfTAqIN/M+hKLi2lvttS90bp+AniUSWDnZMCLPoXVLaJ4duXMVlXDxKS7duySg87YK3xTIzoK8Rx3yt0QvUrDN8OaIbr6rjZ4x0cA6Nc/h3KEuJx8dvc3yCnCtA0UCuBdfFVmZ4ARcDmqmZpkwZprDecNcDk9VYJ09CE7qY5ETH9t3bO5mWTD2dgusHcuFRth6owOW5FoU6dwI2Zf8Ifmlb6MAVmCSdAP/zE+/o08+X9K+RU+n0s/aPuC0B5YHpkoXKiujK5Npz9EUGIDAJDorZTiQkWF+jwSw9ADWYDipd2TlXdJJg62ogO1lLtmZyE/aSC+bEkoBAUgrQaWsTIesDHD0P9KqMJWVd9lKJj3mMOBQlz4HRaaRB6qScpeOrYOfUELJaSsLp0BxqaszDWRnOchQGsnkIADe+YzD0MNd9t8zATRMpB3LfBlmivNEcHgX9a6swg1IqV0tsBLAQX9VbCyoJDPTCcwQ0WxZ4p0M2AmxMSYaWLGGKUCVV7gUl8Fu7azEikWvRL3fUOCSmeEGpkRJrQZPOwJYklglFlgNztvQBtYXuGQ1emCVu5SUW4mVTGSt3+KSmanFUmOWWBZYycRUoC0LrKSTvGk0aIEV5POmbWaFEp6keLbdyTwtKjUr0EQk2dF2zkm+wTZ/G6zeAhqvNx65HLVqDh13hj3aGONmfZMFltnl4e5FsLGoJjnbNIerBpjn81ZEzlMXJqjNkQdF9yOrS521lVn8I7y9EvKLgqaZsC0XmWtkKc/OgIM7waD9oE1u3XthgRUE1j1vw8atNSVI6+Zw5XFBYH1lGJOIJNvNiCQB64H/wPebIFNg8iGNBDL17/dHwj519O60wAoCa/p82LA1bGPLNV/tdYMNlF7/InESSzPq6T0gN4rnayLAqzr++RXM/6pu05tUgz8PNNNkvMkCK0ix1ZuhLIL+pP2u3YP+8tJLyhOoY7VvUTeG+2WyJM8NcyPrjn7qUPk+XeDEA/3krp7HAit+mqVNia0lMG1+/bqrLZm8wf6m0NCWLLDqR/eULr1pO9y+oP5SMW8IyEc9nmSBFQ+10izv5m0wfWEQWK6Z6jW1t86FgmIzrYcr9FLatWINNTlMHAw5WfEN3gIrPnqlVe4t22H6AjONaZEwrBvs3R600pUN68NV8MVPZtHi+afpnXS/z9aZcto/njQsfqlngRVcFf7jU/MVh3sAtsiB0w8xePpoFWyJcQDTL/LEyL5dQJ6UDZW2l8HNb5khDdkP+u3tvyXPrtexFVza1385L6cFViw7Vi5ceawh17w0s2PN+xIWrYTCUrh2oLGs+02vfAYLV0LLHBh/DLQL7j74LW+B5Vne34Z82bHCkvSRq4IG0rkr4OeixLg1J8Py/tj7sGYLnHsEdG4V38puWyl8kw9PLIbx/WC31n4hZfJZYIVMhdJJQi3TUmT1xXpToXSSgpL4CBwtt+pu6Knw1eXw3vcwaQh1crZbthae/NDsPEjviidZYMVDrTTLu7YA7loEw7vDMV3jk1jF5fDwu0axl7lBq8l4kgVWPNRKw7ySOEvXwJk94ZDd/A9AoFqZD2MOg24d/Zezynv8tErbElPnwe6tja7lYw86cDBl8htmO2fYAXUbtpVYdaNbWpV6fTks+BpuOB6a+zBvfLoWZn4AVxwLnVrVbagWWEG6yfmtrKImEeXoJ+c3Ja2UAseV6kbraqUkObQw8OPGUt/mNm83e4aD94MB+8auTdtA6tdl/eM3jNqpMIS+AoqU3I2F1d1m9Lxtc7h6oMksu866wsQAS+gceXD8WyWxYRE5x9Mfw8er4JJjqj6USDlf+RwWfQ3j+kLXelz0ZyVWLANpiKOfgPVTAoE1IonA0r6grOla5fXfx9iltM2jPUGZPmRGEfC+WG+8R7X9U59kgRUE1p0LDdHD7Vhy9JOz2y8SqyBBEkuuyUkElvpfWgEvfAqfrydwzlLTutzLZEnQqWRNzUP2h8P2qA+kTFkLrCAN1xea3f/wVZN0LG8rZHsplCdCwVKbQeNrMnSscJiUlsPWUgO0gK+7Y6bktvXwcQ9vwwKr/h9nStbw42YjfeUWo6QPZNeW1bu6arM5raNDFAd0rFLUtXm9fquRaBWuic6j/wd18r/YsMBKSVjUr1OzP4FPVhvp60lEAWPCAGgXsjUjk8KydUZyTRtetZB49D1YsbEqWF3AR0tuyl1BeqGfZIHlh0pplOeDH2DO0sh7gx1awiV9qySTtnxm/At6d4XhQb92mSY8c0P4sBWm4MI+sM8usQligRWbRmmTQ3a4qXOjLy60MjzzUOjR2QxJphMB6+iucHzQwj7rQ6PcR7PQS8GXG1GsCDIWWGkDm9gd1YHUuV/G1oM8V+Ola0H2LRmAL+oN2ni+JegYGK01gXfsUbHPG1pgxeZX2uSQtJK+VFtSiICee8CoHvDWClj4tTEKTx0GLy4DTaVe7NBI9UjX2msXc5i1tmSBlTawqb2jtelG4SUldeRj9dpyWLHBrPiuHwq3/dOsAmMlmSsmD6v9sK0FViwqpsl7HX546qPY06A3HG0uC4wyLciWdWBH+Hxd7dLKKyszxAW9a9/yscBKE+DE6uZzS+CTNf7cYlSXF+veU9I9Q2msdvRewBraDfrXcjjDAssPJdMgz+0LQa7VyUgC5b4dYMzh0VuzwEoGJ5LQxpQ3ErjdFKO/UsPa5cLlwdNLkbJbYCWB6Q3dhFZ6U+ZGD0neEO3LB14KfzR7lwVWQ1A9yXVqVXfnosR5XfjpvlxudN4wWrLA8kPFNMgjhVrSw4e1oN6jCUgpHb+vxYHeAqveZLYVWB3L3kyRtK/ASqykkbppNWSBFeS3bEB+tjNqg4f22BRlWcZGnehJdpLHQUPHNPU7JgusoML7l2DUZF8nOqNQV/HgL+8PCtH4wmfxH0v3y7Ro+Tq0gIE+jnfVtx0/5S2wYpzS8UNEL49C/egsXgBYy6ouhYynjvrktcAqcee4rntqfYjot6xsPGUx7tLREt07peO33kj5BKyrB0BhCTy/1ATjT2aSh6gCrKVCshIryIVv82P7MsVimCIMy1dJYNb5w2SfwFF0wHjDDcUaU13fW2DVlXK2XK0UsMCyAGkQClhgNQhZbaUCVlamvbrXIiHBFGj0V/dWaFVY6VJcaq/uTTB2aq1uY2ElGY5DdlbdQyHF1d9EXjauVdeP66F1C9g5SrhoWdMryrXic+nYOsnr/7go07gybyioDNwHrWAjkVbHcoxY8zO0aQG5OQkYeyKBlZMNx09wGD0ERvaL7DAiN1od1KyocGmWDTs3t+BKABtrrSK/0PjwCFhyrYkELJlGzrnF4YITXY6qw+1iNTqQaGCdmudw9iA4qU90YHngqnTdQPge7zaIwIECmxJCAYFHUkiHXnOzzc312jv1noc3Ih6Mvd3hvGEuh9czFleg7mQDy7QJrmJBuaHuuxZVCUFUtUqcX4AUOIIfdj1waNZGASwPXEFkJ8XLMvFMS48aQ6e92iI0NxpgpQdbmk4vLbCaDq+TOtK0AdbJfVw7xSUVGvVrLOWBNSLPoV8Pl0P2iTxQ13Xo3sWlTRxXqtWPZLa0KCAzw+IvCRimI6WsTIdHXoOxJ6boqlB2LBnYtOKLlHQs6prfufRKET+lpgI7SaQ/3OXw06boI9bK8dKRLr1TzY6lLu/kw2rrhZ5uKkxNlXE2bxZ7OydhvEmkHStVCGj7kQIUsMBKASY0xi5YYDVGrqbAmCywUoAJjbELFliNkaspMCYLrBRgQmPsggVWY+RqCozJAisFmNAYu2CB1Ri5mgJjssBKASY0xi5YYDVGrqbAmASsssrKObgkJShICgzZdiEJFHAcNjrj762cu72UwUlozzbRRCiQk+2UOGNudedtK2FQExmzHWYSKJCbQ6kFVhII3dSasMBqahxP0ngtsJJE6KbWjAVWU+N4ksZrgZUkQje1ZlIOWIoXmqmIKD44oStrvbgPyl6qOBDZPgoqb7m5+T3W7e+qTX1SlBab/FMgpYClEzxXjIJZ82H9ltoHoZNAeWfDhIcMOHKbwQ3nwWX3RweB6ldS8JFbx8Ls+fDJt+aZjqJHuuRIwL1sFEybbfKd0gde/A/02hfW5pvQP6FpSC94/QPTp7Jyc/tppKSPR8F39V4HGPwkjVH91BVyfj68wEfhBm9v9dNAAvOkFLAkGR69Em58En7YEH2UAsbIvtC+NWzcArqsW6eDTjwKnl0UBArw72WwaWsQTMCYQfCrXQyAeu4H7y03INT9gku+hrkf1WzzmjPhnWXw9lIT9+veS2D0NNizA4weDDfOqiqjfl31f+BkwG2zYdxJcFzPqvfbS6piT73+Hjz6JhzTHcaP8sfRP9wF6zbBzAk14495MRrCI/Y88CLMX5L8iNFpCSxNd09eA6fkwRnHGskwqBd8/j2syY8CLBfuHgcPvASbt1Vn5CF7wd6d4f6Xqz/X2cjnJsGoyUYCqfyMF+DrNUYKPDsJTptSXdLp47j6dJi9EL5ZZ6ZRJUmll6fCqCmGyYqsJ2mo9+ESa7/d4PfDYMLD1QGhj0dlww+dbiuBt6abfooWoUnt+Jnu/UHbf66UA9ZjV8Kkx+H79TUJpCdi9pTR0LYVjLvbSCsR+5WbYOCVoLNzXtJz75yjgHD3xVBSXsVsL1/LXFjxY01gTT3XTDkT/wa/agt3/xHOuLGq/guOh4xM+Osr5pnHcIFFdSp5+pnA8/R1RtpFCnwWqsft04lAjLHrZ0aenju1g349TFgijat9KziiG7z2vvlbcbCUFJbzmYVVf/uHRf1zphywHr4CistqfnmX3msU82GHwdgTjG6z/HsYGDLVhJOjuATOusV8sQFgjYOpMyG/sHrOo7pBr/3h4ddN3u2lcHBXyDsHVvwAN82Cx/8M50+HDSG6n0D90lT468uw6FN46jqz8JDUGH2r0Z80ld7+LBQVG2CpPwJWqBTRQuLW8yHvb+adgHXWQJj4eBWwBHAPMIfuDaf1h3mLYXhvePdzyC8wH9n4kUYqawyXnQYjJhldLtkp5YAlHevBV4wu4SWd1v9xgyHQUxONgj7hDLj4biMRju1BIArdbc9UJ590KU+CeRIrM6umQi2lWDpW7+5GN1r2Hcy6Fm56As4cCF+vNmVOOhpC9SRJhBffgf33gBueMGCRvvb09XDGVBMS8+mJcO40KNwO/5gCH68wkkZTqqYwT9K9dGPVtCpgXXOW+XC8pNiuTy80wBOwjj4Y/jIH8s6CeR8aFUBS8b4/mbYLtsFrt1hg/TJt+FHeNS1dexaMn2Ek0d+vhSUroTCoO4m5Yt79LxnlXHkkRWZcChMehA0F1QHYtztcPwaemAsvv2veaeXVuR1cOByufdQ8kxR4frIBgOocfqTRk159v2olKgAqTyRgPZNnAKi+fbOmCuCaQsOBdfHJZnXsTZsa2xerzNQcCqyJvzMALtI1fJUwoKcFVg3p7HdV2LEtXBcElqSElv5eEBIxXGD45CujM4kxXTsq2AXs3gHW/VylY0kSarrs2A6+XQM3/r26/rNne1OXdCwvPXM9/PYGE+7ynEGwYhW890XV+9qAFU3HigSs2nSscIn14Kvw7ToD/AW3Gz3QSqwQeNUFWF7xbnvA0m/h3CFmarrmEbPy8lLozV8ChYypI/qaqe75RdChTU3lPRxYUsjvGw9jppla/3wGPLsAVv4UGViahh++smoqbAhgSWLt1sEYfPVR6eNp8lOhpqzQcEcClmw0U2bWXBUGpqegEhoqsfRcYcBvvQA2FRpb07h7IscqF+Glh8iIecGJsHAJ/P/L0O8g6Llv7cBSP2dcAve+AF+tNkB66HK48K7qBkiNQVOhJOXUJxSyqXZgScJJYr16M4y43ijo+3Y20jBUeVd7nhFXEqvPQXDX8zD5HHjkDSOxVI/MDqdNhi3bYN5tTVDHEqOkoxwZEvpZkuTALkb/KAkLECZFV6szgSscWCK6GCpmnHAk/GkG/Bw0jOqdCC7b0HGHGiPqoiUwc65hohR8rQplx5rxUvXZ2ZNY0rFkVzrg18bSL/BKp5k10UiH0I/jhCPgt8fBZffBgF5wen944R0jIU/rB3P+bXQsjUN9kFVf07kWDu8vN+1LMu7ZET7/rnp/JJHf+AB67gOXjIBVG2CvTrD2ZzOl63KG7l3gix+MqUG/j5jcBFeFu7aB1i1rqFoRH4hQK9eYr1YW9z+eDFOkCIckMfioA4zN6aX/mhcC6/lDDSjeXAxzF5vnApUkjtJPm+HeOdQISrbbLnDeUJAOM3oo3DzLKOtXnQ6d2xvGP/Ra9T50ags/bjRgOfY30eNR6f28j4x+6JkRYlFCuwzf/QQ9usLAQ2H2ouj160O8ZxycefOO2edMKXNDLMJ67wOrvIrqG9C/vAuiKdQIqelG026ozqVsnsVbUiv8XaCa4GpS9jPV4dmeJB0FYkmdSPuLfsdR13wai/oTqc9enVo96oJ1mVJ2REpLYO0IQtk246OABVZ89LK5fVIgtxmlzvnT3RcKtnGKzzI2m6VATArkNmejc+Ed7kWbinjABmaPSS+bwScFcnOYFfAZO/tmd0tJGa18lrPZLAWiUqBZDhy8F7+W84Vz4+N0Xr6aL0vLaGFpZilQVwpkN4NObRh2x8XOm0EvV1eXjrljp7tXFZcxtLwCWZjsXW91pXDTKudkZFDcIoePDtuTKRed7gSci/4HEtC+EpKzxO8AAAAASUVORK5CYII="},"89dd":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={appid:"__UNI__B5B1A99"}},"8e39":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={"搜索":"搜索","全部":"全部","联系人":"联系人","群聊":"群聊","聊天记录":"聊天记录","文本":"文本","文件":"文件","图片/视频":"图片/视频","其他":"其他","选择时间":"选择时间","今天":"今天","近三天":"近三天","近七天":"近七天","查看更多":"查看更多","条相关":"条相关","条与":"条与","相关的":"相关的","进入聊天":"进入聊天","定位到聊天位置":"定位到聊天位置","搜索会话内容":"搜索会话内容","查看更多历史记录":"查看更多历史记录","暂无搜索结果":"暂无搜索结果","结果":"结果","[文本]":"[文本]","[图片]":"[图片]","[语音]":"[语音]","[视频]":"[视频]","[文件]":"[文件]","[自定义消息]":"[自定义消息]","[系统消息]":"[系统消息]","[合并消息]":"[合并消息]","[位置消息]":"[位置消息]","消息云端搜索失败：":"消息云端搜索失败：","查找联系人失败：":"查找联系人失败：","查找群聊失败：":"查找群聊失败：","进入会话失败":"进入会话失败"};t.default=r},"8e85":function(e,t,n){"use strict";(function(e,n){Object.defineProperty(t,"__esModule",{value:!0}),t.TUIGlobal=void 0,t.getPlatform=function(){var e="";return v?e="pc":g?e="h5":h?e="wechat":_&&(e="app"),e};var r="undefined"!=typeof e&&"function"==typeof e.getSystemInfoSync&&Boolean(e.getSystemInfoSync().fontSizeSetting),o="undefined"!=typeof n&&"undefined"==typeof window,i=r||o,a="undefined"!=typeof n,s=("undefined"!=typeof n||"undefined"!=typeof window)&&!i,u=r?e:a?n:window,c=s&&window&&window.navigator&&window.navigator.userAgent||"",l=/Android/i.test(c),d=/(?:Windows Phone)/.test(c),f=/(?:SymbianOS)/.test(c),p=/iPad/i.test(c)||/iPhone/i.test(c)||/iPod/i.test(c),h=r,g=l||d||f||p,v=s&&!g,_=o&&!r;t.TUIGlobal=u,console.log("TUIUniversvalAPI.VERSION:0.0.1")}).call(this,n("bc2e")["default"],n("543d")["default"])},"914e":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.capitalize=t.isPlainObject=t.hasOwn=t.extend=void 0,t.extend=Object.assign;var r=Object.prototype.hasOwnProperty;t.hasOwn=function(e,t){return r.call(e,t)};var o=Object.prototype.toString;t.isPlainObject=function(e){return"[object Object]"===function(e){return o.call(e)}(e)};t.capitalize=function(e){var t=Object.create(null);return function(n){var r=t[n];return r||(t[n]=e(n))}}((function(e){return e.charAt(0).toUpperCase()+e.slice(1)}))},9430:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={"请对本次服务进行评价":"请对本次服务进行评价","提交评价":"提交评价","服务评价工具":"服务评价工具","使用":"使用","自定义消息":"自定义消息","搭建":"搭建","星":"星"};t.default=r},9523:function(e,t,n){var r=n("a395");e.exports=function(e,t,n){return t=r(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},e.exports.__esModule=!0,e.exports["default"]=e.exports},9547:function(e,t,n){"use strict";var r=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n("dbd5")),i=r(n("3939"));i.default.getInstance();var a=o.default;t.default=a},"970b":function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports["default"]=e.exports},9725:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={namespaced:!0,state:{signPath:""},mutations:{SET_SIGN_PATH:function(e,t){e.signPath=t}},actions:{setSignPath:function(e,t){var n=e.commit;n("SET_SIGN_PATH",t)}}};t.default=r},"995e":function(e){e.exports=JSON.parse('{"uni-datetime-picker.selectDate":"选择日期","uni-datetime-picker.selectTime":"选择时间","uni-datetime-picker.selectDateTime":"选择日期时间","uni-datetime-picker.startDate":"开始日期","uni-datetime-picker.endDate":"结束日期","uni-datetime-picker.startTime":"开始时间","uni-datetime-picker.endTime":"结束时间","uni-datetime-picker.ok":"确定","uni-datetime-picker.clear":"清除","uni-datetime-picker.cancel":"取消","uni-datetime-picker.year":"年","uni-datetime-picker.month":"月","uni-calender.SUN":"日","uni-calender.MON":"一","uni-calender.TUE":"二","uni-calender.WED":"三","uni-calender.THU":"四","uni-calender.FRI":"五","uni-calender.SAT":"六","uni-calender.confirm":"确认"}')},"9b42":function(e,t){e.exports=function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],u=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(l){c=!0,o=l}finally{try{if(!u&&null!=n["return"]&&(a=n["return"](),Object(a)!==a))return}finally{if(c)throw o}}return s}},e.exports.__esModule=!0,e.exports["default"]=e.exports},"9c82":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={"搜索":"Search","全部":"All","联系人":"Contacts","群聊":"Groups","聊天记录":"Chat History","文本":"Text","文件":"File","其他":"Other","图片/视频":"Image/Video","选择时间":"Select time","今天":"Today","近三天":"Nearly three days","近七天":"Nearly seven days","查看更多":"View more ","条相关":" related ","条与":" related to ","相关的":"keywords","进入聊天":"enter","定位到聊天位置":"Navigate to the chat position","搜索会话内容":"Search in conversation","查看更多历史记录":"View more history message","暂无搜索结果":"No Results","结果":"results","[文本]":"[Text Message]","[图片]":"[Image Message]","[语音]":"[Audio Message]","[视频]":"[Video Message]","[文件]":"[File Message]","[自定义消息]":"[Custom Message]","[系统消息]":"[System Message]","[合并消息]":"[Merged Message]","[位置消息]":"[Position Message]","消息云端搜索失败：":"Message cloud search failed: ","查找联系人失败：":"Failed to find contact: ","查找群聊失败：":"Failed to find group: ","进入会话失败":"Failed to enter conversation"};t.default=r},"9d02":function(e,t,n){(function(r,o){var i,a,s,u=n("7037");s=function(){function e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function t(t){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?e(Object(r),!0).forEach((function(e){c(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):e(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function n(e){return(n="function"==typeof Symbol&&"symbol"==u(Symbol.iterator)?function(e){return u(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":u(e)})(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l="undefined"!=typeof r&&"function"==typeof r.getSystemInfoSync&&Boolean(r.getSystemInfoSync().fontSizeSetting),d="undefined"!=typeof qq&&"function"==typeof qq.getSystemInfoSync&&Boolean(qq.getSystemInfoSync().fontSizeSetting),f="undefined"!=typeof tt&&"function"==typeof tt.getSystemInfoSync&&Boolean(tt.getSystemInfoSync().fontSizeSetting),p="undefined"!=typeof swan&&"function"==typeof swan.getSystemInfoSync&&Boolean(swan.getSystemInfoSync().fontSizeSetting),h="undefined"!=typeof my&&"function"==typeof my.getSystemInfoSync&&Boolean(my.getSystemInfoSync().fontSizeSetting),g="undefined"!=typeof o&&"undefined"==typeof window&&"function"==typeof o.requireNativePlugin,v=g&&"ios"===o.getDeviceInfo().platform.toLocaleLowerCase(),_=(g&&o.getDeviceInfo().platform.toLocaleLowerCase(),l||d||f||p||h||g),m=d?qq:f?tt:p?swan:h?my:l?r:g?o:{},y=function(e){if("object"!==n(e)||null===e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;for(var r=t;null!==Object.getPrototypeOf(r);)r=Object.getPrototypeOf(r);return t===r};function I(e){if(null==e)return!0;if("boolean"==typeof e)return!1;if("number"==typeof e)return 0===e;if("string"==typeof e)return 0===e.length;if("function"==typeof e)return 0===e.length;if(Array.isArray(e))return 0===e.length;if(e instanceof Error)return""===e.message;if(y(e)){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}return!1}var M=function(){function e(){i(this,e)}return s(e,[{key:"request",value:function(e,t){var n=this,r=e.downloadUrl||"",o=(e.method||"PUT").toUpperCase(),i=e.url;if(e.qs){var a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"&",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"=";return I(e)?"":y(e)?Object.keys(e).map((function(r){var o=encodeURIComponent(r)+n;return Array.isArray(e[r])?e[r].map((function(e){return o+encodeURIComponent(e)})).join(t):o+encodeURIComponent(e[r])})).filter(Boolean).join(t):void 0}(e.qs);a&&(i+="".concat(-1===i.indexOf("?")?"?":"&").concat(a))}var s=new XMLHttpRequest;s.open(o,i,!0),s.responseType=e.dataType||"text";var u=e.headers||{};if(!I(u))for(var c in u)u.hasOwnProperty(c)&&"content-length"!==c.toLowerCase()&&"user-agent"!==c.toLowerCase()&&"origin"!==c.toLowerCase()&&"host"!==c.toLowerCase()&&s.setRequestHeader(c,u[c]);return s.onload=function(){if(200===s.status)t(null,n._xhrRes(s,n._xhrBody(s,r)));else{var e={code:s.status,message:JSON.stringify(s.responseText)};t(e,n._xhrRes(s,n._xhrBody(s)))}},s.onerror=function(e){var r=n._xhrBody(s),o={code:s.status,message:JSON.stringify(s.responseText)};r||s.statusText||0!==s.status||(e.message="CORS blocked or network error"),t(o,n._xhrRes(s,r)),o=null},e.onProgress&&s.upload&&(s.upload.onprogress=function(t){var n=t.total,r=t.loaded,o=Math.floor(100*r/n);e.onProgress({total:n,loaded:r,percent:(o>=100?100:o)/100})}),s.send(e.resources),s}},{key:"_xhrRes",value:function(e,t){var n={};return e.getAllResponseHeaders().trim().split("\n").forEach((function(e){if(e){var t=e.indexOf(":"),r=e.substr(0,t).trim().toLowerCase(),o=e.substr(t+1).trim();n[r]=o}})),{statusCode:e.status,statusMessage:e.statusText,headers:n,data:t}}},{key:"_xhrBody",value:function(e,t){return 200===e.status&&t?{location:t}:{response:e.responseText}}}]),e}(),T=["unknown","image","video","audio","log"],S=["name"],E=function(){function e(){i(this,e)}return s(e,[{key:"request",value:function(e,n){var r=this,o=e.resources,i=void 0===o?"":o,a=e.headers,s=void 0===a?{}:a,u=e.url,c=e.downloadUrl,l=void 0===c?"":c,d=u,f=null,p=l.match(/^(https?:\/\/[^/]+\/)([^/]*\/?)(.*)$/),g=decodeURIComponent(p[3]),_=g.indexOf("?")>-1?g.split("?")[0]:g,y={key:e.fileKey?e.fileKey:_,success_action_status:200,"Content-Type":""},I={};if(v){var M=u.split("?sign=");if(M.length>1){var E=M[1];d="".concat(M[0],"?sign=").concat(encodeURIComponent("".concat(E))),I.sign=decodeURIComponent(E),I.signature=decodeURIComponent(E)}}var C={url:d,header:s,name:"file",filePath:i,formData:t(t({},y),I),timeout:e.timeout||3e5};if(h){var k=C;k.name,C=t(t({},function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(k,S)),{},{fileName:"file",fileType:T[e.fileType]})}return(f=m.uploadFile(t(t({},C),{},{success:function(e){r._handleResponse({response:e,downloadUrl:l,callback:n})},fail:function(e){r._handleResponse({response:e,downloadUrl:l,callback:n})}}))).onProgressUpdate&&f.onProgressUpdate((function(t){e.onProgress&&e.onProgress({total:t.totalBytesExpectedToSend,loaded:t.totalBytesSent,percent:Math.floor(t.progress)/100})})),f}},{key:"_handleResponse",value:function(e){var n=e.downloadUrl,r=e.response,o=e.callback,i=r.header,a={};if(i)for(var s in i)i.hasOwnProperty(s)&&(a[s.toLowerCase()]=i[s]);var u=+r.statusCode;200===u?o(null,{statusCode:u,headers:a,data:t(t({},r.data),{},{location:n})}):o({code:u,message:JSON.stringify(r.data)},{statusCode:u,headers:a,data:void 0})}}]),e}();return function(){function e(){i(this,e),console.log("TIMUploadPlugin.VERSION: ".concat("1.3.0")),this.retry=1,this.tryCount=0,this.systemClockOffset=0,this.httpRequest=_?new E:new M}return s(e,[{key:"uploadFile",value:function(e,t){var n=this;return this.httpRequest.request(e,(function(r,o){r&&n.tryCount<n.retry&&n.allowRetry(r)?(n.tryCount++,n.uploadFile(e,t)):(n.tryCount=0,t(r,o))}))}},{key:"allowRetry",value:function(e){var t=!1,n=!1;if(e){var r=e.headers&&(e.headers.date||e.headers.Date)||e.error&&e.error.ServerTime;try{var o=e.error&&e.error.Code,i=e.error&&e.error.Message;("RequestTimeTooSkewed"===o||"AccessDenied"===o&&"Request has expired"===i)&&(n=!0)}catch(l){}if(n&&r){var a=Date.now(),s=Date.parse(r);Math.abs(a+this.systemClockOffset-s)>=3e4&&(this.systemClockOffset=s-a,t=!0)}else 5===Math.floor(e.statusCode/100)&&(t=!0)}return t}}]),e}()},"object"==u(t)&&"undefined"!=typeof e?e.exports=s():(i=s,a="function"===typeof i?i.call(t,n,t,e):i,void 0===a||(e.exports=a))}).call(this,n("bc2e")["default"],n("543d")["default"])},a107:function(e,t,n){"use strict";(function(e){var r=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n("970b")),i=r(n("5bc3")),a=r(n("7037")),s="undefined"!=typeof e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},u=[],c=[],l="undefined"!=typeof Uint8Array?Uint8Array:Array,d=!1;function f(){d=!0;for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=0,n=e.length;t<n;++t)u[t]=e[t],c[e.charCodeAt(t)]=t;c["-".charCodeAt(0)]=62,c["_".charCodeAt(0)]=63}function p(e,t,n){for(var r,o,i=[],a=t;a<n;a+=3)r=(e[a]<<16)+(e[a+1]<<8)+e[a+2],i.push(u[(o=r)>>18&63]+u[o>>12&63]+u[o>>6&63]+u[63&o]);return i.join("")}function h(e){var t;d||f();for(var n=e.length,r=n%3,o="",i=[],a=0,s=n-r;a<s;a+=16383)i.push(p(e,a,a+16383>s?s:a+16383));return 1===r?(t=e[n-1],o+=u[t>>2],o+=u[t<<4&63],o+="=="):2===r&&(t=(e[n-2]<<8)+e[n-1],o+=u[t>>10],o+=u[t>>4&63],o+=u[t<<2&63],o+="="),i.push(o),i.join("")}function g(e,t,n,r,o){var i,a,s=8*o-r-1,u=(1<<s)-1,c=u>>1,l=-7,d=n?o-1:0,f=n?-1:1,p=e[t+d];for(d+=f,i=p&(1<<-l)-1,p>>=-l,l+=s;l>0;i=256*i+e[t+d],d+=f,l-=8);for(a=i&(1<<-l)-1,i>>=-l,l+=r;l>0;a=256*a+e[t+d],d+=f,l-=8);if(0===i)i=1-c;else{if(i===u)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,r),i-=c}return(p?-1:1)*a*Math.pow(2,i-r)}function v(e,t,n,r,o,i){var a,s,u,c=8*i-o-1,l=(1<<c)-1,d=l>>1,f=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:i-1,h=r?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=l):(a=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-a))<1&&(a--,u*=2),(t+=a+d>=1?f/u:f*Math.pow(2,1-d))*u>=2&&(a++,u/=2),a+d>=l?(s=0,a=l):a+d>=1?(s=(t*u-1)*Math.pow(2,o),a+=d):(s=t*Math.pow(2,d-1)*Math.pow(2,o),a=0));o>=8;e[n+p]=255&s,p+=h,s/=256,o-=8);for(a=a<<o|s,c+=o;c>0;e[n+p]=255&a,p+=h,a/=256,c-=8);e[n+p-h]|=128*g}var _={}.toString,m=Array.isArray||function(e){return"[object Array]"==_.call(e)};function y(){return M.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function I(e,t){if(y()<t)throw new RangeError("Invalid typed array length");return M.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=M.prototype:(null===e&&(e=new M(t)),e.length=t),e}function M(e,t,n){if(!(M.TYPED_ARRAY_SUPPORT||this instanceof M))return new M(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return E(this,e)}return T(this,e,t,n)}function T(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r),M.TYPED_ARRAY_SUPPORT?(e=t).__proto__=M.prototype:e=C(e,t),e}(e,t,n,r):"string"==typeof t?function(e,t,n){if("string"==typeof n&&""!==n||(n="utf8"),!M.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|D(t,n),o=(e=I(e,r)).write(t,n);return o!==r&&(e=e.slice(0,o)),e}(e,t,n):function(e,t){if(b(t)){var n=0|k(t.length);return 0===(e=I(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(r=t.length)!=r?I(e,0):C(e,t);if("Buffer"===t.type&&m(t.data))return C(e,t.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function S(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function E(e,t){if(S(t),e=I(e,t<0?0:0|k(t)),!M.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function C(e,t){var n=t.length<0?0:0|k(t.length);e=I(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function k(e){if(e>=y())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+y().toString(16)+" bytes");return 0|e}function b(e){return!(null==e||!e._isBuffer)}function D(e,t){if(b(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return te(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return ne(e).length;default:if(r)return te(e).length;t=(""+t).toLowerCase(),r=!0}}function A(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return H(this,t,n);case"utf8":case"utf-8":return q(this,t,n);case"ascii":return B(this,t,n);case"latin1":case"binary":return j(this,t,n);case"base64":return F(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return K(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function O(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function R(e,t,n,r,o){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(o)return-1;n=e.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof t&&(t=M.from(t,r)),b(t))return 0===t.length?-1:N(e,t,n,r,o);if("number"==typeof t)return t&=255,M.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):N(e,[t],n,r,o);throw new TypeError("val must be string, number or Buffer")}function N(e,t,n,r,o){var i,a=1,s=e.length,u=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;a=2,s/=2,u/=2,n/=2}function c(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(o){var l=-1;for(i=n;i<s;i++)if(c(e,i)===c(t,-1===l?0:i-l)){if(-1===l&&(l=i),i-l+1===u)return l*a}else-1!==l&&(i-=i-l),l=-1}else for(n+u>s&&(n=s-u),i=n;i>=0;i--){for(var d=!0,f=0;f<u;f++)if(c(e,i+f)!==c(t,f)){d=!1;break}if(d)return i}return-1}function w(e,t,n,r){n=Number(n)||0;var o=e.length-n;r?(r=Number(r))>o&&(r=o):r=o;var i=t.length;if(i%2!=0)throw new TypeError("Invalid hex string");r>i/2&&(r=i/2);for(var a=0;a<r;++a){var s=parseInt(t.substr(2*a,2),16);if(isNaN(s))return a;e[n+a]=s}return a}function L(e,t,n,r){return re(te(t,e.length-n),e,n,r)}function P(e,t,n,r){return re(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function U(e,t,n,r){return P(e,t,n,r)}function G(e,t,n,r){return re(ne(t),e,n,r)}function x(e,t,n,r){return re(function(e,t){for(var n,r,o,i=[],a=0;a<e.length&&!((t-=2)<0);++a)n=e.charCodeAt(a),r=n>>8,o=n%256,i.push(o),i.push(r);return i}(t,e.length-n),e,n,r)}function F(e,t,n){return 0===t&&n===e.length?h(e):h(e.slice(t,n))}function q(e,t,n){n=Math.min(e.length,n);for(var r=[],o=t;o<n;){var i,a,s,u,c=e[o],l=null,d=c>239?4:c>223?3:c>191?2:1;if(o+d<=n)switch(d){case 1:c<128&&(l=c);break;case 2:128==(192&(i=e[o+1]))&&(u=(31&c)<<6|63&i)>127&&(l=u);break;case 3:i=e[o+1],a=e[o+2],128==(192&i)&&128==(192&a)&&(u=(15&c)<<12|(63&i)<<6|63&a)>2047&&(u<55296||u>57343)&&(l=u);break;case 4:i=e[o+1],a=e[o+2],s=e[o+3],128==(192&i)&&128==(192&a)&&128==(192&s)&&(u=(15&c)<<18|(63&i)<<12|(63&a)<<6|63&s)>65535&&u<1114112&&(l=u)}null===l?(l=65533,d=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),o+=d}return function(e){var t=e.length;if(t<=V)return String.fromCharCode.apply(String,e);for(var n="",r=0;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=V));return n}(r)}M.TYPED_ARRAY_SUPPORT=void 0===s.TYPED_ARRAY_SUPPORT||s.TYPED_ARRAY_SUPPORT,M.poolSize=8192,M._augment=function(e){return e.__proto__=M.prototype,e},M.from=function(e,t,n){return T(null,e,t,n)},M.TYPED_ARRAY_SUPPORT&&(M.prototype.__proto__=Uint8Array.prototype,M.__proto__=Uint8Array),M.alloc=function(e,t,n){return function(e,t,n,r){return S(t),t<=0?I(e,t):void 0!==n?"string"==typeof r?I(e,t).fill(n,r):I(e,t).fill(n):I(e,t)}(null,e,t,n)},M.allocUnsafe=function(e){return E(null,e)},M.allocUnsafeSlow=function(e){return E(null,e)},M.isBuffer=oe,M.compare=function(e,t){if(!b(e)||!b(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,o=0,i=Math.min(n,r);o<i;++o)if(e[o]!==t[o]){n=e[o],r=t[o];break}return n<r?-1:r<n?1:0},M.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},M.concat=function(e,t){if(!m(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return M.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=M.allocUnsafe(t),o=0;for(n=0;n<e.length;++n){var i=e[n];if(!b(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(r,o),o+=i.length}return r},M.byteLength=D,M.prototype._isBuffer=!0,M.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)O(this,t,t+1);return this},M.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)O(this,t,t+3),O(this,t+1,t+2);return this},M.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)O(this,t,t+7),O(this,t+1,t+6),O(this,t+2,t+5),O(this,t+3,t+4);return this},M.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?q(this,0,e):A.apply(this,arguments)},M.prototype.equals=function(e){if(!b(e))throw new TypeError("Argument must be a Buffer");return this===e||0===M.compare(this,e)},M.prototype.inspect=function(){var e="";return this.length>0&&(e=this.toString("hex",0,50).match(/.{2}/g).join(" "),this.length>50&&(e+=" ... ")),"<Buffer "+e+">"},M.prototype.compare=function(e,t,n,r,o){if(!b(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),t<0||n>e.length||r<0||o>this.length)throw new RangeError("out of range index");if(r>=o&&t>=n)return 0;if(r>=o)return-1;if(t>=n)return 1;if(this===e)return 0;for(var i=(o>>>=0)-(r>>>=0),a=(n>>>=0)-(t>>>=0),s=Math.min(i,a),u=this.slice(r,o),c=e.slice(t,n),l=0;l<s;++l)if(u[l]!==c[l]){i=u[l],a=c[l];break}return i<a?-1:a<i?1:0},M.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},M.prototype.indexOf=function(e,t,n){return R(this,e,t,n,!0)},M.prototype.lastIndexOf=function(e,t,n){return R(this,e,t,n,!1)},M.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var o=this.length-t;if((void 0===n||n>o)&&(n=o),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return w(this,e,t,n);case"utf8":case"utf-8":return L(this,e,t,n);case"ascii":return P(this,e,t,n);case"latin1":case"binary":return U(this,e,t,n);case"base64":return G(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,e,t,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},M.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var V=4096;function B(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(127&e[o]);return r}function j(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(e[o]);return r}function H(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var o="",i=t;i<n;++i)o+=ee(e[i]);return o}function K(e,t,n){for(var r=e.slice(t,n),o="",i=0;i<r.length;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}function W(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function Y(e,t,n,r,o,i){if(!b(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<i)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function z(e,t,n,r){t<0&&(t=65535+t+1);for(var o=0,i=Math.min(e.length-n,2);o<i;++o)e[n+o]=(t&255<<8*(r?o:1-o))>>>8*(r?o:1-o)}function J(e,t,n,r){t<0&&(t=4294967295+t+1);for(var o=0,i=Math.min(e.length-n,4);o<i;++o)e[n+o]=t>>>8*(r?o:3-o)&255}function X(e,t,n,r,o,i){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function $(e,t,n,r,o){return o||X(e,0,n,4),v(e,t,n,r,23,4),n+4}function Z(e,t,n,r,o){return o||X(e,0,n,8),v(e,t,n,r,52,8),n+8}M.prototype.slice=function(e,t){var n,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),M.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=M.prototype;else{var o=t-e;n=new M(o,void 0);for(var i=0;i<o;++i)n[i]=this[i+e]}return n},M.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||W(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r},M.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||W(e,t,this.length);for(var r=this[e+--t],o=1;t>0&&(o*=256);)r+=this[e+--t]*o;return r},M.prototype.readUInt8=function(e,t){return t||W(e,1,this.length),this[e]},M.prototype.readUInt16LE=function(e,t){return t||W(e,2,this.length),this[e]|this[e+1]<<8},M.prototype.readUInt16BE=function(e,t){return t||W(e,2,this.length),this[e]<<8|this[e+1]},M.prototype.readUInt32LE=function(e,t){return t||W(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},M.prototype.readUInt32BE=function(e,t){return t||W(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},M.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||W(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r>=(o*=128)&&(r-=Math.pow(2,8*t)),r},M.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||W(e,t,this.length);for(var r=t,o=1,i=this[e+--r];r>0&&(o*=256);)i+=this[e+--r]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*t)),i},M.prototype.readInt8=function(e,t){return t||W(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},M.prototype.readInt16LE=function(e,t){t||W(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},M.prototype.readInt16BE=function(e,t){t||W(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},M.prototype.readInt32LE=function(e,t){return t||W(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},M.prototype.readInt32BE=function(e,t){return t||W(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},M.prototype.readFloatLE=function(e,t){return t||W(e,4,this.length),g(this,e,!0,23,4)},M.prototype.readFloatBE=function(e,t){return t||W(e,4,this.length),g(this,e,!1,23,4)},M.prototype.readDoubleLE=function(e,t){return t||W(e,8,this.length),g(this,e,!0,52,8)},M.prototype.readDoubleBE=function(e,t){return t||W(e,8,this.length),g(this,e,!1,52,8)},M.prototype.writeUIntLE=function(e,t,n,r){e=+e,t|=0,n|=0,r||Y(this,e,t,n,Math.pow(2,8*n)-1,0);var o=1,i=0;for(this[t]=255&e;++i<n&&(o*=256);)this[t+i]=e/o&255;return t+n},M.prototype.writeUIntBE=function(e,t,n,r){e=+e,t|=0,n|=0,r||Y(this,e,t,n,Math.pow(2,8*n)-1,0);var o=n-1,i=1;for(this[t+o]=255&e;--o>=0&&(i*=256);)this[t+o]=e/i&255;return t+n},M.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||Y(this,e,t,1,255,0),M.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},M.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||Y(this,e,t,2,65535,0),M.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):z(this,e,t,!0),t+2},M.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||Y(this,e,t,2,65535,0),M.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):z(this,e,t,!1),t+2},M.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||Y(this,e,t,4,4294967295,0),M.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):J(this,e,t,!0),t+4},M.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||Y(this,e,t,4,4294967295,0),M.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):J(this,e,t,!1),t+4},M.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var o=Math.pow(2,8*n-1);Y(this,e,t,n,o-1,-o)}var i=0,a=1,s=0;for(this[t]=255&e;++i<n&&(a*=256);)e<0&&0===s&&0!==this[t+i-1]&&(s=1),this[t+i]=(e/a>>0)-s&255;return t+n},M.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var o=Math.pow(2,8*n-1);Y(this,e,t,n,o-1,-o)}var i=n-1,a=1,s=0;for(this[t+i]=255&e;--i>=0&&(a*=256);)e<0&&0===s&&0!==this[t+i+1]&&(s=1),this[t+i]=(e/a>>0)-s&255;return t+n},M.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||Y(this,e,t,1,127,-128),M.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},M.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||Y(this,e,t,2,32767,-32768),M.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):z(this,e,t,!0),t+2},M.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||Y(this,e,t,2,32767,-32768),M.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):z(this,e,t,!1),t+2},M.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||Y(this,e,t,4,2147483647,-2147483648),M.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):J(this,e,t,!0),t+4},M.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||Y(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),M.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):J(this,e,t,!1),t+4},M.prototype.writeFloatLE=function(e,t,n){return $(this,e,t,!0,n)},M.prototype.writeFloatBE=function(e,t,n){return $(this,e,t,!1,n)},M.prototype.writeDoubleLE=function(e,t,n){return Z(this,e,t,!0,n)},M.prototype.writeDoubleBE=function(e,t,n){return Z(this,e,t,!1,n)},M.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var o,i=r-n;if(this===e&&n<t&&t<r)for(o=i-1;o>=0;--o)e[o+t]=this[o+n];else if(i<1e3||!M.TYPED_ARRAY_SUPPORT)for(o=0;o<i;++o)e[o+t]=this[o+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+i),t);return i},M.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var o=e.charCodeAt(0);o<256&&(e=o)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!M.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var i;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(i=t;i<n;++i)this[i]=e;else{var a=b(e)?e:te(new M(e,r).toString()),s=a.length;for(i=0;i<n-t;++i)this[i+t]=a[i%s]}return this};var Q=/[^+\/0-9A-Za-z-_]/g;function ee(e){return e<16?"0"+e.toString(16):e.toString(16)}function te(e,t){var n;t=t||1/0;for(var r=e.length,o=null,i=[],a=0;a<r;++a){if((n=e.charCodeAt(a))>55295&&n<57344){if(!o){if(n>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(a+1===r){(t-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(n<56320){(t-=3)>-1&&i.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(t-=3)>-1&&i.push(239,191,189);if(o=null,n<128){if((t-=1)<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function ne(e){return function(e){var t,n,r,o,i,a;d||f();var s=e.length;if(s%4>0)throw new Error("Invalid string. Length must be a multiple of 4");i="="===e[s-2]?2:"="===e[s-1]?1:0,a=new l(3*s/4-i),r=i>0?s-4:s;var u=0;for(t=0,n=0;t<r;t+=4,n+=3)o=c[e.charCodeAt(t)]<<18|c[e.charCodeAt(t+1)]<<12|c[e.charCodeAt(t+2)]<<6|c[e.charCodeAt(t+3)],a[u++]=o>>16&255,a[u++]=o>>8&255,a[u++]=255&o;return 2===i?(o=c[e.charCodeAt(t)]<<2|c[e.charCodeAt(t+1)]>>4,a[u++]=255&o):1===i&&(o=c[e.charCodeAt(t)]<<10|c[e.charCodeAt(t+1)]<<4|c[e.charCodeAt(t+2)]>>2,a[u++]=o>>8&255,a[u++]=255&o),a}(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(Q,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function re(e,t,n,r){for(var o=0;o<r&&!(o+n>=t.length||o>=e.length);++o)t[o+n]=e[o];return o}function oe(e){return null!=e&&(!!e._isBuffer||ie(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&ie(e.slice(0,0))}(e))}function ie(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}function ae(e,t){return e(t={exports:{}},t.exports),t.exports}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof e||"undefined"!=typeof self&&self;var se=ae((function(e,t){var n;e.exports=(n=n||function(e,t){var n=Object.create||function(){function e(){}return function(t){var n;return e.prototype=t,n=new e,e.prototype=null,n}}(),r={},o=r.lib={},i=o.Base={extend:function(e){var t=n(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},a=o.WordArray=i.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||u).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes,o=e.sigBytes;if(this.clamp(),r%4)for(var i=0;i<o;i++){var a=n[i>>>2]>>>24-i%4*8&255;t[r+i>>>2]|=a<<24-(r+i)%4*8}else for(i=0;i<o;i+=4)t[r+i>>>2]=n[i>>>2];return this.sigBytes+=o,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=i.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n,r=[],o=function(t){t=t;var n=987654321,r=4294967295;return function(){var o=((n=36969*(65535&n)+(n>>16)&r)<<16)+(t=18e3*(65535&t)+(t>>16)&r)&r;return o/=4294967296,(o+=.5)*(e.random()>.5?1:-1)}},i=0;i<t;i+=4){var s=o(4294967296*(n||e.random()));n=987654071*s(),r.push(4294967296*s()|0)}return new a.init(r,t)}}),s=r.enc={},u=s.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],o=0;o<n;o++){var i=t[o>>>2]>>>24-o%4*8&255;r.push((i>>>4).toString(16)),r.push((15&i).toString(16))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new a.init(n,t/2)}},c=s.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],o=0;o<n;o++){var i=t[o>>>2]>>>24-o%4*8&255;r.push(String.fromCharCode(i))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new a.init(n,t)}},l=s.Utf8={stringify:function(e){try{return decodeURIComponent(escape(c.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return c.parse(unescape(encodeURIComponent(e)))}},d=o.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new a.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=l.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,r=n.words,o=n.sigBytes,i=this.blockSize,s=4*i,u=o/s,c=(u=t?e.ceil(u):e.max((0|u)-this._minBufferSize,0))*i,l=e.min(4*c,o);if(c){for(var d=0;d<c;d+=i)this._doProcessBlock(r,d);var f=r.splice(0,c);n.sigBytes-=l}return new a.init(f,l)},clone:function(){var e=i.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),f=(o.Hasher=d.extend({cfg:i.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){d.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){e&&this._append(e);var t=this._doFinalize();return t},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new f.HMAC.init(e,n).finalize(t)}}}),r.algo={});return r}(Math),n)})),ue=(ae((function(e,t){var n,r,o,i,a,s;e.exports=(o=(r=n=se).lib,i=o.Base,a=o.WordArray,(s=r.x64={}).Word=i.extend({init:function(e,t){this.high=e,this.low=t}}),s.WordArray=i.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:8*e.length},toX32:function(){for(var e=this.words,t=e.length,n=[],r=0;r<t;r++){var o=e[r];n.push(o.high),n.push(o.low)}return a.create(n,this.sigBytes)},clone:function(){for(var e=i.clone.call(this),t=e.words=this.words.slice(0),n=t.length,r=0;r<n;r++)t[r]=t[r].clone();return e}}),n)})),ae((function(e,t){var n;e.exports=(n=se,function(){if("function"==typeof ArrayBuffer){var e=n.lib.WordArray,t=e.init;(e.init=function(e){if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),(e instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array)&&(e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),e instanceof Uint8Array){for(var n=e.byteLength,r=[],o=0;o<n;o++)r[o>>>2]|=e[o]<<24-o%4*8;t.call(this,r,n)}else t.apply(this,arguments)}).prototype=e}}(),n.lib.WordArray)})),ae((function(e,t){var n;e.exports=(n=se,function(){var e=n,t=e.lib.WordArray,r=e.enc;function o(e){return e<<8&4278255360|e>>>8&16711935}r.Utf16=r.Utf16BE={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],o=0;o<n;o+=2){var i=t[o>>>2]>>>16-o%4*8&65535;r.push(String.fromCharCode(i))}return r.join("")},parse:function(e){for(var n=e.length,r=[],o=0;o<n;o++)r[o>>>1]|=e.charCodeAt(o)<<16-o%2*16;return t.create(r,2*n)}},r.Utf16LE={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],i=0;i<n;i+=2){var a=o(t[i>>>2]>>>16-i%4*8&65535);r.push(String.fromCharCode(a))}return r.join("")},parse:function(e){for(var n=e.length,r=[],i=0;i<n;i++)r[i>>>1]|=o(e.charCodeAt(i)<<16-i%2*16);return t.create(r,2*n)}}}(),n.enc.Utf16)})),ae((function(e,t){var n,r,o;e.exports=(o=(r=n=se).lib.WordArray,r.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp();for(var o=[],i=0;i<n;i+=3)for(var a=(t[i>>>2]>>>24-i%4*8&255)<<16|(t[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|t[i+2>>>2]>>>24-(i+2)%4*8&255,s=0;s<4&&i+.75*s<n;s++)o.push(r.charAt(a>>>6*(3-s)&63));var u=r.charAt(64);if(u)for(;o.length%4;)o.push(u);return o.join("")},parse:function(e){var t=e.length,n=this._map,r=this._reverseMap;if(!r){r=this._reverseMap=[];for(var i=0;i<n.length;i++)r[n.charCodeAt(i)]=i}var a=n.charAt(64);if(a){var s=e.indexOf(a);-1!==s&&(t=s)}return function(e,t,n){for(var r=[],i=0,a=0;a<t;a++)if(a%4){var s=n[e.charCodeAt(a-1)]<<a%4*2,u=n[e.charCodeAt(a)]>>>6-a%4*2;r[i>>>2]|=(s|u)<<24-i%4*8,i++}return o.create(r,i)}(e,t,r)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},n.enc.Base64)})),ae((function(e,t){var n;e.exports=(n=se,function(e){var t=n,r=t.lib,o=r.WordArray,i=r.Hasher,a=t.algo,s=[];!function(){for(var t=0;t<64;t++)s[t]=4294967296*e.abs(e.sin(t+1))|0}();var u=a.MD5=i.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var n=0;n<16;n++){var r=t+n,o=e[r];e[r]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8)}var i=this._hash.words,a=e[t+0],u=e[t+1],p=e[t+2],h=e[t+3],g=e[t+4],v=e[t+5],_=e[t+6],m=e[t+7],y=e[t+8],I=e[t+9],M=e[t+10],T=e[t+11],S=e[t+12],E=e[t+13],C=e[t+14],k=e[t+15],b=i[0],D=i[1],A=i[2],O=i[3];b=c(b,D,A,O,a,7,s[0]),O=c(O,b,D,A,u,12,s[1]),A=c(A,O,b,D,p,17,s[2]),D=c(D,A,O,b,h,22,s[3]),b=c(b,D,A,O,g,7,s[4]),O=c(O,b,D,A,v,12,s[5]),A=c(A,O,b,D,_,17,s[6]),D=c(D,A,O,b,m,22,s[7]),b=c(b,D,A,O,y,7,s[8]),O=c(O,b,D,A,I,12,s[9]),A=c(A,O,b,D,M,17,s[10]),D=c(D,A,O,b,T,22,s[11]),b=c(b,D,A,O,S,7,s[12]),O=c(O,b,D,A,E,12,s[13]),A=c(A,O,b,D,C,17,s[14]),b=l(b,D=c(D,A,O,b,k,22,s[15]),A,O,u,5,s[16]),O=l(O,b,D,A,_,9,s[17]),A=l(A,O,b,D,T,14,s[18]),D=l(D,A,O,b,a,20,s[19]),b=l(b,D,A,O,v,5,s[20]),O=l(O,b,D,A,M,9,s[21]),A=l(A,O,b,D,k,14,s[22]),D=l(D,A,O,b,g,20,s[23]),b=l(b,D,A,O,I,5,s[24]),O=l(O,b,D,A,C,9,s[25]),A=l(A,O,b,D,h,14,s[26]),D=l(D,A,O,b,y,20,s[27]),b=l(b,D,A,O,E,5,s[28]),O=l(O,b,D,A,p,9,s[29]),A=l(A,O,b,D,m,14,s[30]),b=d(b,D=l(D,A,O,b,S,20,s[31]),A,O,v,4,s[32]),O=d(O,b,D,A,y,11,s[33]),A=d(A,O,b,D,T,16,s[34]),D=d(D,A,O,b,C,23,s[35]),b=d(b,D,A,O,u,4,s[36]),O=d(O,b,D,A,g,11,s[37]),A=d(A,O,b,D,m,16,s[38]),D=d(D,A,O,b,M,23,s[39]),b=d(b,D,A,O,E,4,s[40]),O=d(O,b,D,A,a,11,s[41]),A=d(A,O,b,D,h,16,s[42]),D=d(D,A,O,b,_,23,s[43]),b=d(b,D,A,O,I,4,s[44]),O=d(O,b,D,A,S,11,s[45]),A=d(A,O,b,D,k,16,s[46]),b=f(b,D=d(D,A,O,b,p,23,s[47]),A,O,a,6,s[48]),O=f(O,b,D,A,m,10,s[49]),A=f(A,O,b,D,C,15,s[50]),D=f(D,A,O,b,v,21,s[51]),b=f(b,D,A,O,S,6,s[52]),O=f(O,b,D,A,h,10,s[53]),A=f(A,O,b,D,M,15,s[54]),D=f(D,A,O,b,u,21,s[55]),b=f(b,D,A,O,y,6,s[56]),O=f(O,b,D,A,k,10,s[57]),A=f(A,O,b,D,_,15,s[58]),D=f(D,A,O,b,E,21,s[59]),b=f(b,D,A,O,g,6,s[60]),O=f(O,b,D,A,T,10,s[61]),A=f(A,O,b,D,p,15,s[62]),D=f(D,A,O,b,I,21,s[63]),i[0]=i[0]+b|0,i[1]=i[1]+D|0,i[2]=i[2]+A|0,i[3]=i[3]+O|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,o=8*t.sigBytes;n[o>>>5]|=128<<24-o%32;var i=e.floor(r/4294967296),a=r;n[15+(o+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),n[14+(o+64>>>9<<4)]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),t.sigBytes=4*(n.length+1),this._process();for(var s=this._hash,u=s.words,c=0;c<4;c++){var l=u[c];u[c]=16711935&(l<<8|l>>>24)|4278255360&(l<<24|l>>>8)}return s},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});function c(e,t,n,r,o,i,a){var s=e+(t&n|~t&r)+o+a;return(s<<i|s>>>32-i)+t}function l(e,t,n,r,o,i,a){var s=e+(t&r|n&~r)+o+a;return(s<<i|s>>>32-i)+t}function d(e,t,n,r,o,i,a){var s=e+(t^n^r)+o+a;return(s<<i|s>>>32-i)+t}function f(e,t,n,r,o,i,a){var s=e+(n^(t|~r))+o+a;return(s<<i|s>>>32-i)+t}t.MD5=i._createHelper(u),t.HmacMD5=i._createHmacHelper(u)}(Math),n.MD5)})),ae((function(e,t){var n,r,o,i,a,s,u,c;e.exports=(o=(r=n=se).lib,i=o.WordArray,a=o.Hasher,s=r.algo,u=[],c=s.SHA1=a.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],o=n[1],i=n[2],a=n[3],s=n[4],c=0;c<80;c++){if(c<16)u[c]=0|e[t+c];else{var l=u[c-3]^u[c-8]^u[c-14]^u[c-16];u[c]=l<<1|l>>>31}var d=(r<<5|r>>>27)+s+u[c];d+=c<20?1518500249+(o&i|~o&a):c<40?1859775393+(o^i^a):c<60?(o&i|o&a|i&a)-1894007588:(o^i^a)-899497514,s=a,a=i,i=o<<30|o>>>2,o=r,r=d}n[0]=n[0]+r|0,n[1]=n[1]+o|0,n[2]=n[2]+i|0,n[3]=n[3]+a|0,n[4]=n[4]+s|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;return t[r>>>5]|=128<<24-r%32,t[14+(r+64>>>9<<4)]=Math.floor(n/4294967296),t[15+(r+64>>>9<<4)]=n,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=a.clone.call(this);return e._hash=this._hash.clone(),e}}),r.SHA1=a._createHelper(c),r.HmacSHA1=a._createHmacHelper(c),n.SHA1)})),ae((function(e,t){var n;e.exports=(n=se,function(e){var t=n,r=t.lib,o=r.WordArray,i=r.Hasher,a=t.algo,s=[],u=[];!function(){function t(t){for(var n=e.sqrt(t),r=2;r<=n;r++)if(!(t%r))return!1;return!0}function n(e){return 4294967296*(e-(0|e))|0}for(var r=2,o=0;o<64;)t(r)&&(o<8&&(s[o]=n(e.pow(r,.5))),u[o]=n(e.pow(r,1/3)),o++),r++}();var c=[],l=a.SHA256=i.extend({_doReset:function(){this._hash=new o.init(s.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],o=n[1],i=n[2],a=n[3],s=n[4],l=n[5],d=n[6],f=n[7],p=0;p<64;p++){if(p<16)c[p]=0|e[t+p];else{var h=c[p-15],g=(h<<25|h>>>7)^(h<<14|h>>>18)^h>>>3,v=c[p-2],_=(v<<15|v>>>17)^(v<<13|v>>>19)^v>>>10;c[p]=g+c[p-7]+_+c[p-16]}var m=r&o^r&i^o&i,y=(r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22),I=f+((s<<26|s>>>6)^(s<<21|s>>>11)^(s<<7|s>>>25))+(s&l^~s&d)+u[p]+c[p];f=d,d=l,l=s,s=a+I|0,a=i,i=o,o=r,r=I+(y+m)|0}n[0]=n[0]+r|0,n[1]=n[1]+o|0,n[2]=n[2]+i|0,n[3]=n[3]+a|0,n[4]=n[4]+s|0,n[5]=n[5]+l|0,n[6]=n[6]+d|0,n[7]=n[7]+f|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,o=8*t.sigBytes;return n[o>>>5]|=128<<24-o%32,n[14+(o+64>>>9<<4)]=e.floor(r/4294967296),n[15+(o+64>>>9<<4)]=r,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=i._createHelper(l),t.HmacSHA256=i._createHmacHelper(l)}(Math),n.SHA256)})),ae((function(e,t){var n,r,o,i,a,s;e.exports=(o=(r=n=se).lib.WordArray,i=r.algo,a=i.SHA256,s=i.SHA224=a.extend({_doReset:function(){this._hash=new o.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var e=a._doFinalize.call(this);return e.sigBytes-=4,e}}),r.SHA224=a._createHelper(s),r.HmacSHA224=a._createHmacHelper(s),n.SHA224)})),ae((function(e,t){var n;e.exports=(n=se,function(){var e=n,t=e.lib.Hasher,r=e.x64,o=r.Word,i=r.WordArray,a=e.algo;function s(){return o.create.apply(o,arguments)}var u=[s(1116352408,3609767458),s(1899447441,602891725),s(3049323471,3964484399),s(3921009573,2173295548),s(961987163,4081628472),s(1508970993,3053834265),s(2453635748,2937671579),s(2870763221,3664609560),s(3624381080,2734883394),s(310598401,1164996542),s(607225278,1323610764),s(1426881987,3590304994),s(1925078388,4068182383),s(2162078206,991336113),s(2614888103,633803317),s(3248222580,3479774868),s(3835390401,2666613458),s(4022224774,944711139),s(264347078,2341262773),s(604807628,2007800933),s(770255983,1495990901),s(1249150122,1856431235),s(1555081692,3175218132),s(1996064986,2198950837),s(2554220882,3999719339),s(2821834349,766784016),s(2952996808,2566594879),s(3210313671,3203337956),s(3336571891,1034457026),s(3584528711,2466948901),s(113926993,3758326383),s(338241895,168717936),s(666307205,1188179964),s(773529912,1546045734),s(1294757372,1522805485),s(1396182291,2643833823),s(1695183700,2343527390),s(1986661051,1014477480),s(2177026350,1206759142),s(2456956037,344077627),s(2730485921,1290863460),s(2820302411,3158454273),s(3259730800,3505952657),s(3345764771,106217008),s(3516065817,3606008344),s(3600352804,1432725776),s(4094571909,1467031594),s(275423344,851169720),s(430227734,3100823752),s(506948616,1363258195),s(659060556,3750685593),s(883997877,3785050280),s(958139571,3318307427),s(1322822218,3812723403),s(1537002063,2003034995),s(1747873779,3602036899),s(1955562222,1575990012),s(2024104815,1125592928),s(2227730452,2716904306),s(2361852424,442776044),s(2428436474,593698344),s(2756734187,3733110249),s(3204031479,2999351573),s(3329325298,3815920427),s(3391569614,3928383900),s(3515267271,566280711),s(3940187606,3454069534),s(4118630271,4000239992),s(116418474,1914138554),s(174292421,2731055270),s(289380356,3203993006),s(460393269,320620315),s(685471733,587496836),s(852142971,1086792851),s(1017036298,365543100),s(1126000580,2618297676),s(1288033470,3409855158),s(1501505948,4234509866),s(1607167915,987167468),s(1816402316,1246189591)],c=[];!function(){for(var e=0;e<80;e++)c[e]=s()}();var l=a.SHA512=t.extend({_doReset:function(){this._hash=new i.init([new o.init(1779033703,4089235720),new o.init(3144134277,2227873595),new o.init(1013904242,4271175723),new o.init(2773480762,1595750129),new o.init(1359893119,2917565137),new o.init(2600822924,725511199),new o.init(528734635,4215389547),new o.init(1541459225,327033209)])},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],o=n[1],i=n[2],a=n[3],s=n[4],l=n[5],d=n[6],f=n[7],p=r.high,h=r.low,g=o.high,v=o.low,_=i.high,m=i.low,y=a.high,I=a.low,M=s.high,T=s.low,S=l.high,E=l.low,C=d.high,k=d.low,b=f.high,D=f.low,A=p,O=h,R=g,N=v,w=_,L=m,P=y,U=I,G=M,x=T,F=S,q=E,V=C,B=k,j=b,H=D,K=0;K<80;K++){var W=c[K];if(K<16)var Y=W.high=0|e[t+2*K],z=W.low=0|e[t+2*K+1];else{var J=c[K-15],X=J.high,$=J.low,Z=(X>>>1|$<<31)^(X>>>8|$<<24)^X>>>7,Q=($>>>1|X<<31)^($>>>8|X<<24)^($>>>7|X<<25),ee=c[K-2],te=ee.high,ne=ee.low,re=(te>>>19|ne<<13)^(te<<3|ne>>>29)^te>>>6,oe=(ne>>>19|te<<13)^(ne<<3|te>>>29)^(ne>>>6|te<<26),ie=c[K-7],ae=ie.high,se=ie.low,ue=c[K-16],ce=ue.high,le=ue.low;Y=(Y=(Y=Z+ae+((z=Q+se)>>>0<Q>>>0?1:0))+re+((z+=oe)>>>0<oe>>>0?1:0))+ce+((z+=le)>>>0<le>>>0?1:0),W.high=Y,W.low=z}var de,fe=G&F^~G&V,pe=x&q^~x&B,he=A&R^A&w^R&w,ge=O&N^O&L^N&L,ve=(A>>>28|O<<4)^(A<<30|O>>>2)^(A<<25|O>>>7),_e=(O>>>28|A<<4)^(O<<30|A>>>2)^(O<<25|A>>>7),me=(G>>>14|x<<18)^(G>>>18|x<<14)^(G<<23|x>>>9),ye=(x>>>14|G<<18)^(x>>>18|G<<14)^(x<<23|G>>>9),Ie=u[K],Me=Ie.high,Te=Ie.low,Se=j+me+((de=H+ye)>>>0<H>>>0?1:0),Ee=_e+ge;j=V,H=B,V=F,B=q,F=G,q=x,G=P+(Se=(Se=(Se=Se+fe+((de+=pe)>>>0<pe>>>0?1:0))+Me+((de+=Te)>>>0<Te>>>0?1:0))+Y+((de+=z)>>>0<z>>>0?1:0))+((x=U+de|0)>>>0<U>>>0?1:0)|0,P=w,U=L,w=R,L=N,R=A,N=O,A=Se+(ve+he+(Ee>>>0<_e>>>0?1:0))+((O=de+Ee|0)>>>0<de>>>0?1:0)|0}h=r.low=h+O,r.high=p+A+(h>>>0<O>>>0?1:0),v=o.low=v+N,o.high=g+R+(v>>>0<N>>>0?1:0),m=i.low=m+L,i.high=_+w+(m>>>0<L>>>0?1:0),I=a.low=I+U,a.high=y+P+(I>>>0<U>>>0?1:0),T=s.low=T+x,s.high=M+G+(T>>>0<x>>>0?1:0),E=l.low=E+q,l.high=S+F+(E>>>0<q>>>0?1:0),k=d.low=k+B,d.high=C+V+(k>>>0<B>>>0?1:0),D=f.low=D+H,f.high=b+j+(D>>>0<H>>>0?1:0)},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;return t[r>>>5]|=128<<24-r%32,t[30+(r+128>>>10<<5)]=Math.floor(n/4294967296),t[31+(r+128>>>10<<5)]=n,e.sigBytes=4*t.length,this._process(),this._hash.toX32()},clone:function(){var e=t.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:32});e.SHA512=t._createHelper(l),e.HmacSHA512=t._createHmacHelper(l)}(),n.SHA512)})),ae((function(e,t){var n,r,o,i,a,s,u,c;e.exports=(o=(r=n=se).x64,i=o.Word,a=o.WordArray,s=r.algo,u=s.SHA512,c=s.SHA384=u.extend({_doReset:function(){this._hash=new a.init([new i.init(3418070365,3238371032),new i.init(1654270250,914150663),new i.init(2438529370,812702999),new i.init(355462360,4144912697),new i.init(1731405415,4290775857),new i.init(2394180231,1750603025),new i.init(3675008525,1694076839),new i.init(1203062813,3204075428)])},_doFinalize:function(){var e=u._doFinalize.call(this);return e.sigBytes-=16,e}}),r.SHA384=u._createHelper(c),r.HmacSHA384=u._createHmacHelper(c),n.SHA384)})),ae((function(e,t){var n;e.exports=(n=se,function(e){var t=n,r=t.lib,o=r.WordArray,i=r.Hasher,a=t.x64.Word,s=t.algo,u=[],c=[],l=[];!function(){for(var e=1,t=0,n=0;n<24;n++){u[e+5*t]=(n+1)*(n+2)/2%64;var r=(2*e+3*t)%5;e=t%5,t=r}for(e=0;e<5;e++)for(t=0;t<5;t++)c[e+5*t]=t+(2*e+3*t)%5*5;for(var o=1,i=0;i<24;i++){for(var s=0,d=0,f=0;f<7;f++){if(1&o){var p=(1<<f)-1;p<32?d^=1<<p:s^=1<<p-32}128&o?o=o<<1^113:o<<=1}l[i]=a.create(s,d)}}();var d=[];!function(){for(var e=0;e<25;e++)d[e]=a.create()}();var f=s.SHA3=i.extend({cfg:i.cfg.extend({outputLength:512}),_doReset:function(){for(var e=this._state=[],t=0;t<25;t++)e[t]=new a.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(e,t){for(var n=this._state,r=this.blockSize/2,o=0;o<r;o++){var i=e[t+2*o],a=e[t+2*o+1];i=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),a=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),(D=n[o]).high^=a,D.low^=i}for(var s=0;s<24;s++){for(var f=0;f<5;f++){for(var p=0,h=0,g=0;g<5;g++)p^=(D=n[f+5*g]).high,h^=D.low;var v=d[f];v.high=p,v.low=h}for(f=0;f<5;f++){var _=d[(f+4)%5],m=d[(f+1)%5],y=m.high,I=m.low;for(p=_.high^(y<<1|I>>>31),h=_.low^(I<<1|y>>>31),g=0;g<5;g++)(D=n[f+5*g]).high^=p,D.low^=h}for(var M=1;M<25;M++){var T=(D=n[M]).high,S=D.low,E=u[M];E<32?(p=T<<E|S>>>32-E,h=S<<E|T>>>32-E):(p=S<<E-32|T>>>64-E,h=T<<E-32|S>>>64-E);var C=d[c[M]];C.high=p,C.low=h}var k=d[0],b=n[0];for(k.high=b.high,k.low=b.low,f=0;f<5;f++)for(g=0;g<5;g++){var D=n[M=f+5*g],A=d[M],O=d[(f+1)%5+5*g],R=d[(f+2)%5+5*g];D.high=A.high^~O.high&R.high,D.low=A.low^~O.low&R.low}D=n[0];var N=l[s];D.high^=N.high,D.low^=N.low}},_doFinalize:function(){var t=this._data,n=t.words,r=(this._nDataBytes,8*t.sigBytes),i=32*this.blockSize;n[r>>>5]|=1<<24-r%32,n[(e.ceil((r+1)/i)*i>>>5)-1]|=128,t.sigBytes=4*n.length,this._process();for(var a=this._state,s=this.cfg.outputLength/8,u=s/8,c=[],l=0;l<u;l++){var d=a[l],f=d.high,p=d.low;f=16711935&(f<<8|f>>>24)|4278255360&(f<<24|f>>>8),p=16711935&(p<<8|p>>>24)|4278255360&(p<<24|p>>>8),c.push(p),c.push(f)}return new o.init(c,s)},clone:function(){for(var e=i.clone.call(this),t=e._state=this._state.slice(0),n=0;n<25;n++)t[n]=t[n].clone();return e}});t.SHA3=i._createHelper(f),t.HmacSHA3=i._createHmacHelper(f)}(Math),n.SHA3)})),ae((function(e,t){var n;e.exports=(n=se,function(e){var t=n,r=t.lib,o=r.WordArray,i=r.Hasher,a=t.algo,s=o.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),u=o.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),c=o.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),l=o.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),d=o.create([0,1518500249,1859775393,2400959708,2840853838]),f=o.create([1352829926,1548603684,1836072691,2053994217,0]),p=a.RIPEMD160=i.extend({_doReset:function(){this._hash=o.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=0;n<16;n++){var r=t+n,o=e[r];e[r]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8)}var i,a,p,I,M,T,S,E,C,k,b,D=this._hash.words,A=d.words,O=f.words,R=s.words,N=u.words,w=c.words,L=l.words;for(T=i=D[0],S=a=D[1],E=p=D[2],C=I=D[3],k=M=D[4],n=0;n<80;n+=1)b=i+e[t+R[n]]|0,b+=n<16?h(a,p,I)+A[0]:n<32?g(a,p,I)+A[1]:n<48?v(a,p,I)+A[2]:n<64?_(a,p,I)+A[3]:m(a,p,I)+A[4],b=(b=y(b|=0,w[n]))+M|0,i=M,M=I,I=y(p,10),p=a,a=b,b=T+e[t+N[n]]|0,b+=n<16?m(S,E,C)+O[0]:n<32?_(S,E,C)+O[1]:n<48?v(S,E,C)+O[2]:n<64?g(S,E,C)+O[3]:h(S,E,C)+O[4],b=(b=y(b|=0,L[n]))+k|0,T=k,k=C,C=y(E,10),E=S,S=b;b=D[1]+p+C|0,D[1]=D[2]+I+k|0,D[2]=D[3]+M+T|0,D[3]=D[4]+i+S|0,D[4]=D[0]+a+E|0,D[0]=b},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;t[r>>>5]|=128<<24-r%32,t[14+(r+64>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),e.sigBytes=4*(t.length+1),this._process();for(var o=this._hash,i=o.words,a=0;a<5;a++){var s=i[a];i[a]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8)}return o},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});function h(e,t,n){return e^t^n}function g(e,t,n){return e&t|~e&n}function v(e,t,n){return(e|~t)^n}function _(e,t,n){return e&n|t&~n}function m(e,t,n){return e^(t|~n)}function y(e,t){return e<<t|e>>>32-t}t.RIPEMD160=i._createHelper(p),t.HmacRIPEMD160=i._createHmacHelper(p)}(),n.RIPEMD160)})),ae((function(e,t){var n,r,o,i,a,s;e.exports=(r=(n=se).lib,o=r.Base,i=n.enc,a=i.Utf8,s=n.algo,void(s.HMAC=o.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=a.parse(t));var n=e.blockSize,r=4*n;t.sigBytes>r&&(t=e.finalize(t)),t.clamp();for(var o=this._oKey=t.clone(),i=this._iKey=t.clone(),s=o.words,u=i.words,c=0;c<n;c++)s[c]^=1549556828,u[c]^=909522486;o.sigBytes=i.sigBytes=r,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,n=t.finalize(e);t.reset();var r=t.finalize(this._oKey.clone().concat(n));return r}})))})),ae((function(e,t){var n,r,o,i,a,s,u,c,l;e.exports=(o=(r=n=se).lib,i=o.Base,a=o.WordArray,s=r.algo,u=s.SHA1,c=s.HMAC,l=s.PBKDF2=i.extend({cfg:i.extend({keySize:4,hasher:u,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=this.cfg,r=c.create(n.hasher,e),o=a.create(),i=a.create([1]),s=o.words,u=i.words,l=n.keySize,d=n.iterations;s.length<l;){var f=r.update(t).finalize(i);r.reset();for(var p=f.words,h=p.length,g=f,v=1;v<d;v++){g=r.finalize(g),r.reset();for(var _=g.words,m=0;m<h;m++)p[m]^=_[m]}o.concat(f),u[0]++}return o.sigBytes=4*l,o}}),r.PBKDF2=function(e,t,n){return l.create(n).compute(e,t)},n.PBKDF2)})),ae((function(e,t){var n,r,o,i,a,s,u,c;e.exports=(o=(r=n=se).lib,i=o.Base,a=o.WordArray,s=r.algo,u=s.MD5,c=s.EvpKDF=i.extend({cfg:i.extend({keySize:4,hasher:u,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=this.cfg,r=n.hasher.create(),o=a.create(),i=o.words,s=n.keySize,u=n.iterations;i.length<s;){c&&r.update(c);var c=r.update(e).finalize(t);r.reset();for(var l=1;l<u;l++)c=r.finalize(c),r.reset();o.concat(c)}return o.sigBytes=4*s,o}}),r.EvpKDF=function(e,t,n){return c.create(n).compute(e,t)},n.EvpKDF)})),ae((function(e,t){var n,r,o,i,a,s,u,c,l,d,f,p,h,g,v,_,m,y,I,M,T,S,E;e.exports=void((n=se).lib.Cipher||(r=n,o=r.lib,i=o.Base,a=o.WordArray,s=o.BufferedBlockAlgorithm,u=r.enc,u.Utf8,c=u.Base64,l=r.algo,d=l.EvpKDF,f=o.Cipher=s.extend({cfg:i.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,n){this.cfg=this.cfg.extend(n),this._xformMode=e,this._key=t,this.reset()},reset:function(){s.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){e&&this._append(e);var t=this._doFinalize();return t},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function e(e){return"string"==typeof e?E:M}return function(t){return{encrypt:function(n,r,o){return e(r).encrypt(t,n,r,o)},decrypt:function(n,r,o){return e(r).decrypt(t,n,r,o)}}}}()}),o.StreamCipher=f.extend({_doFinalize:function(){var e=this._process(!0);return e},blockSize:1}),p=r.mode={},h=o.BlockCipherMode=i.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}}),g=p.CBC=function(){var e=h.extend();function t(e,t,n){var r=this._iv;if(r){var o=r;this._iv=void 0}else o=this._prevBlock;for(var i=0;i<n;i++)e[t+i]^=o[i]}return e.Encryptor=e.extend({processBlock:function(e,n){var r=this._cipher,o=r.blockSize;t.call(this,e,n,o),r.encryptBlock(e,n),this._prevBlock=e.slice(n,n+o)}}),e.Decryptor=e.extend({processBlock:function(e,n){var r=this._cipher,o=r.blockSize,i=e.slice(n,n+o);r.decryptBlock(e,n),t.call(this,e,n,o),this._prevBlock=i}}),e}(),v=r.pad={},_=v.Pkcs7={pad:function(e,t){for(var n=4*t,r=n-e.sigBytes%n,o=r<<24|r<<16|r<<8|r,i=[],s=0;s<r;s+=4)i.push(o);var u=a.create(i,r);e.concat(u)},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},o.BlockCipher=f.extend({cfg:f.cfg.extend({mode:g,padding:_}),reset:function(){f.reset.call(this);var e=this.cfg,t=e.iv,n=e.mode;if(this._xformMode==this._ENC_XFORM_MODE)var r=n.createEncryptor;else{r=n.createDecryptor;this._minBufferSize=1}this._mode&&this._mode.__creator==r?this._mode.init(this,t&&t.words):(this._mode=r.call(n,this,t&&t.words),this._mode.__creator=r)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else{t=this._process(!0);e.unpad(t)}return t},blockSize:4}),m=o.CipherParams=i.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),y=r.format={},I=y.OpenSSL={stringify:function(e){var t=e.ciphertext,n=e.salt;if(n)var r=a.create([1398893684,1701076831]).concat(n).concat(t);else r=t;return r.toString(c)},parse:function(e){var t=c.parse(e),n=t.words;if(1398893684==n[0]&&1701076831==n[1]){var r=a.create(n.slice(2,4));n.splice(0,4),t.sigBytes-=16}return m.create({ciphertext:t,salt:r})}},M=o.SerializableCipher=i.extend({cfg:i.extend({format:I}),encrypt:function(e,t,n,r){r=this.cfg.extend(r);var o=e.createEncryptor(n,r),i=o.finalize(t),a=o.cfg;return m.create({ciphertext:i,key:n,iv:a.iv,algorithm:e,mode:a.mode,padding:a.padding,blockSize:e.blockSize,formatter:r.format})},decrypt:function(e,t,n,r){r=this.cfg.extend(r),t=this._parse(t,r.format);var o=e.createDecryptor(n,r).finalize(t.ciphertext);return o},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}}),T=r.kdf={},S=T.OpenSSL={execute:function(e,t,n,r){r||(r=a.random(8));var o=d.create({keySize:t+n}).compute(e,r),i=a.create(o.words.slice(t),4*n);return o.sigBytes=4*t,m.create({key:o,iv:i,salt:r})}},E=o.PasswordBasedCipher=M.extend({cfg:M.cfg.extend({kdf:S}),encrypt:function(e,t,n,r){var o=(r=this.cfg.extend(r)).kdf.execute(n,e.keySize,e.ivSize);r.iv=o.iv;var i=M.encrypt.call(this,e,t,o.key,r);return i.mixIn(o),i},decrypt:function(e,t,n,r){r=this.cfg.extend(r),t=this._parse(t,r.format);var o=r.kdf.execute(n,e.keySize,e.ivSize,t.salt);r.iv=o.iv;var i=M.decrypt.call(this,e,t,o.key,r);return i}})))})),ae((function(e,t){var n;e.exports=((n=se).mode.CFB=function(){var e=n.lib.BlockCipherMode.extend();function t(e,t,n,r){var o=this._iv;if(o){var i=o.slice(0);this._iv=void 0}else i=this._prevBlock;r.encryptBlock(i,0);for(var a=0;a<n;a++)e[t+a]^=i[a]}return e.Encryptor=e.extend({processBlock:function(e,n){var r=this._cipher,o=r.blockSize;t.call(this,e,n,o,r),this._prevBlock=e.slice(n,n+o)}}),e.Decryptor=e.extend({processBlock:function(e,n){var r=this._cipher,o=r.blockSize,i=e.slice(n,n+o);t.call(this,e,n,o,r),this._prevBlock=i}}),e}(),n.mode.CFB)})),ae((function(e,t){var n,r,o;e.exports=((n=se).mode.CTR=(r=n.lib.BlockCipherMode.extend(),o=r.Encryptor=r.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,o=this._iv,i=this._counter;o&&(i=this._counter=o.slice(0),this._iv=void 0);var a=i.slice(0);n.encryptBlock(a,0),i[r-1]=i[r-1]+1|0;for(var s=0;s<r;s++)e[t+s]^=a[s]}}),r.Decryptor=o,r),n.mode.CTR)})),ae((function(e,t){var n;e.exports=((n=se).mode.CTRGladman=function(){var e=n.lib.BlockCipherMode.extend();function t(e){if(255==(e>>24&255)){var t=e>>16&255,n=e>>8&255,r=255&e;255===t?(t=0,255===n?(n=0,255===r?r=0:++r):++n):++t,e=0,e+=t<<16,e+=n<<8,e+=r}else e+=1<<24;return e}var r=e.Encryptor=e.extend({processBlock:function(e,n){var r=this._cipher,o=r.blockSize,i=this._iv,a=this._counter;i&&(a=this._counter=i.slice(0),this._iv=void 0),function(e){0===(e[0]=t(e[0]))&&(e[1]=t(e[1]))}(a);var s=a.slice(0);r.encryptBlock(s,0);for(var u=0;u<o;u++)e[n+u]^=s[u]}});return e.Decryptor=r,e}(),n.mode.CTRGladman)})),ae((function(e,t){var n,r,o;e.exports=((n=se).mode.OFB=(r=n.lib.BlockCipherMode.extend(),o=r.Encryptor=r.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,o=this._iv,i=this._keystream;o&&(i=this._keystream=o.slice(0),this._iv=void 0),n.encryptBlock(i,0);for(var a=0;a<r;a++)e[t+a]^=i[a]}}),r.Decryptor=o,r),n.mode.OFB)})),ae((function(e,t){var n,r;e.exports=((n=se).mode.ECB=((r=n.lib.BlockCipherMode.extend()).Encryptor=r.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),r.Decryptor=r.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),r),n.mode.ECB)})),ae((function(e,t){var n;e.exports=((n=se).pad.AnsiX923={pad:function(e,t){var n=e.sigBytes,r=4*t,o=r-n%r,i=n+o-1;e.clamp(),e.words[i>>>2]|=o<<24-i%4*8,e.sigBytes+=o},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},n.pad.Ansix923)})),ae((function(e,t){var n;e.exports=((n=se).pad.Iso10126={pad:function(e,t){var r=4*t,o=r-e.sigBytes%r;e.concat(n.lib.WordArray.random(o-1)).concat(n.lib.WordArray.create([o<<24],1))},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},n.pad.Iso10126)})),ae((function(e,t){var n;e.exports=((n=se).pad.Iso97971={pad:function(e,t){e.concat(n.lib.WordArray.create([2147483648],1)),n.pad.ZeroPadding.pad(e,t)},unpad:function(e){n.pad.ZeroPadding.unpad(e),e.sigBytes--}},n.pad.Iso97971)})),ae((function(e,t){var n;e.exports=((n=se).pad.ZeroPadding={pad:function(e,t){var n=4*t;e.clamp(),e.sigBytes+=n-(e.sigBytes%n||n)},unpad:function(e){for(var t=e.words,n=e.sigBytes-1;!(t[n>>>2]>>>24-n%4*8&255);)n--;e.sigBytes=n+1}},n.pad.ZeroPadding)})),ae((function(e,t){var n;e.exports=((n=se).pad.NoPadding={pad:function(){},unpad:function(){}},n.pad.NoPadding)})),ae((function(e,t){var n,r,o,i;e.exports=(o=(r=n=se).lib.CipherParams,i=r.enc.Hex,r.format.Hex={stringify:function(e){return e.ciphertext.toString(i)},parse:function(e){var t=i.parse(e);return o.create({ciphertext:t})}},n.format.Hex)})),ae((function(e,t){var n;e.exports=(n=se,function(){var e=n,t=e.lib.BlockCipher,r=e.algo,o=[],i=[],a=[],s=[],u=[],c=[],l=[],d=[],f=[],p=[];!function(){for(var e=[],t=0;t<256;t++)e[t]=t<128?t<<1:t<<1^283;var n=0,r=0;for(t=0;t<256;t++){var h=r^r<<1^r<<2^r<<3^r<<4;h=h>>>8^255&h^99,o[n]=h,i[h]=n;var g=e[n],v=e[g],_=e[v],m=257*e[h]^16843008*h;a[n]=m<<24|m>>>8,s[n]=m<<16|m>>>16,u[n]=m<<8|m>>>24,c[n]=m,m=16843009*_^65537*v^257*g^16843008*n,l[h]=m<<24|m>>>8,d[h]=m<<16|m>>>16,f[h]=m<<8|m>>>24,p[h]=m,n?(n=g^e[e[e[_^g]]],r^=e[e[r]]):n=r=1}}();var h=[0,1,2,4,8,16,32,64,128,27,54],g=r.AES=t.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var e=this._keyPriorReset=this._key,t=e.words,n=e.sigBytes/4,r=4*((this._nRounds=n+6)+1),i=this._keySchedule=[],a=0;a<r;a++)if(a<n)i[a]=t[a];else{var s=i[a-1];a%n?n>6&&a%n==4&&(s=o[s>>>24]<<24|o[s>>>16&255]<<16|o[s>>>8&255]<<8|o[255&s]):(s=o[(s=s<<8|s>>>24)>>>24]<<24|o[s>>>16&255]<<16|o[s>>>8&255]<<8|o[255&s],s^=h[a/n|0]<<24),i[a]=i[a-n]^s}for(var u=this._invKeySchedule=[],c=0;c<r;c++)a=r-c,s=c%4?i[a]:i[a-4],u[c]=c<4||a<=4?s:l[o[s>>>24]]^d[o[s>>>16&255]]^f[o[s>>>8&255]]^p[o[255&s]]}},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,a,s,u,c,o)},decryptBlock:function(e,t){var n=e[t+1];e[t+1]=e[t+3],e[t+3]=n,this._doCryptBlock(e,t,this._invKeySchedule,l,d,f,p,i),n=e[t+1],e[t+1]=e[t+3],e[t+3]=n},_doCryptBlock:function(e,t,n,r,o,i,a,s){for(var u=this._nRounds,c=e[t]^n[0],l=e[t+1]^n[1],d=e[t+2]^n[2],f=e[t+3]^n[3],p=4,h=1;h<u;h++){var g=r[c>>>24]^o[l>>>16&255]^i[d>>>8&255]^a[255&f]^n[p++],v=r[l>>>24]^o[d>>>16&255]^i[f>>>8&255]^a[255&c]^n[p++],_=r[d>>>24]^o[f>>>16&255]^i[c>>>8&255]^a[255&l]^n[p++],m=r[f>>>24]^o[c>>>16&255]^i[l>>>8&255]^a[255&d]^n[p++];c=g,l=v,d=_,f=m}g=(s[c>>>24]<<24|s[l>>>16&255]<<16|s[d>>>8&255]<<8|s[255&f])^n[p++],v=(s[l>>>24]<<24|s[d>>>16&255]<<16|s[f>>>8&255]<<8|s[255&c])^n[p++],_=(s[d>>>24]<<24|s[f>>>16&255]<<16|s[c>>>8&255]<<8|s[255&l])^n[p++],m=(s[f>>>24]<<24|s[c>>>16&255]<<16|s[l>>>8&255]<<8|s[255&d])^n[p++],e[t]=g,e[t+1]=v,e[t+2]=_,e[t+3]=m},keySize:8});e.AES=t._createHelper(g)}(),n.AES)})),ae((function(e,t){var n;e.exports=(n=se,function(){var e=n,t=e.lib,r=t.WordArray,o=t.BlockCipher,i=e.algo,a=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],s=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],u=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],c=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],l=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],d=i.DES=o.extend({_doReset:function(){for(var e=this._key.words,t=[],n=0;n<56;n++){var r=a[n]-1;t[n]=e[r>>>5]>>>31-r%32&1}for(var o=this._subKeys=[],i=0;i<16;i++){var c=o[i]=[],l=u[i];for(n=0;n<24;n++)c[n/6|0]|=t[(s[n]-1+l)%28]<<31-n%6,c[4+(n/6|0)]|=t[28+(s[n+24]-1+l)%28]<<31-n%6;for(c[0]=c[0]<<1|c[0]>>>31,n=1;n<7;n++)c[n]=c[n]>>>4*(n-1)+3;c[7]=c[7]<<5|c[7]>>>27}var d=this._invSubKeys=[];for(n=0;n<16;n++)d[n]=o[15-n]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._subKeys)},decryptBlock:function(e,t){this._doCryptBlock(e,t,this._invSubKeys)},_doCryptBlock:function(e,t,n){this._lBlock=e[t],this._rBlock=e[t+1],f.call(this,4,252645135),f.call(this,16,65535),p.call(this,2,858993459),p.call(this,8,16711935),f.call(this,1,1431655765);for(var r=0;r<16;r++){for(var o=n[r],i=this._lBlock,a=this._rBlock,s=0,u=0;u<8;u++)s|=c[u][((a^o[u])&l[u])>>>0];this._lBlock=a,this._rBlock=i^s}var d=this._lBlock;this._lBlock=this._rBlock,this._rBlock=d,f.call(this,1,1431655765),p.call(this,8,16711935),p.call(this,2,858993459),f.call(this,16,65535),f.call(this,4,252645135),e[t]=this._lBlock,e[t+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});function f(e,t){var n=(this._lBlock>>>e^this._rBlock)&t;this._rBlock^=n,this._lBlock^=n<<e}function p(e,t){var n=(this._rBlock>>>e^this._lBlock)&t;this._lBlock^=n,this._rBlock^=n<<e}e.DES=o._createHelper(d);var h=i.TripleDES=o.extend({_doReset:function(){var e=this._key.words;this._des1=d.createEncryptor(r.create(e.slice(0,2))),this._des2=d.createEncryptor(r.create(e.slice(2,4))),this._des3=d.createEncryptor(r.create(e.slice(4,6)))},encryptBlock:function(e,t){this._des1.encryptBlock(e,t),this._des2.decryptBlock(e,t),this._des3.encryptBlock(e,t)},decryptBlock:function(e,t){this._des3.decryptBlock(e,t),this._des2.encryptBlock(e,t),this._des1.decryptBlock(e,t)},keySize:6,ivSize:2,blockSize:2});e.TripleDES=o._createHelper(h)}(),n.TripleDES)})),ae((function(e,t){var n;e.exports=(n=se,function(){var e=n,t=e.lib.StreamCipher,r=e.algo,o=r.RC4=t.extend({_doReset:function(){for(var e=this._key,t=e.words,n=e.sigBytes,r=this._S=[],o=0;o<256;o++)r[o]=o;o=0;for(var i=0;o<256;o++){var a=o%n,s=t[a>>>2]>>>24-a%4*8&255;i=(i+r[o]+s)%256;var u=r[o];r[o]=r[i],r[i]=u}this._i=this._j=0},_doProcessBlock:function(e,t){e[t]^=i.call(this)},keySize:8,ivSize:0});function i(){for(var e=this._S,t=this._i,n=this._j,r=0,o=0;o<4;o++){n=(n+e[t=(t+1)%256])%256;var i=e[t];e[t]=e[n],e[n]=i,r|=e[(e[t]+e[n])%256]<<24-8*o}return this._i=t,this._j=n,r}e.RC4=t._createHelper(o);var a=r.RC4Drop=o.extend({cfg:o.cfg.extend({drop:192}),_doReset:function(){o._doReset.call(this);for(var e=this.cfg.drop;e>0;e--)i.call(this)}});e.RC4Drop=t._createHelper(a)}(),n.RC4)})),ae((function(e,t){var n;e.exports=(n=se,function(){var e=n,t=e.lib.StreamCipher,r=e.algo,o=[],i=[],a=[],s=r.Rabbit=t.extend({_doReset:function(){for(var e=this._key.words,t=this.cfg.iv,n=0;n<4;n++)e[n]=16711935&(e[n]<<8|e[n]>>>24)|4278255360&(e[n]<<24|e[n]>>>8);var r=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],o=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];for(this._b=0,n=0;n<4;n++)u.call(this);for(n=0;n<8;n++)o[n]^=r[n+4&7];if(t){var i=t.words,a=i[0],s=i[1],c=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),l=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),d=c>>>16|4294901760&l,f=l<<16|65535&c;for(o[0]^=c,o[1]^=d,o[2]^=l,o[3]^=f,o[4]^=c,o[5]^=d,o[6]^=l,o[7]^=f,n=0;n<4;n++)u.call(this)}},_doProcessBlock:function(e,t){var n=this._X;u.call(this),o[0]=n[0]^n[5]>>>16^n[3]<<16,o[1]=n[2]^n[7]>>>16^n[5]<<16,o[2]=n[4]^n[1]>>>16^n[7]<<16,o[3]=n[6]^n[3]>>>16^n[1]<<16;for(var r=0;r<4;r++)o[r]=16711935&(o[r]<<8|o[r]>>>24)|4278255360&(o[r]<<24|o[r]>>>8),e[t+r]^=o[r]},blockSize:4,ivSize:2});function u(){for(var e=this._X,t=this._C,n=0;n<8;n++)i[n]=t[n];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<i[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<i[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<i[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<i[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<i[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<i[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<i[6]>>>0?1:0)|0,this._b=t[7]>>>0<i[7]>>>0?1:0,n=0;n<8;n++){var r=e[n]+t[n],o=65535&r,s=r>>>16,u=((o*o>>>17)+o*s>>>15)+s*s,c=((4294901760&r)*r|0)+((65535&r)*r|0);a[n]=u^c}e[0]=a[0]+(a[7]<<16|a[7]>>>16)+(a[6]<<16|a[6]>>>16)|0,e[1]=a[1]+(a[0]<<8|a[0]>>>24)+a[7]|0,e[2]=a[2]+(a[1]<<16|a[1]>>>16)+(a[0]<<16|a[0]>>>16)|0,e[3]=a[3]+(a[2]<<8|a[2]>>>24)+a[1]|0,e[4]=a[4]+(a[3]<<16|a[3]>>>16)+(a[2]<<16|a[2]>>>16)|0,e[5]=a[5]+(a[4]<<8|a[4]>>>24)+a[3]|0,e[6]=a[6]+(a[5]<<16|a[5]>>>16)+(a[4]<<16|a[4]>>>16)|0,e[7]=a[7]+(a[6]<<8|a[6]>>>24)+a[5]|0}e.Rabbit=t._createHelper(s)}(),n.Rabbit)})),ae((function(e,t){var n;e.exports=(n=se,function(){var e=n,t=e.lib.StreamCipher,r=e.algo,o=[],i=[],a=[],s=r.RabbitLegacy=t.extend({_doReset:function(){var e=this._key.words,t=this.cfg.iv,n=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],r=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];this._b=0;for(var o=0;o<4;o++)u.call(this);for(o=0;o<8;o++)r[o]^=n[o+4&7];if(t){var i=t.words,a=i[0],s=i[1],c=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),l=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),d=c>>>16|4294901760&l,f=l<<16|65535&c;for(r[0]^=c,r[1]^=d,r[2]^=l,r[3]^=f,r[4]^=c,r[5]^=d,r[6]^=l,r[7]^=f,o=0;o<4;o++)u.call(this)}},_doProcessBlock:function(e,t){var n=this._X;u.call(this),o[0]=n[0]^n[5]>>>16^n[3]<<16,o[1]=n[2]^n[7]>>>16^n[5]<<16,o[2]=n[4]^n[1]>>>16^n[7]<<16,o[3]=n[6]^n[3]>>>16^n[1]<<16;for(var r=0;r<4;r++)o[r]=16711935&(o[r]<<8|o[r]>>>24)|4278255360&(o[r]<<24|o[r]>>>8),e[t+r]^=o[r]},blockSize:4,ivSize:2});function u(){for(var e=this._X,t=this._C,n=0;n<8;n++)i[n]=t[n];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<i[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<i[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<i[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<i[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<i[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<i[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<i[6]>>>0?1:0)|0,this._b=t[7]>>>0<i[7]>>>0?1:0,n=0;n<8;n++){var r=e[n]+t[n],o=65535&r,s=r>>>16,u=((o*o>>>17)+o*s>>>15)+s*s,c=((4294901760&r)*r|0)+((65535&r)*r|0);a[n]=u^c}e[0]=a[0]+(a[7]<<16|a[7]>>>16)+(a[6]<<16|a[6]>>>16)|0,e[1]=a[1]+(a[0]<<8|a[0]>>>24)+a[7]|0,e[2]=a[2]+(a[1]<<16|a[1]>>>16)+(a[0]<<16|a[0]>>>16)|0,e[3]=a[3]+(a[2]<<8|a[2]>>>24)+a[1]|0,e[4]=a[4]+(a[3]<<16|a[3]>>>16)+(a[2]<<16|a[2]>>>16)|0,e[5]=a[5]+(a[4]<<8|a[4]>>>24)+a[3]|0,e[6]=a[6]+(a[5]<<16|a[5]>>>16)+(a[4]<<16|a[4]>>>16)|0,e[7]=a[7]+(a[6]<<8|a[6]>>>24)+a[5]|0}e.RabbitLegacy=t._createHelper(s)}(),n.RabbitLegacy)})),ae((function(e,t){e.exports=se})));function ce(){throw new Error("setTimeout has not been defined")}function le(){throw new Error("clearTimeout has not been defined")}var de=ce,fe=le;function pe(e){if(de===setTimeout)return setTimeout(e,0);if((de===ce||!de)&&setTimeout)return de=setTimeout,setTimeout(e,0);try{return de(e,0)}catch(u){try{return de.call(null,e,0)}catch(u){return de.call(this,e,0)}}}"function"==typeof s.setTimeout&&(de=setTimeout),"function"==typeof s.clearTimeout&&(fe=clearTimeout);var he,ge=[],ve=!1,_e=-1;function me(){ve&&he&&(ve=!1,he.length?ge=he.concat(ge):_e=-1,ge.length&&ye())}function ye(){if(!ve){var e=pe(me);ve=!0;for(var t=ge.length;t;){for(he=ge,ge=[];++_e<t;)he&&he[_e].run();_e=-1,t=ge.length}he=null,ve=!1,function(e){if(fe===clearTimeout)return clearTimeout(e);if((fe===le||!fe)&&clearTimeout)return fe=clearTimeout,clearTimeout(e);try{fe(e)}catch(t){try{return fe.call(null,e)}catch(t){return fe.call(this,e)}}}(e)}}function Ie(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];ge.push(new Me(e,t)),1!==ge.length||ve||pe(ye)}function Me(e,t){this.fun=e,this.array=t}Me.prototype.run=function(){this.fun.apply(null,this.array)};var Te=s.performance||{};function Se(){}function Ee(){Ee.init.call(this)}function Ce(e){return void 0===e._maxListeners?Ee.defaultMaxListeners:e._maxListeners}function ke(e,t,n){if(t)e.call(n);else for(var r=e.length,o=Le(e,r),i=0;i<r;++i)o[i].call(n)}function be(e,t,n,r){if(t)e.call(n,r);else for(var o=e.length,i=Le(e,o),a=0;a<o;++a)i[a].call(n,r)}function De(e,t,n,r,o){if(t)e.call(n,r,o);else for(var i=e.length,a=Le(e,i),s=0;s<i;++s)a[s].call(n,r,o)}function Ae(e,t,n,r,o,i){if(t)e.call(n,r,o,i);else for(var a=e.length,s=Le(e,a),u=0;u<a;++u)s[u].call(n,r,o,i)}function Oe(e,t,n,r){if(t)e.apply(n,r);else for(var o=e.length,i=Le(e,o),a=0;a<o;++a)i[a].apply(n,r)}function Re(e,t,n,r){var o,i,a,s;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if((i=e._events)?(i.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),i=e._events),a=i[t]):(i=e._events=new Se,e._eventsCount=0),a){if("function"==typeof a?a=i[t]=r?[n,a]:[a,n]:r?a.unshift(n):a.push(n),!a.warned&&(o=Ce(e))&&o>0&&a.length>o){a.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=a.length,s=u,"function"==typeof console.warn?console.warn(s):console.log(s)}}else a=i[t]=n,++e._eventsCount;return e}function Ne(e,t,n){var r=!1;function o(){e.removeListener(t,o),r||(r=!0,n.apply(e,arguments))}return o.listener=n,o}function we(e){var t=this._events;if(t){var n=t[e];if("function"==typeof n)return 1;if(n)return n.length}return 0}function Le(e,t){for(var n=new Array(t);t--;)n[t]=e[t];return n}Te.now||Te.mozNow||Te.msNow||Te.oNow||Te.webkitNow,Se.prototype=Object.create(null),Ee.EventEmitter=Ee,Ee.usingDomains=!1,Ee.prototype.domain=void 0,Ee.prototype._events=void 0,Ee.prototype._maxListeners=void 0,Ee.defaultMaxListeners=10,Ee.init=function(){this.domain=null,Ee.usingDomains&&(void 0).active&&(void 0).Domain,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new Se,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Ee.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},Ee.prototype.getMaxListeners=function(){return Ce(this)},Ee.prototype.emit=function(e){var t,n,r,o,i,a,s,u="error"===e;if(a=this._events)u=u&&null==a.error;else if(!u)return!1;if(s=this.domain,u){if(t=arguments[1],!s){if(t instanceof Error)throw t;var c=new Error('Uncaught, unspecified "error" event. ('+t+")");throw c.context=t,c}return t||(t=new Error('Uncaught, unspecified "error" event')),t.domainEmitter=this,t.domain=s,t.domainThrown=!1,s.emit("error",t),!1}if(!(n=a[e]))return!1;var l="function"==typeof n;switch(r=arguments.length){case 1:ke(n,l,this);break;case 2:be(n,l,this,arguments[1]);break;case 3:De(n,l,this,arguments[1],arguments[2]);break;case 4:Ae(n,l,this,arguments[1],arguments[2],arguments[3]);break;default:for(o=new Array(r-1),i=1;i<r;i++)o[i-1]=arguments[i];Oe(n,l,this,o)}return!0},Ee.prototype.addListener=function(e,t){return Re(this,e,t,!1)},Ee.prototype.on=Ee.prototype.addListener,Ee.prototype.prependListener=function(e,t){return Re(this,e,t,!0)},Ee.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,Ne(this,e,t)),this},Ee.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,Ne(this,e,t)),this},Ee.prototype.removeListener=function(e,t){var n,r,o,i,a;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(r=this._events))return this;if(!(n=r[e]))return this;if(n===t||n.listener&&n.listener===t)0==--this._eventsCount?this._events=new Se:(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(o=-1,i=n.length;i-- >0;)if(n[i]===t||n[i].listener&&n[i].listener===t){a=n[i].listener,o=i;break}if(o<0)return this;if(1===n.length){if(n[0]=void 0,0==--this._eventsCount)return this._events=new Se,this;delete r[e]}else!function(e,t){for(var n=t,r=n+1,o=e.length;r<o;n+=1,r+=1)e[n]=e[r];e.pop()}(n,o);r.removeListener&&this.emit("removeListener",e,a||t)}return this},Ee.prototype.removeAllListeners=function(e){var t,n;if(!(n=this._events))return this;if(!n.removeListener)return 0===arguments.length?(this._events=new Se,this._eventsCount=0):n[e]&&(0==--this._eventsCount?this._events=new Se:delete n[e]),this;if(0===arguments.length){for(var r,o=Object.keys(n),i=0;i<o.length;++i)"removeListener"!==(r=o[i])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=new Se,this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(t)do{this.removeListener(e,t[t.length-1])}while(t[0]);return this},Ee.prototype.listeners=function(e){var t,n=this._events;return n&&(t=n[e])?"function"==typeof t?[t.listener||t]:function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(t):[]},Ee.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):we.call(e,t)},Ee.prototype.listenerCount=we,Ee.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var Pe="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e},Ue=/%[sdj%]/g;function Ge(e){if(!Je(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(Ve(arguments[n]));return t.join(" ")}n=1;for(var r=arguments,o=r.length,i=String(e).replace(Ue,(function(e){if("%%"===e)return"%";if(n>=o)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return e}})),a=r[n];n<o;a=r[++n])ze(a)||!Ze(a)?i+=" "+a:i+=" "+Ve(a);return i}function xe(e,t){if(Xe(s.process))return function(){return xe(e,t).apply(this,arguments)};var n=!1;return function(){return n||(console.error(t),n=!0),e.apply(this,arguments)}}var Fe,qe={};function Ve(e,t){var n={seen:[],stylize:je};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),Ye(t)?n.showHidden=t:t&&function(e,t){if(!t||!Ze(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]]}(n,t),Xe(n.showHidden)&&(n.showHidden=!1),Xe(n.depth)&&(n.depth=2),Xe(n.colors)&&(n.colors=!1),Xe(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=Be),He(n,e,n.depth)}function Be(e,t){var n=Ve.styles[t];return n?"["+Ve.colors[n][0]+"m"+e+"["+Ve.colors[n][1]+"m":e}function je(e,t){return e}function He(e,t,n){if(e.customInspect&&t&&tt(t.inspect)&&t.inspect!==Ve&&(!t.constructor||t.constructor.prototype!==t)){var r=t.inspect(n,e);return Je(r)||(r=He(e,r,n)),r}var o=function(e,t){if(Xe(t))return e.stylize("undefined","undefined");if(Je(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}return r=t,"number"==typeof r?e.stylize(""+t,"number"):Ye(t)?e.stylize(""+t,"boolean"):ze(t)?e.stylize("null","null"):void 0;var r}(e,t);if(o)return o;var i=Object.keys(t),a=function(e){var t={};return e.forEach((function(e,n){t[e]=!0})),t}(i);if(e.showHidden&&(i=Object.getOwnPropertyNames(t)),et(t)&&(i.indexOf("message")>=0||i.indexOf("description")>=0))return Ke(t);if(0===i.length){if(tt(t)){var s=t.name?": "+t.name:"";return e.stylize("[Function"+s+"]","special")}if($e(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(Qe(t))return e.stylize(Date.prototype.toString.call(t),"date");if(et(t))return Ke(t)}var u,c,l="",d=!1,f=["{","}"];return u=t,Array.isArray(u)&&(d=!0,f=["[","]"]),tt(t)&&(l=" [Function"+(t.name?": "+t.name:"")+"]"),$e(t)&&(l=" "+RegExp.prototype.toString.call(t)),Qe(t)&&(l=" "+Date.prototype.toUTCString.call(t)),et(t)&&(l=" "+Ke(t)),0!==i.length||d&&0!=t.length?n<0?$e(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special"):(e.seen.push(t),c=d?function(e,t,n,r,o){for(var i=[],a=0,s=t.length;a<s;++a)rt(t,String(a))?i.push(We(e,t,n,r,String(a),!0)):i.push("");return o.forEach((function(o){o.match(/^\d+$/)||i.push(We(e,t,n,r,o,!0))})),i}(e,t,n,a,i):i.map((function(r){return We(e,t,n,a,r,d)})),e.seen.pop(),function(e,t,n){return e.reduce((function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}(c,l,f)):f[0]+l+f[1]}function Ke(e){return"["+Error.prototype.toString.call(e)+"]"}function We(e,t,n,r,o,i){var a,s,u;if((u=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]}).get?s=u.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):u.set&&(s=e.stylize("[Setter]","special")),rt(r,o)||(a="["+o+"]"),s||(e.seen.indexOf(u.value)<0?(s=ze(n)?He(e,u.value,null):He(e,u.value,n-1)).indexOf("\n")>-1&&(s=i?s.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+s.split("\n").map((function(e){return"   "+e})).join("\n")):s=e.stylize("[Circular]","special")),Xe(a)){if(i&&o.match(/^\d+$/))return s;(a=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+s}function Ye(e){return"boolean"==typeof e}function ze(e){return null===e}function Je(e){return"string"==typeof e}function Xe(e){return void 0===e}function $e(e){return Ze(e)&&"[object RegExp]"===nt(e)}function Ze(e){return"object"==(0,a.default)(e)&&null!==e}function Qe(e){return Ze(e)&&"[object Date]"===nt(e)}function et(e){return Ze(e)&&("[object Error]"===nt(e)||e instanceof Error)}function tt(e){return"function"==typeof e}function nt(e){return Object.prototype.toString.call(e)}function rt(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function ot(){this.head=null,this.tail=null,this.length=0}Ve.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},Ve.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},ot.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},ot.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},ot.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},ot.prototype.clear=function(){this.head=this.tail=null,this.length=0},ot.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n},ot.prototype.concat=function(e){if(0===this.length)return M.alloc(0);if(1===this.length)return this.head.data;for(var t=M.allocUnsafe(e>>>0),n=this.head,r=0;n;)n.data.copy(t,r),r+=n.data.length,n=n.next;return t};var it=M.isEncoding||function(e){switch(e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function at(e){switch(this.encoding=(e||"utf8").toLowerCase().replace(/[-_]/,""),function(e){if(e&&!it(e))throw new Error("Unknown encoding: "+e)}(e),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=ut;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=ct;break;default:return void(this.write=st)}this.charBuffer=new M(6),this.charReceived=0,this.charLength=0}function st(e){return e.toString(this.encoding)}function ut(e){this.charReceived=e.length%2,this.charLength=this.charReceived?2:0}function ct(e){this.charReceived=e.length%3,this.charLength=this.charReceived?3:0}at.prototype.write=function(e){for(var t="";this.charLength;){var n=e.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:e.length;if(e.copy(this.charBuffer,this.charReceived,0,n),this.charReceived+=n,this.charReceived<this.charLength)return"";if(e=e.slice(n,e.length),!((r=(t=this.charBuffer.slice(0,this.charLength).toString(this.encoding)).charCodeAt(t.length-1))>=55296&&r<=56319)){if(this.charReceived=this.charLength=0,0===e.length)return t;break}this.charLength+=this.surrogateSize,t=""}this.detectIncompleteChar(e);var r,o=e.length;if(this.charLength&&(e.copy(this.charBuffer,0,e.length-this.charReceived,o),o-=this.charReceived),o=(t+=e.toString(this.encoding,0,o)).length-1,(r=t.charCodeAt(o))>=55296&&r<=56319){var i=this.surrogateSize;return this.charLength+=i,this.charReceived+=i,this.charBuffer.copy(this.charBuffer,i,0,i),e.copy(this.charBuffer,0,0,i),t.substring(0,o)}return t},at.prototype.detectIncompleteChar=function(e){for(var t=e.length>=3?3:e.length;t>0;t--){var n=e[e.length-t];if(1==t&&n>>5==6){this.charLength=2;break}if(t<=2&&n>>4==14){this.charLength=3;break}if(t<=3&&n>>3==30){this.charLength=4;break}}this.charReceived=t},at.prototype.end=function(e){var t="";if(e&&e.length&&(t=this.write(e)),this.charReceived){var n=this.charReceived,r=this.charBuffer,o=this.encoding;t+=r.slice(0,n).toString(o)}return t},ft.ReadableState=dt;var lt=function(e){return Xe(Fe)&&(Fe=""),e=e.toUpperCase(),qe[e]||(new RegExp("\\b"+e+"\\b","i").test(Fe)?qe[e]=function(){var t=Ge.apply(null,arguments);console.error("%s %d: %s",e,0,t)}:qe[e]=function(){}),qe[e]}("stream");function dt(e,t){e=e||{},this.objectMode=!!e.objectMode,t instanceof Ft&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var n=e.highWaterMark,r=this.objectMode?16:16384;this.highWaterMark=n||0===n?n:r,this.highWaterMark=~~this.highWaterMark,this.buffer=new ot,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(this.decoder=new at(e.encoding),this.encoding=e.encoding)}function ft(e){if(!(this instanceof ft))return new ft(e);this._readableState=new dt(e,this),this.readable=!0,e&&"function"==typeof e.read&&(this._read=e.read),Ee.call(this)}function pt(e,t,n,r,o){var i=function(e,t){var n=null;return oe(t)||"string"==typeof t||null==t||e.objectMode||(n=new TypeError("Invalid non-string/buffer chunk")),n}(t,n);if(i)e.emit("error",i);else if(null===n)t.reading=!1,function(e,t){if(!t.ended){if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,gt(e)}}(e,t);else if(t.objectMode||n&&n.length>0)if(t.ended&&!o){var a=new Error("stream.push() after EOF");e.emit("error",a)}else if(t.endEmitted&&o){var s=new Error("stream.unshift() after end event");e.emit("error",s)}else{var u;!t.decoder||o||r||(n=t.decoder.write(n),u=!t.objectMode&&0===n.length),o||(t.reading=!1),u||(t.flowing&&0===t.length&&!t.sync?(e.emit("data",n),e.read(0)):(t.length+=t.objectMode?1:n.length,o?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&gt(e))),function(e,t){t.readingMore||(t.readingMore=!0,Ie(_t,e,t))}(e,t)}else o||(t.reading=!1);return function(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}(t)}Pe(ft,Ee),ft.prototype.push=function(e,t){var n=this._readableState;return n.objectMode||"string"!=typeof e||(t=t||n.defaultEncoding)!==n.encoding&&(e=M.from(e,t),t=""),pt(this,n,e,t,!1)},ft.prototype.unshift=function(e){return pt(this,this._readableState,e,"",!0)},ft.prototype.isPaused=function(){return!1===this._readableState.flowing},ft.prototype.setEncoding=function(e){return this._readableState.decoder=new at(e),this._readableState.encoding=e,this};function ht(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=8388608?e=8388608:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function gt(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(lt("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?Ie(vt,e):vt(e))}function vt(e){lt("emit readable"),e.emit("readable"),It(e)}function _t(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(lt("maybeReadMore read 0"),e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function mt(e){lt("readable nexttick read 0"),e.read(0)}function yt(e,t){t.reading||(lt("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),It(e),t.flowing&&!t.reading&&e.read(0)}function It(e){var t=e._readableState;for(lt("flow",t.flowing);t.flowing&&null!==e.read(););}function Mt(e,t){return 0===t.length?null:(t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):n=function(e,t,n){var r;return e<t.head.data.length?(r=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):r=e===t.head.data.length?t.shift():n?function(e,t){var n=t.head,r=1,o=n.data;for(e-=o.length;n=n.next;){var i=n.data,a=e>i.length?i.length:e;if(a===i.length?o+=i:o+=i.slice(0,e),0===(e-=a)){a===i.length?(++r,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=i.slice(a));break}++r}return t.length-=r,o}(e,t):function(e,t){var n=M.allocUnsafe(e),r=t.head,o=1;for(r.data.copy(n),e-=r.data.length;r=r.next;){var i=r.data,a=e>i.length?i.length:e;if(i.copy(n,n.length-e,0,a),0===(e-=a)){a===i.length?(++o,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=i.slice(a));break}++o}return t.length-=o,n}(e,t),r}(e,t.buffer,t.decoder),n);var n}function Tt(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,Ie(St,t,e))}function St(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function Et(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}function Ct(){}function kt(e,t,n){this.chunk=e,this.encoding=t,this.callback=n,this.next=null}function bt(e,t){Object.defineProperty(this,"buffer",{get:xe((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")}),e=e||{},this.objectMode=!!e.objectMode,t instanceof Ft&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var n=e.highWaterMark,r=this.objectMode?16:16384;this.highWaterMark=n||0===n?n:r,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var o=!1===e.decodeStrings;this.decodeStrings=!o,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var n=e._writableState,r=n.sync,o=n.writecb;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(n),t)!function(e,t,n,r,o){--t.pendingcb,n?Ie(o,r):o(r),e._writableState.errorEmitted=!0,e.emit("error",r)}(e,n,r,t,o);else{var i=Nt(n);i||n.corked||n.bufferProcessing||!n.bufferedRequest||Rt(e,n),r?Ie(Ot,e,n,i,o):Ot(e,n,i,o)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new Pt(this)}function Dt(e){if(!(this instanceof Dt||this instanceof Ft))return new Dt(e);this._writableState=new bt(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev)),Ee.call(this)}function At(e,t,n,r,o,i,a){t.writelen=r,t.writecb=a,t.writing=!0,t.sync=!0,n?e._writev(o,t.onwrite):e._write(o,i,t.onwrite),t.sync=!1}function Ot(e,t,n,r){n||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,r(),Lt(e,t)}function Rt(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var r=t.bufferedRequestCount,o=new Array(r),i=t.corkedRequestsFree;i.entry=n;for(var a=0;n;)o[a]=n,n=n.next,a+=1;At(e,t,!0,t.length,o,"",i.finish),t.pendingcb++,t.lastBufferedRequest=null,i.next?(t.corkedRequestsFree=i.next,i.next=null):t.corkedRequestsFree=new Pt(t)}else{for(;n;){var s=n.chunk,u=n.encoding,c=n.callback;if(At(e,t,!1,t.objectMode?1:s.length,s,u,c),n=n.next,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequestCount=0,t.bufferedRequest=n,t.bufferProcessing=!1}function Nt(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function wt(e,t){t.prefinished||(t.prefinished=!0,e.emit("prefinish"))}function Lt(e,t){var n=Nt(t);return n&&(0===t.pendingcb?(wt(e,t),t.finished=!0,e.emit("finish")):wt(e,t)),n}function Pt(e){var t=this;this.next=null,this.entry=null,this.finish=function(n){var r=t.entry;for(t.entry=null;r;){var o=r.callback;e.pendingcb--,o(n),r=r.next}e.corkedRequestsFree?e.corkedRequestsFree.next=t:e.corkedRequestsFree=t}}ft.prototype.read=function(e){lt("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return lt("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?Tt(this):gt(this),null;if(0===(e=ht(e,t))&&t.ended)return 0===t.length&&Tt(this),null;var r,o=t.needReadable;return lt("need readable",o),(0===t.length||t.length-e<t.highWaterMark)&&lt("length less than watermark",o=!0),t.ended||t.reading?lt("reading or ended",o=!1):o&&(lt("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=ht(n,t))),null===(r=e>0?Mt(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&Tt(this)),null!==r&&this.emit("data",r),r},ft.prototype._read=function(e){this.emit("error",new Error("not implemented"))},ft.prototype.pipe=function(e,t){var n=this,r=this._readableState;switch(r.pipesCount){case 0:r.pipes=e;break;case 1:r.pipes=[r.pipes,e];break;default:r.pipes.push(e)}r.pipesCount+=1,lt("pipe count=%d opts=%j",r.pipesCount,t);var o=t&&!1===t.end?c:a;function i(e){lt("onunpipe"),e===n&&c()}function a(){lt("onend"),e.end()}r.endEmitted?Ie(o):n.once("end",o),e.on("unpipe",i);var s=function(e){return function(){var t=e._readableState;lt("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&e.listeners("data").length&&(t.flowing=!0,It(e))}}(n);e.on("drain",s);var u=!1;function c(){lt("cleanup"),e.removeListener("close",p),e.removeListener("finish",h),e.removeListener("drain",s),e.removeListener("error",f),e.removeListener("unpipe",i),n.removeListener("end",a),n.removeListener("end",c),n.removeListener("data",d),u=!0,!r.awaitDrain||e._writableState&&!e._writableState.needDrain||s()}var l=!1;function d(t){lt("ondata"),l=!1,!1!==e.write(t)||l||((1===r.pipesCount&&r.pipes===e||r.pipesCount>1&&-1!==Et(r.pipes,e))&&!u&&(lt("false write response, pause",n._readableState.awaitDrain),n._readableState.awaitDrain++,l=!0),n.pause())}function f(t){lt("onerror",t),g(),e.removeListener("error",f),0===("error",e.listeners("error").length)&&e.emit("error",t)}function p(){e.removeListener("finish",h),g()}function h(){lt("onfinish"),e.removeListener("close",p),g()}function g(){lt("unpipe"),n.unpipe(e)}return n.on("data",d),function(e,t,n){if("function"==typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n)}(e,"error",f),e.once("close",p),e.once("finish",h),e.emit("pipe",n),r.flowing||(lt("pipe resume"),n.resume()),e},ft.prototype.unpipe=function(e){var t=this._readableState;if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this)),this;if(!e){var n=t.pipes,r=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var o=0;o<r;o++)n[o].emit("unpipe",this);return this}var i=Et(t.pipes,e);return-1===i||(t.pipes.splice(i,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this)),this},ft.prototype.on=function(e,t){var n=Ee.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var r=this._readableState;r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.emittedReadable=!1,r.reading?r.length&&gt(this):Ie(mt,this))}return n},ft.prototype.addListener=ft.prototype.on,ft.prototype.resume=function(){var e=this._readableState;return e.flowing||(lt("resume"),e.flowing=!0,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,Ie(yt,e,t))}(this,e)),this},ft.prototype.pause=function(){return lt("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(lt("pause"),this._readableState.flowing=!1,this.emit("pause")),this},ft.prototype.wrap=function(e){var t=this._readableState,n=!1,r=this;for(var o in e.on("end",(function(){if(lt("wrapped end"),t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&r.push(e)}r.push(null)})),e.on("data",(function(o){lt("wrapped data"),t.decoder&&(o=t.decoder.write(o)),t.objectMode&&null==o||(t.objectMode||o&&o.length)&&(r.push(o)||(n=!0,e.pause()))})),e)void 0===this[o]&&"function"==typeof e[o]&&(this[o]=function(t){return function(){return e[t].apply(e,arguments)}}(o));return function(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n])}(["error","close","destroy","pause","resume"],(function(t){e.on(t,r.emit.bind(r,t))})),r._read=function(t){lt("wrapped _read",t),n&&(n=!1,e.resume())},r},ft._fromList=Mt,Dt.WritableState=bt,Pe(Dt,Ee),bt.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},Dt.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},Dt.prototype.write=function(e,t,n){var r=this._writableState,o=!1;return"function"==typeof t&&(n=t,t=null),M.isBuffer(e)?t="buffer":t||(t=r.defaultEncoding),"function"!=typeof n&&(n=Ct),r.ended?function(e,t){var n=new Error("write after end");e.emit("error",n),Ie(t,n)}(this,n):function(e,t,n,r){var o=!0,i=!1;return null===n?i=new TypeError("May not write null values to stream"):M.isBuffer(n)||"string"==typeof n||void 0===n||t.objectMode||(i=new TypeError("Invalid non-string/buffer chunk")),i&&(e.emit("error",i),Ie(r,i),o=!1),o}(this,r,e,n)&&(r.pendingcb++,o=function(e,t,n,r,o){n=function(e,t,n){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=M.from(t,n)),t}(t,n,r),M.isBuffer(n)&&(r="buffer");var i=t.objectMode?1:n.length;t.length+=i;var a=t.length<t.highWaterMark;if(a||(t.needDrain=!0),t.writing||t.corked){var s=t.lastBufferedRequest;t.lastBufferedRequest=new kt(n,r,o),s?s.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else At(e,t,!1,i,n,r,o);return a}(this,r,e,t,n)),o},Dt.prototype.cork=function(){this._writableState.corked++},Dt.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||Rt(this,e))},Dt.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Dt.prototype._write=function(e,t,n){n(new Error("not implemented"))},Dt.prototype._writev=null,Dt.prototype.end=function(e,t,n){var r=this._writableState;"function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!=e&&this.write(e,t),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||function(e,t,n){t.ending=!0,Lt(e,t),n&&(t.finished?Ie(n):e.once("finish",n)),t.ended=!0,e.writable=!1}(this,r,n)},Pe(Ft,ft);for(var Ut=Object.keys(Dt.prototype),Gt=0;Gt<Ut.length;Gt++){var xt=Ut[Gt];Ft.prototype[xt]||(Ft.prototype[xt]=Dt.prototype[xt])}function Ft(e){if(!(this instanceof Ft))return new Ft(e);ft.call(this,e),Dt.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",qt)}function qt(){this.allowHalfOpen||this._writableState.ended||Ie(Vt,this)}function Vt(e){e.end()}function Bt(e){this.afterTransform=function(t,n){return function(e,t,n){var r=e._transformState;r.transforming=!1;var o=r.writecb;if(!o)return e.emit("error",new Error("no writecb in Transform class"));r.writechunk=null,r.writecb=null,null!=n&&e.push(n),o(t);var i=e._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&e._read(i.highWaterMark)}(e,t,n)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function jt(e){if(!(this instanceof jt))return new jt(e);Ft.call(this,e),this._transformState=new Bt(this);var t=this;this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.once("prefinish",(function(){"function"==typeof this._flush?this._flush((function(e){Ht(t,e)})):Ht(t)}))}function Ht(e,t){if(t)return e.emit("error",t);var n=e._writableState,r=e._transformState;if(n.length)throw new Error("Calling transform done when ws.length != 0");if(r.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}function Kt(e){if(!(this instanceof Kt))return new Kt(e);jt.call(this,e)}function Wt(){Ee.call(this)}Pe(jt,Ft),jt.prototype.push=function(e,t){return this._transformState.needTransform=!1,Ft.prototype.push.call(this,e,t)},jt.prototype._transform=function(e,t,n){throw new Error("Not implemented")},jt.prototype._write=function(e,t,n){var r=this._transformState;if(r.writecb=n,r.writechunk=e,r.writeencoding=t,!r.transforming){var o=this._readableState;(r.needTransform||o.needReadable||o.length<o.highWaterMark)&&this._read(o.highWaterMark)}},jt.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},Pe(Kt,jt),Kt.prototype._transform=function(e,t,n){n(null,e)},Pe(Wt,Ee),Wt.Readable=ft,Wt.Writable=Dt,Wt.Duplex=Ft,Wt.Transform=jt,Wt.PassThrough=Kt,Wt.Stream=Wt,Wt.prototype.pipe=function(e,t){var n=this;function r(t){e.writable&&!1===e.write(t)&&n.pause&&n.pause()}function o(){n.readable&&n.resume&&n.resume()}n.on("data",r),e.on("drain",o),e._isStdio||t&&!1===t.end||(n.on("end",a),n.on("close",s));var i=!1;function a(){i||(i=!0,e.end())}function s(){i||(i=!0,"function"==typeof e.destroy&&e.destroy())}function u(e){if(c(),0===Ee.listenerCount(this,"error"))throw e}function c(){n.removeListener("data",r),e.removeListener("drain",o),n.removeListener("end",a),n.removeListener("close",s),n.removeListener("error",u),e.removeListener("error",u),n.removeListener("end",c),n.removeListener("close",c),e.removeListener("close",c)}return n.on("error",u),e.on("error",u),n.on("end",c),n.on("close",c),e.on("close",c),e.emit("pipe",n),e};var Yt={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"};function zt(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}function Jt(e,t,n,r,o){if(t.subarray&&e.subarray)e.set(t.subarray(n,n+r),o);else for(var i=0;i<r;i++)e[o+i]=t[n+i]}var Xt=Uint8Array,$t=Uint16Array,Zt=Int32Array;function Qt(e){for(var t=e.length;--t>=0;)e[t]=0}var en=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],tn=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],nn=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],rn=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],on=new Array(576);Qt(on);var an=new Array(60);Qt(an);var sn=new Array(512);Qt(sn);var un=new Array(256);Qt(un);var cn=new Array(29);Qt(cn);var ln,dn,fn,pn=new Array(30);function hn(e,t,n,r,o){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=o,this.has_stree=e&&e.length}function gn(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function vn(e){return e<256?sn[e]:sn[256+(e>>>7)]}function _n(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function mn(e,t,n){e.bi_valid>16-n?(e.bi_buf|=t<<e.bi_valid&65535,_n(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=n-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function yn(e,t,n){mn(e,n[2*t],n[2*t+1])}function In(e,t){var n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1}function Mn(e,t,n){var r,o,i=new Array(16),a=0;for(r=1;r<=15;r++)i[r]=a=a+n[r-1]<<1;for(o=0;o<=t;o++){var s=e[2*o+1];0!==s&&(e[2*o]=In(i[s]++,s))}}function Tn(e){var t;for(t=0;t<286;t++)e.dyn_ltree[2*t]=0;for(t=0;t<30;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function Sn(e){e.bi_valid>8?_n(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function En(e,t,n,r){var o=2*t,i=2*n;return e[o]<e[i]||e[o]===e[i]&&r[t]<=r[n]}function Cn(e,t,n){for(var r=e.heap[n],o=n<<1;o<=e.heap_len&&(o<e.heap_len&&En(t,e.heap[o+1],e.heap[o],e.depth)&&o++,!En(t,r,e.heap[o],e.depth));)e.heap[n]=e.heap[o],n=o,o<<=1;e.heap[n]=r}function kn(e,t,n){var r,o,i,a,s=0;if(0!==e.last_lit)do{r=e.pending_buf[e.d_buf+2*s]<<8|e.pending_buf[e.d_buf+2*s+1],o=e.pending_buf[e.l_buf+s],s++,0===r?yn(e,o,t):(yn(e,(i=un[o])+256+1,t),0!==(a=en[i])&&mn(e,o-=cn[i],a),yn(e,i=vn(--r),n),0!==(a=tn[i])&&mn(e,r-=pn[i],a))}while(s<e.last_lit);yn(e,256,t)}function bn(e,t){var n,r,o,i=t.dyn_tree,a=t.stat_desc.static_tree,s=t.stat_desc.has_stree,u=t.stat_desc.elems,c=-1;for(e.heap_len=0,e.heap_max=573,n=0;n<u;n++)0!==i[2*n]?(e.heap[++e.heap_len]=c=n,e.depth[n]=0):i[2*n+1]=0;for(;e.heap_len<2;)i[2*(o=e.heap[++e.heap_len]=c<2?++c:0)]=1,e.depth[o]=0,e.opt_len--,s&&(e.static_len-=a[2*o+1]);for(t.max_code=c,n=e.heap_len>>1;n>=1;n--)Cn(e,i,n);o=u;do{n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],Cn(e,i,1),r=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=r,i[2*o]=i[2*n]+i[2*r],e.depth[o]=(e.depth[n]>=e.depth[r]?e.depth[n]:e.depth[r])+1,i[2*n+1]=i[2*r+1]=o,e.heap[1]=o++,Cn(e,i,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var n,r,o,i,a,s,u=t.dyn_tree,c=t.max_code,l=t.stat_desc.static_tree,d=t.stat_desc.has_stree,f=t.stat_desc.extra_bits,p=t.stat_desc.extra_base,h=t.stat_desc.max_length,g=0;for(i=0;i<=15;i++)e.bl_count[i]=0;for(u[2*e.heap[e.heap_max]+1]=0,n=e.heap_max+1;n<573;n++)(i=u[2*u[2*(r=e.heap[n])+1]+1]+1)>h&&(i=h,g++),u[2*r+1]=i,r>c||(e.bl_count[i]++,a=0,r>=p&&(a=f[r-p]),s=u[2*r],e.opt_len+=s*(i+a),d&&(e.static_len+=s*(l[2*r+1]+a)));if(0!==g){do{for(i=h-1;0===e.bl_count[i];)i--;e.bl_count[i]--,e.bl_count[i+1]+=2,e.bl_count[h]--,g-=2}while(g>0);for(i=h;0!==i;i--)for(r=e.bl_count[i];0!==r;)(o=e.heap[--n])>c||(u[2*o+1]!==i&&(e.opt_len+=(i-u[2*o+1])*u[2*o],u[2*o+1]=i),r--)}}(e,t),Mn(i,c,e.bl_count)}function Dn(e,t,n){var r,o,i=-1,a=t[1],s=0,u=7,c=4;for(0===a&&(u=138,c=3),t[2*(n+1)+1]=65535,r=0;r<=n;r++)o=a,a=t[2*(r+1)+1],++s<u&&o===a||(s<c?e.bl_tree[2*o]+=s:0!==o?(o!==i&&e.bl_tree[2*o]++,e.bl_tree[32]++):s<=10?e.bl_tree[34]++:e.bl_tree[36]++,s=0,i=o,0===a?(u=138,c=3):o===a?(u=6,c=3):(u=7,c=4))}function An(e,t,n){var r,o,i=-1,a=t[1],s=0,u=7,c=4;for(0===a&&(u=138,c=3),r=0;r<=n;r++)if(o=a,a=t[2*(r+1)+1],!(++s<u&&o===a)){if(s<c)do{yn(e,o,e.bl_tree)}while(0!=--s);else 0!==o?(o!==i&&(yn(e,o,e.bl_tree),s--),yn(e,16,e.bl_tree),mn(e,s-3,2)):s<=10?(yn(e,17,e.bl_tree),mn(e,s-3,3)):(yn(e,18,e.bl_tree),mn(e,s-11,7));s=0,i=o,0===a?(u=138,c=3):o===a?(u=6,c=3):(u=7,c=4)}}Qt(pn);var On=!1;function Rn(e,t,n,r){mn(e,0+(r?1:0),3),function(e,t,n,r){Sn(e),_n(e,n),_n(e,~n),Jt(e.pending_buf,e.window,t,n,e.pending),e.pending+=n}(e,t,n)}function Nn(e,t,n){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(un[n]+256+1)]++,e.dyn_dtree[2*vn(t)]++),e.last_lit===e.lit_bufsize-1}function wn(e,t,n,r){for(var o=65535&e|0,i=e>>>16&65535|0,a=0;0!==n;){n-=a=n>2e3?2e3:n;do{i=i+(o=o+t[r++]|0)|0}while(--a);o%=65521,i%=65521}return o|i<<16|0}var Ln=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();function Pn(e,t,n,r){var o=Ln,i=r+n;e^=-1;for(var a=r;a<i;a++)e=e>>>8^o[255&(e^t[a])];return-1^e}var Un,Gn=258,xn=262;function Fn(e,t){return e.msg=Yt[t],t}function qn(e){return(e<<1)-(e>4?9:0)}function Vn(e){for(var t=e.length;--t>=0;)e[t]=0}function Bn(e){var t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(Jt(e.output,t.pending_buf,t.pending_out,n,e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))}function jn(e,t){(function(e,t,n,r){var o,i,a=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<256;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),bn(e,e.l_desc),bn(e,e.d_desc),a=function(e){var t;for(Dn(e,e.dyn_ltree,e.l_desc.max_code),Dn(e,e.dyn_dtree,e.d_desc.max_code),bn(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*rn[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),o=e.opt_len+3+7>>>3,(i=e.static_len+3+7>>>3)<=o&&(o=i)):o=i=n+5,n+4<=o&&-1!==t?Rn(e,t,n,r):4===e.strategy||i===o?(mn(e,2+(r?1:0),3),kn(e,on,an)):(mn(e,4+(r?1:0),3),function(e,t,n,r){var o;for(mn(e,t-257,5),mn(e,n-1,5),mn(e,r-4,4),o=0;o<r;o++)mn(e,e.bl_tree[2*rn[o]+1],3);An(e,e.dyn_ltree,t-1),An(e,e.dyn_dtree,n-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,a+1),kn(e,e.dyn_ltree,e.dyn_dtree)),Tn(e),r&&Sn(e)})(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,Bn(e.strm)}function Hn(e,t){e.pending_buf[e.pending++]=t}function Kn(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function Wn(e,t){var n,r,o=e.max_chain_length,i=e.strstart,a=e.prev_length,s=e.nice_match,u=e.strstart>e.w_size-xn?e.strstart-(e.w_size-xn):0,c=e.window,l=e.w_mask,d=e.prev,f=e.strstart+Gn,p=c[i+a-1],h=c[i+a];e.prev_length>=e.good_match&&(o>>=2),s>e.lookahead&&(s=e.lookahead);do{if(c[(n=t)+a]===h&&c[n+a-1]===p&&c[n]===c[i]&&c[++n]===c[i+1]){i+=2,n++;do{}while(c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&i<f);if(r=Gn-(f-i),i=f-Gn,r>a){if(e.match_start=t,a=r,r>=s)break;p=c[i+a-1],h=c[i+a]}}}while((t=d[t&l])>u&&0!=--o);return a<=e.lookahead?a:e.lookahead}function Yn(e){var t,n,r,o,i,a,s,u,c,l,d=e.w_size;do{if(o=e.window_size-e.lookahead-e.strstart,e.strstart>=d+(d-xn)){Jt(e.window,e.window,d,d,0),e.match_start-=d,e.strstart-=d,e.block_start-=d,t=n=e.hash_size;do{r=e.head[--t],e.head[t]=r>=d?r-d:0}while(--n);t=n=d;do{r=e.prev[--t],e.prev[t]=r>=d?r-d:0}while(--n);o+=d}if(0===e.strm.avail_in)break;if(a=e.strm,s=e.window,u=e.strstart+e.lookahead,c=o,l=void 0,(l=a.avail_in)>c&&(l=c),n=0===l?0:(a.avail_in-=l,Jt(s,a.input,a.next_in,l,u),1===a.state.wrap?a.adler=wn(a.adler,s,l,u):2===a.state.wrap&&(a.adler=Pn(a.adler,s,l,u)),a.next_in+=l,a.total_in+=l,l),e.lookahead+=n,e.lookahead+e.insert>=3)for(i=e.strstart-e.insert,e.ins_h=e.window[i],e.ins_h=(e.ins_h<<e.hash_shift^e.window[i+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[i+3-1])&e.hash_mask,e.prev[i&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=i,i++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<xn&&0!==e.strm.avail_in)}function zn(e,t){for(var n,r;;){if(e.lookahead<xn){if(Yn(e),e.lookahead<xn&&0===t)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-xn&&(e.match_length=Wn(e,n)),e.match_length>=3)if(r=Nn(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else r=Nn(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(jn(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,4===t?(jn(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(jn(e,!1),0===e.strm.avail_out)?1:2}function Jn(e,t){for(var n,r,o;;){if(e.lookahead<xn){if(Yn(e),e.lookahead<xn&&0===t)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-xn&&(e.match_length=Wn(e,n),e.match_length<=5&&(1===e.strategy||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){o=e.strstart+e.lookahead-3,r=Nn(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=o&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,r&&(jn(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((r=Nn(e,0,e.window[e.strstart-1]))&&jn(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=Nn(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,4===t?(jn(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(jn(e,!1),0===e.strm.avail_out)?1:2}function Xn(e,t,n,r,o){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=o}function $n(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new $t(1146),this.dyn_dtree=new $t(122),this.bl_tree=new $t(78),Vn(this.dyn_ltree),Vn(this.dyn_dtree),Vn(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new $t(16),this.heap=new $t(573),Vn(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new $t(573),Vn(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Zn(e){var t,n=function(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=2,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:113,e.adler=2===t.wrap?0:1,t.last_flush=0,function(e){On||(function(){var e,t,n,r,o,i=new Array(16);for(n=0,r=0;r<28;r++)for(cn[r]=n,e=0;e<1<<en[r];e++)un[n++]=r;for(un[n-1]=r,o=0,r=0;r<16;r++)for(pn[r]=o,e=0;e<1<<tn[r];e++)sn[o++]=r;for(o>>=7;r<30;r++)for(pn[r]=o<<7,e=0;e<1<<tn[r]-7;e++)sn[256+o++]=r;for(t=0;t<=15;t++)i[t]=0;for(e=0;e<=143;)on[2*e+1]=8,e++,i[8]++;for(;e<=255;)on[2*e+1]=9,e++,i[9]++;for(;e<=279;)on[2*e+1]=7,e++,i[7]++;for(;e<=287;)on[2*e+1]=8,e++,i[8]++;for(Mn(on,287,i),e=0;e<30;e++)an[2*e+1]=5,an[2*e]=In(e,5);ln=new hn(on,en,257,286,15),dn=new hn(an,tn,0,30,15),fn=new hn(new Array(0),nn,0,19,7)}(),On=!0),e.l_desc=new gn(e.dyn_ltree,ln),e.d_desc=new gn(e.dyn_dtree,dn),e.bl_desc=new gn(e.bl_tree,fn),e.bi_buf=0,e.bi_valid=0,Tn(e)}(t),0):Fn(e,-2)}(e);return 0===n&&((t=e.state).window_size=2*t.w_size,Vn(t.head),t.max_lazy_match=Un[t.level].max_lazy,t.good_match=Un[t.level].good_length,t.nice_match=Un[t.level].nice_length,t.max_chain_length=Un[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0),n}function Qn(e,t){var n,r,o,i;if(!e||!e.state||t>5||t<0)return e?Fn(e,-2):-2;if(r=e.state,!e.output||!e.input&&0!==e.avail_in||666===r.status&&4!==t)return Fn(e,0===e.avail_out?-5:-2);if(r.strm=e,n=r.last_flush,r.last_flush=t,42===r.status)if(2===r.wrap)e.adler=0,Hn(r,31),Hn(r,139),Hn(r,8),r.gzhead?(Hn(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),Hn(r,255&r.gzhead.time),Hn(r,r.gzhead.time>>8&255),Hn(r,r.gzhead.time>>16&255),Hn(r,r.gzhead.time>>24&255),Hn(r,9===r.level?2:r.strategy>=2||r.level<2?4:0),Hn(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(Hn(r,255&r.gzhead.extra.length),Hn(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=Pn(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69):(Hn(r,0),Hn(r,0),Hn(r,0),Hn(r,0),Hn(r,0),Hn(r,9===r.level?2:r.strategy>=2||r.level<2?4:0),Hn(r,3),r.status=113);else{var a=8+(r.w_bits-8<<4)<<8;a|=(r.strategy>=2||r.level<2?0:r.level<6?1:6===r.level?2:3)<<6,0!==r.strstart&&(a|=32),a+=31-a%31,r.status=113,Kn(r,a),0!==r.strstart&&(Kn(r,e.adler>>>16),Kn(r,65535&e.adler)),e.adler=1}if(69===r.status)if(r.gzhead.extra){for(o=r.pending;r.gzindex<(65535&r.gzhead.extra.length)&&(r.pending!==r.pending_buf_size||(r.gzhead.hcrc&&r.pending>o&&(e.adler=Pn(e.adler,r.pending_buf,r.pending-o,o)),Bn(e),o=r.pending,r.pending!==r.pending_buf_size));)Hn(r,255&r.gzhead.extra[r.gzindex]),r.gzindex++;r.gzhead.hcrc&&r.pending>o&&(e.adler=Pn(e.adler,r.pending_buf,r.pending-o,o)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=73)}else r.status=73;if(73===r.status)if(r.gzhead.name){o=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>o&&(e.adler=Pn(e.adler,r.pending_buf,r.pending-o,o)),Bn(e),o=r.pending,r.pending===r.pending_buf_size)){i=1;break}i=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,Hn(r,i)}while(0!==i);r.gzhead.hcrc&&r.pending>o&&(e.adler=Pn(e.adler,r.pending_buf,r.pending-o,o)),0===i&&(r.gzindex=0,r.status=91)}else r.status=91;if(91===r.status)if(r.gzhead.comment){o=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>o&&(e.adler=Pn(e.adler,r.pending_buf,r.pending-o,o)),Bn(e),o=r.pending,r.pending===r.pending_buf_size)){i=1;break}i=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,Hn(r,i)}while(0!==i);r.gzhead.hcrc&&r.pending>o&&(e.adler=Pn(e.adler,r.pending_buf,r.pending-o,o)),0===i&&(r.status=103)}else r.status=103;if(103===r.status&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&Bn(e),r.pending+2<=r.pending_buf_size&&(Hn(r,255&e.adler),Hn(r,e.adler>>8&255),e.adler=0,r.status=113)):r.status=113),0!==r.pending){if(Bn(e),0===e.avail_out)return r.last_flush=-1,0}else if(0===e.avail_in&&qn(t)<=qn(n)&&4!==t)return Fn(e,-5);if(666===r.status&&0!==e.avail_in)return Fn(e,-5);if(0!==e.avail_in||0!==r.lookahead||0!==t&&666!==r.status){var s=2===r.strategy?function(e,t){for(var n;;){if(0===e.lookahead&&(Yn(e),0===e.lookahead)){if(0===t)return 1;break}if(e.match_length=0,n=Nn(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(jn(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(jn(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(jn(e,!1),0===e.strm.avail_out)?1:2}(r,t):3===r.strategy?function(e,t){for(var n,r,o,i,a=e.window;;){if(e.lookahead<=Gn){if(Yn(e),e.lookahead<=Gn&&0===t)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(r=a[o=e.strstart-1])===a[++o]&&r===a[++o]&&r===a[++o]){i=e.strstart+Gn;do{}while(r===a[++o]&&r===a[++o]&&r===a[++o]&&r===a[++o]&&r===a[++o]&&r===a[++o]&&r===a[++o]&&r===a[++o]&&o<i);e.match_length=Gn-(i-o),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(n=Nn(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=Nn(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(jn(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(jn(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(jn(e,!1),0===e.strm.avail_out)?1:2}(r,t):Un[r.level].func(r,t);if(3!==s&&4!==s||(r.status=666),1===s||3===s)return 0===e.avail_out&&(r.last_flush=-1),0;if(2===s&&(1===t?function(e){mn(e,2,3),yn(e,256,on),function(e){16===e.bi_valid?(_n(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}(r):5!==t&&(Rn(r,0,0,!1),3===t&&(Vn(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),Bn(e),0===e.avail_out))return r.last_flush=-1,0}return 4!==t?0:r.wrap<=0?1:(2===r.wrap?(Hn(r,255&e.adler),Hn(r,e.adler>>8&255),Hn(r,e.adler>>16&255),Hn(r,e.adler>>24&255),Hn(r,255&e.total_in),Hn(r,e.total_in>>8&255),Hn(r,e.total_in>>16&255),Hn(r,e.total_in>>24&255)):(Kn(r,e.adler>>>16),Kn(r,65535&e.adler)),Bn(e),r.wrap>0&&(r.wrap=-r.wrap),0!==r.pending?0:1)}Un=[new Xn(0,0,0,0,(function(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(Yn(e),0===e.lookahead&&0===t)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var r=e.block_start+n;if((0===e.strstart||e.strstart>=r)&&(e.lookahead=e.strstart-r,e.strstart=r,jn(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-xn&&(jn(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(jn(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(jn(e,!1),e.strm.avail_out),1)})),new Xn(4,4,8,4,zn),new Xn(4,5,16,8,zn),new Xn(4,6,32,32,zn),new Xn(4,4,16,16,Jn),new Xn(8,16,32,32,Jn),new Xn(8,16,128,128,Jn),new Xn(8,32,128,256,Jn),new Xn(32,128,258,1024,Jn),new Xn(32,258,258,4096,Jn)];function er(e,t){var n,r,o,i,a,s,u,c,l,d,f,p,h,g,v,_,m,y,I,M,T,S,E,C,k;n=e.state,r=e.next_in,C=e.input,o=r+(e.avail_in-5),i=e.next_out,k=e.output,a=i-(t-e.avail_out),s=i+(e.avail_out-257),u=n.dmax,c=n.wsize,l=n.whave,d=n.wnext,f=n.window,p=n.hold,h=n.bits,g=n.lencode,v=n.distcode,_=(1<<n.lenbits)-1,m=(1<<n.distbits)-1;e:do{h<15&&(p+=C[r++]<<h,h+=8,p+=C[r++]<<h,h+=8),y=g[p&_];t:for(;;){if(p>>>=I=y>>>24,h-=I,0===(I=y>>>16&255))k[i++]=65535&y;else{if(!(16&I)){if(0==(64&I)){y=g[(65535&y)+(p&(1<<I)-1)];continue t}if(32&I){n.mode=12;break e}e.msg="invalid literal/length code",n.mode=30;break e}M=65535&y,(I&=15)&&(h<I&&(p+=C[r++]<<h,h+=8),M+=p&(1<<I)-1,p>>>=I,h-=I),h<15&&(p+=C[r++]<<h,h+=8,p+=C[r++]<<h,h+=8),y=v[p&m];n:for(;;){if(p>>>=I=y>>>24,h-=I,!(16&(I=y>>>16&255))){if(0==(64&I)){y=v[(65535&y)+(p&(1<<I)-1)];continue n}e.msg="invalid distance code",n.mode=30;break e}if(T=65535&y,h<(I&=15)&&(p+=C[r++]<<h,(h+=8)<I&&(p+=C[r++]<<h,h+=8)),(T+=p&(1<<I)-1)>u){e.msg="invalid distance too far back",n.mode=30;break e}if(p>>>=I,h-=I,T>(I=i-a)){if((I=T-I)>l&&n.sane){e.msg="invalid distance too far back",n.mode=30;break e}if(S=0,E=f,0===d){if(S+=c-I,I<M){M-=I;do{k[i++]=f[S++]}while(--I);S=i-T,E=k}}else if(d<I){if(S+=c+d-I,(I-=d)<M){M-=I;do{k[i++]=f[S++]}while(--I);if(S=0,d<M){M-=I=d;do{k[i++]=f[S++]}while(--I);S=i-T,E=k}}}else if(S+=d-I,I<M){M-=I;do{k[i++]=f[S++]}while(--I);S=i-T,E=k}for(;M>2;)k[i++]=E[S++],k[i++]=E[S++],k[i++]=E[S++],M-=3;M&&(k[i++]=E[S++],M>1&&(k[i++]=E[S++]))}else{S=i-T;do{k[i++]=k[S++],k[i++]=k[S++],k[i++]=k[S++],M-=3}while(M>2);M&&(k[i++]=k[S++],M>1&&(k[i++]=k[S++]))}break}}break}}while(r<o&&i<s);r-=M=h>>3,p&=(1<<(h-=M<<3))-1,e.next_in=r,e.next_out=i,e.avail_in=r<o?o-r+5:5-(r-o),e.avail_out=i<s?s-i+257:257-(i-s),n.hold=p,n.bits=h}var tr=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],nr=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],rr=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],or=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];function ir(e,t,n,r,o,i,a,s){var u,c,l,d,f,p,h,g,v,_=s.bits,m=0,y=0,I=0,M=0,T=0,S=0,E=0,C=0,k=0,b=0,D=null,A=0,O=new $t(16),R=new $t(16),N=null,w=0;for(m=0;m<=15;m++)O[m]=0;for(y=0;y<r;y++)O[t[n+y]]++;for(T=_,M=15;M>=1&&0===O[M];M--);if(T>M&&(T=M),0===M)return o[i++]=20971520,o[i++]=20971520,s.bits=1,0;for(I=1;I<M&&0===O[I];I++);for(T<I&&(T=I),C=1,m=1;m<=15;m++)if(C<<=1,(C-=O[m])<0)return-1;if(C>0&&(0===e||1!==M))return-1;for(R[1]=0,m=1;m<15;m++)R[m+1]=R[m]+O[m];for(y=0;y<r;y++)0!==t[n+y]&&(a[R[t[n+y]]++]=y);if(0===e?(D=N=a,p=19):1===e?(D=tr,A-=257,N=nr,w-=257,p=256):(D=rr,N=or,p=-1),b=0,y=0,m=I,f=i,S=T,E=0,l=-1,d=(k=1<<T)-1,1===e&&k>852||2===e&&k>592)return 1;for(;;){h=m-E,a[y]<p?(g=0,v=a[y]):a[y]>p?(g=N[w+a[y]],v=D[A+a[y]]):(g=96,v=0),u=1<<m-E,I=c=1<<S;do{o[f+(b>>E)+(c-=u)]=h<<24|g<<16|v|0}while(0!==c);for(u=1<<m-1;b&u;)u>>=1;if(0!==u?(b&=u-1,b+=u):b=0,y++,0==--O[m]){if(m===M)break;m=t[n+a[y]]}if(m>T&&(b&d)!==l){for(0===E&&(E=T),f+=I,C=1<<(S=m-E);S+E<M&&!((C-=O[S+E])<=0);)S++,C<<=1;if(k+=1<<S,1===e&&k>852||2===e&&k>592)return 1;o[l=b&d]=T<<24|S<<16|f-i|0}}return 0!==b&&(o[f+b]=m-E<<24|64<<16|0),s.bits=T,0}function ar(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function sr(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new $t(320),this.work=new $t(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function ur(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,function(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Zt(852),t.distcode=t.distdyn=new Zt(592),t.sane=1,t.back=-1,0):-2}(e)):-2}var cr,lr,dr=!0;function fr(e){if(dr){var t;for(cr=new Zt(512),lr=new Zt(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(ir(1,e.lens,0,288,cr,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;ir(2,e.lens,0,32,lr,0,e.work,{bits:5}),dr=!1}e.lencode=cr,e.lenbits=9,e.distcode=lr,e.distbits=5}var pr;function hr(e){if(e<1||e>7)throw new TypeError("Bad argument");this.mode=e,this.init_done=!1,this.write_in_progress=!1,this.pending_close=!1,this.windowBits=0,this.level=0,this.memLevel=0,this.strategy=0,this.dictionary=null}function gr(e,t){for(var n=0;n<e.length;n++)this[t+n]=e[n]}hr.prototype.init=function(e,t,n,r,o){var i;switch(this.windowBits=e,this.level=t,this.memLevel=n,this.strategy=r,3!==this.mode&&4!==this.mode||(this.windowBits+=16),7===this.mode&&(this.windowBits+=32),5!==this.mode&&6!==this.mode||(this.windowBits=-this.windowBits),this.strm=new zt,this.mode){case 1:case 3:case 5:i=function(e,t,n,r,o,i){if(!e)return-2;var a=1;if(-1===t&&(t=6),r<0?(a=0,r=-r):r>15&&(a=2,r-=16),o<1||o>9||r<8||r>15||t<0||t>9||i<0||i>4)return Fn(e,-2);8===r&&(r=9);var s=new $n;return e.state=s,s.strm=e,s.wrap=a,s.gzhead=null,s.w_bits=r,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=o+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+3-1)/3),s.window=new Xt(2*s.w_size),s.head=new $t(s.hash_size),s.prev=new $t(s.w_size),s.lit_bufsize=1<<o+6,s.pending_buf_size=4*s.lit_bufsize,s.pending_buf=new Xt(s.pending_buf_size),s.d_buf=1*s.lit_bufsize,s.l_buf=3*s.lit_bufsize,s.level=t,s.strategy=i,s.method=8,Zn(e)}(this.strm,this.level,0,this.windowBits,this.memLevel,this.strategy);break;case 2:case 4:case 6:case 7:i=function(e,t){var n,r;return e?(r=new sr,e.state=r,r.window=null,0!==(n=function(e,t){var n,r;return e&&e.state?(r=e.state,t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?-2:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,ur(e))):-2}(e,t))&&(e.state=null),n):-2}(this.strm,this.windowBits);break;default:throw new Error("Unknown mode "+this.mode)}0===i?(this.write_in_progress=!1,this.init_done=!0):this._error(i)},hr.prototype.params=function(){throw new Error("deflateParams Not supported")},hr.prototype._writeCheck=function(){if(!this.init_done)throw new Error("write before init");if(0===this.mode)throw new Error("already finalized");if(this.write_in_progress)throw new Error("write already in progress");if(this.pending_close)throw new Error("close is pending")},hr.prototype.write=function(e,t,n,r,o,i,a){this._writeCheck(),this.write_in_progress=!0;var s=this;return Ie((function(){s.write_in_progress=!1;var u=s._write(e,t,n,r,o,i,a);s.callback(u[0],u[1]),s.pending_close&&s.close()})),this},hr.prototype.writeSync=function(e,t,n,r,o,i,a){return this._writeCheck(),this._write(e,t,n,r,o,i,a)},hr.prototype._write=function(e,t,n,r,o,i,a){if(this.write_in_progress=!0,0!==e&&1!==e&&2!==e&&3!==e&&4!==e&&5!==e)throw new Error("Invalid flush value");null==t&&(t=new M(0),r=0,n=0),o._set?o.set=o._set:o.set=gr;var s,u=this.strm;switch(u.avail_in=r,u.input=t,u.next_in=n,u.avail_out=a,u.output=o,u.next_out=i,this.mode){case 1:case 3:case 5:s=Qn(u,e);break;case 7:case 2:case 4:case 6:s=function(e,t){var n,r,o,i,a,s,u,c,l,d,f,p,h,g,v,_,m,y,I,M,T,S,E,C,k=0,b=new Xt(4),D=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return-2;12===(n=e.state).mode&&(n.mode=13),a=e.next_out,o=e.output,u=e.avail_out,i=e.next_in,r=e.input,s=e.avail_in,c=n.hold,l=n.bits,d=s,f=u,S=0;e:for(;;)switch(n.mode){case 1:if(0===n.wrap){n.mode=13;break}for(;l<16;){if(0===s)break e;s--,c+=r[i++]<<l,l+=8}if(2&n.wrap&&35615===c){n.check=0,b[0]=255&c,b[1]=c>>>8&255,n.check=Pn(n.check,b,2,0),c=0,l=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&c)<<8)+(c>>8))%31){e.msg="incorrect header check",n.mode=30;break}if(8!==(15&c)){e.msg="unknown compression method",n.mode=30;break}if(l-=4,T=8+(15&(c>>>=4)),0===n.wbits)n.wbits=T;else if(T>n.wbits){e.msg="invalid window size",n.mode=30;break}n.dmax=1<<T,e.adler=n.check=1,n.mode=512&c?10:12,c=0,l=0;break;case 2:for(;l<16;){if(0===s)break e;s--,c+=r[i++]<<l,l+=8}if(n.flags=c,8!==(255&n.flags)){e.msg="unknown compression method",n.mode=30;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=30;break}n.head&&(n.head.text=c>>8&1),512&n.flags&&(b[0]=255&c,b[1]=c>>>8&255,n.check=Pn(n.check,b,2,0)),c=0,l=0,n.mode=3;case 3:for(;l<32;){if(0===s)break e;s--,c+=r[i++]<<l,l+=8}n.head&&(n.head.time=c),512&n.flags&&(b[0]=255&c,b[1]=c>>>8&255,b[2]=c>>>16&255,b[3]=c>>>24&255,n.check=Pn(n.check,b,4,0)),c=0,l=0,n.mode=4;case 4:for(;l<16;){if(0===s)break e;s--,c+=r[i++]<<l,l+=8}n.head&&(n.head.xflags=255&c,n.head.os=c>>8),512&n.flags&&(b[0]=255&c,b[1]=c>>>8&255,n.check=Pn(n.check,b,2,0)),c=0,l=0,n.mode=5;case 5:if(1024&n.flags){for(;l<16;){if(0===s)break e;s--,c+=r[i++]<<l,l+=8}n.length=c,n.head&&(n.head.extra_len=c),512&n.flags&&(b[0]=255&c,b[1]=c>>>8&255,n.check=Pn(n.check,b,2,0)),c=0,l=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&((p=n.length)>s&&(p=s),p&&(n.head&&(T=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),Jt(n.head.extra,r,i,p,T)),512&n.flags&&(n.check=Pn(n.check,r,p,i)),s-=p,i+=p,n.length-=p),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===s)break e;p=0;do{T=r[i+p++],n.head&&T&&n.length<65536&&(n.head.name+=String.fromCharCode(T))}while(T&&p<s);if(512&n.flags&&(n.check=Pn(n.check,r,p,i)),s-=p,i+=p,T)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===s)break e;p=0;do{T=r[i+p++],n.head&&T&&n.length<65536&&(n.head.comment+=String.fromCharCode(T))}while(T&&p<s);if(512&n.flags&&(n.check=Pn(n.check,r,p,i)),s-=p,i+=p,T)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;l<16;){if(0===s)break e;s--,c+=r[i++]<<l,l+=8}if(c!==(65535&n.check)){e.msg="header crc mismatch",n.mode=30;break}c=0,l=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=12;break;case 10:for(;l<32;){if(0===s)break e;s--,c+=r[i++]<<l,l+=8}e.adler=n.check=ar(c),c=0,l=0,n.mode=11;case 11:if(0===n.havedict)return e.next_out=a,e.avail_out=u,e.next_in=i,e.avail_in=s,n.hold=c,n.bits=l,2;e.adler=n.check=1,n.mode=12;case 12:if(5===t||6===t)break e;case 13:if(n.last){c>>>=7&l,l-=7&l,n.mode=27;break}for(;l<3;){if(0===s)break e;s--,c+=r[i++]<<l,l+=8}switch(n.last=1&c,l-=1,3&(c>>>=1)){case 0:n.mode=14;break;case 1:if(fr(n),n.mode=20,6===t){c>>>=2,l-=2;break e}break;case 2:n.mode=17;break;case 3:e.msg="invalid block type",n.mode=30}c>>>=2,l-=2;break;case 14:for(c>>>=7&l,l-=7&l;l<32;){if(0===s)break e;s--,c+=r[i++]<<l,l+=8}if((65535&c)!=(c>>>16^65535)){e.msg="invalid stored block lengths",n.mode=30;break}if(n.length=65535&c,c=0,l=0,n.mode=15,6===t)break e;case 15:n.mode=16;case 16:if(p=n.length){if(p>s&&(p=s),p>u&&(p=u),0===p)break e;Jt(o,r,i,p,a),s-=p,i+=p,u-=p,a+=p,n.length-=p;break}n.mode=12;break;case 17:for(;l<14;){if(0===s)break e;s--,c+=r[i++]<<l,l+=8}if(n.nlen=257+(31&c),c>>>=5,l-=5,n.ndist=1+(31&c),c>>>=5,l-=5,n.ncode=4+(15&c),c>>>=4,l-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=30;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;l<3;){if(0===s)break e;s--,c+=r[i++]<<l,l+=8}n.lens[D[n.have++]]=7&c,c>>>=3,l-=3}for(;n.have<19;)n.lens[D[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,E={bits:n.lenbits},S=ir(0,n.lens,0,19,n.lencode,0,n.work,E),n.lenbits=E.bits,S){e.msg="invalid code lengths set",n.mode=30;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;_=(k=n.lencode[c&(1<<n.lenbits)-1])>>>16&255,m=65535&k,!((v=k>>>24)<=l);){if(0===s)break e;s--,c+=r[i++]<<l,l+=8}if(m<16)c>>>=v,l-=v,n.lens[n.have++]=m;else{if(16===m){for(C=v+2;l<C;){if(0===s)break e;s--,c+=r[i++]<<l,l+=8}if(c>>>=v,l-=v,0===n.have){e.msg="invalid bit length repeat",n.mode=30;break}T=n.lens[n.have-1],p=3+(3&c),c>>>=2,l-=2}else if(17===m){for(C=v+3;l<C;){if(0===s)break e;s--,c+=r[i++]<<l,l+=8}l-=v,T=0,p=3+(7&(c>>>=v)),c>>>=3,l-=3}else{for(C=v+7;l<C;){if(0===s)break e;s--,c+=r[i++]<<l,l+=8}l-=v,T=0,p=11+(127&(c>>>=v)),c>>>=7,l-=7}if(n.have+p>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=30;break}for(;p--;)n.lens[n.have++]=T}}if(30===n.mode)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=30;break}if(n.lenbits=9,E={bits:n.lenbits},S=ir(1,n.lens,0,n.nlen,n.lencode,0,n.work,E),n.lenbits=E.bits,S){e.msg="invalid literal/lengths set",n.mode=30;break}if(n.distbits=6,n.distcode=n.distdyn,E={bits:n.distbits},S=ir(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,E),n.distbits=E.bits,S){e.msg="invalid distances set",n.mode=30;break}if(n.mode=20,6===t)break e;case 20:n.mode=21;case 21:if(s>=6&&u>=258){e.next_out=a,e.avail_out=u,e.next_in=i,e.avail_in=s,n.hold=c,n.bits=l,er(e,f),a=e.next_out,o=e.output,u=e.avail_out,i=e.next_in,r=e.input,s=e.avail_in,c=n.hold,l=n.bits,12===n.mode&&(n.back=-1);break}for(n.back=0;_=(k=n.lencode[c&(1<<n.lenbits)-1])>>>16&255,m=65535&k,!((v=k>>>24)<=l);){if(0===s)break e;s--,c+=r[i++]<<l,l+=8}if(_&&0==(240&_)){for(y=v,I=_,M=m;_=(k=n.lencode[M+((c&(1<<y+I)-1)>>y)])>>>16&255,m=65535&k,!(y+(v=k>>>24)<=l);){if(0===s)break e;s--,c+=r[i++]<<l,l+=8}c>>>=y,l-=y,n.back+=y}if(c>>>=v,l-=v,n.back+=v,n.length=m,0===_){n.mode=26;break}if(32&_){n.back=-1,n.mode=12;break}if(64&_){e.msg="invalid literal/length code",n.mode=30;break}n.extra=15&_,n.mode=22;case 22:if(n.extra){for(C=n.extra;l<C;){if(0===s)break e;s--,c+=r[i++]<<l,l+=8}n.length+=c&(1<<n.extra)-1,c>>>=n.extra,l-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;_=(k=n.distcode[c&(1<<n.distbits)-1])>>>16&255,m=65535&k,!((v=k>>>24)<=l);){if(0===s)break e;s--,c+=r[i++]<<l,l+=8}if(0==(240&_)){for(y=v,I=_,M=m;_=(k=n.distcode[M+((c&(1<<y+I)-1)>>y)])>>>16&255,m=65535&k,!(y+(v=k>>>24)<=l);){if(0===s)break e;s--,c+=r[i++]<<l,l+=8}c>>>=y,l-=y,n.back+=y}if(c>>>=v,l-=v,n.back+=v,64&_){e.msg="invalid distance code",n.mode=30;break}n.offset=m,n.extra=15&_,n.mode=24;case 24:if(n.extra){for(C=n.extra;l<C;){if(0===s)break e;s--,c+=r[i++]<<l,l+=8}n.offset+=c&(1<<n.extra)-1,c>>>=n.extra,l-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=30;break}n.mode=25;case 25:if(0===u)break e;if(p=f-u,n.offset>p){if((p=n.offset-p)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=30;break}p>n.wnext?(p-=n.wnext,h=n.wsize-p):h=n.wnext-p,p>n.length&&(p=n.length),g=n.window}else g=o,h=a-n.offset,p=n.length;p>u&&(p=u),u-=p,n.length-=p;do{o[a++]=g[h++]}while(--p);0===n.length&&(n.mode=21);break;case 26:if(0===u)break e;o[a++]=n.length,u--,n.mode=21;break;case 27:if(n.wrap){for(;l<32;){if(0===s)break e;s--,c|=r[i++]<<l,l+=8}if(f-=u,e.total_out+=f,n.total+=f,f&&(e.adler=n.check=n.flags?Pn(n.check,o,f,a-f):wn(n.check,o,f,a-f)),f=u,(n.flags?c:ar(c))!==n.check){e.msg="incorrect data check",n.mode=30;break}c=0,l=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;l<32;){if(0===s)break e;s--,c+=r[i++]<<l,l+=8}if(c!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=30;break}c=0,l=0}n.mode=29;case 29:S=1;break e;case 30:S=-3;break e;case 31:return-4;case 32:default:return-2}return e.next_out=a,e.avail_out=u,e.next_in=i,e.avail_in=s,n.hold=c,n.bits=l,(n.wsize||f!==e.avail_out&&n.mode<30&&(n.mode<27||4!==t))&&function(e,t,n,r){var o,i=e.state;null===i.window&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new Xt(i.wsize)),r>=i.wsize?(Jt(i.window,t,n-i.wsize,i.wsize,0),i.wnext=0,i.whave=i.wsize):((o=i.wsize-i.wnext)>r&&(o=r),Jt(i.window,t,n-r,o,i.wnext),(r-=o)?(Jt(i.window,t,n-r,r,0),i.wnext=r,i.whave=i.wsize):(i.wnext+=o,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=o)))}(e,e.output,e.next_out,f-e.avail_out),d-=e.avail_in,f-=e.avail_out,e.total_in+=d,e.total_out+=f,n.total+=f,n.wrap&&f&&(e.adler=n.check=n.flags?Pn(n.check,o,f,e.next_out-f):wn(n.check,o,f,e.next_out-f)),e.data_type=n.bits+(n.last?64:0)+(12===n.mode?128:0)+(20===n.mode||15===n.mode?256:0),(0===d&&0===f||4===t)&&0===S&&(S=-5),S}(u,e);break;default:throw new Error("Unknown mode "+this.mode)}return 1!==s&&0!==s&&this._error(s),this.write_in_progress=!1,[u.avail_in,u.avail_out]},hr.prototype.close=function(){this.write_in_progress?this.pending_close=!0:(this.pending_close=!1,1===this.mode||3===this.mode||5===this.mode?function(e){var t;e&&e.state&&(42!==(t=e.state.status)&&69!==t&&73!==t&&91!==t&&103!==t&&113!==t&&666!==t?Fn(e,-2):(e.state=null,113===t&&Fn(e,-3)))}(this.strm):function(e){if(!e||!e.state)return-2;var t=e.state;t.window&&(t.window=null),e.state=null}(this.strm),this.mode=0)},hr.prototype.reset=function(){switch(this.mode){case 1:case 5:pr=Zn(this.strm);break;case 2:case 6:pr=ur(this.strm)}0!==pr&&this._error(pr)},hr.prototype._error=function(e){this.onerror(Yt[e]+": "+this.strm.msg,e),this.write_in_progress=!1,this.pending_close&&this.close()};var vr=Object.freeze({NONE:0,DEFLATE:1,INFLATE:2,GZIP:3,GUNZIP:4,DEFLATERAW:5,INFLATERAW:6,UNZIP:7,Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8,Zlib:hr}),_r={};Object.keys(vr).forEach((function(e){_r[e]=vr[e]})),_r.Z_MIN_WINDOWBITS=8,_r.Z_MAX_WINDOWBITS=15,_r.Z_DEFAULT_WINDOWBITS=15,_r.Z_MIN_CHUNK=64,_r.Z_MAX_CHUNK=1/0,_r.Z_DEFAULT_CHUNK=16384,_r.Z_MIN_MEMLEVEL=1,_r.Z_MAX_MEMLEVEL=9,_r.Z_DEFAULT_MEMLEVEL=8,_r.Z_MIN_LEVEL=-1,_r.Z_MAX_LEVEL=9,_r.Z_DEFAULT_LEVEL=_r.Z_DEFAULT_COMPRESSION;var mr={Z_OK:_r.Z_OK,Z_STREAM_END:_r.Z_STREAM_END,Z_NEED_DICT:_r.Z_NEED_DICT,Z_ERRNO:_r.Z_ERRNO,Z_STREAM_ERROR:_r.Z_STREAM_ERROR,Z_DATA_ERROR:_r.Z_DATA_ERROR,Z_MEM_ERROR:_r.Z_MEM_ERROR,Z_BUF_ERROR:_r.Z_BUF_ERROR,Z_VERSION_ERROR:_r.Z_VERSION_ERROR};function yr(e,t,n){var r=[],o=0;function i(){for(var t;null!==(t=e.read());)r.push(t),o+=t.length;e.once("readable",i)}function a(){var t=M.concat(r,o);r=[],n(null,t),e.close()}e.on("error",(function(t){e.removeListener("end",a),e.removeListener("readable",i),n(t)})),e.on("end",a),e.end(t),i()}function Ir(e,t){if("string"==typeof t&&(t=new M(t)),!oe(t))throw new TypeError("Not a string or buffer");var n=_r.Z_FINISH;return e._processChunk(t,n)}function Mr(e){if(!(this instanceof Mr))return new Mr(e);Dr.call(this,e,_r.DEFLATE)}function Tr(e){if(!(this instanceof Tr))return new Tr(e);Dr.call(this,e,_r.INFLATE)}function Sr(e){if(!(this instanceof Sr))return new Sr(e);Dr.call(this,e,_r.GZIP)}function Er(e){if(!(this instanceof Er))return new Er(e);Dr.call(this,e,_r.GUNZIP)}function Cr(e){if(!(this instanceof Cr))return new Cr(e);Dr.call(this,e,_r.DEFLATERAW)}function kr(e){if(!(this instanceof kr))return new kr(e);Dr.call(this,e,_r.INFLATERAW)}function br(e){if(!(this instanceof br))return new br(e);Dr.call(this,e,_r.UNZIP)}function Dr(e,t){if(this._opts=e=e||{},this._chunkSize=e.chunkSize||_r.Z_DEFAULT_CHUNK,jt.call(this,e),e.flush&&e.flush!==_r.Z_NO_FLUSH&&e.flush!==_r.Z_PARTIAL_FLUSH&&e.flush!==_r.Z_SYNC_FLUSH&&e.flush!==_r.Z_FULL_FLUSH&&e.flush!==_r.Z_FINISH&&e.flush!==_r.Z_BLOCK)throw new Error("Invalid flush flag: "+e.flush);if(this._flushFlag=e.flush||_r.Z_NO_FLUSH,e.chunkSize&&(e.chunkSize<_r.Z_MIN_CHUNK||e.chunkSize>_r.Z_MAX_CHUNK))throw new Error("Invalid chunk size: "+e.chunkSize);if(e.windowBits&&(e.windowBits<_r.Z_MIN_WINDOWBITS||e.windowBits>_r.Z_MAX_WINDOWBITS))throw new Error("Invalid windowBits: "+e.windowBits);if(e.level&&(e.level<_r.Z_MIN_LEVEL||e.level>_r.Z_MAX_LEVEL))throw new Error("Invalid compression level: "+e.level);if(e.memLevel&&(e.memLevel<_r.Z_MIN_MEMLEVEL||e.memLevel>_r.Z_MAX_MEMLEVEL))throw new Error("Invalid memLevel: "+e.memLevel);if(e.strategy&&e.strategy!=_r.Z_FILTERED&&e.strategy!=_r.Z_HUFFMAN_ONLY&&e.strategy!=_r.Z_RLE&&e.strategy!=_r.Z_FIXED&&e.strategy!=_r.Z_DEFAULT_STRATEGY)throw new Error("Invalid strategy: "+e.strategy);if(e.dictionary&&!oe(e.dictionary))throw new Error("Invalid dictionary: it should be a Buffer instance");this._binding=new _r.Zlib(t);var n=this;this._hadError=!1,this._binding.onerror=function(e,t){n._binding=null,n._hadError=!0;var r=new Error(e);r.errno=t,r.code=_r.codes[t],n.emit("error",r)};var r=_r.Z_DEFAULT_COMPRESSION;"number"==typeof e.level&&(r=e.level);var o=_r.Z_DEFAULT_STRATEGY;"number"==typeof e.strategy&&(o=e.strategy),this._binding.init(e.windowBits||_r.Z_DEFAULT_WINDOWBITS,r,e.memLevel||_r.Z_DEFAULT_MEMLEVEL,o,e.dictionary),this._buffer=new M(this._chunkSize),this._offset=0,this._closed=!1,this._level=r,this._strategy=o,this.once("end",this.close)}Object.keys(mr).forEach((function(e){mr[mr[e]]=e})),Pe(Dr,jt),Dr.prototype.params=function(e,t,n){if(e<_r.Z_MIN_LEVEL||e>_r.Z_MAX_LEVEL)throw new RangeError("Invalid compression level: "+e);if(t!=_r.Z_FILTERED&&t!=_r.Z_HUFFMAN_ONLY&&t!=_r.Z_RLE&&t!=_r.Z_FIXED&&t!=_r.Z_DEFAULT_STRATEGY)throw new TypeError("Invalid strategy: "+t);if(this._level!==e||this._strategy!==t){var r=this;this.flush(_r.Z_SYNC_FLUSH,(function(){r._binding.params(e,t),r._hadError||(r._level=e,r._strategy=t,n&&n())}))}else Ie(n)},Dr.prototype.reset=function(){return this._binding.reset()},Dr.prototype._flush=function(e){this._transform(new M(0),"",e)},Dr.prototype.flush=function(e,t){var n=this._writableState;if(("function"==typeof e||void 0===e&&!t)&&(t=e,e=_r.Z_FULL_FLUSH),n.ended)t&&Ie(t);else if(n.ending)t&&this.once("end",t);else if(n.needDrain){var r=this;this.once("drain",(function(){r.flush(t)}))}else this._flushFlag=e,this.write(new M(0),"",t)},Dr.prototype.close=function(e){if(e&&Ie(e),!this._closed){this._closed=!0,this._binding.close();var t=this;Ie((function(){t.emit("close")}))}},Dr.prototype._transform=function(e,t,n){var r,o=this._writableState,i=(o.ending||o.ended)&&(!e||o.length===e.length);if(null===!e&&!oe(e))return n(new Error("invalid input"));i?r=_r.Z_FINISH:(r=this._flushFlag,e.length>=o.length&&(this._flushFlag=this._opts.flush||_r.Z_NO_FLUSH)),this._processChunk(e,r,n)},Dr.prototype._processChunk=function(e,t,n){var r=e&&e.length,o=this._chunkSize-this._offset,i=0,a=this,s="function"==typeof n;if(!s){var u,c=[],l=0;this.on("error",(function(e){u=e}));do{var d=this._binding.writeSync(t,e,i,r,this._buffer,this._offset,o)}while(!this._hadError&&h(d[0],d[1]));if(this._hadError)throw u;var f=M.concat(c,l);return this.close(),f}var p=this._binding.write(t,e,i,r,this._buffer,this._offset,o);function h(u,d){if(!a._hadError){var f=o-d;if(function(e,t){if(!e)throw new Error("have should not go down")}(f>=0),f>0){var p=a._buffer.slice(a._offset,a._offset+f);a._offset+=f,s?a.push(p):(c.push(p),l+=p.length)}if((0===d||a._offset>=a._chunkSize)&&(o=a._chunkSize,a._offset=0,a._buffer=new M(a._chunkSize)),0===d){if(i+=r-u,r=u,!s)return!0;var g=a._binding.write(t,e,i,r,a._buffer,a._offset,a._chunkSize);return g.callback=h,void(g.buffer=e)}if(!s)return!1;n()}}p.buffer=e,p.callback=h},Pe(Mr,Dr),Pe(Tr,Dr),Pe(Sr,Dr),Pe(Er,Dr),Pe(Cr,Dr),Pe(kr,Dr),Pe(br,Dr);var Ar={codes:mr,createDeflate:function(e){return new Mr(e)},createInflate:function(e){return new Tr(e)},createDeflateRaw:function(e){return new Cr(e)},createInflateRaw:function(e){return new kr(e)},createGzip:function(e){return new Sr(e)},createGunzip:function(e){return new Er(e)},createUnzip:function(e){return new br(e)},deflate:function(e,t,n){return"function"==typeof t&&(n=t,t={}),yr(new Mr(t),e,n)},deflateSync:function(e,t){return Ir(new Mr(t),e)},gzip:function(e,t,n){return"function"==typeof t&&(n=t,t={}),yr(new Sr(t),e,n)},gzipSync:function(e,t){return Ir(new Sr(t),e)},deflateRaw:function(e,t,n){return"function"==typeof t&&(n=t,t={}),yr(new Cr(t),e,n)},deflateRawSync:function(e,t){return Ir(new Cr(t),e)},unzip:function(e,t,n){return"function"==typeof t&&(n=t,t={}),yr(new br(t),e,n)},unzipSync:function(e,t){return Ir(new br(t),e)},inflate:function(e,t,n){return"function"==typeof t&&(n=t,t={}),yr(new Tr(t),e,n)},inflateSync:function(e,t){return Ir(new Tr(t),e)},gunzip:function(e,t,n){return"function"==typeof t&&(n=t,t={}),yr(new Er(t),e,n)},gunzipSync:function(e,t){return Ir(new Er(t),e)},inflateRaw:function(e,t,n){return"function"==typeof t&&(n=t,t={}),yr(new kr(t),e,n)},inflateRawSync:function(e,t){return Ir(new kr(t),e)},Deflate:Mr,Inflate:Tr,Gzip:Sr,Gunzip:Er,DeflateRaw:Cr,InflateRaw:kr,Unzip:br,Zlib:Dr},Or=function(){function e(t,n,r){(0,o.default)(this,e),this.SDKAPPID=t,this.EXPIRETIME=r,this.PRIVATEKEY=n}return(0,i.default)(e,[{key:"genTestUserSig",value:function(e){return this._isNumber(this.SDKAPPID)?this._isString(this.PRIVATEKEY)?this._isString(e)?this._isNumber(this.EXPIRETIME)?(console.log("sdkAppID="+this.SDKAPPID+" key="+this.PRIVATEKEY+" userID="+e+" expire="+this.EXPIRETIME),this.genSigWithUserbuf(e,this.EXPIRETIME,null)):(console.error("expireTime must be a number"),""):(console.error("userID must be a string"),""):(console.error("privateKey must be a string"),""):(console.error("sdkAppID must be a number"),"")}},{key:"newBuffer",value:function(e,t){return M.from?M.from(e,t):new M(e,t)}},{key:"unescape",value:function(e){return e.replace(/_/g,"=").replace(/\-/g,"/").replace(/\*/g,"+")}},{key:"escape",value:function(e){return e.replace(/\+/g,"*").replace(/\//g,"-").replace(/=/g,"_")}},{key:"encode",value:function(e){return this.escape(this.newBuffer(e).toString("base64"))}},{key:"decode",value:function(e){return this.newBuffer(this.unescape(e),"base64")}},{key:"base64encode",value:function(e){return this.newBuffer(e).toString("base64")}},{key:"base64decode",value:function(e){return this.newBuffer(e,"base64").toString()}},{key:"_hmacsha256",value:function(e,t,n,r){var o="TLS.identifier:"+e+"\n";o+="TLS.sdkappid:"+this.SDKAPPID+"\n",o+="TLS.time:"+t+"\n",o+="TLS.expire:"+n+"\n",null!=r&&(o+="TLS.userbuf:"+r+"\n");var i=ue.HmacSHA256(o,this.PRIVATEKEY);return ue.enc.Base64.stringify(i)}},{key:"_utc",value:function(){return Math.round(Date.now()/1e3)}},{key:"_isNumber",value:function(e){return null!==e&&("number"==typeof e&&!isNaN(e-0)||"object"==(0,a.default)(e)&&e.constructor===Number)}},{key:"_isString",value:function(e){return"string"==typeof e}},{key:"genSigWithUserbuf",value:function(e,t,n){var r=this._utc(),o={"TLS.ver":"2.0","TLS.identifier":e,"TLS.sdkappid":this.SDKAPPID,"TLS.time":r,"TLS.expire":t},i="";if(null!=n){var a=this.base64encode(n);o["TLS.userbuf"]=a,i=this._hmacsha256(e,r,t,a)}else i=this._hmacsha256(e,r,t,null);o["TLS.sig"]=i;var s=JSON.stringify(o),u=Ar.deflateSync(this.newBuffer(s)).toString("base64"),c=this.escape(u);return console.log("ret="+c),c}},{key:"validate",value:function(e){var t=this.decode(e),n=Ar.inflateSync(t);console.log("validate ret="+n)}}]),e}();t.default=Or}).call(this,n("c8ba"))},a128:function(e,t,n){var r=n("36c6"),o=n("4a4b"),i=n("c5f7"),a=n("b17c");function s(t){var n="function"===typeof Map?new Map:void 0;return e.exports=s=function(e){if(null===e||!i(e))return e;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof n){if(n.has(e))return n.get(e);n.set(e,t)}function t(){return a(e,arguments,r(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),o(t,e)},e.exports.__esModule=!0,e.exports["default"]=e.exports,s(t)}e.exports=s,e.exports.__esModule=!0,e.exports["default"]=e.exports},a285:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={"发起会话":"发起会话","发起单聊":"发起单聊","发起群聊":"发起群聊","请输入userID":"请输入userID","删除会话":"删除会话","删除后，将清空该聊天的消息记录":"删除后，将清空该聊天的消息记录","删除后，将清空该群聊的消息记录":"删除后，将清空该群聊的消息记录","置顶会话":"置顶会话","取消置顶":"取消置顶","消息免打扰":"消息免打扰","取消免打扰":"取消免打扰","系统通知":"系统通知","有人@我":"有人@我","@所有人":"@所有人","条":"条","我":"我","网络异常，请您检查网络设置":"网络异常，请您检查网络设置","您已被群管理员移出群聊":"您已被群管理员移出群聊","该群聊已被解散":"该群聊已被解散","您已退出该群聊":"您已退出该群聊"};t.default=r},a395:function(e,t,n){var r=n("7037")["default"],o=n("e50d");e.exports=function(e){var t=o(e,"string");return"symbol"===r(t)?t:String(t)},e.exports.__esModule=!0,e.exports["default"]=e.exports},a460:function(e,t,n){"use strict";var r=n("b4d1"),o=n.n(r);o.a},a463:function(e,t){e.exports="/pages/sub-packages-doctor/static/bg-upload.png"},a493:function(e,t,n){"use strict";var r=n("71ba"),o=n.n(r);o.a},a61f:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAeCAYAAAA/xX6fAAAAAXNSR0IArs4c6QAAAbJJREFUSEvt1k9Kw0AUBvDvjYgIgmvdeAIP4AEERRC1YBHBhdJ5yQUEd57CJFPrwp1KqRXEhYdw4Q1cuVfU0jpPR6YS7X9su5Bm16bJL/PNy3slDPmgJElKANaG5F468AnA1JDAZzLGrIvIGYBxj94DuO7TA6wAmPf3qhJRltyHKIrWlVJ19F0ptZvL5U7/gubz+R1r7QmAMQBVa202DMPSF9hvtBXmnG+wX2g7rAF0XxhjVkXkHMAEgHdrbRiGYb6beI0xORGJfIwVItrUWl+lr/2xwvqJJEncZhc9aoko0Fq3RT0WA1AAKgAyzNxQfE1BB/eCdos1jTS9/G7QXrCOoN/TZWttkYgmAVgAzMzH7lwcxxtEdOFiFJFXpVRGa33Tbr9bRpq+KI7jRQBljz4w85yP/QhA6B5ERJaCILjtVFxdgf7m9Z77yMwzfvWRiAQA3pjZJdDxGIHfEaXG2CjStoUzKppR0fzPTvMCYJuZy8aYo0H2UjfNOfWS3bmmDWBhUM17GsChiLAfU+kXvP/TIvV/x42m/V/w4MA6XCgUZmu12oGI7BFRmZm3Og7Dzx98APXHdIVhykgCAAAAAElFTkSuQmCC"},a675:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={id:"2852637",name:"uniui图标库",font_family:"uniicons",css_prefix_text:"uniui-",description:"",glyphs:[{icon_id:"25027049",name:"yanse",font_class:"color",unicode:"e6cf",unicode_decimal:59087},{icon_id:"25027048",name:"wallet",font_class:"wallet",unicode:"e6b1",unicode_decimal:59057},{icon_id:"25015720",name:"settings-filled",font_class:"settings-filled",unicode:"e6ce",unicode_decimal:59086},{icon_id:"25015434",name:"shimingrenzheng-filled",font_class:"auth-filled",unicode:"e6cc",unicode_decimal:59084},{icon_id:"24934246",name:"shop-filled",font_class:"shop-filled",unicode:"e6cd",unicode_decimal:59085},{icon_id:"24934159",name:"staff-filled-01",font_class:"staff-filled",unicode:"e6cb",unicode_decimal:59083},{icon_id:"24932461",name:"VIP-filled",font_class:"vip-filled",unicode:"e6c6",unicode_decimal:59078},{icon_id:"24932462",name:"plus_circle_fill",font_class:"plus-filled",unicode:"e6c7",unicode_decimal:59079},{icon_id:"24932463",name:"folder_add-filled",font_class:"folder-add-filled",unicode:"e6c8",unicode_decimal:59080},{icon_id:"24932464",name:"yanse-filled",font_class:"color-filled",unicode:"e6c9",unicode_decimal:59081},{icon_id:"24932465",name:"tune-filled",font_class:"tune-filled",unicode:"e6ca",unicode_decimal:59082},{icon_id:"24932455",name:"a-rilidaka-filled",font_class:"calendar-filled",unicode:"e6c0",unicode_decimal:59072},{icon_id:"24932456",name:"notification-filled",font_class:"notification-filled",unicode:"e6c1",unicode_decimal:59073},{icon_id:"24932457",name:"wallet-filled",font_class:"wallet-filled",unicode:"e6c2",unicode_decimal:59074},{icon_id:"24932458",name:"paihangbang-filled",font_class:"medal-filled",unicode:"e6c3",unicode_decimal:59075},{icon_id:"24932459",name:"gift-filled",font_class:"gift-filled",unicode:"e6c4",unicode_decimal:59076},{icon_id:"24932460",name:"fire-filled",font_class:"fire-filled",unicode:"e6c5",unicode_decimal:59077},{icon_id:"24928001",name:"refreshempty",font_class:"refreshempty",unicode:"e6bf",unicode_decimal:59071},{icon_id:"24926853",name:"location-ellipse",font_class:"location-filled",unicode:"e6af",unicode_decimal:59055},{icon_id:"24926735",name:"person-filled",font_class:"person-filled",unicode:"e69d",unicode_decimal:59037},{icon_id:"24926703",name:"personadd-filled",font_class:"personadd-filled",unicode:"e698",unicode_decimal:59032},{icon_id:"24923351",name:"back",font_class:"back",unicode:"e6b9",unicode_decimal:59065},{icon_id:"24923352",name:"forward",font_class:"forward",unicode:"e6ba",unicode_decimal:59066},{icon_id:"24923353",name:"arrowthinright",font_class:"arrow-right",unicode:"e6bb",unicode_decimal:59067},{icon_id:"24923353",name:"arrowthinright",font_class:"arrowthinright",unicode:"e6bb",unicode_decimal:59067},{icon_id:"24923354",name:"arrowthinleft",font_class:"arrow-left",unicode:"e6bc",unicode_decimal:59068},{icon_id:"24923354",name:"arrowthinleft",font_class:"arrowthinleft",unicode:"e6bc",unicode_decimal:59068},{icon_id:"24923355",name:"arrowthinup",font_class:"arrow-up",unicode:"e6bd",unicode_decimal:59069},{icon_id:"24923355",name:"arrowthinup",font_class:"arrowthinup",unicode:"e6bd",unicode_decimal:59069},{icon_id:"24923356",name:"arrowthindown",font_class:"arrow-down",unicode:"e6be",unicode_decimal:59070},{icon_id:"24923356",name:"arrowthindown",font_class:"arrowthindown",unicode:"e6be",unicode_decimal:59070},{icon_id:"24923349",name:"arrowdown",font_class:"bottom",unicode:"e6b8",unicode_decimal:59064},{icon_id:"24923349",name:"arrowdown",font_class:"arrowdown",unicode:"e6b8",unicode_decimal:59064},{icon_id:"24923346",name:"arrowright",font_class:"right",unicode:"e6b5",unicode_decimal:59061},{icon_id:"24923346",name:"arrowright",font_class:"arrowright",unicode:"e6b5",unicode_decimal:59061},{icon_id:"24923347",name:"arrowup",font_class:"top",unicode:"e6b6",unicode_decimal:59062},{icon_id:"24923347",name:"arrowup",font_class:"arrowup",unicode:"e6b6",unicode_decimal:59062},{icon_id:"24923348",name:"arrowleft",font_class:"left",unicode:"e6b7",unicode_decimal:59063},{icon_id:"24923348",name:"arrowleft",font_class:"arrowleft",unicode:"e6b7",unicode_decimal:59063},{icon_id:"24923334",name:"eye",font_class:"eye",unicode:"e651",unicode_decimal:58961},{icon_id:"24923335",name:"eye-filled",font_class:"eye-filled",unicode:"e66a",unicode_decimal:58986},{icon_id:"24923336",name:"eye-slash",font_class:"eye-slash",unicode:"e6b3",unicode_decimal:59059},{icon_id:"24923337",name:"eye-slash-filled",font_class:"eye-slash-filled",unicode:"e6b4",unicode_decimal:59060},{icon_id:"24923305",name:"info-filled",font_class:"info-filled",unicode:"e649",unicode_decimal:58953},{icon_id:"24923299",name:"reload-01",font_class:"reload",unicode:"e6b2",unicode_decimal:59058},{icon_id:"24923195",name:"mic_slash_fill",font_class:"micoff-filled",unicode:"e6b0",unicode_decimal:59056},{icon_id:"24923165",name:"map-pin-ellipse",font_class:"map-pin-ellipse",unicode:"e6ac",unicode_decimal:59052},{icon_id:"24923166",name:"map-pin",font_class:"map-pin",unicode:"e6ad",unicode_decimal:59053},{icon_id:"24923167",name:"location",font_class:"location",unicode:"e6ae",unicode_decimal:59054},{icon_id:"24923064",name:"starhalf",font_class:"starhalf",unicode:"e683",unicode_decimal:59011},{icon_id:"24923065",name:"star",font_class:"star",unicode:"e688",unicode_decimal:59016},{icon_id:"24923066",name:"star-filled",font_class:"star-filled",unicode:"e68f",unicode_decimal:59023},{icon_id:"24899646",name:"a-rilidaka",font_class:"calendar",unicode:"e6a0",unicode_decimal:59040},{icon_id:"24899647",name:"fire",font_class:"fire",unicode:"e6a1",unicode_decimal:59041},{icon_id:"24899648",name:"paihangbang",font_class:"medal",unicode:"e6a2",unicode_decimal:59042},{icon_id:"24899649",name:"font",font_class:"font",unicode:"e6a3",unicode_decimal:59043},{icon_id:"24899650",name:"gift",font_class:"gift",unicode:"e6a4",unicode_decimal:59044},{icon_id:"24899651",name:"link",font_class:"link",unicode:"e6a5",unicode_decimal:59045},{icon_id:"24899652",name:"notification",font_class:"notification",unicode:"e6a6",unicode_decimal:59046},{icon_id:"24899653",name:"staff",font_class:"staff",unicode:"e6a7",unicode_decimal:59047},{icon_id:"24899654",name:"VIP",font_class:"vip",unicode:"e6a8",unicode_decimal:59048},{icon_id:"24899655",name:"folder_add",font_class:"folder-add",unicode:"e6a9",unicode_decimal:59049},{icon_id:"24899656",name:"tune",font_class:"tune",unicode:"e6aa",unicode_decimal:59050},{icon_id:"24899657",name:"shimingrenzheng",font_class:"auth",unicode:"e6ab",unicode_decimal:59051},{icon_id:"24899565",name:"person",font_class:"person",unicode:"e699",unicode_decimal:59033},{icon_id:"24899566",name:"email-filled",font_class:"email-filled",unicode:"e69a",unicode_decimal:59034},{icon_id:"24899567",name:"phone-filled",font_class:"phone-filled",unicode:"e69b",unicode_decimal:59035},{icon_id:"24899568",name:"phone",font_class:"phone",unicode:"e69c",unicode_decimal:59036},{icon_id:"24899570",name:"email",font_class:"email",unicode:"e69e",unicode_decimal:59038},{icon_id:"24899571",name:"personadd",font_class:"personadd",unicode:"e69f",unicode_decimal:59039},{icon_id:"24899558",name:"chatboxes-filled",font_class:"chatboxes-filled",unicode:"e692",unicode_decimal:59026},{icon_id:"24899559",name:"contact",font_class:"contact",unicode:"e693",unicode_decimal:59027},{icon_id:"24899560",name:"chatbubble-filled",font_class:"chatbubble-filled",unicode:"e694",unicode_decimal:59028},{icon_id:"24899561",name:"contact-filled",font_class:"contact-filled",unicode:"e695",unicode_decimal:59029},{icon_id:"24899562",name:"chatboxes",font_class:"chatboxes",unicode:"e696",unicode_decimal:59030},{icon_id:"24899563",name:"chatbubble",font_class:"chatbubble",unicode:"e697",unicode_decimal:59031},{icon_id:"24881290",name:"upload-filled",font_class:"upload-filled",unicode:"e68e",unicode_decimal:59022},{icon_id:"24881292",name:"upload",font_class:"upload",unicode:"e690",unicode_decimal:59024},{icon_id:"24881293",name:"weixin",font_class:"weixin",unicode:"e691",unicode_decimal:59025},{icon_id:"24881274",name:"compose",font_class:"compose",unicode:"e67f",unicode_decimal:59007},{icon_id:"24881275",name:"qq",font_class:"qq",unicode:"e680",unicode_decimal:59008},{icon_id:"24881276",name:"download-filled",font_class:"download-filled",unicode:"e681",unicode_decimal:59009},{icon_id:"24881277",name:"pengyouquan",font_class:"pyq",unicode:"e682",unicode_decimal:59010},{icon_id:"24881279",name:"sound",font_class:"sound",unicode:"e684",unicode_decimal:59012},{icon_id:"24881280",name:"trash-filled",font_class:"trash-filled",unicode:"e685",unicode_decimal:59013},{icon_id:"24881281",name:"sound-filled",font_class:"sound-filled",unicode:"e686",unicode_decimal:59014},{icon_id:"24881282",name:"trash",font_class:"trash",unicode:"e687",unicode_decimal:59015},{icon_id:"24881284",name:"videocam-filled",font_class:"videocam-filled",unicode:"e689",unicode_decimal:59017},{icon_id:"24881285",name:"spinner-cycle",font_class:"spinner-cycle",unicode:"e68a",unicode_decimal:59018},{icon_id:"24881286",name:"weibo",font_class:"weibo",unicode:"e68b",unicode_decimal:59019},{icon_id:"24881288",name:"videocam",font_class:"videocam",unicode:"e68c",unicode_decimal:59020},{icon_id:"24881289",name:"download",font_class:"download",unicode:"e68d",unicode_decimal:59021},{icon_id:"24879601",name:"help",font_class:"help",unicode:"e679",unicode_decimal:59001},{icon_id:"24879602",name:"navigate-filled",font_class:"navigate-filled",unicode:"e67a",unicode_decimal:59002},{icon_id:"24879603",name:"plusempty",font_class:"plusempty",unicode:"e67b",unicode_decimal:59003},{icon_id:"24879604",name:"smallcircle",font_class:"smallcircle",unicode:"e67c",unicode_decimal:59004},{icon_id:"24879605",name:"minus-filled",font_class:"minus-filled",unicode:"e67d",unicode_decimal:59005},{icon_id:"24879606",name:"micoff",font_class:"micoff",unicode:"e67e",unicode_decimal:59006},{icon_id:"24879588",name:"closeempty",font_class:"closeempty",unicode:"e66c",unicode_decimal:58988},{icon_id:"24879589",name:"clear",font_class:"clear",unicode:"e66d",unicode_decimal:58989},{icon_id:"24879590",name:"navigate",font_class:"navigate",unicode:"e66e",unicode_decimal:58990},{icon_id:"24879591",name:"minus",font_class:"minus",unicode:"e66f",unicode_decimal:58991},{icon_id:"24879592",name:"image",font_class:"image",unicode:"e670",unicode_decimal:58992},{icon_id:"24879593",name:"mic",font_class:"mic",unicode:"e671",unicode_decimal:58993},{icon_id:"24879594",name:"paperplane",font_class:"paperplane",unicode:"e672",unicode_decimal:58994},{icon_id:"24879595",name:"close",font_class:"close",unicode:"e673",unicode_decimal:58995},{icon_id:"24879596",name:"help-filled",font_class:"help-filled",unicode:"e674",unicode_decimal:58996},{icon_id:"24879597",name:"plus-filled",font_class:"paperplane-filled",unicode:"e675",unicode_decimal:58997},{icon_id:"24879598",name:"plus",font_class:"plus",unicode:"e676",unicode_decimal:58998},{icon_id:"24879599",name:"mic-filled",font_class:"mic-filled",unicode:"e677",unicode_decimal:58999},{icon_id:"24879600",name:"image-filled",font_class:"image-filled",unicode:"e678",unicode_decimal:59e3},{icon_id:"24855900",name:"locked-filled",font_class:"locked-filled",unicode:"e668",unicode_decimal:58984},{icon_id:"24855901",name:"info",font_class:"info",unicode:"e669",unicode_decimal:58985},{icon_id:"24855903",name:"locked",font_class:"locked",unicode:"e66b",unicode_decimal:58987},{icon_id:"24855884",name:"camera-filled",font_class:"camera-filled",unicode:"e658",unicode_decimal:58968},{icon_id:"24855885",name:"chat-filled",font_class:"chat-filled",unicode:"e659",unicode_decimal:58969},{icon_id:"24855886",name:"camera",font_class:"camera",unicode:"e65a",unicode_decimal:58970},{icon_id:"24855887",name:"circle",font_class:"circle",unicode:"e65b",unicode_decimal:58971},{icon_id:"24855888",name:"checkmarkempty",font_class:"checkmarkempty",unicode:"e65c",unicode_decimal:58972},{icon_id:"24855889",name:"chat",font_class:"chat",unicode:"e65d",unicode_decimal:58973},{icon_id:"24855890",name:"circle-filled",font_class:"circle-filled",unicode:"e65e",unicode_decimal:58974},{icon_id:"24855891",name:"flag",font_class:"flag",unicode:"e65f",unicode_decimal:58975},{icon_id:"24855892",name:"flag-filled",font_class:"flag-filled",unicode:"e660",unicode_decimal:58976},{icon_id:"24855893",name:"gear-filled",font_class:"gear-filled",unicode:"e661",unicode_decimal:58977},{icon_id:"24855894",name:"home",font_class:"home",unicode:"e662",unicode_decimal:58978},{icon_id:"24855895",name:"home-filled",font_class:"home-filled",unicode:"e663",unicode_decimal:58979},{icon_id:"24855896",name:"gear",font_class:"gear",unicode:"e664",unicode_decimal:58980},{icon_id:"24855897",name:"smallcircle-filled",font_class:"smallcircle-filled",unicode:"e665",unicode_decimal:58981},{icon_id:"24855898",name:"map-filled",font_class:"map-filled",unicode:"e666",unicode_decimal:58982},{icon_id:"24855899",name:"map",font_class:"map",unicode:"e667",unicode_decimal:58983},{icon_id:"24855825",name:"refresh-filled",font_class:"refresh-filled",unicode:"e656",unicode_decimal:58966},{icon_id:"24855826",name:"refresh",font_class:"refresh",unicode:"e657",unicode_decimal:58967},{icon_id:"24855808",name:"cloud-upload",font_class:"cloud-upload",unicode:"e645",unicode_decimal:58949},{icon_id:"24855809",name:"cloud-download-filled",font_class:"cloud-download-filled",unicode:"e646",unicode_decimal:58950},{icon_id:"24855810",name:"cloud-download",font_class:"cloud-download",unicode:"e647",unicode_decimal:58951},{icon_id:"24855811",name:"cloud-upload-filled",font_class:"cloud-upload-filled",unicode:"e648",unicode_decimal:58952},{icon_id:"24855813",name:"redo",font_class:"redo",unicode:"e64a",unicode_decimal:58954},{icon_id:"24855814",name:"images-filled",font_class:"images-filled",unicode:"e64b",unicode_decimal:58955},{icon_id:"24855815",name:"undo-filled",font_class:"undo-filled",unicode:"e64c",unicode_decimal:58956},{icon_id:"24855816",name:"more",font_class:"more",unicode:"e64d",unicode_decimal:58957},{icon_id:"24855817",name:"more-filled",font_class:"more-filled",unicode:"e64e",unicode_decimal:58958},{icon_id:"24855818",name:"undo",font_class:"undo",unicode:"e64f",unicode_decimal:58959},{icon_id:"24855819",name:"images",font_class:"images",unicode:"e650",unicode_decimal:58960},{icon_id:"24855821",name:"paperclip",font_class:"paperclip",unicode:"e652",unicode_decimal:58962},{icon_id:"24855822",name:"settings",font_class:"settings",unicode:"e653",unicode_decimal:58963},{icon_id:"24855823",name:"search",font_class:"search",unicode:"e654",unicode_decimal:58964},{icon_id:"24855824",name:"redo-filled",font_class:"redo-filled",unicode:"e655",unicode_decimal:58965},{icon_id:"24841702",name:"list",font_class:"list",unicode:"e644",unicode_decimal:58948},{icon_id:"24841489",name:"mail-open-filled",font_class:"mail-open-filled",unicode:"e63a",unicode_decimal:58938},{icon_id:"24841491",name:"hand-thumbsdown-filled",font_class:"hand-down-filled",unicode:"e63c",unicode_decimal:58940},{icon_id:"24841492",name:"hand-thumbsdown",font_class:"hand-down",unicode:"e63d",unicode_decimal:58941},{icon_id:"24841493",name:"hand-thumbsup-filled",font_class:"hand-up-filled",unicode:"e63e",unicode_decimal:58942},{icon_id:"24841494",name:"hand-thumbsup",font_class:"hand-up",unicode:"e63f",unicode_decimal:58943},{icon_id:"24841496",name:"heart-filled",font_class:"heart-filled",unicode:"e641",unicode_decimal:58945},{icon_id:"24841498",name:"mail-open",font_class:"mail-open",unicode:"e643",unicode_decimal:58947},{icon_id:"24841488",name:"heart",font_class:"heart",unicode:"e639",unicode_decimal:58937},{icon_id:"24839963",name:"loop",font_class:"loop",unicode:"e633",unicode_decimal:58931},{icon_id:"24839866",name:"pulldown",font_class:"pulldown",unicode:"e632",unicode_decimal:58930},{icon_id:"24813798",name:"scan",font_class:"scan",unicode:"e62a",unicode_decimal:58922},{icon_id:"24813786",name:"bars",font_class:"bars",unicode:"e627",unicode_decimal:58919},{icon_id:"24813788",name:"cart-filled",font_class:"cart-filled",unicode:"e629",unicode_decimal:58921},{icon_id:"24813790",name:"checkbox",font_class:"checkbox",unicode:"e62b",unicode_decimal:58923},{icon_id:"24813791",name:"checkbox-filled",font_class:"checkbox-filled",unicode:"e62c",unicode_decimal:58924},{icon_id:"24813794",name:"shop",font_class:"shop",unicode:"e62f",unicode_decimal:58927},{icon_id:"24813795",name:"headphones",font_class:"headphones",unicode:"e630",unicode_decimal:58928},{icon_id:"24813796",name:"cart",font_class:"cart",unicode:"e631",unicode_decimal:58929}]}},a6ed:function(e,t,n){"use strict";(function(e,r){var o=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.TUIUserService=t.TUITranslateService=t.TUIStore=t.TUIGroupService=t.TUIGlobal=t.TUIFriendService=t.TUIConversationService=t.TUIChatService=t.StoreName=void 0;var i=o(n("2eee")),a=o(n("3c96")),s=o(n("7037")),u=o(n("278c")),c=o(n("448a")),l=o(n("ed6d")),d=o(n("6b58")),f=o(n("36c6")),p=o(n("9523")),h=o(n("970b")),g=o(n("5bc3")),v=o(n("1815")),_=o(n("9d02")),m=o(n("0e47"));function y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,f.default)(e);if(t){var o=(0,f.default)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(0,d.default)(this,n)}}function I(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return M(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return M(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function T(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}function S(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))}"function"==typeof SuppressedError&&SuppressedError;var E,C,k,b,D,A,O,R,N,w=function(){function e(t){return(0,h.default)(this,e),e.instance||(e.instance=this,this.engine=t,this.events={},this.bindIMEvents()),e.instance}return(0,g.default)(e,[{key:"addEvent",value:function(e,t){this.events[e]||(this.events[e]=new Map),this.events[e].set(t,1)}},{key:"removeEvents",value:function(){var e=this;Object.keys(this.events).forEach((function(t){e.events[t].clear()})),this.events={}}},{key:"dispatch",value:function(e,t){if(this.events[e]){var n,r=I(this.events[e].keys());try{for(r.s();!(n=r.n()).done;){var o=n.value;o.call(this,t)}}catch(i){r.e(i)}finally{r.f()}}}},{key:"bindIMEvents",value:function(){this.engine.chat.on(this.engine.EVENT.SDK_READY,this.onSDKReady,this),this.engine.chat.on(this.engine.EVENT.SDK_NOT_READY,this.onSDKNotReady,this),this.engine.chat.on(this.engine.EVENT.KICKED_OUT,this.onKickedOut,this),this.engine.chat.on(this.engine.EVENT.NET_STATE_CHANGE,this.onNetStateChange,this),this.engine.chat.on(this.engine.EVENT.MESSAGE_RECEIVED,this.onReceiveMessage,this),this.engine.chat.on(this.engine.EVENT.MESSAGE_MODIFIED,this.onMessageModified,this),this.engine.chat.on(this.engine.EVENT.MESSAGE_REVOKED,this.onMessageRevoked,this),this.engine.chat.on(this.engine.EVENT.MESSAGE_READ_BY_PEER,this.onMessageReadByPeer,this),this.engine.chat.on(this.engine.EVENT.MESSAGE_READ_RECEIPT_RECEIVED,this.onMessageReadReceiptReceived,this),this.engine.chat.on(this.engine.EVENT.CONVERSATION_LIST_UPDATED,this.onConversationListUpdated,this),this.engine.chat.on(this.engine.EVENT.TOTAL_UNREAD_MESSAGE_COUNT_UPDATED,this.onTotalMessageCountUpdated,this),this.engine.chat.on(this.engine.EVENT.PROFILE_UPDATED,this.onProfileUpdated,this),this.engine.chat.on(this.engine.EVENT.BLACKLIST_UPDATED,this.onBlacklistUpdated,this),this.engine.chat.on(this.engine.EVENT.USER_STATUS_UPDATED,this.onUserStatusUpdated,this),this.engine.chat.on(this.engine.EVENT.GROUP_LIST_UPDATED,this.onGroupListUpdated,this),this.engine.chat.on(this.engine.EVENT.GROUP_ATTRIBUTES_UPDATED,this.onGroupAttributesUpdated,this),this.engine.chat.on(this.engine.EVENT.GROUP_COUNTER_UPDATED,this.onGroupCounterUpdated,this),this.engine.chat.on(this.engine.EVENT.FRIEND_LIST_UPDATED,this.onFriendListUpdated,this),this.engine.chat.on(this.engine.EVENT.FRIEND_APPLICATION_LIST_UPDATED,this.onFriendApplicationListUpdated,this)}},{key:"unbindIMEvents",value:function(){this.engine.chat.off(this.engine.EVENT.SDK_READY,this.onSDKReady,this),this.engine.chat.off(this.engine.EVENT.SDK_NOT_READY,this.onSDKNotReady,this),this.engine.chat.off(this.engine.EVENT.KICKED_OUT,this.onKickedOut,this),this.engine.chat.off(this.engine.EVENT.NET_STATE_CHANGE,this.onNetStateChange,this),this.engine.chat.off(this.engine.EVENT.MESSAGE_RECEIVED,this.onReceiveMessage,this),this.engine.chat.off(this.engine.EVENT.MESSAGE_MODIFIED,this.onMessageModified,this),this.engine.chat.off(this.engine.EVENT.MESSAGE_REVOKED,this.onMessageRevoked,this),this.engine.chat.off(this.engine.EVENT.MESSAGE_READ_BY_PEER,this.onMessageReadByPeer,this),this.engine.chat.off(this.engine.EVENT.MESSAGE_MODIFIED,this.onMessageReadReceiptReceived,this),this.engine.chat.off(this.engine.EVENT.CONVERSATION_LIST_UPDATED,this.onConversationListUpdated,this),this.engine.chat.off(this.engine.EVENT.TOTAL_UNREAD_MESSAGE_COUNT_UPDATED,this.onTotalMessageCountUpdated,this),this.engine.chat.off(this.engine.EVENT.PROFILE_UPDATED,this.onProfileUpdated,this),this.engine.chat.off(this.engine.EVENT.BLACKLIST_UPDATED,this.onBlacklistUpdated,this),this.engine.chat.off(this.engine.EVENT.USER_STATUS_UPDATED,this.onUserStatusUpdated,this),this.engine.chat.off(this.engine.EVENT.GROUP_LIST_UPDATED,this.onGroupListUpdated,this),this.engine.chat.off(this.engine.EVENT.GROUP_ATTRIBUTES_UPDATED,this.onGroupAttributesUpdated,this),this.engine.chat.off(this.engine.EVENT.GROUP_COUNTER_UPDATED,this.onGroupCounterUpdated,this),this.engine.chat.off(this.engine.EVENT.FRIEND_LIST_UPDATED,this.onFriendListUpdated,this),this.engine.chat.off(this.engine.EVENT.FRIEND_APPLICATION_LIST_UPDATED,this.onFriendApplicationListUpdated,this)}},{key:"onSDKReady",value:function(e){this.dispatch(this.engine.EVENT.SDK_READY,e.data)}},{key:"onSDKNotReady",value:function(e){this.dispatch(this.engine.EVENT.SDK_NOT_READY,e.data)}},{key:"onKickedOut",value:function(e){this.dispatch(this.engine.EVENT.KICKED_OUT,e.data)}},{key:"onNetStateChange",value:function(e){this.dispatch(this.engine.EVENT.NET_STATE_CHANGE,e.data)}},{key:"onReceiveMessage",value:function(e){this.dispatch(this.engine.EVENT.MESSAGE_RECEIVED,e.data)}},{key:"onMessageModified",value:function(e){this.dispatch(this.engine.EVENT.MESSAGE_MODIFIED,e.data)}},{key:"onMessageRevoked",value:function(e){this.dispatch(this.engine.EVENT.MESSAGE_REVOKED,e.data)}},{key:"onMessageReadByPeer",value:function(e){this.dispatch(this.engine.EVENT.MESSAGE_READ_BY_PEER,e.data)}},{key:"onMessageReadReceiptReceived",value:function(e){this.dispatch(this.engine.EVENT.MESSAGE_READ_RECEIPT_RECEIVED,e.data)}},{key:"onConversationListUpdated",value:function(e){this.dispatch(this.engine.EVENT.CONVERSATION_LIST_UPDATED,e.data)}},{key:"onTotalMessageCountUpdated",value:function(e){this.dispatch(this.engine.EVENT.TOTAL_UNREAD_MESSAGE_COUNT_UPDATED,e.data)}},{key:"onProfileUpdated",value:function(e){this.dispatch(this.engine.EVENT.PROFILE_UPDATED,e.data)}},{key:"onBlacklistUpdated",value:function(e){this.dispatch(this.engine.EVENT.BLACKLIST_UPDATED,e.data)}},{key:"onUserStatusUpdated",value:function(e){this.dispatch(this.engine.EVENT.USER_STATUS_UPDATED,e.data)}},{key:"onGroupListUpdated",value:function(e){this.dispatch(this.engine.EVENT.GROUP_LIST_UPDATED,e.data)}},{key:"onGroupAttributesUpdated",value:function(e){this.dispatch(this.engine.EVENT.GROUP_ATTRIBUTES_UPDATED,e.data)}},{key:"onGroupCounterUpdated",value:function(e){this.dispatch(this.engine.EVENT.GROUP_COUNTER_UPDATED,e.data)}},{key:"onFriendListUpdated",value:function(e){this.dispatch(this.engine.EVENT.FRIEND_LIST_UPDATED,e.data)}},{key:"onFriendApplicationListUpdated",value:function(e){this.dispatch(this.engine.EVENT.FRIEND_APPLICATION_LIST_UPDATED,e.data)}}]),e}();t.StoreName=C,function(e){e.TUIStore="TUIStore",e.TUITranslate="TUITranslate",e.TUIConversation="TUIConversation",e.TUIChat="TUIChat",e.TUIGroup="TUIGroup",e.TUIUser="TUIUser",e.TUIFriend="TUIFriend"}(E||(E={})),function(e){e.APP="application",e.CONV="conversation",e.CHAT="chat",e.GRP="group",e.USER="user",e.FRIEND="friend",e.CUSTOM="custom"}(C||(t.StoreName=C={})),function(e){e[e.UNSUB_USER=-1]="UNSUB_USER"}(k||(k={})),function(e){e.BUSINESS_ID="user_typing_status",e[e.STATUS_START=1]="STATUS_START",e[e.STATUS_END=0]="STATUS_END",e[e.VERSION=1]="VERSION",e[e.ACTION_START_ID=14]="ACTION_START_ID",e[e.ACTION_END_ID=0]="ACTION_END_ID",e.ACTION_START="EIMAMSG_InputStatus_Ing",e.ACTION_END="EIMAMSG_InputStatus_End",e[e.NEED_TYPING=1]="NEED_TYPING"}(b||(b={})),function(e){e.ADD="add",e.REMOVE="remove"}(D||(D={})),function(e){e[e.MSG_MODIFY_CONFLICT=2480]="MSG_MODIFY_CONFLICT",e[e.MSG_MODIFY_DISABLED_IN_AVCHATROOM=2481]="MSG_MODIFY_DISABLED_IN_AVCHATROOM",e[e.MODIFY_MESSAGE_NOT_EXIST=20026]="MODIFY_MESSAGE_NOT_EXIST"}(A||(A={})),function(e){e[e.NOT_INIT=-1e5]="NOT_INIT",e[e.INVALID_CONV_ID=-100001]="INVALID_CONV_ID",e[e.CONV_ID_SAME=-100002]="CONV_ID_SAME",e[e.CONV_NOT_EXIST=-100003]="CONV_NOT_EXIST",e[e.GET_MSG_LIST_ERROR=-100004]="GET_MSG_LIST_ERROR",e[e.MISMATCH_TYPE_AND_PAYLOAD=-100005]="MISMATCH_TYPE_AND_PAYLOAD"}(O||(O={})),function(e){e.MSG_MODIFY_CONFLICT="MODIFY_MESSAGE_ERROR,修改消息发生冲突, data.message 是最新的消息",e.MSG_MODIFY_DISABLED_IN_AVCHATROOM="MODIFY_MESSAGE_ERROR,不支持修改直播群消息.",e.MODIFY_MESSAGE_NOT_EXIST="MODIFY_MESSAGE_ERROR,消息不存在."}(R||(R={})),function(e){e.NOT_INIT="TUIChatEngine 初始化未完成，请确认 TUIChatEngine.login 接口调用是否正常。",e.INVALID_CONV_ID="会话 ID 无效",e.CONV_ID_SAME="您切换的是同一个会话 ID",e.CONV_NOT_EXIST="会话不存在",e.GET_MSG_LIST_ERROR="Chat SDK is not ready.",e.MISMATCH_TYPE_AND_PAYLOAD="type 与 payload 不匹配."}(N||(N={}));var L=function(e){return void 0===e},P=function(e){return e.startsWith("_")},U=function(e){return/^(https?:\/\/(([a-zA-Z0-9]+-?)+[a-zA-Z0-9]+\.)+[a-zA-Z]+)(:\d+)?(\/.*)?(\?.*)?(#.*)?$/.test(e)},G=function(e){return e&&function(e){if("string"==typeof e)try{return!!JSON.parse(e)}catch(e){return!1}return!1}(e)?JSON.parse(e):e},x=function(e){var t;return t=e>=1048576?"".concat((e/1048576).toFixed(2)," Mb"):e>=1024?"".concat((e/1024).toFixed(2)," Kb"):"".concat(e.toFixed(2),"B"),t},F=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5,r=t;return e.catch((function(e){if(0===r)throw e;var t=setTimeout((function(){clearTimeout(t),r--}),1e3*n)}))},q={"[NO]":"emoji_0@2x.png","[OK]":"emoji_1@2x.png","[下雨]":"emoji_2@2x.png","[么么哒]":"emoji_3@2x.png","[乒乓]":"emoji_4@2x.png","[便便]":"emoji_5@2x.png","[信封]":"emoji_6@2x.png","[偷笑]":"emoji_7@2x.png","[傲慢]":"emoji_8@2x.png","[再见]":"emoji_9@2x.png","[冷汗]":"emoji_10@2x.png","[凋谢]":"emoji_11@2x.png","[刀]":"emoji_12@2x.png","[删除]":"emoji_13@2x.png","[勾引]":"emoji_14@2x.png","[发呆]":"emoji_15@2x.png","[发抖]":"emoji_16@2x.png","[可怜]":"emoji_17@2x.png","[可爱]":"emoji_18@2x.png","[右哼哼]":"emoji_19@2x.png","[右太极]":"emoji_20@2x.png","[右车头]":"emoji_21@2x.png","[吐]":"emoji_22@2x.png","[吓]":"emoji_23@2x.png","[咒骂]":"emoji_24@2x.png","[咖啡]":"emoji_25@2x.png","[啤酒]":"emoji_26@2x.png","[嘘]":"emoji_27@2x.png","[回头]":"emoji_28@2x.png","[困]":"emoji_29@2x.png","[坏笑]":"emoji_30@2x.png","[多云]":"emoji_31@2x.png","[大兵]":"emoji_32@2x.png","[大哭]":"emoji_33@2x.png","[太阳]":"emoji_34@2x.png","[奋斗]":"emoji_35@2x.png","[奶瓶]":"emoji_36@2x.png","[委屈]":"emoji_37@2x.png","[害羞]":"emoji_38@2x.png","[尴尬]":"emoji_39@2x.png","[左哼哼]":"emoji_40@2x.png","[左太极]":"emoji_41@2x.png","[左车头]":"emoji_42@2x.png","[差劲]":"emoji_43@2x.png","[弱]":"emoji_44@2x.png","[强]":"emoji_45@2x.png","[彩带]":"emoji_46@2x.png","[彩球]":"emoji_47@2x.png","[得意]":"emoji_48@2x.png","[微笑]":"emoji_49@2x.png","[心碎了]":"emoji_50@2x.png","[快哭了]":"emoji_51@2x.png","[怄火]":"emoji_52@2x.png","[怒]":"emoji_53@2x.png","[惊恐]":"emoji_54@2x.png","[惊讶]":"emoji_55@2x.png","[憨笑]":"emoji_56@2x.png","[手枪]":"emoji_57@2x.png","[打哈欠]":"emoji_58@2x.png","[抓狂]":"emoji_59@2x.png","[折磨]":"emoji_60@2x.png","[抠鼻]":"emoji_61@2x.png","[抱抱]":"emoji_62@2x.png","[抱拳]":"emoji_63@2x.png","[拳头]":"emoji_64@2x.png","[挥手]":"emoji_65@2x.png","[握手]":"emoji_66@2x.png","[撇嘴]":"emoji_67@2x.png","[擦汗]":"emoji_68@2x.png","[敲打]":"emoji_69@2x.png","[晕]":"emoji_70@2x.png","[月亮]":"emoji_71@2x.png","[棒棒糖]":"emoji_72@2x.png","[汽车]":"emoji_73@2x.png","[沙发]":"emoji_74@2x.png","[流汗]":"emoji_75@2x.png","[流泪]":"emoji_76@2x.png","[激动]":"emoji_77@2x.png","[灯泡]":"emoji_78@2x.png","[炸弹]":"emoji_79@2x.png","[熊猫]":"emoji_80@2x.png","[爆筋]":"emoji_81@2x.png","[爱你]":"emoji_82@2x.png","[爱心]":"emoji_83@2x.png","[爱情]":"emoji_84@2x.png","[猪头]":"emoji_85@2x.png","[猫咪]":"emoji_86@2x.png","[献吻]":"emoji_87@2x.png","[玫瑰]":"emoji_88@2x.png","[瓢虫]":"emoji_89@2x.png","[疑问]":"emoji_90@2x.png","[白眼]":"emoji_91@2x.png","[皮球]":"emoji_92@2x.png","[睡觉]":"emoji_93@2x.png","[磕头]":"emoji_94@2x.png","[示爱]":"emoji_95@2x.png","[礼品袋]":"emoji_96@2x.png","[礼物]":"emoji_97@2x.png","[篮球]":"emoji_98@2x.png","[米饭]":"emoji_99@2x.png","[糗大了]":"emoji_100@2x.png","[红双喜]":"emoji_101@2x.png","[红灯笼]":"emoji_102@2x.png","[纸巾]":"emoji_103@2x.png","[胜利]":"emoji_104@2x.png","[色]":"emoji_105@2x.png","[药]":"emoji_106@2x.png","[菜刀]":"emoji_107@2x.png","[蛋糕]":"emoji_108@2x.png","[蜡烛]":"emoji_109@2x.png","[街舞]":"emoji_110@2x.png","[衰]":"emoji_111@2x.png","[西瓜]":"emoji_112@2x.png","[调皮]":"emoji_113@2x.png","[象棋]":"emoji_114@2x.png","[跳绳]":"emoji_115@2x.png","[跳跳]":"emoji_116@2x.png","[车厢]":"emoji_117@2x.png","[转圈]":"emoji_118@2x.png","[鄙视]":"emoji_119@2x.png","[酷]":"emoji_120@2x.png","[钞票]":"emoji_121@2x.png","[钻戒]":"emoji_122@2x.png","[闪电]":"emoji_123@2x.png","[闭嘴]":"emoji_124@2x.png","[闹钟]":"emoji_125@2x.png","[阴险]":"emoji_126@2x.png","[难过]":"emoji_127@2x.png","[雨伞]":"emoji_128@2x.png","[青蛙]":"emoji_129@2x.png","[面条]":"emoji_130@2x.png","[鞭炮]":"emoji_131@2x.png","[风车]":"emoji_132@2x.png","[飞吻]":"emoji_133@2x.png","[飞机]":"emoji_134@2x.png","[饥饿]":"emoji_135@2x.png","[香蕉]":"emoji_136@2x.png","[骷髅]":"emoji_137@2x.png","[麦克风]":"emoji_138@2x.png","[麻将]":"emoji_139@2x.png","[鼓掌]":"emoji_140@2x.png","[龇牙]":"emoji_141@2x.png"},V={enabledMessageReadReceipt:Math.pow(2,5),enabledEmojiPlugin:Math.pow(2,48),enabledOnlineStatus:Math.pow(2,7)},B=["messageList","conversationList","newMessageList"],j="undefined"!=typeof e&&"function"==typeof e.getSystemInfoSync&&Boolean(e.getSystemInfoSync().fontSizeSetting),H="undefined"!=typeof r&&"undefined"==typeof window,K=j||H,W="undefined"!=typeof r,Y=("undefined"!=typeof r||"undefined"!=typeof window)&&!K,z=j?e:W?r:window,J=Y&&window&&window.navigator&&window.navigator.userAgent||"",X=/Android/i.test(J),$=/(?:Windows Phone)/.test(J),Z=/(?:SymbianOS)/.test(J),Q=/iPad/i.test(J)||/iPhone/i.test(J)||/iPod/i.test(J),ee=X||$||Z||Q,te=Y&&!ee,ne=function(){function e(){(0,h.default)(this,e),this.global=z,this.isOfficial=!1}return(0,g.default)(e,[{key:"initOfficial",value:function(e){this.isOfficial=e}},{key:"getPlatform",value:function(){var e="";return te?e="pc":ee?e="h5":j?e="wechat":H&&!j&&(e="app"),e}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}(),re=function(){function e(){(0,h.default)(this,e),this.EVENT=v.default.EVENT,this.TYPES=v.default.TYPES,this.loginStatusPromise=new Map,this.userID="",this.isInited=!1}return(0,g.default)(e,[{key:"mount",value:function(e,t){this[e]=t}},{key:"login",value:function(e){var t=this,n=e.chat,r=e.SDKAppID,o=e.userID,i=1400187352===r||1400188366===r;return this.createChat(e),this.userID=o,ne.getInstance().initOfficial(i),this.TUIStore.update(C.APP,"isOfficial",i),this.TUIStore.update(C.APP,"SDKVersion",v.default.VERSION),this.eventCenter=new w(this),this.eventCenter.removeEvents(),this.initStore(),this.initService(),n&&n.isReady()?(console.log("TUIChatEngine.login ok, from TUICore."),this.checkCommercialAbility(),Promise.resolve({})):(this.registerPlugin(e),this.eventCenter.addEvent(this.EVENT.SDK_READY,(function(){t.onSDKReady()})),this.eventCenter.addEvent(this.EVENT.SDK_NOT_READY,(function(){t.onSDKNotReady()})),this.loginChat(e))}},{key:"logout",value:function(){return this.userID="",this.isInited=!1,this.chat.logout()}},{key:"isReady",value:function(){var e;return(null===(e=this.chat)||void 0===e?void 0:e.isReady())||!1}},{key:"setLogLevel",value:function(e){if(this.chat)return this.chat.setLogLevel(e);console.warn("TUIChatEngine 初始化未完成，请确认 TUIChatEngine.login 接口调用是否正常。")}},{key:"destroy",value:function(){return this.eventCenter.unbindIMEvents(),this.isInited=!1,this.chat.destroy()}},{key:"getMyUserID",value:function(){return this.userID}},{key:"initStore",value:function(){this.TUIStore.reset(C.CHAT),this.TUIStore.reset(C.CONV),this.TUIStore.reset(C.GRP),this.TUIStore.reset(C.USER),console.log("TUIEngine.initStore ok.")}},{key:"initService",value:function(){this.TUIChat.init(),this.TUIConversation.init(),this.TUIGroup.init(),this.TUIUser.init(),this.TUIFriend.init(),this.isInited=!0,console.log("TUIEngine.initService ok.")}},{key:"createChat",value:function(e){var t=e.chat,n=T(e,["chat"]);L(t)?this.chat=v.default.create(Object.assign(Object.assign({},n),{scene:"chat-uikit-engine"})):this.chat=t}},{key:"loginChat",value:function(e){var t=this,n=e.userID,r=e.userSig;return new Promise((function(e,o){t.chat.login({userID:n,userSig:r}).then((function(n){console.log("TUIChatEngine.loginChat ok."),t.checkCommercialAbility(),n.data.repeatLogin&&t.chat.isReady()&&e(n),t.loginStatusPromise.set("login",{resolve:e,reject:o,imResponse:n})})).catch((function(e){o(e)}))}))}},{key:"registerPlugin",value:function(e){var t=e.useUploadPlugin,n=void 0!==t&&t,r=e.useProfanityFilterPlugin,o=void 0!==r&&r,i=e.TUIOfflinePush,a=e.offlinePushConfig;!0===n&&this.chat.registerPlugin({"tim-upload-plugin":_.default}),!0===o&&this.chat.registerPlugin({"tim-profanity-filter-plugin":m.default}),!H||j||L(i)||L(a)||this.chat.registerPlugin({"tim-offline-push-plugin":i,offlinePushConfig:a})}},{key:"onSDKReady",value:function(){if(this.loginStatusPromise.has("login")){var e=this.loginStatusPromise.get("login");e.resolve(e.imResponse),this.TUIUser.getUserProfile()}this.loginStatusPromise.delete("login")}},{key:"onSDKNotReady",value:function(){this.loginStatusPromise.has("login")&&this.loginStatusPromise.get("login").reject(new Error("sdk not ready")),this.loginStatusPromise.delete("login")}},{key:"checkCommercialAbility",value:function(){var e=this;Object.keys(V).forEach((function(t){var n=V[t];e.chat.callExperimentalAPI("isCommercialAbilityEnabled",n).then((function(n){var r=n.data.enabled,o=void 0!==r&&r;e.TUIStore.update(C.APP,t,o)}))}))}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}(),oe=function(){function e(){(0,h.default)(this,e),this.defaultStore={enabledMessageReadReceipt:!1,enabledEmojiPlugin:!1,enabledOnlineStatus:!1,enableTyping:!0,isOfficial:!1,SDKVersion:"3.0.0",tasks:{sendMessage:!1,revokeMessage:!1,modifyNickName:!1,groupChat:!1,muteGroup:!1,dismissGroup:!1,call:!1,searchCloudMessage:!1,customerService:!1}},this.store={enabledEmojiPlugin:!1,enabledMessageReadReceipt:!1,enabledOnlineStatus:!1,enableTyping:!0,isOfficial:!1,SDKVersion:"3.0.0",tasks:{sendMessage:!1,revokeMessage:!1,modifyNickName:!1,groupChat:!1,muteGroup:!1,dismissGroup:!1,call:!1,searchCloudMessage:!1,customerService:!1}}}return(0,g.default)(e,[{key:"update",value:function(e,t){this.store[e]=t}},{key:"getData",value:function(e){return this.store[e]}},{key:"reset",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];0===t.length&&(t=Object.keys(this.store)),this.store=Object.assign(Object.assign(Object.assign({},this.defaultStore),this.store),t.reduce((function(t,n){return Object.assign(Object.assign({},t),(0,p.default)({},n,e.defaultStore[n]))}),{}))}}]),e}(),ie=function(){function e(){(0,h.default)(this,e),this.defaultStore={userProfile:{},displayOnlineStatus:!1,autoSubOnlineStatus:!0,userStatusList:new Map,kickedOut:"",netStateChange:"",displayMessageReadReceipt:!0,userBlacklist:[]},this.store={userProfile:{},displayOnlineStatus:!1,autoSubOnlineStatus:!0,userStatusList:new Map,kickedOut:"",netStateChange:"",displayMessageReadReceipt:!0,userBlacklist:[]}}return(0,g.default)(e,[{key:"update",value:function(e,t){"userStatusList"===e?this.updateUserStatusList(t):this.store[e]=t}},{key:"getData",value:function(e){return this.store[e]}},{key:"reset",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];0===t.length&&(t=Object.keys(this.store)),this.store=Object.assign(Object.assign(Object.assign({},this.defaultStore),this.store),t.reduce((function(t,n){return Object.assign(Object.assign({},t),(0,p.default)({},n,e.defaultStore[n]))}),{}))}},{key:"updateUserStatusList",value:function(e){var t=this;0!==e.length?e.forEach((function(e){var n=e.userID,r=e.statusType,o=void 0===r?0:r,i=e.customStatus,a=void 0===i?"":i;o===k.UNSUB_USER?t.store.userStatusList.delete(n):t.store.userStatusList.set(n,{statusType:o,customStatus:a})})):this.store.userStatusList.clear()}}]),e}(),ae=function(){function e(){(0,h.default)(this,e)}return(0,g.default)(e,[{key:"getEngine",value:function(){return re.getInstance()}}]),e}(),se=function(e){(0,l.default)(n,e);var t=y(n);function n(e){var r;return(0,h.default)(this,n),r=t.call(this),r.initProxy(e),r.isMuted=r.messageRemindType===r.getEngine().TYPES.MSG_REMIND_ACPT_NOT_NOTE||r.messageRemindType===r.getEngine().TYPES.MSG_REMIND_DISCARD,r.operationType=0,r._conversation=e,r}return(0,g.default)(n,[{key:"initProxy",value:function(e){var t=this;Object.keys(e).forEach((function(n){P(n)||(t[n]=e[n])}))}},{key:"updateProperties",value:function(e){var t=this;this._conversation=e,Object.keys(e).forEach((function(n){P(n)||(t[n]=e[n])}))}},{key:"getConversation",value:function(){return this._conversation}},{key:"deleteConversation",value:function(){return this.getEngine().TUIConversation.deleteConversation(this.conversationID)}},{key:"pinConversation",value:function(){return this.getEngine().TUIConversation.pinConversation({conversationID:this.conversationID,isPinned:!this.isPinned})}},{key:"muteConversation",value:function(){var e=this.getEngine(),t={messageRemindType:!0===this.isMuted?e.TYPES.MSG_REMIND_ACPT_AND_NOTE:e.TYPES.MSG_REMIND_ACPT_NOT_NOTE};if(this.type===e.TYPES.CONV_C2C){var n=this.conversationID.replace(e.TYPES.CONV_C2C,"");t.userIDList=[n]}else if(this.type===e.TYPES.CONV_GROUP){var r=this.conversationID.replace(e.TYPES.CONV_GROUP,"");t.groupID=r}return e.TUIConversation.muteConversation(t)}},{key:"getAvatar",value:function(){var e,t,n,r,o,i,a=this.getEngine(),s="";switch(this.type){case a.TYPES.CONV_C2C:s=U(null===(e=this.userProfile)||void 0===e?void 0:e.avatar)?null===(t=this.userProfile)||void 0===t?void 0:t.avatar:"https://web.sdk.qcloud.com/component/TUIKit/assets/avatar_21.png";break;case a.TYPES.CONV_GROUP:s=U(null===(n=this.groupProfile)||void 0===n?void 0:n.avatar)?null===(r=this.groupProfile)||void 0===r?void 0:r.avatar:"https://web.sdk.qcloud.com/im/demo/TUIkit/web/img/constomer.svg";break;case a.TYPES.CONV_SYSTEM:s=U(null===(o=this.groupProfile)||void 0===o?void 0:o.avatar)?null===(i=this.groupProfile)||void 0===i?void 0:i.avatar:"https://web.sdk.qcloud.com/component/TUIKit/assets/group_avatar.png"}return s}},{key:"getShowName",value:function(){var e,t,n,r,o=this.getEngine(),i="";switch(this.type){case o.TYPES.CONV_C2C:i=this.remark||(null===(e=this.userProfile)||void 0===e?void 0:e.nick)||(null===(t=this.userProfile)||void 0===t?void 0:t.userID)||"";break;case o.TYPES.CONV_GROUP:i=(null===(n=this.groupProfile)||void 0===n?void 0:n.name)||(null===(r=this.groupProfile)||void 0===r?void 0:r.groupID)||"";break;case o.TYPES.CONV_SYSTEM:i=o.TUITranslate.t("系统通知")}return i}},{key:"getGroupAtInfo",value:function(){for(var e=this.getEngine(),t=e.TUITranslate.t.bind(e.TUITranslate),n=["[".concat(t("TUIConversation.有人@我"),"]"),"[".concat(t("TUIConversation.@所有人"),"]"),"[".concat(t("TUIConversation.@所有人"),"][").concat(t("TUIConversation.有人@我"),"]")],r="",o=0;o<this.groupAtInfoList.length;o++)this.groupAtInfoList[o].atTypeArray[0]&&this.unreadCount>0&&(r=n[this.groupAtInfoList[o].atTypeArray[0]-1]);return r}},{key:"getLastMessage",value:function(e){return"time"===e?this.getLastMessageTime():"text"===e?this.getLastMessageText():(console.warn("ConversationModel.getLastMessage key:".concat(e," is invalid.")),null)}},{key:"getLastMessageTime",value:function(){var e,t=this.getEngine(),n="";return(null===(e=this.lastMessage)||void 0===e?void 0:e.lastTime)>0&&(n=function(e,t){var n=36e5,r=(new Date).getTime()-e,o="";if(r<0)return o;var i=r/6e4,a=r/n,s=r/864e5,u=r/6048e5;if(u>=1&&u<=4)o=" ".concat(parseInt("".concat(u),10)," ").concat(t("time.周")).concat(t("time.前"));else if(s>=1&&s<=6)o=" ".concat(parseInt("".concat(s),10)," ").concat(t("time.天")).concat(t("time.前"));else if(a>=1&&a<=23)o=" ".concat(parseInt("".concat(a),10)," ").concat(t("time.小时")).concat(t("time.前"));else if(i>=1&&i<=59)o=" ".concat(parseInt("".concat(i),10)," ").concat(t("time.分钟")).concat(t("time.前"));else if(r>=0&&r<=6e4)o="".concat(t("time.刚刚"));else{var c=new Date;c.setTime(e),o="".concat(c.getFullYear(),"-").concat(c.getMonth()+1<10?"0".concat(c.getMonth()+1):c.getMonth()+1,"-").concat(c.getDate()<10?"0".concat(c.getDate()):c.getDate())}return o}(1e3*this.lastMessage.lastTime,t.TUITranslate.t.bind(t.TUITranslate))),n}},{key:"getLastMessageText",value:function(){var e,t=this.getEngine(),n=t.TUITranslate.t.bind(t.TUITranslate);if(4===this.operationType)return n("TUIConversation.您已被群管理员移出群聊");if(5===this.operationType)return n("TUIConversation.该群聊已被解散");if(8===this.operationType)return n("TUIConversation.您已退出该群聊");var r=this._conversation,o=this.lastMessage,i="",a="",s=r.unreadCount>0&&r.messageRemindType===t.TYPES.MSG_REMIND_ACPT_NOT_NOTE?n("[".concat(r.unreadCount>99?"99+":r.unreadCount,"条]")):"";if(r.type===t.TYPES.CONV_GROUP)if(o.fromAccount===t.getMyUserID())i=n("TUIConversation.我");else{var u=o.fromAccount;i=t.TUIFriend.getFriendRemark([u])[u]||o.nameCard||o.nick||u}if(o.type===t.TYPES.MSG_TEXT)a=o.payload.text;else if(o.type===t.TYPES.MSG_CUSTOM){var c=G(null===(e=null==o?void 0:o.payload)||void 0===e?void 0:e.data);if(1===(null==c?void 0:c.businessID))return a=t.TUIChat.messageHandler.handleCallKitSignaling(o),a;a=o.messageForShow}else a=o.messageForShow;return o.isRevoked&&(a=n("TUIChat.撤回了一条消息")),r.type===t.TYPES.CONV_GROUP&&o.type===t.TYPES.MSG_GRP_TIP?a:"".concat(s).concat(i?"".concat(i,":"):"").concat(a)}}]),n}(ae),ue=function(){function e(){(0,h.default)(this,e),this.defaultStore={currentConversationID:"",totalUnreadCount:0,conversationList:[],currentConversation:null},this.store={currentConversationID:"",totalUnreadCount:0,conversationList:[],currentConversation:null}}return(0,g.default)(e,[{key:"update",value:function(e,t){"conversationList"===e?this.updateConversationList(t):this.store[e]=t}},{key:"getData",value:function(e){return this.store[e]}},{key:"getModel",value:function(e){return this.store.conversationList.find((function(t){return t.conversationID===e}))}},{key:"reset",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];0===t.length&&(t=Object.keys(this.store)),this.store=Object.assign(Object.assign(Object.assign({},this.defaultStore),this.store),t.reduce((function(t,n){return Object.assign(Object.assign({},t),(0,p.default)({},n,e.defaultStore[n]))}),{}))}},{key:"updateConversationList",value:function(e){var t=[];e.forEach((function(e){var n=e;e instanceof se?n.updateProperties(e):n=new se(e),t.push(n)})),this.store.conversationList=t}}]),e}(),ce=function(e){(0,l.default)(n,e);var t=y(n);function n(e){var r,o;return(0,h.default)(this,n),o=t.call(this),o.messageHandlers=(r={},(0,p.default)(r,o.getEngine().TYPES.MSG_TEXT,(function(e){return o.getEngine().TUIChat.messageHandler.handleTextMessage(e)})),(0,p.default)(r,o.getEngine().TYPES.MSG_FACE,(function(e){return o.getEngine().TUIChat.messageHandler.handleFaceMessage(e)})),(0,p.default)(r,o.getEngine().TYPES.MSG_LOCATION,(function(e){return o.getEngine().TUIChat.messageHandler.handleLocationMessage(e)})),(0,p.default)(r,o.getEngine().TYPES.MSG_IMAGE,(function(e){return o.getEngine().TUIChat.messageHandler.handleImageMessage(e)})),(0,p.default)(r,o.getEngine().TYPES.MSG_AUDIO,(function(e){return o.getEngine().TUIChat.messageHandler.handleAudioMessage(e)})),(0,p.default)(r,o.getEngine().TYPES.MSG_VIDEO,(function(e){return o.getEngine().TUIChat.messageHandler.handleVideoMessage(e)})),(0,p.default)(r,o.getEngine().TYPES.MSG_FILE,(function(e){return o.getEngine().TUIChat.messageHandler.handleFileMessage(e)})),(0,p.default)(r,o.getEngine().TYPES.MSG_CUSTOM,(function(e){return o.getEngine().TUIChat.messageHandler.handleCustomMessage(e)})),(0,p.default)(r,o.getEngine().TYPES.MSG_MERGER,(function(e){return o.getEngine().TUIChat.messageHandler.handleMergeMessage(e)})),(0,p.default)(r,o.getEngine().TYPES.MSG_GRP_TIP,(function(e){return o.getEngine().TUIChat.messageHandler.handleGroupTipsMessage(e)})),r),o._message=e,o._signalingInfo=void 0,o.progress=0,o.initProperties(e),o}return(0,g.default)(n,[{key:"initProperties",value:function(e){var t=this;Object.keys(e).forEach((function(n){P(n)||(t[n]=e[n])}))}},{key:"updateProperties",value:function(e){var t=this;this._message=e,Object.keys(e).forEach((function(n){P(n)||(t[n]=e[n])}))}},{key:"getMessage",value:function(){return this._message}},{key:"modifyMessage",value:function(e){return e.type&&this._message.type!==e.type&&!e.payload?Promise.reject({code:O.MISMATCH_TYPE_AND_PAYLOAD,message:N.MISMATCH_TYPE_AND_PAYLOAD}):(this._message.type=e.type||this._message.type,this._message.payload=e.payload||this._message.payload,this._message.cloudCustomData=e.cloudCustomData||this._message.cloudCustomData,this.getEngine().TUIChat.modifyMessage(this._message))}},{key:"revokeMessage",value:function(){return this.getEngine().TUIChat.revokeMessage(this._message)}},{key:"resendMessage",value:function(){return this.getEngine().TUIChat.resendMessage(this._message)}},{key:"deleteMessage",value:function(){return this.getEngine().TUIChat.deleteMessage([this._message])}},{key:"quoteMessage",value:function(){return this.getEngine().TUIChat.quoteMessage(this._message)}},{key:"replyMessage",value:function(){return this.getEngine().TUIChat.replyMessage(this._message)}},{key:"setMessageExtensions",value:function(e){return this.getEngine().TUIChat.setMessageExtensions(this._message,e)}},{key:"getMessageExtensions",value:function(){return this.getEngine().TUIChat.getMessageExtensions(this._message)}},{key:"deleteMessageExtensions",value:function(e){return this.getEngine().TUIChat.deleteMessageExtensions(this._message,e)}},{key:"getSignalingInfo",value:function(){return this.type!==this.getEngine().TYPES.MSG_CUSTOM?null:L(this._signalingInfo)?(this._signalingInfo=this.getEngine().chat.getSignalingInfo(this._message),this._signalingInfo):this._signalingInfo}},{key:"getMessageContent",value:function(){var e=this.messageHandlers[this.type];if(L(e))return{};if(this.type===this.getEngine().TYPES.MSG_GRP_TIP)return e(this._message);var t=this.getEngine().TUIFriend.getFriendRemark([this.from]);return Object.assign(Object.assign({},e(this._message)),{showName:t[this.from]||this.nameCard||this.nick||this.from})}},{key:"getMessageReaction",value:function(){var e=Object.assign({},this._message.cloudCustomData?G(this._message.cloudCustomData):{});return e.messageReact?e.messageReact:void 0}},{key:"addMessageReaction",value:function(e){var t=this.setMessageReaction(e);if(t)return F(this.getEngine().TUIChat.modifyMessage(t))}},{key:"deleteMessageReaction",value:function(e){var t=this.setMessageReaction(e,D.REMOVE);if(t)return F(this.getEngine().TUIChat.modifyMessage(t))}},{key:"setMessageReaction",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:D.ADD,n=this.getEngine().getMyUserID(),r=this._message,o=Object.assign({messageReact:{}},r.cloudCustomData?G(r.cloudCustomData):{}),i=Object.assign({reacts:{},version:1},o.messageReact),a=i.reacts[e]||[],s=a.indexOf(n),u=-1===s&&t===D.REMOVE,c=s>=0&&t===D.ADD;if(!u&&!c)return-1===s?a.push(n):a.splice(s,1),i.reacts[e]=a,i.reacts=Object.keys(i.reacts).filter((function(e){return i.reacts[e].length>0})).reduce((function(e,t){return Object.assign(Object.assign({},e),(0,p.default)({},t,i.reacts[t]))}),{}),o.messageReact=i,r.cloudCustomData=JSON.stringify(o),r}},{key:"sendForwardMessage",value:function(e){return this.getEngine().TUIChat.sendForwardMessage(e,[this._message])}}]),n}(ae),le=function(){function e(){(0,h.default)(this,e),this.defaultStore={messageList:[],isCompleted:!1,nextReqMessageID:"",quoteMessage:{},newMessageList:[],typingStatus:!1,messageSource:void 0},this.store={messageList:[],isCompleted:!1,nextReqMessageID:"",quoteMessage:{},newMessageList:[],typingStatus:!1,messageSource:void 0}}return(0,g.default)(e,[{key:"update",value:function(e,t){"messageList"===e?this.updateMessageList(t):this.store[e]=t}},{key:"getData",value:function(e){return this.store[e]}},{key:"getModel",value:function(e){return this.store.messageList.find((function(t){return t.ID===e}))}},{key:"reset",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];0===t.length&&(t=Object.keys(this.store)),this.store=Object.assign(Object.assign(Object.assign({},this.defaultStore),this.store),null==t?void 0:t.reduce((function(t,n){return Object.assign(Object.assign({},t),(0,p.default)({},n,e.defaultStore[n]))}),{}))}},{key:"updateMessageList",value:function(e){var t=this,n=[];e.forEach((function(e){var r=e;e instanceof ce||(r=t.getModel(e.ID),r?r.updateProperties(e):r=new ce(e)),n.push(r)})),this.store.messageList=n}}]),e}(),de=function(e){(0,l.default)(n,e);var t=y(n);function n(e){var r;return(0,h.default)(this,n),r=t.call(this),r.groupAttributes={},r.groupCounters={},r.initProxy(e),r}return(0,g.default)(n,[{key:"initProxy",value:function(e){var t=this;Object.keys(e).forEach((function(n){P(n)||(t[n]=e[n])})),this._group=e}},{key:"getGroup",value:function(){return this._group}},{key:"switchGroup",value:function(){return this.getEngine().TUIGroup.switchGroup(this.groupID)}},{key:"getGroupProfile",value:function(e){return this.getEngine().TUIGroup.getGroupProfile({groupID:this.groupID,groupCustomFieldFilter:e})}},{key:"updateGroupProfile",value:function(e){return this.getEngine().TUIGroup.updateGroupProfile(Object.assign({groupID:this.groupID},e))}},{key:"joinGroup",value:function(e){return this.getEngine().TUIGroup.joinGroup({groupID:this.groupID,applyMessage:e})}},{key:"quitGroup",value:function(){return this.getEngine().TUIGroup.quitGroup(this.groupID)}},{key:"dismissGroup",value:function(){return this.getEngine().TUIGroup.dismissGroup(this.groupID)}},{key:"getGroupOnlineMemberCount",value:function(){return this.getEngine().TUIGroup.getGroupOnlineMemberCount(this.groupID)}},{key:"changeGroupOwner",value:function(e){return this.getEngine().TUIGroup.changeGroupOwner(Object.assign({groupID:this.groupID},e))}},{key:"initGroupAttributes",value:function(e){return this.getEngine().TUIGroup.initGroupAttributes(Object.assign({groupID:this.groupID},e))}},{key:"setGroupAttributes",value:function(e){return this.getEngine().TUIGroup.setGroupAttributes(Object.assign({groupID:this.groupID},e))}},{key:"deleteGroupAttributes",value:function(e){return this.getEngine().TUIGroup.deleteGroupAttributes(Object.assign({groupID:this.groupID},e))}},{key:"getGroupAttributes",value:function(e){return this.getEngine().TUIGroup.getGroupAttributes(Object.assign({groupID:this.groupID},e))}},{key:"setGroupCounters",value:function(e){return this.getEngine().TUIGroup.setGroupCounters(Object.assign({groupID:this.groupID},e))}},{key:"increaseGroupCounter",value:function(e){return this.getEngine().TUIGroup.increaseGroupCounter(Object.assign({groupID:this.groupID},e))}},{key:"decreaseGroupCounter",value:function(e){return this.getEngine().TUIGroup.decreaseGroupCounter(Object.assign({groupID:this.groupID},e))}},{key:"getGroupCounters",value:function(e){return this.getEngine().TUIGroup.getGroupCounters(Object.assign({groupID:this.groupID},e))}},{key:"addGroupMember",value:function(e){return this.getEngine().TUIGroup.addGroupMember(Object.assign({groupID:this.groupID},e))}},{key:"getGroupMemberList",value:function(e){return this.getEngine().TUIGroup.getGroupMemberList(Object.assign({groupID:this.groupID},e))}},{key:"getGroupMemberProfile",value:function(e){return this.getEngine().TUIGroup.getGroupMemberProfile(Object.assign({groupID:this.groupID},e))}},{key:"deleteGroupMember",value:function(e){return this.getEngine().TUIGroup.deleteGroupMember(Object.assign({groupID:this.groupID},e))}},{key:"setGroupMemberMuteTime",value:function(e){return this.getEngine().TUIGroup.setGroupMemberMuteTime(Object.assign({groupID:this.groupID},e))}},{key:"setGroupMemberRole",value:function(e){return this.getEngine().TUIGroup.setGroupMemberRole(Object.assign({groupID:this.groupID},e))}},{key:"setGroupMemberNameCard",value:function(e){return this.getEngine().TUIGroup.setGroupMemberNameCard(Object.assign({groupID:this.groupID},e))}},{key:"setGroupMemberCustomField",value:function(e){return this.getEngine().TUIGroup.setGroupMemberCustomField(Object.assign({groupID:this.groupID},e))}},{key:"markGroupMemberList",value:function(e){return this.getEngine().TUIGroup.markGroupMemberList(Object.assign({groupID:this.groupID},e))}}]),n}(ae),fe=function(){function e(){(0,h.default)(this,e),this.defaultStore={currentGroupID:"",currentGroup:{},currentGroupAttributes:{},currentGroupCounters:{},currentGroupMemberList:[],groupList:[],groupSystemNoticeList:[]},this.store={currentGroupID:"",currentGroup:void 0,currentGroupAttributes:{},currentGroupCounters:{},currentGroupMemberList:[],groupList:[],groupSystemNoticeList:[]}}return(0,g.default)(e,[{key:"update",value:function(e,t){switch(e){case"groupList":this.updateGroupList(t);break;case"currentGroup":this.store.currentGroup=t instanceof de?t:new de(t);break;default:this.store[e]=t}}},{key:"getData",value:function(e){if("groupSystemNoticeList"===e){var t=(0,c.default)(this.store.groupSystemNoticeList);return this.store.groupSystemNoticeList.length=0,t}return this.store[e]}},{key:"reset",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];0===t.length&&(t=Object.keys(this.store)),this.store=Object.assign(Object.assign(Object.assign({},this.defaultStore),this.store),t.reduce((function(t,n){return Object.assign(Object.assign({},t),(0,p.default)({},n,e.defaultStore[n]))}),{}))}},{key:"updateGroupList",value:function(e){this.store.groupList=e.map((function(e){return e instanceof de?e:new de(e)}))}}]),e}(),pe=function(){function e(){(0,h.default)(this,e),this.store={}}return(0,g.default)(e,[{key:"update",value:function(e,t){this.store[e]=t}},{key:"getData",value:function(e){return this.store[e]}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];0===e.length&&(this.store={}),this.store=Object.assign(Object.assign({},this.store),e.reduce((function(e,t){return Object.assign(Object.assign({},e),(0,p.default)({},t,void 0))}),{}))}}]),e}(),he=function(){function e(){(0,h.default)(this,e),this.defaultStore={friendList:[],friendApplicationList:[],friendApplicationUnreadCount:0},this.store={friendList:[],friendApplicationList:[],friendApplicationUnreadCount:0}}return(0,g.default)(e,[{key:"update",value:function(e,t){this.store[e]=t}},{key:"getData",value:function(e){return this.store[e]}},{key:"reset",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];0===t.length&&(t=Object.keys(this.store)),this.store=Object.assign(Object.assign(Object.assign({},this.defaultStore),this.store),t.reduce((function(t,n){return Object.assign(Object.assign({},t),(0,p.default)({},n,e.defaultStore[n]))}),{}))}}]),e}(),ge=function(){function e(){var t;(0,h.default)(this,e),this.storeMap=(t={},(0,p.default)(t,C.APP,new oe),(0,p.default)(t,C.USER,new ie),(0,p.default)(t,C.CONV,new ue),(0,p.default)(t,C.CHAT,new le),(0,p.default)(t,C.GRP,new fe),(0,p.default)(t,C.FRIEND,new he),t),this.task={}}return(0,g.default)(e,[{key:"watch",value:function(e,t){var n=this;this.task[e]||(this.task[e]={});var r=this.task[e];Object.keys(t).forEach((function(o){var i=t[o];r[o]||(r[o]=new Map),r[o].set(i,1),n.notifyOnWatch(e,o,i)}))}},{key:"unwatch",value:function(e,t){if(this.task[e]){var n=this.task[e];Object.keys(t).forEach((function(e){n[e].delete(t[e])}))}}},{key:"update",value:function(e,t,n){var r;e!==C.CUSTOM||this.storeMap[e]||(this.storeMap[e]=new pe),null===(r=this.storeMap[e])||void 0===r||r.update(t,n),this.notify(e,t)}},{key:"getData",value:function(e,t){var n;return e!==C.CUSTOM||this.storeMap[e]||(this.storeMap[e]=new pe),null===(n=this.storeMap[e])||void 0===n?void 0:n.getData(t)}},{key:"getConversationModel",value:function(e){var t;return null===(t=this.storeMap[C.CONV])||void 0===t?void 0:t.getModel(e)}},{key:"getMessageModel",value:function(e){var t;return null===(t=this.storeMap[C.CHAT])||void 0===t?void 0:t.getModel(e)}},{key:"reset",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e in this.storeMap){var o=this.storeMap[e];0===n.length&&(n=Object.keys(null==o?void 0:o.store)),o.reset(n),r&&n.forEach((function(n){t.notify(e,n)}))}}},{key:"notifyOnWatch",value:function(e,t,n){var r=this.getData(e,t);B.indexOf(t)>-1&&0===r.length||n&&n.call(this,r)}},{key:"notify",value:function(e,t){if(this.task[e]){var n=this.task[e];if(n[t]){var r,o=n[t],i=this.getData(e,t),a=I(o.entries());try{for(a.s();!(r=a.n()).done;){var s=(0,u.default)(r.value,1),c=s[0];c.call(this,i)}}catch(l){a.e(l)}finally{a.f()}}}}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();function ve(e){return ve="function"==typeof Symbol&&"symbol"==(0,s.default)(Symbol.iterator)?function(e){return(0,s.default)(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":(0,s.default)(e)},ve(e)}function _e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function me(e){var t=function(e,t){if("object"!=ve(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=ve(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==ve(t)?t:String(t)}function ye(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,me(r.key),r)}}function Ie(e,t,n){return t&&ye(e.prototype,t),n&&ye(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Me(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Te(e,t){return Te=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Te(e,t)}function Se(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Te(e,t)}function Ee(e,t){if(t&&("object"===ve(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Me(e)}function Ce(e){return Ce=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ce(e)}function ke(e,t,n){return(t=me(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function be(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function De(e){return function(e){if(Array.isArray(e))return e}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return be(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?be(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ae(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Oe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ae(Object(n),!0).forEach((function(t){ke(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ae(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Re={type:"logger",log:function(e){this.output("log",e)},warn:function(e){this.output("warn",e)},error:function(e){this.output("error",e)},output:function(e,t){console&&console[e]&&console[e].apply(console,t)}},Ne=new(function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_e(this,e),this.init(t,n)}return Ie(e,[{key:"init",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.prefix=t.prefix||"i18next:",this.logger=e||Re,this.options=t,this.debug=t.debug}},{key:"setDebug",value:function(e){this.debug=e}},{key:"log",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"log","",!0)}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"warn","",!0)}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"error","")}},{key:"deprecate",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"warn","WARNING DEPRECATED: ",!0)}},{key:"forward",value:function(e,t,n,r){return r&&!this.debug?null:("string"==typeof e[0]&&(e[0]="".concat(n).concat(this.prefix," ").concat(e[0])),this.logger[t](e))}},{key:"create",value:function(t){return new e(this.logger,Oe(Oe({},{prefix:"".concat(this.prefix,":").concat(t,":")}),this.options))}},{key:"clone",value:function(t){return(t=t||this.options).prefix=t.prefix||this.prefix,new e(this.logger,t)}}]),e}()),we=function(){function e(){_e(this,e),this.observers={}}return Ie(e,[{key:"on",value:function(e,t){var n=this;return e.split(" ").forEach((function(e){n.observers[e]=n.observers[e]||[],n.observers[e].push(t)})),this}},{key:"off",value:function(e,t){this.observers[e]&&(t?this.observers[e]=this.observers[e].filter((function(e){return e!==t})):delete this.observers[e])}},{key:"emit",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.observers[e]&&[].concat(this.observers[e]).forEach((function(e){e.apply(void 0,n)})),this.observers["*"]&&[].concat(this.observers["*"]).forEach((function(t){t.apply(t,[e].concat(n))}))}}]),e}();function Le(){var e,t,n=new Promise((function(n,r){e=n,t=r}));return n.resolve=e,n.reject=t,n}function Pe(e){return null==e?"":""+e}function Ue(e,t,n){function r(e){return e&&e.indexOf("###")>-1?e.replace(/###/g,"."):e}function o(){return!e||"string"==typeof e}for(var i="string"!=typeof t?[].concat(t):t.split(".");i.length>1;){if(o())return{};var a=r(i.shift());!e[a]&&n&&(e[a]=new n),e=Object.prototype.hasOwnProperty.call(e,a)?e[a]:{}}return o()?{}:{obj:e,k:r(i.shift())}}function Ge(e,t,n){var r=Ue(e,t,Object);r.obj[r.k]=n}function xe(e,t){var n=Ue(e,t),r=n.obj,o=n.k;if(r)return r[o]}function Fe(e,t,n){for(var r in t)"__proto__"!==r&&"constructor"!==r&&(r in e?"string"==typeof e[r]||e[r]instanceof String||"string"==typeof t[r]||t[r]instanceof String?n&&(e[r]=t[r]):Fe(e[r],t[r],n):e[r]=t[r]);return e}function qe(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}var Ve={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function Be(e){return"string"==typeof e?e.replace(/[&<>"'\/]/g,(function(e){return Ve[e]})):e}var je="undefined"!=typeof window&&window.navigator&&void 0===window.navigator.userAgentData&&window.navigator.userAgent&&window.navigator.userAgent.indexOf("MSIE")>-1,He=[" ",",","?","!",";"];function Ke(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".";if(e){if(e[t])return e[t];for(var r=t.split(n),o=e,i=0;i<r.length;++i){if(!o)return;if("string"==typeof o[r[i]]&&i+1<r.length)return;if(void 0===o[r[i]]){for(var a=2,s=r.slice(i,i+a).join(n),u=o[s];void 0===u&&r.length>i+a;)a++,u=o[s=r.slice(i,i+a).join(n)];if(void 0===u)return;if(null===u)return null;if(t.endsWith(s)){if("string"==typeof u)return u;if(s&&"string"==typeof u[s])return u[s]}var c=r.slice(i+a).join(n);return c?Ke(u,c,n):void 0}o=o[r[i]]}return o}}function We(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ye(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?We(Object(n),!0).forEach((function(t){ke(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):We(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ze=function(e){Se(n,we);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ce(e);if(t){var o=Ce(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ee(this,n)}}(n);function n(e){var r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{ns:["translation"],defaultNS:"translation"};return _e(this,n),r=t.call(this),je&&we.call(Me(r)),r.data=e||{},r.options=o,void 0===r.options.keySeparator&&(r.options.keySeparator="."),void 0===r.options.ignoreJSONStructure&&(r.options.ignoreJSONStructure=!0),r}return Ie(n,[{key:"addNamespaces",value:function(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}},{key:"removeNamespaces",value:function(e){var t=this.options.ns.indexOf(e);t>-1&&this.options.ns.splice(t,1)}},{key:"getResource",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=void 0!==r.keySeparator?r.keySeparator:this.options.keySeparator,i=void 0!==r.ignoreJSONStructure?r.ignoreJSONStructure:this.options.ignoreJSONStructure,a=[e,t];n&&"string"!=typeof n&&(a=a.concat(n)),n&&"string"==typeof n&&(a=a.concat(o?n.split(o):n)),e.indexOf(".")>-1&&(a=e.split("."));var s=xe(this.data,a);return s||!i||"string"!=typeof n?s:Ke(this.data&&this.data[e]&&this.data[e][t],n,o)}},{key:"addResource",value:function(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{silent:!1},i=void 0!==o.keySeparator?o.keySeparator:this.options.keySeparator,a=[e,t];n&&(a=a.concat(i?n.split(i):n)),e.indexOf(".")>-1&&(r=t,t=(a=e.split("."))[1]),this.addNamespaces(t),Ge(this.data,a,r),o.silent||this.emit("added",e,t,n,r)}},{key:"addResources",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{silent:!1};for(var o in n)"string"!=typeof n[o]&&"[object Array]"!==Object.prototype.toString.apply(n[o])||this.addResource(e,t,o,n[o],{silent:!0});r.silent||this.emit("added",e,t,n)}},{key:"addResourceBundle",value:function(e,t,n,r,o){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{silent:!1},a=[e,t];e.indexOf(".")>-1&&(r=n,n=t,t=(a=e.split("."))[1]),this.addNamespaces(t);var s=xe(this.data,a)||{};r?Fe(s,n,o):s=Ye(Ye({},s),n),Ge(this.data,a,s),i.silent||this.emit("added",e,t,n)}},{key:"removeResourceBundle",value:function(e,t){this.hasResourceBundle(e,t)&&delete this.data[e][t],this.removeNamespaces(t),this.emit("removed",e,t)}},{key:"hasResourceBundle",value:function(e,t){return void 0!==this.getResource(e,t)}},{key:"getResourceBundle",value:function(e,t){return t||(t=this.options.defaultNS),"v1"===this.options.compatibilityAPI?Ye(Ye({},{}),this.getResource(e,t)):this.getResource(e,t)}},{key:"getDataByLanguage",value:function(e){return this.data[e]}},{key:"hasLanguageSomeTranslations",value:function(e){var t=this.getDataByLanguage(e);return!!(t&&Object.keys(t)||[]).find((function(e){return t[e]&&Object.keys(t[e]).length>0}))}},{key:"toJSON",value:function(){return this.data}}]),n}(),Je={processors:{},addPostProcessor:function(e){this.processors[e.name]=e},handle:function(e,t,n,r,o){var i=this;return e.forEach((function(e){i.processors[e]&&(t=i.processors[e].process(t,n,r,o))})),t}};function Xe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $e(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xe(Object(n),!0).forEach((function(t){ke(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ze={},Qe=function(e){Se(n,we);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ce(e);if(t){var o=Ce(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ee(this,n)}}(n);function n(e){var r,o,i,a,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return _e(this,n),r=t.call(this),je&&we.call(Me(r)),o=["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],i=e,a=Me(r),o.forEach((function(e){i[e]&&(a[e]=i[e])})),r.options=s,void 0===r.options.keySeparator&&(r.options.keySeparator="."),r.logger=Ne.create("translator"),r}return Ie(n,[{key:"changeLanguage",value:function(e){e&&(this.language=e)}},{key:"exists",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}};if(null==e)return!1;var n=this.resolve(e,t);return n&&void 0!==n.res}},{key:"extractFromKey",value:function(e,t){var n=void 0!==t.nsSeparator?t.nsSeparator:this.options.nsSeparator;void 0===n&&(n=":");var r=void 0!==t.keySeparator?t.keySeparator:this.options.keySeparator,o=t.ns||this.options.defaultNS||[],i=n&&e.indexOf(n)>-1,a=!(this.options.userDefinedKeySeparator||t.keySeparator||this.options.userDefinedNsSeparator||t.nsSeparator||function(e,t,n){t=t||"",n=n||"";var r=He.filter((function(e){return t.indexOf(e)<0&&n.indexOf(e)<0}));if(0===r.length)return!0;var o=new RegExp("(".concat(r.map((function(e){return"?"===e?"\\?":e})).join("|"),")")),i=!o.test(e);if(!i){var a=e.indexOf(n);a>0&&!o.test(e.substring(0,a))&&(i=!0)}return i}(e,n,r));if(i&&!a){var s=e.match(this.interpolator.nestingRegexp);if(s&&s.length>0)return{key:e,namespaces:o};var u=e.split(n);(n!==r||n===r&&this.options.ns.indexOf(u[0])>-1)&&(o=u.shift()),e=u.join(r)}return"string"==typeof o&&(o=[o]),{key:e,namespaces:o}}},{key:"translate",value:function(e,t,r){var o=this;if("object"!==ve(t)&&this.options.overloadTranslationOptionHandler&&(t=this.options.overloadTranslationOptionHandler(arguments)),"object"===ve(t)&&(t=$e({},t)),t||(t={}),null==e)return"";Array.isArray(e)||(e=[String(e)]);var i=void 0!==t.returnDetails?t.returnDetails:this.options.returnDetails,a=void 0!==t.keySeparator?t.keySeparator:this.options.keySeparator,s=this.extractFromKey(e[e.length-1],t),u=s.key,c=s.namespaces,l=c[c.length-1],d=t.lng||this.language,f=t.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(d&&"cimode"===d.toLowerCase()){if(f){var p=t.nsSeparator||this.options.nsSeparator;return i?{res:"".concat(l).concat(p).concat(u),usedKey:u,exactUsedKey:u,usedLng:d,usedNS:l}:"".concat(l).concat(p).concat(u)}return i?{res:u,usedKey:u,exactUsedKey:u,usedLng:d,usedNS:l}:u}var h=this.resolve(e,t),g=h&&h.res,v=h&&h.usedKey||u,_=h&&h.exactUsedKey||u,m=Object.prototype.toString.apply(g),y=void 0!==t.joinArrays?t.joinArrays:this.options.joinArrays,I=!this.i18nFormat||this.i18nFormat.handleAsObject;if(I&&g&&"string"!=typeof g&&"boolean"!=typeof g&&"number"!=typeof g&&["[object Number]","[object Function]","[object RegExp]"].indexOf(m)<0&&("string"!=typeof y||"[object Array]"!==m)){if(!t.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");var M=this.options.returnedObjectHandler?this.options.returnedObjectHandler(v,g,$e($e({},t),{},{ns:c})):"key '".concat(u," (").concat(this.language,")' returned an object instead of string.");return i?(h.res=M,h):M}if(a){var T="[object Array]"===m,S=T?[]:{},E=T?_:v;for(var C in g)if(Object.prototype.hasOwnProperty.call(g,C)){var k="".concat(E).concat(a).concat(C);S[C]=this.translate(k,$e($e({},t),{joinArrays:!1,ns:c})),S[C]===k&&(S[C]=g[C])}g=S}}else if(I&&"string"==typeof y&&"[object Array]"===m)(g=g.join(y))&&(g=this.extendTranslation(g,e,t,r));else{var b=!1,D=!1,A=void 0!==t.count&&"string"!=typeof t.count,O=n.hasDefaultValue(t),R=A?this.pluralResolver.getSuffix(d,t.count,t):"",N=t["defaultValue".concat(R)]||t.defaultValue;!this.isValidLookup(g)&&O&&(b=!0,g=N),this.isValidLookup(g)||(D=!0,g=u);var w=(t.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&D?void 0:g,L=O&&N!==g&&this.options.updateMissing;if(D||b||L){if(this.logger.log(L?"updateKey":"missingKey",d,l,u,L?N:g),a){var P=this.resolve(u,$e($e({},t),{},{keySeparator:!1}));P&&P.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}var U=[],G=this.languageUtils.getFallbackCodes(this.options.fallbackLng,t.lng||this.language);if("fallback"===this.options.saveMissingTo&&G&&G[0])for(var x=0;x<G.length;x++)U.push(G[x]);else"all"===this.options.saveMissingTo?U=this.languageUtils.toResolveHierarchy(t.lng||this.language):U.push(t.lng||this.language);var F=function(e,n,r){var i=O&&r!==g?r:w;o.options.missingKeyHandler?o.options.missingKeyHandler(e,l,n,i,L,t):o.backendConnector&&o.backendConnector.saveMissing&&o.backendConnector.saveMissing(e,l,n,i,L,t),o.emit("missingKey",e,l,n,g)};this.options.saveMissing&&(this.options.saveMissingPlurals&&A?U.forEach((function(e){o.pluralResolver.getSuffixes(e,t).forEach((function(n){F([e],u+n,t["defaultValue".concat(n)]||N)}))})):F(U,u,N))}g=this.extendTranslation(g,e,t,h,r),D&&g===u&&this.options.appendNamespaceToMissingKey&&(g="".concat(l,":").concat(u)),(D||b)&&this.options.parseMissingKeyHandler&&(g="v1"!==this.options.compatibilityAPI?this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?"".concat(l,":").concat(u):u,b?g:void 0):this.options.parseMissingKeyHandler(g))}return i?(h.res=g,h):g}},{key:"extendTranslation",value:function(e,t,n,r,o){var i=this;if(this.i18nFormat&&this.i18nFormat.parse)e=this.i18nFormat.parse(e,$e($e({},this.options.interpolation.defaultVariables),n),r.usedLng,r.usedNS,r.usedKey,{resolved:r});else if(!n.skipInterpolation){n.interpolation&&this.interpolator.init($e($e({},n),{interpolation:$e($e({},this.options.interpolation),n.interpolation)}));var a,s="string"==typeof e&&(n&&n.interpolation&&void 0!==n.interpolation.skipOnVariables?n.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);if(s){var u=e.match(this.interpolator.nestingRegexp);a=u&&u.length}var c=n.replace&&"string"!=typeof n.replace?n.replace:n;if(this.options.interpolation.defaultVariables&&(c=$e($e({},this.options.interpolation.defaultVariables),c)),e=this.interpolator.interpolate(e,c,n.lng||this.language,n),s){var l=e.match(this.interpolator.nestingRegexp);a<(l&&l.length)&&(n.nest=!1)}!n.lng&&"v1"!==this.options.compatibilityAPI&&r&&r.res&&(n.lng=r.usedLng),!1!==n.nest&&(e=this.interpolator.nest(e,(function(){for(var e=arguments.length,r=new Array(e),a=0;a<e;a++)r[a]=arguments[a];return o&&o[0]===r[0]&&!n.context?(i.logger.warn("It seems you are nesting recursively key: ".concat(r[0]," in key: ").concat(t[0])),null):i.translate.apply(i,r.concat([t]))}),n)),n.interpolation&&this.interpolator.reset()}var d=n.postProcess||this.options.postProcess,f="string"==typeof d?[d]:d;return null!=e&&f&&f.length&&!1!==n.applyPostProcessor&&(e=Je.handle(f,e,t,this.options&&this.options.postProcessPassResolved?$e({i18nResolved:r},n):n,this)),e}},{key:"resolve",value:function(e){var t,n,r,o,i,a=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"string"==typeof e&&(e=[e]),e.forEach((function(e){if(!a.isValidLookup(t)){var u=a.extractFromKey(e,s),c=u.key;n=c;var l=u.namespaces;a.options.fallbackNS&&(l=l.concat(a.options.fallbackNS));var d=void 0!==s.count&&"string"!=typeof s.count,f=d&&!s.ordinal&&0===s.count&&a.pluralResolver.shouldUseIntlApi(),p=void 0!==s.context&&("string"==typeof s.context||"number"==typeof s.context)&&""!==s.context,h=s.lngs?s.lngs:a.languageUtils.toResolveHierarchy(s.lng||a.language,s.fallbackLng);l.forEach((function(e){a.isValidLookup(t)||(i=e,!Ze["".concat(h[0],"-").concat(e)]&&a.utils&&a.utils.hasLoadedNamespace&&!a.utils.hasLoadedNamespace(i)&&(Ze["".concat(h[0],"-").concat(e)]=!0,a.logger.warn('key "'.concat(n,'" for languages "').concat(h.join(", "),'" won\'t get resolved as namespace "').concat(i,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),h.forEach((function(n){if(!a.isValidLookup(t)){o=n;var i,u=[c];if(a.i18nFormat&&a.i18nFormat.addLookupKeys)a.i18nFormat.addLookupKeys(u,c,n,e,s);else{var l;d&&(l=a.pluralResolver.getSuffix(n,s.count,s));var h="".concat(a.options.pluralSeparator,"zero");if(d&&(u.push(c+l),f&&u.push(c+h)),p){var g="".concat(c).concat(a.options.contextSeparator).concat(s.context);u.push(g),d&&(u.push(g+l),f&&u.push(g+h))}}for(;i=u.pop();)a.isValidLookup(t)||(r=i,t=a.getResource(n,e,i,s))}})))}))}})),{res:t,usedKey:n,exactUsedKey:r,usedLng:o,usedNS:i}}},{key:"isValidLookup",value:function(e){return!(void 0===e||!this.options.returnNull&&null===e||!this.options.returnEmptyString&&""===e)}},{key:"getResource",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(e,t,n,r):this.resourceStore.getResource(e,t,n,r)}}],[{key:"hasDefaultValue",value:function(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&"defaultValue"===t.substring(0,12)&&void 0!==e[t])return!0;return!1}}]),n}();function et(e){return e.charAt(0).toUpperCase()+e.slice(1)}var tt=function(){function e(t){_e(this,e),this.options=t,this.supportedLngs=this.options.supportedLngs||!1,this.logger=Ne.create("languageUtils")}return Ie(e,[{key:"getScriptPartFromCode",value:function(e){if(!e||e.indexOf("-")<0)return null;var t=e.split("-");return 2===t.length?null:(t.pop(),"x"===t[t.length-1].toLowerCase()?null:this.formatLanguageCode(t.join("-")))}},{key:"getLanguagePartFromCode",value:function(e){if(!e||e.indexOf("-")<0)return e;var t=e.split("-");return this.formatLanguageCode(t[0])}},{key:"formatLanguageCode",value:function(e){if("string"==typeof e&&e.indexOf("-")>-1){var t=["hans","hant","latn","cyrl","cans","mong","arab"],n=e.split("-");return this.options.lowerCaseLng?n=n.map((function(e){return e.toLowerCase()})):2===n.length?(n[0]=n[0].toLowerCase(),n[1]=n[1].toUpperCase(),t.indexOf(n[1].toLowerCase())>-1&&(n[1]=et(n[1].toLowerCase()))):3===n.length&&(n[0]=n[0].toLowerCase(),2===n[1].length&&(n[1]=n[1].toUpperCase()),"sgn"!==n[0]&&2===n[2].length&&(n[2]=n[2].toUpperCase()),t.indexOf(n[1].toLowerCase())>-1&&(n[1]=et(n[1].toLowerCase())),t.indexOf(n[2].toLowerCase())>-1&&(n[2]=et(n[2].toLowerCase()))),n.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}},{key:"isSupportedCode",value:function(e){return("languageOnly"===this.options.load||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}},{key:"getBestMatchFromCodes",value:function(e){var t,n=this;return e?(e.forEach((function(e){if(!t){var r=n.formatLanguageCode(e);n.options.supportedLngs&&!n.isSupportedCode(r)||(t=r)}})),!t&&this.options.supportedLngs&&e.forEach((function(e){if(!t){var r=n.getLanguagePartFromCode(e);if(n.isSupportedCode(r))return t=r;t=n.options.supportedLngs.find((function(e){return e===r?e:e.indexOf("-")<0&&r.indexOf("-")<0?void 0:0===e.indexOf(r)?e:void 0}))}})),t||(t=this.getFallbackCodes(this.options.fallbackLng)[0]),t):null}},{key:"getFallbackCodes",value:function(e,t){if(!e)return[];if("function"==typeof e&&(e=e(t)),"string"==typeof e&&(e=[e]),"[object Array]"===Object.prototype.toString.apply(e))return e;if(!t)return e.default||[];var n=e[t];return n||(n=e[this.getScriptPartFromCode(t)]),n||(n=e[this.formatLanguageCode(t)]),n||(n=e[this.getLanguagePartFromCode(t)]),n||(n=e.default),n||[]}},{key:"toResolveHierarchy",value:function(e,t){var n=this,r=this.getFallbackCodes(t||this.options.fallbackLng||[],e),o=[],i=function(e){e&&(n.isSupportedCode(e)?o.push(e):n.logger.warn("rejecting language code not found in supportedLngs: ".concat(e)))};return"string"==typeof e&&e.indexOf("-")>-1?("languageOnly"!==this.options.load&&i(this.formatLanguageCode(e)),"languageOnly"!==this.options.load&&"currentOnly"!==this.options.load&&i(this.getScriptPartFromCode(e)),"currentOnly"!==this.options.load&&i(this.getLanguagePartFromCode(e))):"string"==typeof e&&i(this.formatLanguageCode(e)),r.forEach((function(e){o.indexOf(e)<0&&i(n.formatLanguageCode(e))})),o}}]),e}(),nt=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kk","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],rt={1:function(e){return Number(e>1)},2:function(e){return Number(1!=e)},3:function(e){return 0},4:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2)},5:function(e){return Number(0==e?0:1==e?1:2==e?2:e%100>=3&&e%100<=10?3:e%100>=11?4:5)},6:function(e){return Number(1==e?0:e>=2&&e<=4?1:2)},7:function(e){return Number(1==e?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2)},8:function(e){return Number(1==e?0:2==e?1:8!=e&&11!=e?2:3)},9:function(e){return Number(e>=2)},10:function(e){return Number(1==e?0:2==e?1:e<7?2:e<11?3:4)},11:function(e){return Number(1==e||11==e?0:2==e||12==e?1:e>2&&e<20?2:3)},12:function(e){return Number(e%10!=1||e%100==11)},13:function(e){return Number(0!==e)},14:function(e){return Number(1==e?0:2==e?1:3==e?2:3)},15:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&(e%100<10||e%100>=20)?1:2)},16:function(e){return Number(e%10==1&&e%100!=11?0:0!==e?1:2)},17:function(e){return Number(1==e||e%10==1&&e%100!=11?0:1)},18:function(e){return Number(0==e?0:1==e?1:2)},19:function(e){return Number(1==e?0:0==e||e%100>1&&e%100<11?1:e%100>10&&e%100<20?2:3)},20:function(e){return Number(1==e?0:0==e||e%100>0&&e%100<20?1:2)},21:function(e){return Number(e%100==1?1:e%100==2?2:e%100==3||e%100==4?3:0)},22:function(e){return Number(1==e?0:2==e?1:(e<0||e>10)&&e%10==0?2:3)}},ot=["v1","v2","v3"],it={zero:0,one:1,two:2,few:3,many:4,other:5},at=function(){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_e(this,e),this.languageUtils=t,this.options=r,this.logger=Ne.create("pluralResolver"),this.options.compatibilityJSON&&"v4"!==this.options.compatibilityJSON||"undefined"!=typeof Intl&&Intl.PluralRules||(this.options.compatibilityJSON="v3",this.logger.error("Your environment seems not to be Intl API compatible, use an Intl.PluralRules polyfill. Will fallback to the compatibilityJSON v3 format handling.")),this.rules=(n={},nt.forEach((function(e){e.lngs.forEach((function(t){n[t]={numbers:e.nr,plurals:rt[e.fc]}}))})),n)}return Ie(e,[{key:"addRule",value:function(e,t){this.rules[e]=t}},{key:"getRule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.shouldUseIntlApi())try{return new Intl.PluralRules(e,{type:t.ordinal?"ordinal":"cardinal"})}catch(e){return}return this.rules[e]||this.rules[this.languageUtils.getLanguagePartFromCode(e)]}},{key:"needsPlural",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getRule(e,t);return this.shouldUseIntlApi()?n&&n.resolvedOptions().pluralCategories.length>1:n&&n.numbers.length>1}},{key:"getPluralFormsOfKey",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.getSuffixes(e,n).map((function(e){return"".concat(t).concat(e)}))}},{key:"getSuffixes",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.getRule(e,n);return r?this.shouldUseIntlApi()?r.resolvedOptions().pluralCategories.sort((function(e,t){return it[e]-it[t]})).map((function(e){return"".concat(t.options.prepend).concat(e)})):r.numbers.map((function(r){return t.getSuffix(e,r,n)})):[]}},{key:"getSuffix",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=this.getRule(e,n);return r?this.shouldUseIntlApi()?"".concat(this.options.prepend).concat(r.select(t)):this.getSuffixRetroCompatible(r,t):(this.logger.warn("no plural rule found for: ".concat(e)),"")}},{key:"getSuffixRetroCompatible",value:function(e,t){var n=this,r=e.noAbs?e.plurals(t):e.plurals(Math.abs(t)),o=e.numbers[r];this.options.simplifyPluralSuffix&&2===e.numbers.length&&1===e.numbers[0]&&(2===o?o="plural":1===o&&(o=""));var i=function(){return n.options.prepend&&o.toString()?n.options.prepend+o.toString():o.toString()};return"v1"===this.options.compatibilityJSON?1===o?"":"number"==typeof o?"_plural_".concat(o.toString()):i():"v2"===this.options.compatibilityJSON||this.options.simplifyPluralSuffix&&2===e.numbers.length&&1===e.numbers[0]?i():this.options.prepend&&r.toString()?this.options.prepend+r.toString():r.toString()}},{key:"shouldUseIntlApi",value:function(){return!ot.includes(this.options.compatibilityJSON)}}]),e}();function st(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ut(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?st(Object(n),!0).forEach((function(t){ke(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):st(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ct(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:".",o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=function(e,t,n){var r=xe(e,n);return void 0!==r?r:xe(t,n)}(e,t,n);return!i&&o&&"string"==typeof n&&void 0===(i=Ke(e,n,r))&&(i=Ke(t,n,r)),i}var lt=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_e(this,e),this.logger=Ne.create("interpolator"),this.options=t,this.format=t.interpolation&&t.interpolation.format||function(e){return e},this.init(t)}return Ie(e,[{key:"init",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.interpolation||(e.interpolation={escapeValue:!0});var t=e.interpolation;this.escape=void 0!==t.escape?t.escape:Be,this.escapeValue=void 0===t.escapeValue||t.escapeValue,this.useRawValueToEscape=void 0!==t.useRawValueToEscape&&t.useRawValueToEscape,this.prefix=t.prefix?qe(t.prefix):t.prefixEscaped||"{{",this.suffix=t.suffix?qe(t.suffix):t.suffixEscaped||"}}",this.formatSeparator=t.formatSeparator?t.formatSeparator:t.formatSeparator||",",this.unescapePrefix=t.unescapeSuffix?"":t.unescapePrefix||"-",this.unescapeSuffix=this.unescapePrefix?"":t.unescapeSuffix||"",this.nestingPrefix=t.nestingPrefix?qe(t.nestingPrefix):t.nestingPrefixEscaped||qe("$t("),this.nestingSuffix=t.nestingSuffix?qe(t.nestingSuffix):t.nestingSuffixEscaped||qe(")"),this.nestingOptionsSeparator=t.nestingOptionsSeparator?t.nestingOptionsSeparator:t.nestingOptionsSeparator||",",this.maxReplaces=t.maxReplaces?t.maxReplaces:1e3,this.alwaysFormat=void 0!==t.alwaysFormat&&t.alwaysFormat,this.resetRegExp()}},{key:"reset",value:function(){this.options&&this.init(this.options)}},{key:"resetRegExp",value:function(){var e="".concat(this.prefix,"(.+?)").concat(this.suffix);this.regexp=new RegExp(e,"g");var t="".concat(this.prefix).concat(this.unescapePrefix,"(.+?)").concat(this.unescapeSuffix).concat(this.suffix);this.regexpUnescape=new RegExp(t,"g");var n="".concat(this.nestingPrefix,"(.+?)").concat(this.nestingSuffix);this.nestingRegexp=new RegExp(n,"g")}},{key:"interpolate",value:function(e,t,n,r){var o,i,a,s=this,u=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{};function c(e){return e.replace(/\$/g,"$$$$")}var l=function(e){if(e.indexOf(s.formatSeparator)<0){var o=ct(t,u,e,s.options.keySeparator,s.options.ignoreJSONStructure);return s.alwaysFormat?s.format(o,void 0,n,ut(ut(ut({},r),t),{},{interpolationkey:e})):o}var i=e.split(s.formatSeparator),a=i.shift().trim(),c=i.join(s.formatSeparator).trim();return s.format(ct(t,u,a,s.options.keySeparator,s.options.ignoreJSONStructure),c,n,ut(ut(ut({},r),t),{},{interpolationkey:a}))};this.resetRegExp();var d=r&&r.missingInterpolationHandler||this.options.missingInterpolationHandler,f=r&&r.interpolation&&void 0!==r.interpolation.skipOnVariables?r.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:function(e){return c(e)}},{regex:this.regexp,safeValue:function(e){return s.escapeValue?c(s.escape(e)):c(e)}}].forEach((function(t){for(a=0;o=t.regex.exec(e);){var n=o[1].trim();if(void 0===(i=l(n)))if("function"==typeof d){var u=d(e,o,r);i="string"==typeof u?u:""}else if(r&&Object.prototype.hasOwnProperty.call(r,n))i="";else{if(f){i=o[0];continue}s.logger.warn("missed to pass in variable ".concat(n," for interpolating ").concat(e)),i=""}else"string"==typeof i||s.useRawValueToEscape||(i=Pe(i));var c=t.safeValue(i);if(e=e.replace(o[0],c),f?(t.regex.lastIndex+=i.length,t.regex.lastIndex-=o[0].length):t.regex.lastIndex=0,++a>=s.maxReplaces)break}})),e}},{key:"nest",value:function(e,t){var n,r,o,i=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};function s(e,t){var n=this.nestingOptionsSeparator;if(e.indexOf(n)<0)return e;var r=e.split(new RegExp("".concat(n,"[ ]*{"))),i="{".concat(r[1]);e=r[0];var a=(i=this.interpolate(i,o)).match(/'/g),s=i.match(/"/g);(a&&a.length%2==0&&!s||s.length%2!=0)&&(i=i.replace(/'/g,'"'));try{o=JSON.parse(i),t&&(o=ut(ut({},t),o))}catch(t){return this.logger.warn("failed parsing options string in nesting for key ".concat(e),t),"".concat(e).concat(n).concat(i)}return delete o.defaultValue,e}for(;n=this.nestingRegexp.exec(e);){var u=[];(o=(o=ut({},a)).replace&&"string"!=typeof o.replace?o.replace:o).applyPostProcessor=!1,delete o.defaultValue;var c=!1;if(-1!==n[0].indexOf(this.formatSeparator)&&!/{.*}/.test(n[1])){var l=n[1].split(this.formatSeparator).map((function(e){return e.trim()}));n[1]=l.shift(),u=l,c=!0}if((r=t(s.call(this,n[1].trim(),o),o))&&n[0]===e&&"string"!=typeof r)return r;"string"!=typeof r&&(r=Pe(r)),r||(this.logger.warn("missed to resolve ".concat(n[1]," for nesting ").concat(e)),r=""),c&&(r=u.reduce((function(e,t){return i.format(e,t,a.lng,ut(ut({},a),{},{interpolationkey:n[1].trim()}))}),r.trim())),e=e.replace(n[0],r),this.regexp.lastIndex=0}return e}}]),e}();function dt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ft(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?dt(Object(n),!0).forEach((function(t){ke(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function pt(e){var t={};return function(n,r,o){var i=r+JSON.stringify(o),a=t[i];return a||(a=e(r,o),t[i]=a),a(n)}}var ht=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_e(this,e),this.logger=Ne.create("formatter"),this.options=t,this.formats={number:pt((function(e,t){var n=new Intl.NumberFormat(e,ft({},t));return function(e){return n.format(e)}})),currency:pt((function(e,t){var n=new Intl.NumberFormat(e,ft(ft({},t),{},{style:"currency"}));return function(e){return n.format(e)}})),datetime:pt((function(e,t){var n=new Intl.DateTimeFormat(e,ft({},t));return function(e){return n.format(e)}})),relativetime:pt((function(e,t){var n=new Intl.RelativeTimeFormat(e,ft({},t));return function(e){return n.format(e,t.range||"day")}})),list:pt((function(e,t){var n=new Intl.ListFormat(e,ft({},t));return function(e){return n.format(e)}}))},this.init(t)}return Ie(e,[{key:"init",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}}).interpolation;this.formatSeparator=t.formatSeparator?t.formatSeparator:t.formatSeparator||","}},{key:"add",value:function(e,t){this.formats[e.toLowerCase().trim()]=t}},{key:"addCached",value:function(e,t){this.formats[e.toLowerCase().trim()]=pt(t)}},{key:"format",value:function(e,t,n){var r=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return t.split(this.formatSeparator).reduce((function(e,t){var i=function(e){var t=e.toLowerCase().trim(),n={};if(e.indexOf("(")>-1){var r=e.split("(");t=r[0].toLowerCase().trim();var o=r[1].substring(0,r[1].length-1);"currency"===t&&o.indexOf(":")<0?n.currency||(n.currency=o.trim()):"relativetime"===t&&o.indexOf(":")<0?n.range||(n.range=o.trim()):o.split(";").forEach((function(e){if(e){var t=De(e.split(":")),r=t[0],o=t.slice(1).join(":").trim().replace(/^'+|'+$/g,"");n[r.trim()]||(n[r.trim()]=o),"false"===o&&(n[r.trim()]=!1),"true"===o&&(n[r.trim()]=!0),isNaN(o)||(n[r.trim()]=parseInt(o,10))}}))}return{formatName:t,formatOptions:n}}(t),a=i.formatName,s=i.formatOptions;if(r.formats[a]){var u=e;try{var c=o&&o.formatParams&&o.formatParams[o.interpolationkey]||{},l=c.locale||c.lng||o.locale||o.lng||n;u=r.formats[a](e,l,ft(ft(ft({},s),o),c))}catch(e){r.logger.warn(e)}return u}return r.logger.warn("there was no format function for ".concat(a)),e}),e)}}]),e}();function gt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function vt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?gt(Object(n),!0).forEach((function(t){ke(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var _t=function(e){Se(n,we);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ce(e);if(t){var o=Ce(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ee(this,n)}}(n);function n(e,r,o){var i,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return _e(this,n),i=t.call(this),je&&we.call(Me(i)),i.backend=e,i.store=r,i.services=o,i.languageUtils=o.languageUtils,i.options=a,i.logger=Ne.create("backendConnector"),i.waitingReads=[],i.maxParallelReads=a.maxParallelReads||10,i.readingCalls=0,i.maxRetries=a.maxRetries>=0?a.maxRetries:5,i.retryTimeout=a.retryTimeout>=1?a.retryTimeout:350,i.state={},i.queue=[],i.backend&&i.backend.init&&i.backend.init(o,a.backend,a),i}return Ie(n,[{key:"queueLoad",value:function(e,t,n,r){var o=this,i={},a={},s={},u={};return e.forEach((function(e){var r=!0;t.forEach((function(t){var s="".concat(e,"|").concat(t);!n.reload&&o.store.hasResourceBundle(e,t)?o.state[s]=2:o.state[s]<0||(1===o.state[s]?void 0===a[s]&&(a[s]=!0):(o.state[s]=1,r=!1,void 0===a[s]&&(a[s]=!0),void 0===i[s]&&(i[s]=!0),void 0===u[t]&&(u[t]=!0)))})),r||(s[e]=!0)})),(Object.keys(i).length||Object.keys(a).length)&&this.queue.push({pending:a,pendingCount:Object.keys(a).length,loaded:{},errors:[],callback:r}),{toLoad:Object.keys(i),pending:Object.keys(a),toLoadLanguages:Object.keys(s),toLoadNamespaces:Object.keys(u)}}},{key:"loaded",value:function(e,t,n){var r=e.split("|"),o=r[0],i=r[1];t&&this.emit("failedLoading",o,i,t),n&&this.store.addResourceBundle(o,i,n),this.state[e]=t?-1:2;var a={};this.queue.forEach((function(n){var r,s,u,c,l;r=n.loaded,s=i,u=Ue(r,[o],Object),c=u.obj,l=u.k,c[l]=c[l]||[],c[l].push(s),function(e,t){void 0!==e.pending[t]&&(delete e.pending[t],e.pendingCount--)}(n,e),t&&n.errors.push(t),0!==n.pendingCount||n.done||(Object.keys(n.loaded).forEach((function(e){a[e]||(a[e]={});var t=n.loaded[e];t.length&&t.forEach((function(t){void 0===a[e][t]&&(a[e][t]=!0)}))})),n.done=!0,n.errors.length?n.callback(n.errors):n.callback())})),this.emit("loaded",a),this.queue=this.queue.filter((function(e){return!e.done}))}},{key:"read",value:function(e,t,n){var r=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.retryTimeout,a=arguments.length>5?arguments[5]:void 0;if(!e.length)return a(null,{});if(this.readingCalls>=this.maxParallelReads)this.waitingReads.push({lng:e,ns:t,fcName:n,tried:o,wait:i,callback:a});else{this.readingCalls++;var s=function(s,u){if(r.readingCalls--,r.waitingReads.length>0){var c=r.waitingReads.shift();r.read(c.lng,c.ns,c.fcName,c.tried,c.wait,c.callback)}s&&u&&o<r.maxRetries?setTimeout((function(){r.read.call(r,e,t,n,o+1,2*i,a)}),i):a(s,u)},u=this.backend[n].bind(this.backend);if(2!==u.length)return u(e,t,s);try{var c=u(e,t);c&&"function"==typeof c.then?c.then((function(e){return s(null,e)})).catch(s):s(null,c)}catch(e){s(e)}}}},{key:"prepareLoading",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),o&&o();"string"==typeof e&&(e=this.languageUtils.toResolveHierarchy(e)),"string"==typeof t&&(t=[t]);var i=this.queueLoad(e,t,r,o);if(!i.toLoad.length)return i.pending.length||o(),null;i.toLoad.forEach((function(e){n.loadOne(e)}))}},{key:"load",value:function(e,t,n){this.prepareLoading(e,t,{},n)}},{key:"reload",value:function(e,t,n){this.prepareLoading(e,t,{reload:!0},n)}},{key:"loadOne",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=e.split("|"),o=r[0],i=r[1];this.read(o,i,"read",void 0,void 0,(function(r,a){r&&t.logger.warn("".concat(n,"loading namespace ").concat(i," for language ").concat(o," failed"),r),!r&&a&&t.logger.log("".concat(n,"loaded namespace ").concat(i," for language ").concat(o),a),t.loaded(e,r,a)}))}},{key:"saveMissing",value:function(e,t,n,r,o){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:function(){};if(this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(t))this.logger.warn('did not save key "'.concat(n,'" as the namespace "').concat(t,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");else if(null!=n&&""!==n){if(this.backend&&this.backend.create){var s=vt(vt({},i),{},{isUpdate:o}),u=this.backend.create.bind(this.backend);if(u.length<6)try{var c;(c=5===u.length?u(e,t,n,r,s):u(e,t,n,r))&&"function"==typeof c.then?c.then((function(e){return a(null,e)})).catch(a):a(null,c)}catch(e){a(e)}else u(e,t,n,r,a,s)}e&&e[0]&&this.store.addResource(e[0],t,n,r)}}}]),n}();function mt(){return{debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!0,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:function(e){var t={};if("object"===ve(e[1])&&(t=e[1]),"string"==typeof e[1]&&(t.defaultValue=e[1]),"string"==typeof e[2]&&(t.tDescription=e[2]),"object"===ve(e[2])||"object"===ve(e[3])){var n=e[3]||e[2];Object.keys(n).forEach((function(e){t[e]=n[e]}))}return t},interpolation:{escapeValue:!0,format:function(e,t,n,r){return e},prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}}function yt(e){return"string"==typeof e.ns&&(e.ns=[e.ns]),"string"==typeof e.fallbackLng&&(e.fallbackLng=[e.fallbackLng]),"string"==typeof e.fallbackNS&&(e.fallbackNS=[e.fallbackNS]),e.supportedLngs&&e.supportedLngs.indexOf("cimode")<0&&(e.supportedLngs=e.supportedLngs.concat(["cimode"])),e}function It(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Mt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?It(Object(n),!0).forEach((function(t){ke(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):It(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Tt(){}var St=function(e){Se(n,we);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ce(e);if(t){var o=Ce(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ee(this,n)}}(n);function n(){var e,r,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0;if(_e(this,n),e=t.call(this),je&&we.call(Me(e)),e.options=yt(o),e.services={},e.logger=Ne,e.modules={external:[]},r=Me(e),Object.getOwnPropertyNames(Object.getPrototypeOf(r)).forEach((function(e){"function"==typeof r[e]&&(r[e]=r[e].bind(r))})),i&&!e.isInitialized&&!o.isClone){if(!e.options.initImmediate)return e.init(o,i),Ee(e,Me(e));setTimeout((function(){e.init(o,i)}),0)}return e}return Ie(n,[{key:"init",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;"function"==typeof t&&(n=t,t={}),!t.defaultNS&&!1!==t.defaultNS&&t.ns&&("string"==typeof t.ns?t.defaultNS=t.ns:t.ns.indexOf("translation")<0&&(t.defaultNS=t.ns[0]));var r=mt();function o(e){return e?"function"==typeof e?new e:e:null}if(this.options=Mt(Mt(Mt({},r),this.options),yt(t)),"v1"!==this.options.compatibilityAPI&&(this.options.interpolation=Mt(Mt({},r.interpolation),this.options.interpolation)),void 0!==t.keySeparator&&(this.options.userDefinedKeySeparator=t.keySeparator),void 0!==t.nsSeparator&&(this.options.userDefinedNsSeparator=t.nsSeparator),!this.options.isClone){var i;this.modules.logger?Ne.init(o(this.modules.logger),this.options):Ne.init(null,this.options),this.modules.formatter?i=this.modules.formatter:"undefined"!=typeof Intl&&(i=ht);var a=new tt(this.options);this.store=new ze(this.options.resources,this.options);var s=this.services;s.logger=Ne,s.resourceStore=this.store,s.languageUtils=a,s.pluralResolver=new at(a,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),!i||this.options.interpolation.format&&this.options.interpolation.format!==r.interpolation.format||(s.formatter=o(i),s.formatter.init(s,this.options),this.options.interpolation.format=s.formatter.format.bind(s.formatter)),s.interpolator=new lt(this.options),s.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},s.backendConnector=new _t(o(this.modules.backend),s.resourceStore,s,this.options),s.backendConnector.on("*",(function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];e.emit.apply(e,[t].concat(r))})),this.modules.languageDetector&&(s.languageDetector=o(this.modules.languageDetector),s.languageDetector.init&&s.languageDetector.init(s,this.options.detection,this.options)),this.modules.i18nFormat&&(s.i18nFormat=o(this.modules.i18nFormat),s.i18nFormat.init&&s.i18nFormat.init(this)),this.translator=new Qe(this.services,this.options),this.translator.on("*",(function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];e.emit.apply(e,[t].concat(r))})),this.modules.external.forEach((function(t){t.init&&t.init(e)}))}if(this.format=this.options.interpolation.format,n||(n=Tt),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){var u=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);u.length>0&&"dev"!==u[0]&&(this.options.lng=u[0])}this.services.languageDetector||this.options.lng||this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach((function(t){e[t]=function(){var n;return(n=e.store)[t].apply(n,arguments)}})),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach((function(t){e[t]=function(){var n;return(n=e.store)[t].apply(n,arguments),e}}));var c=Le(),l=function(){var t=function(t,r){e.isInitialized&&!e.initializedStoreOnce&&e.logger.warn("init: i18next is already initialized. You should call init just once!"),e.isInitialized=!0,e.options.isClone||e.logger.log("initialized",e.options),e.emit("initialized",e.options),c.resolve(r),n(t,r)};if(e.languages&&"v1"!==e.options.compatibilityAPI&&!e.isInitialized)return t(null,e.t.bind(e));e.changeLanguage(e.options.lng,t)};return this.options.resources||!this.options.initImmediate?l():setTimeout(l,0),c}},{key:"loadResources",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Tt,r="string"==typeof e?e:this.language;if("function"==typeof e&&(n=e),!this.options.resources||this.options.partialBundledLanguages){if(r&&"cimode"===r.toLowerCase())return n();var o=[],i=function(e){e&&t.services.languageUtils.toResolveHierarchy(e).forEach((function(e){o.indexOf(e)<0&&o.push(e)}))};r?i(r):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach((function(e){return i(e)})),this.options.preload&&this.options.preload.forEach((function(e){return i(e)})),this.services.backendConnector.load(o,this.options.ns,(function(e){e||t.resolvedLanguage||!t.language||t.setResolvedLanguage(t.language),n(e)}))}else n(null)}},{key:"reloadResources",value:function(e,t,n){var r=Le();return e||(e=this.languages),t||(t=this.options.ns),n||(n=Tt),this.services.backendConnector.reload(e,t,(function(e){r.resolve(),n(e)})),r}},{key:"use",value:function(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return"backend"===e.type&&(this.modules.backend=e),("logger"===e.type||e.log&&e.warn&&e.error)&&(this.modules.logger=e),"languageDetector"===e.type&&(this.modules.languageDetector=e),"i18nFormat"===e.type&&(this.modules.i18nFormat=e),"postProcessor"===e.type&&Je.addPostProcessor(e),"formatter"===e.type&&(this.modules.formatter=e),"3rdParty"===e.type&&this.modules.external.push(e),this}},{key:"setResolvedLanguage",value:function(e){if(e&&this.languages&&!(["cimode","dev"].indexOf(e)>-1))for(var t=0;t<this.languages.length;t++){var n=this.languages[t];if(!(["cimode","dev"].indexOf(n)>-1)&&this.store.hasLanguageSomeTranslations(n)){this.resolvedLanguage=n;break}}}},{key:"changeLanguage",value:function(e,t){var n=this;this.isLanguageChangingTo=e;var r=Le();this.emit("languageChanging",e);var o=function(e){n.language=e,n.languages=n.services.languageUtils.toResolveHierarchy(e),n.resolvedLanguage=void 0,n.setResolvedLanguage(e)},i=function(i){e||i||!n.services.languageDetector||(i=[]);var a="string"==typeof i?i:n.services.languageUtils.getBestMatchFromCodes(i);a&&(n.language||o(a),n.translator.language||n.translator.changeLanguage(a),n.services.languageDetector&&n.services.languageDetector.cacheUserLanguage&&n.services.languageDetector.cacheUserLanguage(a)),n.loadResources(a,(function(e){!function(e,i){i?(o(i),n.translator.changeLanguage(i),n.isLanguageChangingTo=void 0,n.emit("languageChanged",i),n.logger.log("languageChanged",i)):n.isLanguageChangingTo=void 0,r.resolve((function(){return n.t.apply(n,arguments)})),t&&t(e,(function(){return n.t.apply(n,arguments)}))}(e,a)}))};return e||!this.services.languageDetector||this.services.languageDetector.async?!e&&this.services.languageDetector&&this.services.languageDetector.async?0===this.services.languageDetector.detect.length?this.services.languageDetector.detect().then(i):this.services.languageDetector.detect(i):i(e):i(this.services.languageDetector.detect()),r}},{key:"getFixedT",value:function(e,t,n){var r=this,o=function e(t,o){var i;if("object"!==ve(o)){for(var a=arguments.length,s=new Array(a>2?a-2:0),u=2;u<a;u++)s[u-2]=arguments[u];i=r.options.overloadTranslationOptionHandler([t,o].concat(s))}else i=Mt({},o);i.lng=i.lng||e.lng,i.lngs=i.lngs||e.lngs,i.ns=i.ns||e.ns,i.keyPrefix=i.keyPrefix||n||e.keyPrefix;var c,l=r.options.keySeparator||".";return c=i.keyPrefix&&Array.isArray(t)?t.map((function(e){return"".concat(i.keyPrefix).concat(l).concat(e)})):i.keyPrefix?"".concat(i.keyPrefix).concat(l).concat(t):t,r.t(c,i)};return"string"==typeof e?o.lng=e:o.lngs=e,o.ns=t,o.keyPrefix=n,o}},{key:"t",value:function(){var e;return this.translator&&(e=this.translator).translate.apply(e,arguments)}},{key:"exists",value:function(){var e;return this.translator&&(e=this.translator).exists.apply(e,arguments)}},{key:"setDefaultNamespace",value:function(e){this.options.defaultNS=e}},{key:"hasLoadedNamespace",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;var r=n.lng||this.resolvedLanguage||this.languages[0],o=!!this.options&&this.options.fallbackLng,i=this.languages[this.languages.length-1];if("cimode"===r.toLowerCase())return!0;var a=function(e,n){var r=t.services.backendConnector.state["".concat(e,"|").concat(n)];return-1===r||2===r};if(n.precheck){var s=n.precheck(this,a);if(void 0!==s)return s}return!!this.hasResourceBundle(r,e)||!(this.services.backendConnector.backend&&(!this.options.resources||this.options.partialBundledLanguages))||!(!a(r,e)||o&&!a(i,e))}},{key:"loadNamespaces",value:function(e,t){var n=this,r=Le();return this.options.ns?("string"==typeof e&&(e=[e]),e.forEach((function(e){n.options.ns.indexOf(e)<0&&n.options.ns.push(e)})),this.loadResources((function(e){r.resolve(),t&&t(e)})),r):(t&&t(),Promise.resolve())}},{key:"loadLanguages",value:function(e,t){var n=Le();"string"==typeof e&&(e=[e]);var r=this.options.preload||[],o=e.filter((function(e){return r.indexOf(e)<0}));return o.length?(this.options.preload=r.concat(o),this.loadResources((function(e){n.resolve(),t&&t(e)})),n):(t&&t(),Promise.resolve())}},{key:"dir",value:function(e){if(e||(e=this.resolvedLanguage||(this.languages&&this.languages.length>0?this.languages[0]:this.language)),!e)return"rtl";var t=this.services&&this.services.languageUtils||new tt(mt());return["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"].indexOf(t.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}},{key:"cloneInstance",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Tt,o=Mt(Mt(Mt({},this.options),t),{isClone:!0}),i=new n(o);return void 0===t.debug&&void 0===t.prefix||(i.logger=i.logger.clone(t)),["store","services","language"].forEach((function(t){i[t]=e[t]})),i.services=Mt({},this.services),i.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},i.translator=new Qe(i.services,i.options),i.translator.on("*",(function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];i.emit.apply(i,[e].concat(n))})),i.init(o,r),i.translator.options=i.options,i.translator.backendConnector.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},i}},{key:"toJSON",value:function(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}]),n}();ke(St,"createInstance",(function(){return new St(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},arguments.length>1?arguments[1]:void 0)}));var Et=St.createInstance();Et.createInstance=St.createInstance,Et.createInstance,Et.dir,Et.init,Et.loadResources,Et.reloadResources,Et.use,Et.changeLanguage,Et.getFixedT,Et.t,Et.exists,Et.setDefaultNamespace,Et.hasLoadedNamespace,Et.loadNamespaces,Et.loadLanguages;var Ct=function(e){(0,l.default)(n,e);var t=y(n);function n(){var e;return(0,h.default)(this,n),e=t.call(this),e.languages=null,e}return(0,g.default)(n,[{key:"provideLanguages",value:function(e){j||(this.languages=e,console.log("TUITranslateService.provideLanguages ok."))}},{key:"useI18n",value:function(e){j||(this.languages?Et.init({compatibilityJSON:"v3",lng:e||"zh",fallbackLng:"zh",detection:{order:["querystring","navigator"],caches:["localStorage","cookie"]},resources:{en:{translation:this.languages.en},zh:{translation:this.languages.zh_cn}}}):console.warn("TUITranslateService.useI18next not have messages."))}},{key:"changeLanguage",value:function(e){return Et.changeLanguage(e)}},{key:"t",value:function(e){if(!this.languages){var t=e;return!L(e)&&e.indexOf(".")>-1&&(t=e.split(".").pop()||""),t}return Et.t(e)}}],[{key:"getInstance",value:function(){return n.instance||(n.instance=new n),n.instance}}]),n}(ae),kt=function(e){(0,l.default)(n,e);var t=y(n);function n(){var e;return(0,h.default)(this,n),e=t.call(this),e.serv="TUIConversationService",e}return(0,g.default)(n,[{key:"init",value:function(){var e=this.getEngine();e.eventCenter.addEvent(e.EVENT.CONVERSATION_LIST_UPDATED,this.onConversationListUpdated.bind(this)),e.eventCenter.addEvent(e.EVENT.TOTAL_UNREAD_MESSAGE_COUNT_UPDATED,this.onTotalUnreadCountUpdated.bind(this)),e.eventCenter.addEvent(e.EVENT.MESSAGE_RECEIVED,this.onMessageReceived.bind(this)),this.getConversationInitData()}},{key:"onConversationListUpdated",value:function(e){var t=this.filterSystemConversation(e);this.getEngine().TUIStore.update(C.CONV,"conversationList",t),this.updateCurrentConversation()}},{key:"onTotalUnreadCountUpdated",value:function(e){this.getEngine().TUIStore.update(C.CONV,"totalUnreadCount",e)}},{key:"onMessageReceived",value:function(e){for(var t=this.getEngine(),n=this.getEngine().TUIStore.getData(C.CONV,"conversationList"),r=!1,o=0;o<e.length;o++)if(e[o].type===t.TYPES.MSG_GRP_SYS_NOTICE){var i=e[o].payload.operationType,a="GROUP".concat(e[o].to),s=4===i||5===i||8===i,u=2===i||6===i||7===i;if(s||u)for(var c=0;c<n.length;c++)if(n[c].type!==t.TYPES.CONV_C2C&&n[c].conversationID===a){if(s){n[c].operationType=i,r=!0;break}if(u&&n[c].operationType>0){n[c].operationType=0,r=!0;break}}}r&&this.getEngine().TUIStore.update(C.CONV,"conversationList",n)}},{key:"getConversationInitData",value:function(){var e=this,t=this.getEngine();t.chat.isReady()&&t.chat.getConversationList().then((function(n){var r=n.data,o=r.conversationList,i=r.isSyncCompleted;if(console.log("".concat(e.serv,".init, getConversationList count:").concat(o.length," isSyncCompleted:").concat(i)),o.length>0){e.onConversationListUpdated(o);var a=t.chat.getTotalUnreadMessageCount();e.onTotalUnreadCountUpdated(a)}}))}},{key:"switchConversation",value:function(e){return S(this,void 0,void 0,i.default.mark((function t(){var n,r,o,a;return i.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n="".concat(this.serv,".switchConversation"),r=this.getEngine(),e){t.next=3;break}return t.abrupt("return",(r.TUIStore.reset(C.CHAT,["messageList","isCompleted","nextReqMessageID"]),r.TUIStore.update(C.CONV,"currentConversationID",""),r.TUIStore.update(C.CONV,"currentConversation",null),console.log("".concat(n," conversationID is empty, conversationID:").concat(e)),Promise.resolve({})));case 3:if(e.startsWith(r.TYPES.CONV_C2C)||e.startsWith(r.TYPES.CONV_GROUP)){t.next=5;break}return t.abrupt("return",(console.warn("".concat(n," conversationID is invalid, conversationID:").concat(e)),Promise.reject({code:O.INVALID_CONV_ID,message:N.INVALID_CONV_ID})));case 5:if(o=r.TUIStore.getData(C.CONV,"currentConversationID"),!o||o!==e){t.next=8;break}return t.abrupt("return",(this.setMessageRead(o),console.warn("".concat(n," please check conversationID, conversationID:").concat(e)),Promise.resolve({code:O.CONV_ID_SAME,message:N.CONV_ID_SAME})));case 8:return t.next=10,this.getConversationModel(e);case 10:return a=t.sent,t.abrupt("return",L(a)?(console.warn("".concat(n," target conversation is not exist, conversationID:").concat(e)),Promise.reject({code:O.CONV_NOT_EXIST,message:N.CONV_NOT_EXIST})):(o&&this.setMessageRead(o),e&&this.setMessageRead(e),r.TUIStore.reset(C.CHAT,["messageList","isCompleted","nextReqMessageID"]),r.TUIStore.update(C.CONV,"currentConversationID",e),r.TUIStore.update(C.CONV,"currentConversation",a),Promise.resolve(a)));case 12:case"end":return t.stop()}}),t,this)})))}},{key:"getConversationModel",value:function(e){return S(this,void 0,void 0,i.default.mark((function t(){var n,r;return i.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=this.findConversation(e),!L(n)){t.next=12;break}return t.prev=2,t.next=5,this.getConversationProfile(e);case 5:r=t.sent,r.data&&r.data.conversation&&(n=new se(r.data.conversation)),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](2),n=void 0;case 12:return t.abrupt("return",n);case 13:case"end":return t.stop()}}),t,this,[[2,9]])})))}},{key:"findConversation",value:function(e){for(var t,n=this.getEngine().TUIStore.getData(C.CONV,"conversationList"),r=0;r<n.length;r++)if(n[r].conversationID===e){t=n[r];break}return t}},{key:"updateCurrentConversation",value:function(){var e=this.getEngine(),t=e.TUIStore.getData(C.CONV,"currentConversationID"),n=this.findConversation(t);n&&e.TUIStore.update(C.CONV,"currentConversation",n)}},{key:"getConversationList",value:function(){return this.getEngine().chat.getConversationList()}},{key:"getConversationProfile",value:function(e){return this.getEngine().chat.getConversationProfile(e)}},{key:"deleteConversation",value:function(e){var t=this;return this.getEngine().chat.deleteConversation(e).then((function(n){var r=t.getEngine().TUIStore.getData(C.CONV,"currentConversationID");return console.log("".concat(t.serv,".deleteConversation conversationID:").concat(e," currentConversationID:").concat(r)),e===r&&(t.getEngine().TUIStore.update(C.CONV,"currentConversationID",""),t.getEngine().TUIStore.update(C.CONV,"currentConversation",null)),n}))}},{key:"pinConversation",value:function(e){return this.getEngine().chat.pinConversation(e)}},{key:"muteConversation",value:function(e){return this.getEngine().chat.setMessageRemindType(e)}},{key:"clearHistoryMessage",value:function(e){var t=this;return this.getEngine().chat.clearHistoryMessage(e).then((function(e){return t.getEngine().TUIStore.update(C.CHAT,"messageList",[]),t.getEngine().TUIStore.update(C.CHAT,"nextReqMessageID",""),t.getEngine().TUIStore.update(C.CHAT,"isCompleted",!0),e}))}},{key:"setMessageRead",value:function(e){return this.getEngine().chat.setMessageRead({conversationID:e})}},{key:"filterSystemConversation",value:function(e){var t=this;return e.filter((function(e){return e.type!==t.getEngine().TYPES.CONV_SYSTEM}))}}],[{key:"getInstance",value:function(){return n.instance||(n.instance=new n),n.instance}}]),n}(ae),bt=function(){function e(t){(0,h.default)(this,e),this.TUIUserService=t}return(0,g.default)(e,[{key:"getEngine",value:function(){return this.TUIUserService.getEngine()}},{key:"init",value:function(){this.getEngine().eventCenter.addEvent(this.getEngine().EVENT.PROFILE_UPDATED,this.onProfileUpdated.bind(this)),this.getEngine().eventCenter.addEvent(this.getEngine().EVENT.BLACKLIST_UPDATED,this.onBlacklistUpdated.bind(this))}},{key:"onProfileUpdated",value:function(e){var t=this.getEngine(),n=t.TUIStore.getData(C.USER,"userProfile");e.forEach((function(e){e.userID===n.userID&&t.TUIStore.update(C.USER,"userProfile",e)}))}},{key:"onBlacklistUpdated",value:function(e){var t=this.getEngine();this.getBlacklistProfile(e).then((function(e){t.TUIStore.update(C.USER,"userBlacklist",e)}))}},{key:"getBlacklistProfile",value:function(e){for(var t=this,n=[],r=0;r<e.length;)n.push(e.slice(r,r+=100));var o=[];n.forEach((function(e){o.push(t.TUIUserService.getUserProfile({userIDList:e}))}));var i=[];return Promise.all(o).then((function(e){return e.forEach((function(e){var t=e.data.map((function(e){var t=e.userID,n=e.nick,r=e.avatar;return{userID:t,nick:n,avatar:r}}));i.push.apply(i,(0,c.default)(t))})),i}))}},{key:"getUserProfile",value:function(e){var t=this.getEngine();return L(e)?t.chat.getMyProfile().then((function(e){return t.TUIStore.update(C.USER,"userProfile",e.data),e})).catch((function(e){return Promise.reject(e)})):t.chat.getUserProfile(e)}},{key:"updateMyProfile",value:function(e){return this.getEngine().chat.updateMyProfile(e)}},{key:"addToBlacklist",value:function(e){return this.getEngine().chat.addToBlacklist(e)}},{key:"removeFromBlacklist",value:function(e){return this.getEngine().chat.removeFromBlacklist(e)}}]),e}();function Dt(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];!function(e,t){K?z.setStorageSync(e,t):Rt()&&localStorage.setItem(e,JSON.stringify(t))}(n?Ot(e):e,t)}function At(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];try{return function(e){if(K)return z.getStorageSync(e);if(Rt()){var t=localStorage.getItem(e);if("undefined"!==t)return JSON.parse(t)}}(t?Ot(e):e)}catch(e){return void console.warn("Storage.getStorageItem error:",e)}}function Ot(e){return"chat_engine_".concat(e)}function Rt(){return navigator&&navigator.cookieEnabled&&localStorage}var Nt=function(){function e(t){(0,h.default)(this,e),this.TUIUserService=t}return(0,g.default)(e,[{key:"getEngine",value:function(){return this.TUIUserService.getEngine()}},{key:"init",value:function(){var e=this.getEngine(),t=At("displayOnlineStatus")||!1;e.TUIStore.update(C.USER,"displayOnlineStatus",t),e.eventCenter.addEvent(e.EVENT.USER_STATUS_UPDATED,this.onUserStatusUpdated.bind(this)),this.onConversationListUpdated()}},{key:"onConversationListUpdated",value:function(){var e=this,t=this.getEngine();t.TUIStore.watch(C.CONV,{conversationList:function(){var n=t.TUIStore.getData(C.APP,"enabledOnlineStatus"),r=t.TUIStore.getData(C.USER,"displayOnlineStatus");n&&r&&e.startToSubscribe()}})}},{key:"onUserStatusUpdated",value:function(e){this.getEngine().TUIStore.update(C.USER,"userStatusList",e)}},{key:"switchUserStatus",value:function(e){var t=this.getEngine(),n=e.displayOnlineStatus,r=void 0!==n&&n;t.TUIStore.update(C.USER,"displayOnlineStatus",r),Dt("displayOnlineStatus",r);var o=t.TUIStore.getData(C.APP,"enabledOnlineStatus");o?!0===r?this.startToSubscribe():this.unsubscribeUserStatus():console.warn("UserStatusHandler.switchUserStatus enabledOnlineStatus:".concat(o," displayOnlineStatus:").concat(r))}},{key:"getUserStatus",value:function(e){var t=this.getEngine();return t.chat.getUserStatus(e).then((function(e){var n=e.data.successUserList;return n.length>0&&t.TUIStore.update(C.USER,"userStatusList",n),e})).catch((function(e){return Promise.reject(e)}))}},{key:"subscribeUserStatus",value:function(e){var t,n=(null===(t=null==e?void 0:e.userIDList)||void 0===t?void 0:t.length)||0;return 0===n?(console.warn("UserStatusHandler.subscribeUserStatus userID count:".concat(n)),Promise.resolve()):this.getEngine().chat.subscribeUserStatus(e)}},{key:"unsubscribeUserStatus",value:function(e){var t=this.getEngine(),n=e||{},r=n.userIDList,o=void 0===r?[]:r;return t.chat.unsubscribeUserStatus({userIDList:o}).then((function(e){var n=e.data.failureUserList,r=[];return o.forEach((function(e){n.includes(e)||r.push({userID:e,statusType:k.UNSUB_USER})})),t.TUIStore.update(C.USER,"userStatusList",r),e})).catch((function(e){return Promise.reject(e)}))}},{key:"startToSubscribe",value:function(){var e=this.getEngine(),t=e.TUIStore.getData(C.CONV,"conversationList"),n=e.TUIStore.getData(C.USER,"userStatusList"),r=[];t.forEach((function(t){if(t.type===e.TYPES.CONV_C2C){var o=t.conversationID.replace(e.TYPES.CONV_C2C,"");n.has(o)||r.push(o)}})),0!==r.length&&e.chat.isReady()&&(this.subscribeUserStatus({userIDList:r}),this.getUserStatus({userIDList:r}))}}]),e}(),wt=function(e){(0,l.default)(n,e);var t=y(n);function n(){var e;return(0,h.default)(this,n),e=t.call(this),e.userProfileHandler=new bt((0,a.default)(e)),e.userStatusHandler=new Nt((0,a.default)(e)),e}return(0,g.default)(n,[{key:"init",value:function(){var e=this.getEngine();e.eventCenter.addEvent(e.EVENT.KICKED_OUT,this.onKickedOut.bind(this)),e.eventCenter.addEvent(e.EVENT.NET_STATE_CHANGE,this.onNetStateChange.bind(this)),this.userProfileHandler.init(),this.userStatusHandler.init(),this.initMessageReadReceipt()}},{key:"onKickedOut",value:function(e){this.getEngine().TUIStore.update(C.USER,"kickedOut",e.type)}},{key:"onNetStateChange",value:function(e){this.getEngine().TUIStore.update(C.USER,"netStateChange",e.state)}},{key:"initMessageReadReceipt",value:function(){var e=At("displayMessageReadReceipt")||!0;this.getEngine().TUIStore.update(C.USER,"displayMessageReadReceipt",e)}},{key:"switchUserStatus",value:function(e){return this.userStatusHandler.switchUserStatus(e)}},{key:"switchMessageReadStatus",value:function(e){this.getEngine().TUIStore.update(C.USER,"displayMessageReadReceipt",e),Dt("displayMessageReadReceipt",e)}},{key:"getUserProfile",value:function(e){return this.userProfileHandler.getUserProfile(e)}},{key:"updateMyProfile",value:function(e){return this.userProfileHandler.updateMyProfile(e)}},{key:"addToBlacklist",value:function(e){return this.userProfileHandler.addToBlacklist(e)}},{key:"removeFromBlacklist",value:function(e){return this.userProfileHandler.removeFromBlacklist(e)}},{key:"getUserStatus",value:function(e){return this.userStatusHandler.getUserStatus(e)}},{key:"subscribeUserStatus",value:function(e){return this.userStatusHandler.subscribeUserStatus(e)}},{key:"unsubscribeUserStatus",value:function(e){return this.userStatusHandler.unsubscribeUserStatus(e)}}],[{key:"getInstance",value:function(){return n.instance||(n.instance=new n),n.instance}}]),n}(ae),Lt=function(){function e(t){(0,h.default)(this,e),this.TUIChatService=t}return(0,g.default)(e,[{key:"getEngine",value:function(){return this.TUIChatService.getEngine()}},{key:"t",value:function(e){return this.getEngine().TUITranslate.t(e)}},{key:"handleTextMessage",value:function(e){return{text:this.decodeText(e.payload)}}},{key:"handleFaceMessage",value:function(e){var t={name:"",url:""};return t.name=e.payload.data.indexOf("@2x")<0?"".concat(e.payload.data,"@2x"):e.payload.data,t.url="".concat("https://web.sdk.qcloud.com/im/assets/face-elem/").concat(t.name,".png"),t}},{key:"handleLocationMessage",value:function(e){var t={lon:"",lat:"",href:"",url:"",description:""};return t.lon=e.payload.longitude.toFixed(6),t.lat=e.payload.latitude.toFixed(6),t.href="".concat("https://map.qq.com/?type=marker&isopeninfowin=1&markertype=1&","pointx=").concat(t.lon,"&pointy=").concat(t.lat,"&name=").concat(e.payload.description),t.url="".concat("https://apis.map.qq.com/ws/staticmap/v2/?","center=").concat(t.lat,",").concat(t.lon,"&zoom=10&size=300*150&maptype=roadmap&markers=size:large|color:0xFFCCFF|label:k|").concat(t.lat,",").concat(t.lon,"&key=UBNBZ-PTP3P-TE7DB-LHRTI-Y4YLE-VWBBD"),t.description=e.payload.description,t}},{key:"handleImageMessage",value:function(e){return{url:e.payload.imageInfoArray[0].url,width:e.payload.imageInfoArray[0].width,height:e.payload.imageInfoArray[0].height}}},{key:"handleAudioMessage",value:function(e){return{url:e.payload.url,second:e.payload.second}}},{key:"handleVideoMessage",value:function(e){return{url:e.payload.videoUrl,snapshotUrl:e.payload.snapshotUrl,snapshotWidth:e.payload.snapshotWidth,snapshotHeight:e.payload.snapshotHeight}}},{key:"handleFileMessage",value:function(e){return{url:e.payload.fileUrl,name:e.payload.fileName,size:x(e.payload.fileSize)}}},{key:"handleCustomMessage",value:function(e){var t,n=this.handleCreateGroupCustomMessage(e);return{custom:this.handleCallKitSignaling(e)||n||(null===(t=null==e?void 0:e.payload)||void 0===t?void 0:t.extension)||"[".concat(this.t("message.custom.自定义消息"),"]"),businessID:n?"group_create":""}}},{key:"handleMergeMessage",value:function(e){return Object.assign({},e.payload)}},{key:"handleGroupTipsMessage",value:function(e){var t,n,r,o,i,a,s=this.getEngine(),u={text:""},c=(null==e?void 0:e.nick)||(null===(n=null===(t=null==e?void 0:e.payload)||void 0===t?void 0:t.userIDList)||void 0===n?void 0:n.join(","));switch((null===(o=null===(r=null==e?void 0:e.payload)||void 0===r?void 0:r.memberList)||void 0===o?void 0:o.length)>0&&(c="",null===(a=null===(i=null==e?void 0:e.payload)||void 0===i?void 0:i.memberList)||void 0===a||a.map((function(e){c+="".concat((null==e?void 0:e.nick)||(null==e?void 0:e.userID),",")})),c=null==c?void 0:c.slice(0,-1)),e.payload.operationType){case s.TYPES.GRP_TIP_MBR_JOIN:u.text="".concat(c," ").concat(this.t("message.tip.加入群组"));break;case s.TYPES.GRP_TIP_MBR_QUIT:u.text="".concat(this.t("message.tip.群成员"),"：").concat(c," ").concat(this.t("message.tip.退出群组"));break;case s.TYPES.GRP_TIP_MBR_KICKED_OUT:u.text="".concat(this.t("message.tip.群成员"),"：").concat(c," ").concat(this.t("message.tip.被")).concat(this.t("message.tip.踢出群组"));break;case s.TYPES.GRP_TIP_MBR_SET_ADMIN:u.text="".concat(this.t("message.tip.群成员"),"：").concat(c," ").concat(this.t("message.tip.成为管理员"));break;case s.TYPES.GRP_TIP_MBR_CANCELED_ADMIN:u.text="".concat(this.t("message.tip.群成员"),"：").concat(c," ").concat(this.t("message.tip.被撤销管理员"));break;case s.TYPES.GRP_TIP_GRP_PROFILE_UPDATED:u.text=this.handleGroupProfileUpdated(e);break;case s.TYPES.GRP_TIP_MBR_PROFILE_UPDATED:var l,d=I(e.payload.memberList);try{for(d.s();!(l=d.n()).done;){var f=l.value;f.muteTime>0?u.text="".concat(this.t("message.tip.群成员"),"：").concat(c," ").concat(this.t("message.tip.被禁言")):u.text="".concat(this.t("message.tip.群成员"),"：").concat(c," ").concat(this.t("message.tip.被取消禁言"))}}catch(p){d.e(p)}finally{d.f()}break;default:u.text="[".concat(this.t("message.tip.群提示消息"),"]")}return u}},{key:"handleGroupSystemMessage",value:function(e){var t=e.payload.groupProfile.name||e.payload.groupProfile.groupID,n={text:""};switch(e.payload.operationType){case 1:n.text="".concat(e.payload.operatorID," ").concat(this.t("message.tip.申请加入群组"),"：").concat(t);break;case 2:n.text="".concat(this.t("message.tip.成功加入群组"),"：").concat(t);break;case 3:n.text="".concat(this.t("message.tip.申请加入群组"),"：").concat(t," ").concat(this.t("message.tip.被拒绝"));break;case 4:n.text="".concat(this.t("message.tip.你被管理员")).concat(e.payload.operatorID," ").concat(this.t("message.tip.踢出群组"),"：").concat(t);break;case 5:n.text="".concat(this.t("message.tip.群"),"：").concat(t," ").concat(this.t("message.tip.被")," ").concat(e.payload.operatorID," ").concat(this.t("message.tip.解散"));break;case 6:n.text="".concat(e.payload.operatorID," ").concat(this.t("message.tip.创建群"),"：").concat(t);break;case 7:case 12:n.text="".concat(e.payload.operatorID," ").concat(this.t("message.tip.邀请你加群"),"：").concat(t);break;case 8:n.text="".concat(this.t("message.tip.你退出群组"),"：").concat(t);break;case 9:n.text="".concat(this.t("message.tip.你被")).concat(e.payload.operatorID," ").concat(this.t("message.tip.设置为群"),"：").concat(t," ").concat(this.t("message.tip.的管理员"));break;case 10:n.text="".concat(this.t("message.tip.你被")).concat(e.payload.operatorID," ").concat(this.t("message.tip.撤销群"),"：").concat(t," ").concat(this.t("message.tip.的管理员身份"));break;case 13:n.text="".concat(e.payload.operatorID," ").concat(this.t("message.tip.同意加群"),"：").concat(t);break;case 14:n.text="".concat(e.payload.operatorID," ").concat(this.t("message.tip.拒接加群"),"：").concat(t);break;case 255:n.text="".concat(this.t("message.tip.自定义群系统通知"),": ").concat(e.payload.userDefinedField);break;default:n.text="未解析的群系统通知"}return n}},{key:"handleCallKitSignaling",value:function(e){var t,n,r,o,i,a,s,u,c,l,d=G(e.payload.data);if(1!==(null==d?void 0:d.businessID))return"";var f=G(null==d?void 0:d.data),p="";null===(t=null==d?void 0:d.inviteeList)||void 0===t||t.forEach((function(e){p+="".concat(e,"、")})),p=p.substring(0,p.lastIndexOf("、"));var h=null==d?void 0:d.inviter;switch(null==d?void 0:d.actionType){case 1:return"audioCall"!==(null===(n=null==f?void 0:f.data)||void 0===n?void 0:n.cmd)&&"videoCall"!==(null===(r=null==f?void 0:f.data)||void 0===r?void 0:r.cmd)||!(null==d?void 0:d.groupID)?"hangup"===(null===(o=null==f?void 0:f.data)||void 0===o?void 0:o.cmd)?(null==d?void 0:d.groupID)?"".concat(this.t("message.custom.结束群聊")):"".concat(this.t("message.custom.通话时长"),"：").concat(function(e){var t,n,r,o=e,i="";return o>=3600?(t=parseInt(""+o/3600,10)<10?"0".concat(parseInt(""+o/3600,10)):parseInt(""+o/3600,10),n=parseInt(""+o%60/60,10)<10?"0".concat(parseInt(""+o%60/60,10)):parseInt(""+o%60/60,10),r=o%3600<10?"0"+o%3600:o%3600,r>60&&(n=parseInt(""+r/60,10)<10?"0".concat(parseInt(""+r/60,10)):parseInt(""+r/60,10),r=r%60<10?"0"+r%60:r%60),i="".concat(t,":").concat(n,":").concat(r)):o>=60&&o<3600?(n=parseInt(""+o/60,10)<10?"0".concat(parseInt(""+o/60,10)):parseInt(""+o/60,10),r=o%60<10?"0"+o%60:o%60,i="00:".concat(n,":").concat(r)):o<60&&(r=o<10?"0".concat(o):o,i="00:00:".concat(r)),i}(null==f?void 0:f.call_end)):"switchToAudio"===(null===(i=null==f?void 0:f.data)||void 0===i?void 0:i.cmd)?"".concat(this.t("message.custom.切换语音通话")):"switchToVideo"===(null===(a=null==f?void 0:f.data)||void 0===a?void 0:a.cmd)?"".concat(this.t("message.custom.切换视频通话")):"".concat(this.t("message.custom.发起通话")):"".concat(h," ").concat(this.t("message.custom.发起通话"));case 2:return(null==d?void 0:d.groupID)?"".concat(h," ").concat(this.t("message.custom.取消通话")):this.t("message.custom.取消通话");case 3:return"switchToAudio"===(null===(s=null==f?void 0:f.data)||void 0===s?void 0:s.cmd)?"".concat(this.t("message.custom.切换语音通话")):"switchToVideo"===(null===(u=null==f?void 0:f.data)||void 0===u?void 0:u.cmd)?"".concat(this.t("message.custom.切换视频通话")):(null==d?void 0:d.groupID)?"".concat(p," ").concat(this.t("message.custom.已接听")):this.t("message.custom.已接听");case 4:return(null==d?void 0:d.groupID)?"".concat(p," ").concat(this.t("message.custom.拒绝通话")):this.t("message.custom.拒绝通话");case 5:return"switchToAudio"===(null===(c=null==f?void 0:f.data)||void 0===c?void 0:c.cmd)?"".concat(this.t("message.custom.切换语音通话")):"switchToVideo"===(null===(l=null==f?void 0:f.data)||void 0===l?void 0:l.cmd)?"".concat(this.t("message.custom.切换视频通话")):(null==d?void 0:d.groupID)?"".concat(p," ").concat(this.t("message.custom.无应答")):this.t("message.custom.无应答");default:return""}}},{key:"handleCreateGroupCustomMessage",value:function(e){var t;try{var n=G(e.payload.data);"group_create"===n.businessID&&(t="".concat(n.opUser," ").concat(n.content))}catch(e){}return t}},{key:"decodeText",value:function(e){for(var t=[],n=e.text,r=-1,o=-1;""!==n;)switch(r=n.indexOf("["),o=n.indexOf("]"),r){case 0:if(-1===o)t.push({name:"text",text:n}),n="";else{var i=n.slice(0,o+1);q[i]?(t.push({name:"img",src:"https://web.sdk.qcloud.com/im/assets/emoji/"+q[i]}),n=n.substring(o+1)):(t.push({name:"text",text:"["}),n=n.slice(1))}break;case-1:t.push({name:"text",text:n}),n="";break;default:t.push({name:"text",text:n.slice(0,r)}),n=n.substring(r)}return t}},{key:"handleGroupProfileUpdated",value:function(e){var t=e.nick,n=e.payload,r=n.newGroupProfile,o=n.memberList,i=n.operatorID,a="",s=t||i,u=Object.keys(r)[0];switch(u){case"muteAllMembers":a=r[u]?"".concat(this.t("message.tip.管理员")," ").concat(s," ").concat(this.t("message.tip.开启全员禁言")):"".concat(this.t("message.tip.管理员")," ").concat(s," ").concat(this.t("message.tip.取消全员禁言"));break;case"ownerID":a="".concat(o[0].nick||o[0].userID," ").concat(this.t("message.tip.成为新的群主"));break;case"groupName":a="".concat(s," ").concat(this.t("message.tip.修改群名为")," ").concat(r[u]);break;case"notification":a="".concat(s," ").concat(this.t("message.tip.发布新公告"))}return a}}]),e}(),Pt=function(){function e(t){(0,h.default)(this,e),this.TUIChatService=t,this.typingTo="",this.timer=null}return(0,g.default)(e,[{key:"getEngine",value:function(){return this.TUIChatService.getEngine()}},{key:"clearTypingStatus",value:function(){this.getEngine().TUIStore.getData(C.CHAT,"typingStatus")&&this.getEngine().TUIStore.update(C.CHAT,"typingStatus",!1),this.timer&&clearTimeout(this.timer),this.timer=null}},{key:"handleLastMessage",value:function(e){var t=this,n=this.getEngine(),r=n.TUIStore.getData(C.CHAT,"typingStatus");if(e.type===this.getEngine().TYPES.MSG_CUSTOM&&"in"===e.flow){var o=G(e.payload.data);if(o.businessID===b.BUSINESS_ID){var i=o.typingStatus,a=o.userAction;if(i===b.STATUS_START||a===b.ACTION_START_ID)return r?(this.timer&&clearTimeout(this.timer),this.timer=null):n.TUIStore.update(C.CHAT,"typingStatus",!0),this.timer=setTimeout((function(){t.clearTypingStatus()}),3e4),n.TUIStore.getData(C.CHAT,"typingStatus");i!==b.STATUS_END&&a!==b.ACTION_END_ID||this.clearTypingStatus()}}}},{key:"filterTypingMessage",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return 0===t.length?[]:(this.getEngine().TUIStore.getData(C.APP,"enableTyping")&&this.handleLastMessage(t[t.length-1]),t.filter((function(t){return t.type!==e.getEngine().TYPES.MSG_CUSTOM||G(t.payload.data).businessID!==b.BUSINESS_ID})))}},{key:"createTypingMessage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b.STATUS_END,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=b,r=n.BUSINESS_ID,o=n.STATUS_START,i=n.VERSION,a=n.ACTION_START_ID,s=n.ACTION_END_ID,u=n.ACTION_START,c=n.ACTION_END,l=n.NEED_TYPING;return{to:t,conversationType:this.getEngine().TYPES.CONV_C2C,payload:{data:JSON.stringify({businessID:r,typingStatus:e,version:i,userAction:e===o?a:s,actionParam:e===o?u:c}),description:"",extension:""},cloudCustomData:JSON.stringify({messageFeature:{needTyping:l,version:i}})}}},{key:"sendTyping",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(e){this.typingTo=t;var n=this.createTypingMessage(b.STATUS_START,t);this.getEngine().TUIChat.sendCustomMessage(n,{onlineUserOnly:!0})}else this.sendTypingEnd()}},{key:"sendTypingEnd",value:function(){if(this.typingTo){var e=this.createTypingMessage(b.STATUS_END,this.typingTo);this.getEngine().TUIChat.sendCustomMessage(e,{onlineUserOnly:!0})}this.typingTo=""}}]),e}(),Ut=function(){function e(t){(0,h.default)(this,e),this.TUIChatService=t}return(0,g.default)(e,[{key:"getEngine",value:function(){return this.TUIChatService.getEngine()}},{key:"init",value:function(){var e=this.getEngine();e.eventCenter.addEvent(e.EVENT.MESSAGE_READ_RECEIPT_RECEIVED,this.onMessageReadReceiptReceived.bind(this))}},{key:"onMessageReadReceiptReceived",value:function(e){var t=this.getEngine(),n=t.TUIStore.getData(C.CONV,"currentConversationID"),r=[];e.forEach((function(e){var o=e.messageID,i=t.chat.findMessage(o);i&&n===i.conversationID&&r.push(i)})),r.length>0&&t.TUIChat.updateMessageList(r,"edit")}},{key:"sendMessageReadReceipt",value:function(e){var t=[];return e.forEach((function(e){var n=e.getMessage();t.push(n)})),this.getEngine().chat.sendMessageReadReceipt(t)}},{key:"getGroupMessageReadMemberList",value:function(e){var t=e.message.getMessage(),n=Object.assign(Object.assign({},e),{message:t});return this.getEngine().chat.getGroupMessageReadMemberList(n)}},{key:"getMessageReadReceiptList",value:function(e){var t=this.getEngine(),n=t.TUIStore.getData(C.APP,"enabledMessageReadReceipt"),r=t.TUIStore.getData(C.USER,"displayMessageReadReceipt");return n&&r&&0!==e.length&&e[0].conversationType===t.TYPES.CONV_GROUP?t.chat.getMessageReadReceiptList(e).then((function(e){return e.data.messageList})).catch((function(){return Promise.resolve(e)})):Promise.resolve(e)}}]),e}(),Gt=function(e){(0,l.default)(n,e);var t=y(n);function n(){var e;return(0,h.default)(this,n),e=t.call(this),e.messageHandler=new Lt((0,a.default)(e)),e.typingHandler=new Pt((0,a.default)(e)),e.readReceiptHandler=new Ut((0,a.default)(e)),e.isSwitching=!0,e.delayGetHoppingFunction=void 0,e.hoppingConfigMap=new Map,e}return(0,g.default)(n,[{key:"init",value:function(){var e=this.getEngine();e.eventCenter.addEvent(e.EVENT.MESSAGE_RECEIVED,this.onMessageReceived.bind(this)),e.eventCenter.addEvent(e.EVENT.MESSAGE_MODIFIED,this.onMessageModified.bind(this)),e.eventCenter.addEvent(e.EVENT.MESSAGE_REVOKED,this.onMessageRevoked.bind(this)),e.eventCenter.addEvent(e.EVENT.MESSAGE_READ_BY_PEER,this.onMessageReadByPeer.bind(this)),this.onCurrentConversationIDUpdated(),this.onMessageSource(),this.readReceiptHandler.init()}},{key:"onMessageReceived",value:function(e){this.updateMessageList(e,"push"),this.getEngine().TUIStore.update(C.CHAT,"newMessageList",e)}},{key:"onMessageModified",value:function(e){this.updateMessageList(e,"edit")}},{key:"onMessageRevoked",value:function(e){this.updateMessageList(e,"edit")}},{key:"onCurrentConversationIDUpdated",value:function(){var e=this,t=this.getEngine();t.TUIStore.watch(C.CONV,{currentConversationID:function(n){e.isSwitching=!0,e.delayGetHoppingFunction=void 0,e.hoppingConfigMap.clear(),t.TUIStore.reset(C.CHAT),e.typingHandler.clearTypingStatus(),e.typingHandler.sendTypingEnd(),function(e){if(null==e)return!0;if("boolean"==typeof e)return!1;if("number"==typeof e)return 0===e;if("string"==typeof e)return 0===e.length;if("function"==typeof e)return 0===e.length;if(Array.isArray(e))return 0===e.length;if(e instanceof Error)return""===e.message;if(function(e){if("object"!=(0,s.default)(e)||null===e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;for(var n=t;null!==Object.getPrototypeOf(n);)n=Object.getPrototypeOf(n);return t===n}(e)){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}return!1}(n)||e.getMessageList().finally((function(t){e.isSwitching=!1,e.delayGetHoppingFunction&&e.delayGetHoppingFunction()}))}})}},{key:"onMessageSource",value:function(){var e=this,t=this.getEngine();t.TUIStore.watch(C.CHAT,{messageSource:function(n){var r=e.getStoreData(C.CONV,"currentConversationID");if(r&&(!n||n.conversationID===r)){if(L(n))return e.hoppingConfigMap.clear(),t.TUIStore.update(C.CHAT,"messageList",[]),t.TUIStore.update(C.CHAT,"nextReqMessageID",""),t.TUIStore.update(C.CHAT,"isCompleted",!1),void e.getMessageList();var o=e.getStoreData(C.CHAT,"messageList");o&&o.find((function(e){return n&&e.ID===n.ID}))||(e.isSwitching?e.delayGetHoppingFunction=e.getMessageListHoppingForDown:e.getMessageListHoppingForDown())}}})}},{key:"getMessageListHoppingForDown",value:function(){var e=this.getStoreData(C.CHAT,"messageList"),t=this.getStoreData(C.CHAT,"messageSource"),n=t.conversationID,r=t.sequence,o=t.time,i=t.ID;if(!e||!e.find((function(e){return i&&e.ID===i}))){var a=this.getEngine();a.TUIStore.update(C.CHAT,"messageList",[]),a.TUIStore.update(C.CHAT,"nextReqMessageID",""),a.TUIStore.update(C.CHAT,"isCompleted",!1),this.getMessageListHopping({conversationID:n,sequence:r,time:o,direction:1})}}},{key:"onMessageReadByPeer",value:function(e){this.updateMessageList(e,"edit")}},{key:"getStoreData",value:function(e,t){return this.getEngine().TUIStore.getData(e,t)}},{key:"sendMessage",value:function(e,t){this.updateMessageList([e],"send");var n=this.getEngine().chat.sendMessage(e,t);return this.getResponse(n)}},{key:"getResponse",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return e.then((function(e){var r=e.data.messageList?e.data.messageList:[e.data.message];return n&&t.updateMessageList(r,"edit"),e})).catch((function(e){var n;return r&&(null===(n=null==e?void 0:e.data)||void 0===n?void 0:n.message)&&t.updateMessageList([e.data.message],"edit"),Promise.reject(e)}))}},{key:"updateMessageList",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(!this.getStoreData(C.CHAT,"messageSource")||"unshift"===t||"edit"===t){var n=this.getStoreData(C.CHAT,"messageList"),r=this.updateTargetMessageList(e,n,t);this.getEngine().TUIStore.update(C.CHAT,"messageList",r)}}},{key:"updateTargetMessageList",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=this.getStoreData(C.CONV,"currentConversationID"),i=e.filter((function(e){return e.conversationID===o}));if(!r||0===i.length)return t;var a=t||[],s=[];switch(r){case"edit":var u,l=I(t);try{var d=function(){var e=u.value,t=i.find((function(t){return t.ID===e.ID}));s.push(t||e)};for(l.s();!(u=l.n()).done;)d()}catch(f){l.e(f)}finally{l.f()}break;case"resend":s=a.filter((function(e){return e.ID!==i[0].ID})).concat(i);break;case"send":s=a.concat(this.typingHandler.filterTypingMessage(i));break;case"push":s=a.concat(this.typingHandler.filterTypingMessage(i)),this.getEngine().chat.setMessageRead({conversationID:o});break;case"unshift":s=i.filter((function(e){return 0===a.length||!a.find((function(t){return t.ID===e.ID}))})),(n=s).push.apply(n,(0,c.default)(a))}return s}},{key:"enterTypingState",value:function(){this.getStoreData(C.APP,"enableTyping")&&this.sendTyping(!0)}},{key:"leaveTypingState",value:function(){this.getStoreData(C.APP,"enableTyping")&&this.sendTyping(!1)}},{key:"sendTyping",value:function(e){var t=this.getEngine(),n=this.getStoreData(C.CONV,"currentConversationID");if(n.startsWith(t.TYPES.CONV_C2C)){var r=n.replace(t.TYPES.CONV_C2C,"");if(e){var o=this.getStoreData(C.CHAT,"messageList").filter((function(e){return"in"===e.flow}));if(0===o.length)return;var i=1e3*o[o.length-1].time;if((new Date).getTime()-i>3e4)return}this.typingHandler.sendTyping(e,r)}}},{key:"quoteMessage",value:function(e){return this.getEngine().TUIStore.update(C.CHAT,"quoteMessage",{message:e,type:"quote"}),e}},{key:"replyMessage",value:function(e){return this.getEngine().TUIStore.update(C.CHAT,"quoteMessage",{message:e,type:"reply"}),e}},{key:"getCurrentConvInfo",value:function(){var e=this.getStoreData(C.CONV,"currentConversation")||{},t=e.conversationID,n=void 0===t?"":t,r=e.type;return{to:n.replace(r,""),conversationType:r}}},{key:"t",value:function(e){return this.getEngine().TUITranslate.t(e)||e}},{key:"getMessageAbstractAndType",value:function(e){var t,n=this.getEngine(),r={abstract:"",type:0};switch(e.type){case n.TYPES.MSG_TEXT:r.abstract=null===(t=null==e?void 0:e.payload)||void 0===t?void 0:t.text,r.type=1;break;case n.TYPES.MSG_CUSTOM:r.abstract=this.t("[自定义消息]"),r.type=2;break;case n.TYPES.MSG_IMAGE:r.abstract=this.t("[图片]"),r.type=3;break;case n.TYPES.MSG_AUDIO:r.abstract=this.t("[语音]"),r.type=4;break;case n.TYPES.MSG_VIDEO:r.abstract=this.t("[视频]"),r.type=5;break;case n.TYPES.MSG_FILE:r.abstract=this.t("[文件]"),r.type=6;break;case n.TYPES.MSG_FACE:r.abstract=this.t("[表情]"),r.type=7}return r}},{key:"genMessageReply",value:function(e,t){if("reply"!==t&&"quote"!==t)return{};var n=this.getMessageAbstractAndType(e),r=n.abstract,o=n.type,i={messageAbstract:r,messageSender:e.nick||e.from,messageID:e.ID},a=Object.assign(Object.assign({},i),{messageType:o,messageTime:null==e?void 0:e.time,messageSequence:null==e?void 0:e.sequence,version:1});if("reply"===t&&(a.messageRootID=e.ID,e.cloudCustomData)){var s=G(e.cloudCustomData);s.messageReply&&s.messageReply.messageRootID&&(a.messageRootID=s.messageReply.messageRootID)}return{messageReply:a,messageReplyRoot:i}}},{key:"getMessageInfo",value:function(e,t,n){var r,o,i=this.genMessageReply(t,n),a=i.messageReply,s=i.messageReplyRoot,u=e.cloudCustomData?G(e.cloudCustomData):{};if(u.messageReply?u.messageReply=Object.assign(Object.assign({},a),u.messageReply):u.messageReply=a,"reply"===n){var c=a.messageRootID;r=this.getEngine().chat.findMessage(c);var l=r.cloudCustomData?G(r.cloudCustomData):{};l.messageReplies||(l.messageReplies={}),o=l.messageReplies.replies,("function"==typeof Array.isArray?Array.isArray(o):"array"===Object.prototype.toString.call(o).match(/^\[object (.*)\]$/)[1].toLowerCase())||(l.messageReplies.replies=[]),l.messageReplies.replies.push(s),r.cloudCustomData=JSON.stringify(l)}return{cloudCustomData:JSON.stringify(u),rootMessage:r}}},{key:"sendTextMessage",value:function(e,t){var n=this,r=this.getEngine(),o=this.getStoreData(C.CHAT,"quoteMessage"),i=o.message,a=o.type,s={cloudCustomData:e.cloudCustomData||"",rootMessage:void 0};i&&(s=this.getMessageInfo(e,i,a));var u=r.chat.createTextMessage(Object.assign(Object.assign(Object.assign({},this.getCurrentConvInfo()),e),{cloudCustomData:s.cloudCustomData}));return this.sendMessage(u,t).then((function(e){return s.rootMessage&&n.modifyMessage(s.rootMessage),r.TUIStore.reset(C.CHAT,["quoteMessage"],!0),e}))}},{key:"sendTextAtMessage",value:function(e,t){var n=this,r=this.getEngine(),o=this.getStoreData(C.CHAT,"quoteMessage"),i=o.message,a=o.type,s={cloudCustomData:e.cloudCustomData||"",rootMessage:void 0};i&&(s=this.getMessageInfo(e,i,a));var u=r.chat.createTextMessage(Object.assign(Object.assign(Object.assign({},this.getCurrentConvInfo()),e),{cloudCustomData:s.cloudCustomData}));return this.sendMessage(u,t).then((function(e){return s.rootMessage&&n.modifyMessage(s.rootMessage),r.TUIStore.reset(C.CHAT,["quoteMessage"],!0),e}))}},{key:"sendImageMessage",value:function(e,t){var n=this,r=this.getEngine().chat.createImageMessage(Object.assign(Object.assign(Object.assign({},this.getCurrentConvInfo()),e),{onProgress:function(e){n.onProgress(r.ID,e)}}));return this.sendMessage(r,t)}},{key:"sendAudioMessage",value:function(e,t){var n=this,r=this.getEngine().chat.createAudioMessage(Object.assign(Object.assign(Object.assign({},this.getCurrentConvInfo()),e),{onProgress:function(e){n.onProgress(r.ID,e)}}));return this.sendMessage(r,t)}},{key:"sendVideoMessage",value:function(e,t){var n=this,r=this.getEngine().chat.createVideoMessage(Object.assign(Object.assign(Object.assign({},this.getCurrentConvInfo()),e),{onProgress:function(e){n.onProgress(r.ID,e)}}));return this.sendMessage(r,t)}},{key:"sendCustomMessage",value:function(e,t){var n=this.getEngine().chat.createCustomMessage(Object.assign(Object.assign({},this.getCurrentConvInfo()),e));return this.sendMessage(n,t)}},{key:"sendFaceMessage",value:function(e,t){var n=this.getEngine().chat.createFaceMessage(Object.assign(Object.assign({},this.getCurrentConvInfo()),e));return this.sendMessage(n,t)}},{key:"sendFileMessage",value:function(e,t){var n=this,r=this.getEngine().chat.createFileMessage(Object.assign(Object.assign(Object.assign({},this.getCurrentConvInfo()),e),{onProgress:function(e){n.onProgress(r.ID,e)}}));return this.sendMessage(r,t)}},{key:"sendLocationMessage",value:function(e,t){var n=this.getEngine().chat.createLocationMessage(Object.assign(Object.assign({},this.getCurrentConvInfo()),e));return this.sendMessage(n,t)}},{key:"onProgress",value:function(e,t){var n=this.getEngine().TUIStore.getMessageModel(e);n&&(t-n.progress>=.1||1===t)&&(n.progress=t,this.updateMessageList([n],"edit"))}},{key:"setAbstractList",value:function(e){var t=this.getEngine(),n=e.nick||e.from,r="";switch(e.type){case t.TYPES.MSG_TEXT:return r=e.payload.text||"",r.length>20&&(r=r.slice(0,20)),"".concat(n,": ").concat(r);case t.TYPES.MSG_MERGER:return"".concat(n,": ").concat(this.t("[聊天记录]"));case t.TYPES.MSG_IMAGE:return"".concat(n,": ").concat(this.t("[图片]"));case t.TYPES.MSG_AUDIO:return"".concat(n,": ").concat(this.t("[音频]"));case t.TYPES.MSG_VIDEO:return"".concat(n,": ").concat(this.t("[视频]"));case t.TYPES.MSG_CUSTOM:return"".concat(n,": ").concat(this.t("[自定义消息]"));case t.TYPES.MSG_FILE:return"".concat(n,": ").concat(this.t("[文件]"));case t.TYPES.MSG_FACE:return"".concat(n,": ").concat(this.t("[动画表情]"))}}},{key:"genMergerForwardPayload",value:function(e){var t=this,n=e[0],r=n.conversationType,o=n.nick,i=n.from,a=n.to,s=[];return e.forEach((function(e){s.push(t.setAbstractList(e))})),{messageList:e,title:"GROUP"===r?"群聊的聊天记录":"".concat(o||i," 和 ").concat(a," 的聊天记录"),abstractList:s,compatibleText:"请升级IMSDK到v2.10.1或更高版本查看此消息"}}},{key:"sendMergerForwardMessage",value:function(e){for(var t=e.conversationList,n=e.messageList,r=e.params,o=e.sendMessageOptions,i=[],a=0;a<t.length;a++){var s=t[a],u=s.conversationID,c=s.type,l=Object.assign({to:u.replace("".concat(c),""),conversationType:c,payload:this.genMergerForwardPayload(n)},r),d=this.getEngine().chat.createMergerMessage(l);i.push(this.sendMessage(d,o))}return Promise.all(i)}},{key:"getOriginMessageList",value:function(e){return e.map((function(e){return e instanceof ce?e.getMessage():e}))}},{key:"sendForwardMessage",value:function(e,t,n){t=this.getOriginMessageList(t);var r=n||{},o=r.needMerge,i=void 0!==o&&o,a=r.params,s=void 0===a?{}:a,u=T(r,["needMerge","params"]);if(i)return this.sendMergerForwardMessage({conversationList:e,messageList:t,params:s,sendMessageOptions:u});for(var c=[],l=0;l<e.length;l++)for(var d=e[l],f=d.conversationID,p=d.type,h=Object.assign({to:f.replace("".concat(p),""),conversationType:p},s),g=0;g<t.length;g++){Reflect.set(h,"payload",t[g]);var v=this.getEngine().chat.createForwardMessage(h);c.push(this.sendMessage(v,u))}return Promise.all(c)}},{key:"revokeMessage",value:function(e){var t=this.getEngine().chat.revokeMessage(e);return this.getResponse(t,!0,!1)}},{key:"resendMessage",value:function(e){e.status="unSend",this.updateMessageList([e],"resend");var t=this.getEngine().chat.resendMessage(e);return this.getResponse(t,!0,!0)}},{key:"deleteMessage",value:function(e){var t=this.getEngine().chat.deleteMessage(e);return this.getResponse(t,!0,!1)}},{key:"setMessageExtensions",value:function(e,t){return this.getEngine().chat.setMessageExtensions(e,t)}},{key:"getMessageExtensions",value:function(e){return this.getEngine().chat.getMessageExtensions(e)}},{key:"deleteMessageExtensions",value:function(e,t){return this.getEngine().chat.deleteMessageExtensions(e,t)}},{key:"modifyMessage",value:function(e){var t=this.getEngine().chat.modifyMessage(e);return this.getResponse(t,!0,!1).catch((function(e){var t=e.code,n=t.code,r=void 0===n?0:n,o=t.data,i=void 0===o?{}:o;throw r===A.MSG_MODIFY_CONFLICT?console.warn("".concat(R.MSG_MODIFY_CONFLICT," data.message: ").concat(null==i?void 0:i.message)):r===A.MSG_MODIFY_DISABLED_IN_AVCHATROOM?console.warn(R.MSG_MODIFY_DISABLED_IN_AVCHATROOM):r===A.MODIFY_MESSAGE_NOT_EXIST&&console.warn(R.MODIFY_MESSAGE_NOT_EXIST),e}))}},{key:"getMessageList",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{conversationID:this.getStoreData(C.CONV,"currentConversationID"),nextReqMessageID:this.getStoreData(C.CHAT,"nextReqMessageID")},n=this.getEngine();if(!n.chat.isReady())return Promise.reject({code:O.GET_MSG_LIST_ERROR,message:N.GET_MSG_LIST_ERROR});if(this.getStoreData(C.CHAT,"isCompleted"))return Promise.resolve({data:{messageList:[],nextReqMessageID:"",isCompleted:!0}});var r=this.getStoreData(C.CHAT,"messageSource"),o=this.hoppingConfigMap.get("nextMessageSeq"),i=this.hoppingConfigMap.get("nextMessageTime"),a=o||i;return r&&r.conversationID===t.conversationID&&a?this.getMessageListHopping():n.chat.getMessageList(t).then((function(t){var r=t.data,o=r.messageList,i=r.nextReqMessageID,a=r.isCompleted;return e.readReceiptHandler.getMessageReadReceiptList(o).then((function(r){return e.updateMessageList(r,"unshift"),n.TUIStore.update(C.CHAT,"nextReqMessageID",i),n.TUIStore.update(C.CHAT,"isCompleted",a),t.data.messageList=r,t}))})).catch((function(e){return Promise.reject(e)}))}},{key:"getMessageListHopping",value:function(e){var t,n=this;void 0===e&&(e={conversationID:null===(t=this.getStoreData(C.CHAT,"messageSource"))||void 0===t?void 0:t.conversationID,sequence:this.hoppingConfigMap.get("nextMessageSeq"),time:this.hoppingConfigMap.get("nextMessageTime")});var r=this.getEngine();return r.chat.getMessageListHopping(e).then((function(t){var o=t.data,i=o.messageList,a=o.nextMessageSeq,s=o.nextMessageTime,u=o.isCompleted,c=1===e.direction?e.sequence:a,l=1===e.direction?e.time:s;return n.updateMessageList(i,"unshift"),n.delayGetHoppingFunction=void 0,n.hoppingConfigMap.set("nextMessageSeq",c),n.hoppingConfigMap.set("nextMessageTime",l),r.TUIStore.update(C.CHAT,"isCompleted",u),t})).catch((function(e){return Promise.reject(e)}))}},{key:"sendMessageReadReceipt",value:function(e){return this.readReceiptHandler.sendMessageReadReceipt(e)}},{key:"getGroupMessageReadMemberList",value:function(e){var t=this;return this.readReceiptHandler.getGroupMessageReadMemberList(e).then((function(e){var n=e.data,r=n.isCompleted,o=n.cursor,i=n.messageID,a=n.unreadUserIDList,s=n.readUserIDList,u={code:0,data:{cursor:o,isCompleted:r,messageID:i,unreadUserInfoList:[],readUserInfoList:[]}},l=[].concat((0,c.default)(a),(0,c.default)(s));return 0===l.length?u:t.getEngine().TUIUser.getUserProfile({userIDList:l}).then((function(e){return a.length>0?e.data.forEach((function(e){var t=e.userID,n=e.nick,r=void 0===n?"":n,o=e.avatar,i=void 0===o?"":o;u.data.unreadUserInfoList.push({userID:t,nick:r,avatar:i})})):e.data.forEach((function(e){var t=e.userID,n=e.nick,r=void 0===n?"":n,o=e.avatar,i=void 0===o?"":o;u.data.readUserInfoList.push({userID:t,nick:r,avatar:i})})),u}))}))}},{key:"downloadMergedMessages",value:function(e){return this.getEngine().chat.downloadMergerMessage(e.getMessage())}},{key:"translateText",value:function(e){return this.getEngine().chat.translateText(e)}},{key:"searchCloudMessages",value:function(e){var t=this.getStoreData(C.CONV,"conversationList");return this.getEngine().chat.searchCloudMessages(e).then((function(e){var n=e.data.searchResultList;return e.data.searchResultList=n.map((function(e){var n=e.messageList,r=e.conversationID,o=T(e,["messageList","conversationID"]),i=n.map((function(e){return new ce(e)})),a=t.find((function(e){return e.conversationID===r}));return Object.assign(Object.assign({},o),{messageList:i.sort((function(e,t){return t.time-e.time})),conversation:a})})),e}))}}],[{key:"getInstance",value:function(){return n.instance||(n.instance=new n),n.instance}}]),n}(ae),xt=function(e){(0,l.default)(n,e);var t=y(n);function n(){var e;return(0,h.default)(this,n),e=t.call(this),e.groupMap=new Map,e}return(0,g.default)(n,[{key:"init",value:function(){var e=this.getEngine();e.eventCenter.addEvent(e.EVENT.GROUP_LIST_UPDATED,this.onGroupListUpdated.bind(this)),e.eventCenter.addEvent(e.EVENT.GROUP_ATTRIBUTES_UPDATED,this.onGroupAttributesUpdated.bind(this)),e.eventCenter.addEvent(e.EVENT.GROUP_COUNTER_UPDATED,this.onGroupCounterUpdated.bind(this)),e.eventCenter.addEvent(e.EVENT.MESSAGE_RECEIVED,this.onMessageReceived.bind(this)),this.getGroupInitData()}},{key:"onGroupListUpdated",value:function(e){var t=this.getEngine();t.TUIStore.update(C.GRP,"groupList",e);var n=t.TUIStore.getData(C.GRP,"currentGroupID");e.forEach((function(e){e.groupID===n&&t.TUIStore.update(C.GRP,"currentGroup",e)}))}},{key:"onGroupAttributesUpdated",value:function(e){var t=this.getEngine(),n=t.TUIStore.getData(C.GRP,"currentGroupID"),r=t.TUIStore.getData(C.GRP,"groupList"),o=e.groupID,i=e.groupAttributes;n===o&&t.TUIStore.update(C.GRP,"currentGroupAttributes",i),r=r.map((function(e){return e.groupID===o&&(e.groupAttributes=i),e})),t.TUIStore.update(C.GRP,"groupList",r)}},{key:"onGroupCounterUpdated",value:function(e){var t=this.getEngine(),n=t.TUIStore.getData(C.GRP,"currentGroupID"),r=t.TUIStore.getData(C.GRP,"currentGroupCounters")||{},o=t.TUIStore.getData(C.GRP,"groupList"),i=e.groupID,a=e.key,s=e.value;n===i&&(r[a]=s,t.TUIStore.update(C.GRP,"currentGroupCounters",r)),o=o.map((function(e){return e.groupID===i&&(e.groupCounters=Object.assign(Object.assign({},e.groupCounters),(0,p.default)({},a,s))),e})),t.TUIStore.update(C.GRP,"groupList",o)}},{key:"onMessageReceived",value:function(e){var t=this,n=this.getEngine(),r=[];e.forEach((function(e){if(e.type===n.TYPES.MSG_GRP_TIP){var o=e.payload,i=o.operationType,a=o.userIDList,s=n.TUIStore.getData(C.GRP,"currentGroupID");switch(i){case n.TYPES.GRP_TIP_MBR_JOIN:t.addMemberList(a);break;case n.TYPES.GRP_TIP_MBR_QUIT:case n.TYPES.GRP_TIP_MBR_KICKED_OUT:t.removeMemberList(a);break;case n.TYPES.GRP_TIP_MBR_SET_ADMIN:case n.TYPES.GRP_TIP_MBR_CANCELED_ADMIN:t.updateGroupMember(a);break;case n.TYPES.GRP_TIP_GRP_PROFILE_UPDATED:t.getGroupProfile({groupID:s});break;case n.TYPES.GRP_TIP_MBR_PROFILE_UPDATED:case n.TYPES.GRP_TIP_BAN_AVCHATROOM_MEMBER:case n.TYPES.GRP_TIP_UNBAN_AVCHATROOM_MEMBER:t.updateGroupMember(a)}}e.type===n.TYPES.MSG_GRP_SYS_NOTICE&&r.push(e)})),r.length>0&&n.TUIStore.update(C.GRP,"groupSystemNoticeList",r)}},{key:"getGroupInitData",value:function(){var e=this,t=this.getEngine();t.chat.isReady()&&t.chat.getGroupList().then((function(t){var n=t.data.groupList,r=void 0===n?[]:n;console.log("TUIGroupService.init, getGroupList count:".concat(r.length)),r.length>0&&e.onGroupListUpdated(r)}))}},{key:"updateGroupMember",value:function(e){return S(this,void 0,void 0,i.default.mark((function t(){var n,r,o;return i.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=this.getEngine().TUIStore.getData(C.GRP,"currentGroupID"),!n){t.next=7;break}return t.next=4,this.getGroupMemberProfile({groupID:n,userIDList:e});case 4:r=t.sent,o=r.data.memberList,this.updateMemberList(o);case 7:case"end":return t.stop()}}),t,this)})))}},{key:"resetCurrentStore",value:function(){this.getEngine().TUIStore.reset(C.GRP,["currentGroupID","currentGroup","currentGroupAttributes","currentGroupCounters","currentGroupMemberList"],!0)}},{key:"switchGroup",value:function(e){return S(this,void 0,void 0,i.default.mark((function t(){var n,r,o,a,s,u=this;return i.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=this.getEngine(),r=n.TUIStore.getData(C.GRP,"currentGroupID"),e){t.next=3;break}return t.abrupt("return",(this.resetCurrentStore(),Promise.resolve({})));case 3:if(r!==e){t.next=6;break}return o=n.TUIStore.getData(C.GRP,"currentGroup"),t.abrupt("return",Promise.resolve(o));case 6:return this.resetCurrentStore(),n.TUIStore.update(C.GRP,"currentGroupID",e),t.prev=7,t.next=10,this.getGroupInfo(e);case 10:t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](7),Promise.reject(t.t0);case 15:return a=setTimeout((function(){u.groupMap.delete(e),clearTimeout(a)}),5e3),s=n.TUIStore.getData(C.GRP,"currentGroup"),t.abrupt("return",Promise.resolve(s));case 17:case"end":return t.stop()}}),t,this,[[7,12]])})))}},{key:"getGroupInfo",value:function(e){return S(this,void 0,void 0,i.default.mark((function t(){var n,r,o,a,s,u,c,l,d,f,p;return i.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=this.getEngine(),r=this.groupMap.get(e),!r){t.next=3;break}return t.abrupt("return",(this.updateMemberList((null==r?void 0:r.memberList)||[]),n.TUIStore.update(C.GRP,"currentGroup",r.group),n.TUIStore.update(C.GRP,"currentGroupAttributes",r.groupAttributes||{}),void n.TUIStore.update(C.GRP,"currentGroupCounters",r.counters||{})));case 3:return o={group:{},memberList:[],groupAttributes:void 0,counters:void 0},t.next=6,this.getGroupProfile({groupID:e});case 6:return a=t.sent,s=a.data.group,o.group=s,t.next=11,this.getGroupMemberList({groupID:e});case 11:return u=t.sent,c=u.data.memberList,o.memberList=c,t.next=16,this.getGroupAttributes({groupID:e,keyList:[]});case 16:return l=t.sent,d=l.data.groupAttributes,o.groupAttributes=d,n.TUIStore.update(C.GRP,"currentGroupAttributes",d),t.prev=19,t.next=22,this.getGroupCounters({groupID:e,keyList:[]});case 22:f=t.sent,p=f.data.counters,n.TUIStore.update(C.GRP,"currentGroupCounters",p),t.next=30;break;case 27:t.prev=27,t.t0=t["catch"](19),console.warn(t.t0);case 30:this.groupMap.set(e,o);case 31:case"end":return t.stop()}}),t,this,[[19,27]])})))}},{key:"getGroupProfile",value:function(e){var t=this,n=this.getEngine();return n.chat.getGroupProfile(e).then((function(r){return S(t,void 0,void 0,i.default.mark((function t(){var o;return i.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n.TUIStore.getData(C.GRP,"currentGroupID")===e.groupID&&(o=r.data.group,n.TUIStore.update(C.GRP,"currentGroup",o)),t.abrupt("return",r);case 2:case"end":return t.stop()}}),t)})))}))}},{key:"updateGroupProfile",value:function(e){return this.getEngine().chat.updateGroupProfile(e)}},{key:"createGroup",value:function(e){return this.getEngine().chat.createGroup(e)}},{key:"dismissGroup",value:function(e){return this.getEngine().chat.dismissGroup(e)}},{key:"searchGroupByID",value:function(e){var t=this.getEngine();return t.chat.searchGroupByID(e).then((function(e){var n=e.data.group,r=t.TUIStore.getData(C.GRP,"groupList");return e.data.group.isJoinedGroup=r.some((function(e){return e.groupID===n.groupID})),e}))}},{key:"joinGroup",value:function(e){return this.getEngine().chat.joinGroup(e)}},{key:"quitGroup",value:function(e){return this.getEngine().chat.quitGroup(e)}},{key:"getGroupApplicationList",value:function(){return this.getEngine().chat.getGroupApplicationList()}},{key:"handleGroupApplication",value:function(e){return this.getEngine().chat.handleGroupApplication(e)}},{key:"getGroupOnlineMemberCount",value:function(e){return this.getEngine().chat.getGroupOnlineMemberCount(e)}},{key:"changeGroupOwner",value:function(e){return this.getEngine().chat.changeGroupOwner(e)}},{key:"initGroupAttributes",value:function(e){return this.getEngine().chat.initGroupAttributes(e)}},{key:"setGroupAttributes",value:function(e){return this.getEngine().chat.setGroupAttributes(e)}},{key:"deleteGroupAttributes",value:function(e){return this.getEngine().chat.deleteGroupAttributes(e)}},{key:"getGroupAttributes",value:function(e){return this.getEngine().chat.getGroupAttributes(e)}},{key:"setGroupCounters",value:function(e){return this.getEngine().chat.setGroupCounters(e)}},{key:"increaseGroupCounter",value:function(e){return this.getEngine().chat.increaseGroupCounter(e)}},{key:"decreaseGroupCounter",value:function(e){return this.getEngine().chat.decreaseGroupCounter(e)}},{key:"getGroupCounters",value:function(e){return this.getEngine().chat.getGroupCounters(e)}},{key:"updateMemberList",value:function(e){var t=this.getEngine(),n=[].concat((0,c.default)((t.TUIStore.getData(C.GRP,"currentGroupMemberList")||[]).filter((function(t){return!e.find((function(e){return e.userID===t.userID}))}))),(0,c.default)(e));t.TUIStore.update(C.GRP,"currentGroupMemberList",n)}},{key:"addMemberList",value:function(e){return S(this,void 0,void 0,i.default.mark((function t(){var n,r,o,a;return i.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=this.getEngine().TUIStore.getData(C.GRP,"currentGroupID"),!n){t.next=14;break}return t.prev=2,t.next=5,this.getGroupMemberProfile({groupID:n,userIDList:e});case 5:r=t.sent,o=r.data.memberList,this.updateMemberList(o),t.next=14;break;case 10:t.prev=10,t.t0=t["catch"](2),a=e.map((function(e){return{userID:e,avatar:"",nick:"",role:"",joinTime:0,nameCard:"",muteUntil:0,memberCustomField:[]}})),this.updateMemberList(a);case 14:case"end":return t.stop()}}),t,this,[[2,10]])})))}},{key:"removeMemberList",value:function(e){var t=this.getEngine(),n=t.TUIStore.getData(C.GRP,"currentGroupMemberList").filter((function(t){return-1===e.indexOf(t.userID)}));t.TUIStore.update(C.GRP,"currentGroupMemberList",n)}},{key:"getGroupMemberList",value:function(e){var t=this,n=this.getEngine();return n.chat.getGroupMemberList(e).then((function(r){if(n.TUIStore.getData(C.GRP,"currentGroupID")===e.groupID){var o=r.data.memberList;t.updateMemberList(o)}return r}))}},{key:"getGroupMemberProfile",value:function(e){return this.getEngine().chat.getGroupMemberProfile(e)}},{key:"addGroupMember",value:function(e){var t=this,n=this.getEngine();return n.chat.addGroupMember(e).then((function(r){return S(t,void 0,void 0,i.default.mark((function t(){var o,a,s;return i.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n.TUIStore.getData(C.GRP,"currentGroupID")===e.groupID&&(o=r.data,a=o.successUserIDList,s=o.group,n.TUIStore.update(C.GRP,"currentGroup",s),this.addMemberList(a)),t.abrupt("return",r);case 2:case"end":return t.stop()}}),t,this)})))}))}},{key:"deleteGroupMember",value:function(e){var t=this,n=this.getEngine();return n.chat.deleteGroupMember(e).then((function(r){if(n.TUIStore.getData(C.GRP,"currentGroupID")===e.groupID){var o=r.data,i=o.userIDList,a=o.group;t.removeMemberList(i),n.TUIStore.update(C.GRP,"currentGroup",a)}return r}))}},{key:"setGroupMemberMuteTime",value:function(e){return this.getEngine().chat.setGroupMemberMuteTime(e)}},{key:"setGroupMemberRole",value:function(e){return this.getEngine().chat.setGroupMemberRole(e)}},{key:"setGroupMemberNameCard",value:function(e){return this.getEngine().chat.setGroupMemberNameCard(e)}},{key:"setGroupMemberCustomField",value:function(e){return this.getEngine().chat.setGroupMemberCustomField(e)}},{key:"markGroupMemberList",value:function(e){return this.getEngine().chat.markGroupMemberList(e)}}],[{key:"getInstance",value:function(){return n.instance||(n.instance=new n),n.instance}}]),n}(ae),Ft=function(e){(0,l.default)(n,e);var t=y(n);function n(){return(0,h.default)(this,n),t.call(this)}return(0,g.default)(n,[{key:"init",value:function(){var e=this.getEngine();e.eventCenter.addEvent(e.EVENT.FRIEND_LIST_UPDATED,this.onFriendListUpdated.bind(this)),e.eventCenter.addEvent(e.EVENT.FRIEND_APPLICATION_LIST_UPDATED,this.onFriendApplicationListUpdated.bind(this))}},{key:"onFriendListUpdated",value:function(e){this.getEngine().TUIStore.update(C.FRIEND,"friendList",e)}},{key:"onFriendApplicationListUpdated",value:function(e){var t=e.friendApplicationList,n=e.unreadCount,r=void 0===n?0:n,o=this.getEngine();o.TUIStore.update(C.FRIEND,"friendApplicationList",t),o.TUIStore.update(C.FRIEND,"friendApplicationUnreadCount",r)}},{key:"getFriendList",value:function(){return this.getEngine().chat.getFriendList()}},{key:"getFriendRemark",value:function(e){var t=this.getEngine().TUIStore.getData(C.FRIEND,"friendList"),n={};return e.forEach((function(e){for(var r=0;r<t.length;r++)t[r].userID!==e||(n[e]=t[r].remark)})),n}},{key:"addFriend",value:function(e){return this.getEngine().chat.addFriend(e)}},{key:"deleteFriend",value:function(e){return this.getEngine().chat.deleteFriend(e)}},{key:"checkFriend",value:function(e){return this.getEngine().chat.checkFriend(e)}},{key:"getFriendProfile",value:function(e){return this.getEngine().chat.getFriendProfile(e)}},{key:"updateFriend",value:function(e){return this.getEngine().chat.updateFriend(e)}},{key:"acceptFriendApplication",value:function(e){return this.getEngine().chat.acceptFriendApplication(e)}},{key:"refuseFriendApplication",value:function(e){return this.getEngine().chat.refuseFriendApplication({userID:e})}},{key:"deleteFriendApplication",value:function(e){return this.getEngine().chat.deleteFriendApplication(e)}},{key:"setFriendApplicationRead",value:function(){return this.getEngine().chat.setFriendApplicationRead()}}],[{key:"getInstance",value:function(){return n.instance||(n.instance=new n),n.instance}}]),n}(ae),qt=function(){function e(){(0,h.default)(this,e),this.cache=[],this.middlewares=[],this.options=null}return(0,g.default)(e,[{key:"use",value:function(e){if("function"!=typeof e)throw"middleware must be a function";return this.cache.push(e),this}},{key:"next",value:function(){if(this.middlewares&&this.middlewares.length>0)return this.middlewares.shift().call(this,this.options,this.next.bind(this))}},{key:"run",value:function(e){return this.middlewares=this.cache.map((function(e){return e})),this.options=e,this.next()}}]),e}();function Vt(e,t,n){var r=Object.create(null);Object.keys(n).forEach((function(n){if(t[n]){r[n]=t[n];var o=new qt;t[n]=function(){var i=Array.from(arguments);return o.use((function(t,r){return e.isInited?r():Promise.reject({code:O.NOT_INIT,message:"".concat(n," | ").concat(N.NOT_INIT)})})).use((function(e,o){return r[n].apply(t,e)})),o.run(i)}}}))}console.log("TUIChatEngine.VERSION:2.0.2");var Bt=re.getInstance(),jt=ne.getInstance(),Ht=ge.getInstance(),Kt=Ct.getInstance(),Wt=kt.getInstance(),Yt=wt.getInstance(),zt=Gt.getInstance(),Jt=xt.getInstance(),Xt=Ft.getInstance();t.TUIFriendService=Xt,t.TUIGroupService=Jt,t.TUIChatService=zt,t.TUIUserService=Yt,t.TUIConversationService=Wt,t.TUITranslateService=Kt,t.TUIStore=Ht,t.TUIGlobal=jt,t.default=Bt,Bt.mount(E.TUIStore,Ht),Bt.mount(E.TUITranslate,Kt),Bt.mount(E.TUIConversation,Wt),Bt.mount(E.TUIUser,Yt),Bt.mount(E.TUIChat,zt),Bt.mount(E.TUIGroup,Jt),Bt.mount(E.TUIFriend,Xt),Vt(Bt,Bt,{logout:1,destroy:1}),Vt(Bt,Wt,{deleteConversation:1,pinConversation:1,muteConversation:1,switchConversation:1,getConversationProfile:1,clearHistoryMessage:1}),Vt(Bt,zt,{modifyMessage:1,revokeMessage:1,resendMessage:1,deleteMessage:1,quoteMessage:1,replyMessage:1,setMessageExtensions:1,deleteMessageExtensions:1,getMessageExtensions:1,sendTextMessage:1,sendTextAtMessage:1,sendImageMessage:1,sendAudioMessage:1,sendVideoMessage:1,sendFileMessage:1,sendCustomMessage:1,sendFaceMessage:1,sendLocationMessage:1,sendForwardMessage:1,enterTypingState:1,leaveTypingState:1,sendMessageReadReceipt:1,getGroupMessageReadMemberList:1,getMessageList:1,downloadMergedMessages:1,translateText:1,searchCloudMessages:1}),Vt(Bt,Jt,{switchGroup:1,getGroupProfile:1,updateGroupProfile:1,createGroup:1,dismissGroup:1,searchGroupByID:1,joinGroup:1,quitGroup:1,getGroupApplicationList:1,handleGroupApplication:1,getGroupOnlineMemberCount:1,changeGroupOwner:1,initGroupAttributes:1,setGroupAttributes:1,deleteGroupAttributes:1,getGroupAttributes:1,setGroupCounters:1,increaseGroupCounter:1,decreaseGroupCounter:1,getGroupCounters:1,getGroupMemberList:1,getGroupMemberProfile:1,addGroupMember:1,deleteGroupMember:1,setGroupMemberMuteTime:1,setGroupMemberRole:1,setGroupMemberNameCard:1,setGroupMemberCustomField:1,markGroupMemberList:1}),Vt(Bt,Yt,{switchUserStatus:1,switchMessageReadStatus:1,getUserProfile:1,updateMyProfile:1,addToBlacklist:1,removeFromBlacklist:1}),Vt(Bt,Xt,{getFriendList:1,addFriend:1,deleteFriend:1,checkFriend:1,getFriendProfile:1,updateFriend:1,acceptFriendApplication:1,refuseFriendApplication:1,deleteFriendApplication:1,setFriendApplicationRead:1})}).call(this,n("bc2e")["default"],n("543d")["default"])},a826:function(e,t,n){"use strict";var r=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n("1823")),i=r(n("54ab")),a=r(n("853d")),s={en:o.default,"zh-Hans":i.default,"zh-Hant":a.default};t.default=s},a9ff:function(e,t,n){"use strict";(function(e,r,o){var i=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=i(n("2eee")),s=i(n("3c96")),u=i(n("278c")),c=i(n("7037")),l=i(n("448a")),d=i(n("c973")),f=i(n("9523")),p=i(n("ed6d")),h=i(n("6b58")),g=i(n("36c6")),v=i(n("a128")),_=i(n("970b")),m=i(n("5bc3")),y=i(n("6af2"));function I(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return M(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return M(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function T(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?T(Object(n),!0).forEach((function(t){(0,f.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function E(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,g.default)(e);if(t){var o=(0,g.default)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(0,h.default)(this,n)}}function C(e,t,n){return e(n={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&n.path)}},n.exports),n.exports}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof e||"undefined"!=typeof self&&self;var k=C((function(e,t){var n;e.exports=(n=n||function(e,t){var n=Object.create||function(){function e(){}return function(t){var n;return e.prototype=t,n=new e,e.prototype=null,n}}(),r={},o=r.lib={},i=o.Base={extend:function(e){var t=n(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},a=o.WordArray=i.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=void 0!=t?t:4*e.length},toString:function(e){return(e||u).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes,o=e.sigBytes;if(this.clamp(),r%4)for(var i=0;i<o;i++){var a=n[i>>>2]>>>24-i%4*8&255;t[r+i>>>2]|=a<<24-(r+i)%4*8}else for(i=0;i<o;i+=4)t[r+i>>>2]=n[i>>>2];return this.sigBytes+=o,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=i.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n,r=[],o=function(t){t=t;var n=987654321,r=4294967295;return function(){var o=((n=36969*(65535&n)+(n>>16)&r)<<16)+(t=18e3*(65535&t)+(t>>16)&r)&r;return o/=4294967296,(o+=.5)*(e.random()>.5?1:-1)}},i=0;i<t;i+=4){var s=o(4294967296*(n||e.random()));n=987654071*s(),r.push(4294967296*s()|0)}return new a.init(r,t)}}),s=r.enc={},u=s.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],o=0;o<n;o++){var i=t[o>>>2]>>>24-o%4*8&255;r.push((i>>>4).toString(16)),r.push((15&i).toString(16))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new a.init(n,t/2)}},c=s.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],o=0;o<n;o++){var i=t[o>>>2]>>>24-o%4*8&255;r.push(String.fromCharCode(i))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new a.init(n,t)}},l=s.Utf8={stringify:function(e){try{return decodeURIComponent(escape(c.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return c.parse(unescape(encodeURIComponent(e)))}},d=o.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new a.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=l.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,r=n.words,o=n.sigBytes,i=this.blockSize,s=o/(4*i),u=(s=t?e.ceil(s):e.max((0|s)-this._minBufferSize,0))*i,c=e.min(4*u,o);if(u){for(var l=0;l<u;l+=i)this._doProcessBlock(r,l);var d=r.splice(0,u);n.sigBytes-=c}return new a.init(d,c)},clone:function(){var e=i.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});o.Hasher=d.extend({cfg:i.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){d.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new f.HMAC.init(e,n).finalize(t)}}});var f=r.algo={};return r}(Math),n)})),b=k,D=(C((function(e,t){var n;e.exports=(n=b,function(e){var t=n,r=t.lib,o=r.WordArray,i=r.Hasher,a=t.algo,s=[];!function(){for(var t=0;t<64;t++)s[t]=4294967296*e.abs(e.sin(t+1))|0}();var u=a.MD5=i.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var n=0;n<16;n++){var r=t+n,o=e[r];e[r]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8)}var i=this._hash.words,a=e[t+0],u=e[t+1],p=e[t+2],h=e[t+3],g=e[t+4],v=e[t+5],_=e[t+6],m=e[t+7],y=e[t+8],I=e[t+9],M=e[t+10],T=e[t+11],S=e[t+12],E=e[t+13],C=e[t+14],k=e[t+15],b=i[0],D=i[1],A=i[2],O=i[3];b=c(b,D,A,O,a,7,s[0]),O=c(O,b,D,A,u,12,s[1]),A=c(A,O,b,D,p,17,s[2]),D=c(D,A,O,b,h,22,s[3]),b=c(b,D,A,O,g,7,s[4]),O=c(O,b,D,A,v,12,s[5]),A=c(A,O,b,D,_,17,s[6]),D=c(D,A,O,b,m,22,s[7]),b=c(b,D,A,O,y,7,s[8]),O=c(O,b,D,A,I,12,s[9]),A=c(A,O,b,D,M,17,s[10]),D=c(D,A,O,b,T,22,s[11]),b=c(b,D,A,O,S,7,s[12]),O=c(O,b,D,A,E,12,s[13]),A=c(A,O,b,D,C,17,s[14]),b=l(b,D=c(D,A,O,b,k,22,s[15]),A,O,u,5,s[16]),O=l(O,b,D,A,_,9,s[17]),A=l(A,O,b,D,T,14,s[18]),D=l(D,A,O,b,a,20,s[19]),b=l(b,D,A,O,v,5,s[20]),O=l(O,b,D,A,M,9,s[21]),A=l(A,O,b,D,k,14,s[22]),D=l(D,A,O,b,g,20,s[23]),b=l(b,D,A,O,I,5,s[24]),O=l(O,b,D,A,C,9,s[25]),A=l(A,O,b,D,h,14,s[26]),D=l(D,A,O,b,y,20,s[27]),b=l(b,D,A,O,E,5,s[28]),O=l(O,b,D,A,p,9,s[29]),A=l(A,O,b,D,m,14,s[30]),b=d(b,D=l(D,A,O,b,S,20,s[31]),A,O,v,4,s[32]),O=d(O,b,D,A,y,11,s[33]),A=d(A,O,b,D,T,16,s[34]),D=d(D,A,O,b,C,23,s[35]),b=d(b,D,A,O,u,4,s[36]),O=d(O,b,D,A,g,11,s[37]),A=d(A,O,b,D,m,16,s[38]),D=d(D,A,O,b,M,23,s[39]),b=d(b,D,A,O,E,4,s[40]),O=d(O,b,D,A,a,11,s[41]),A=d(A,O,b,D,h,16,s[42]),D=d(D,A,O,b,_,23,s[43]),b=d(b,D,A,O,I,4,s[44]),O=d(O,b,D,A,S,11,s[45]),A=d(A,O,b,D,k,16,s[46]),b=f(b,D=d(D,A,O,b,p,23,s[47]),A,O,a,6,s[48]),O=f(O,b,D,A,m,10,s[49]),A=f(A,O,b,D,C,15,s[50]),D=f(D,A,O,b,v,21,s[51]),b=f(b,D,A,O,S,6,s[52]),O=f(O,b,D,A,h,10,s[53]),A=f(A,O,b,D,M,15,s[54]),D=f(D,A,O,b,u,21,s[55]),b=f(b,D,A,O,y,6,s[56]),O=f(O,b,D,A,k,10,s[57]),A=f(A,O,b,D,_,15,s[58]),D=f(D,A,O,b,E,21,s[59]),b=f(b,D,A,O,g,6,s[60]),O=f(O,b,D,A,T,10,s[61]),A=f(A,O,b,D,p,15,s[62]),D=f(D,A,O,b,I,21,s[63]),i[0]=i[0]+b|0,i[1]=i[1]+D|0,i[2]=i[2]+A|0,i[3]=i[3]+O|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,o=8*t.sigBytes;n[o>>>5]|=128<<24-o%32;var i=e.floor(r/4294967296),a=r;n[15+(o+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),n[14+(o+64>>>9<<4)]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),t.sigBytes=4*(n.length+1),this._process();for(var s=this._hash,u=s.words,c=0;c<4;c++){var l=u[c];u[c]=16711935&(l<<8|l>>>24)|4278255360&(l<<24|l>>>8)}return s},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});function c(e,t,n,r,o,i,a){var s=e+(t&n|~t&r)+o+a;return(s<<i|s>>>32-i)+t}function l(e,t,n,r,o,i,a){var s=e+(t&r|n&~r)+o+a;return(s<<i|s>>>32-i)+t}function d(e,t,n,r,o,i,a){var s=e+(t^n^r)+o+a;return(s<<i|s>>>32-i)+t}function f(e,t,n,r,o,i,a){var s=e+(n^(t|~r))+o+a;return(s<<i|s>>>32-i)+t}t.MD5=i._createHelper(u),t.HmacMD5=i._createHmacHelper(u)}(Math),n.MD5)})),C((function(e,t){var n;e.exports=(n=b,void function(){var e=n,t=e.lib.Base,r=e.enc.Utf8;e.algo.HMAC=t.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=r.parse(t));var n=e.blockSize,o=4*n;t.sigBytes>o&&(t=e.finalize(t)),t.clamp();for(var i=this._oKey=t.clone(),a=this._iKey=t.clone(),s=i.words,u=a.words,c=0;c<n;c++)s[c]^=1549556828,u[c]^=909522486;i.sigBytes=a.sigBytes=o,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,n=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(n))}})}())})),C((function(e,t){e.exports=b.HmacMD5}))),A=C((function(e,t){e.exports=b.enc.Utf8})),O=C((function(e,t){var n;e.exports=(n=b,function(){var e=n,t=e.lib.WordArray;function r(e,n,r){for(var o=[],i=0,a=0;a<n;a++)if(a%4){var s=r[e.charCodeAt(a-1)]<<a%4*2,u=r[e.charCodeAt(a)]>>>6-a%4*2;o[i>>>2]|=(s|u)<<24-i%4*8,i++}return t.create(o,i)}e.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp();for(var o=[],i=0;i<n;i+=3)for(var a=(t[i>>>2]>>>24-i%4*8&255)<<16|(t[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|t[i+2>>>2]>>>24-(i+2)%4*8&255,s=0;s<4&&i+.75*s<n;s++)o.push(r.charAt(a>>>6*(3-s)&63));var u=r.charAt(64);if(u)for(;o.length%4;)o.push(u);return o.join("")},parse:function(e){var t=e.length,n=this._map,o=this._reverseMap;if(!o){o=this._reverseMap=[];for(var i=0;i<n.length;i++)o[n.charCodeAt(i)]=i}var a=n.charAt(64);if(a){var s=e.indexOf(a);-1!==s&&(t=s)}return r(e,t,o)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),n.enc.Base64)})),R="FUNCTION",N="OBJECT",w="pending",L="fulfilled",P="rejected";function U(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function G(e){return"object"===U(e)}function x(e){return"function"==typeof e}function F(e){return function(){try{return e.apply(e,arguments)}catch(e){console.error(e)}}}var q="REJECTED",V="NOT_PENDING",B=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.createPromise,r=t.retryRule,o=void 0===r?q:r;(0,_.default)(this,e),this.createPromise=n,this.status=null,this.promise=null,this.retryRule=o}return(0,m.default)(e,[{key:"needRetry",get:function(){if(!this.status)return!0;switch(this.retryRule){case q:return this.status===P;case V:return this.status!==w}}},{key:"exec",value:function(){var e=this;return this.needRetry?(this.status=w,this.promise=this.createPromise().then((function(t){return e.status=L,Promise.resolve(t)}),(function(t){return e.status=P,Promise.reject(t)})),this.promise):this.promise}}]),e}();function j(e){return e&&"string"==typeof e?JSON.parse(e):e}var H="mp-weixin",K=j([]),W=H,Y=(j(void 0),j([])||[]);try{(n("89dd").default||n("89dd")).appid}catch(lr){}var z={};function J(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t=z,n=e,Object.prototype.hasOwnProperty.call(t,n)||(z[e]=r),z[e]}"app"===W&&(z=r._globalUniCloudObj?r._globalUniCloudObj:r._globalUniCloudObj={});var X=["invoke","success","fail","complete"],$=J("_globalUniCloudInterceptor");function Z(e,t){$[e]||($[e]={}),G(t)&&Object.keys(t).forEach((function(n){X.indexOf(n)>-1&&function(e,t,n){var r=$[e][t];r||(r=$[e][t]=[]),-1===r.indexOf(n)&&x(n)&&r.push(n)}(e,n,t[n])}))}function Q(e,t){$[e]||($[e]={}),G(t)?Object.keys(t).forEach((function(n){X.indexOf(n)>-1&&function(e,t,n){var r=$[e][t];if(r){var o=r.indexOf(n);o>-1&&r.splice(o,1)}}(e,n,t[n])})):delete $[e]}function ee(e,t){return e&&0!==e.length?e.reduce((function(e,n){return e.then((function(){return n(t)}))}),Promise.resolve()):Promise.resolve()}function te(e,t){return $[e]&&$[e][t]||[]}function ne(e){Z("callObject",e)}var re=J("_globalUniCloudListener"),oe="response",ie="needLogin",ae="refreshToken",se="clientdb",ue="cloudfunction",ce="cloudobject";function le(e){return re[e]||(re[e]=[]),re[e]}function de(e,t){var n=le(e);n.includes(t)||n.push(t)}function fe(e,t){var n=le(e),r=n.indexOf(t);-1!==r&&n.splice(r,1)}function pe(e,t){for(var n=le(e),r=0;r<n.length;r++)(0,n[r])(t)}var he,ge=!1;function ve(){return he||(he=new Promise((function(e){ge&&e(),function t(){if("function"==typeof getCurrentPages){var n=getCurrentPages();n&&n[0]&&(ge=!0,e())}ge||setTimeout((function(){t()}),30)}()})),he)}function _e(e){var t={};for(var n in e){var r=e[n];x(r)&&(t[n]=F(r))}return t}var me,ye,Ie=function(e){(0,p.default)(n,e);var t=E(n);function n(e){var r;return(0,_.default)(this,n),r=t.call(this,e.message),r.errMsg=e.message||e.errMsg||"unknown system error",r.code=r.errCode=e.code||e.errCode||"SYSTEM_ERROR",r.errSubject=r.subject=e.subject||e.errSubject,r.cause=e.cause,r.requestId=e.requestId,r}return(0,m.default)(n,[{key:"toJson",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!(e>=10))return e++,{errCode:this.errCode,errMsg:this.errMsg,errSubject:this.errSubject,cause:this.cause&&this.cause.toJson?this.cause.toJson(e):this.cause}}}]),n}((0,v.default)(Error)),Me={request:function(e){return r.request(e)},uploadFile:function(e){return r.uploadFile(e)},setStorageSync:function(e,t){return r.setStorageSync(e,t)},getStorageSync:function(e){return r.getStorageSync(e)},removeStorageSync:function(e){return r.removeStorageSync(e)},clearStorageSync:function(){return r.clearStorageSync()}};function Te(){return{token:Me.getStorageSync("uni_id_token")||Me.getStorageSync("uniIdToken"),tokenExpired:Me.getStorageSync("uni_id_token_expired")}}function Se(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.token,n=e.tokenExpired;t&&Me.setStorageSync("uni_id_token",t),n&&Me.setStorageSync("uni_id_token_expired",n)}function Ee(){return me||(me=r.getSystemInfoSync()),me}function Ce(){var e=r.getLocale&&r.getLocale()||"en";if(ye)return S(S({},ye),{},{locale:e,LOCALE:e});for(var t=Ee(),n=t.deviceId,o=t.osName,i=t.uniPlatform,a=t.appId,s=["pixelRatio","brand","model","system","language","version","platform","host","SDKVersion","swanNativeVersion","app","AppPlatform","fontSizeSetting"],u=0;u<s.length;u++)delete t[s[u]];return ye=S(S({PLATFORM:i,OS:o,APPID:a,DEVICEID:n},function(){var e,t;try{if(r.getLaunchOptionsSync){if(r.getLaunchOptionsSync.toString().indexOf("not yet implemented")>-1)return;var n=r.getLaunchOptionsSync(),o=n.scene,i=n.channel;e=i,t=o}}catch(e){}return{channel:e,scene:t}}()),t),S(S({},ye),{},{locale:e,LOCALE:e})}var ke,be={sign:function(e,t){var n="";return Object.keys(e).sort().forEach((function(t){e[t]&&(n=n+"&"+t+"="+e[t])})),n=n.slice(1),D(n,t).toString()},wrappedRequest:function(e,t){return new Promise((function(n,r){t(Object.assign(e,{complete:function(e){e||(e={});var t=e.data&&e.data.header&&e.data.header["x-serverless-request-id"]||e.header&&e.header["request-id"];if(!e.statusCode||e.statusCode>=400)return r(new Ie({code:"SYS_ERR",message:e.errMsg||"request:fail",requestId:t}));var o=e.data;if(o.error)return r(new Ie({code:o.error.code,message:o.error.message,requestId:t}));o.result=o.data,o.requestId=t,delete o.data,n(o)}}))}))},toBase64:function(e){return O.stringify(A.parse(e))}},De=function(){function e(t){var n=this;(0,_.default)(this,e),["spaceId","clientSecret"].forEach((function(e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new Error("".concat(e," required"))})),this.config=Object.assign({},{endpoint:0===t.spaceId.indexOf("mp-")?"https://api.next.bspapp.com":"https://api.bspapp.com"},t),this.config.provider="aliyun",this.config.requestUrl=this.config.endpoint+"/client",this.config.envType=this.config.envType||"public",this.config.accessTokenKey="access_token_"+this.config.spaceId,this.adapter=Me,this._getAccessTokenPromiseHub=new B({createPromise:function(){return n.requestAuth(n.setupRequest({method:"serverless.auth.user.anonymousAuthorize",params:"{}"},"auth")).then((function(e){if(!e.result||!e.result.accessToken)throw new Ie({code:"AUTH_FAILED",message:"获取accessToken失败"});n.setAccessToken(e.result.accessToken)}))},retryRule:V})}return(0,m.default)(e,[{key:"hasAccessToken",get:function(){return!!this.accessToken}},{key:"setAccessToken",value:function(e){this.accessToken=e}},{key:"requestWrapped",value:function(e){return be.wrappedRequest(e,this.adapter.request)}},{key:"requestAuth",value:function(e){return this.requestWrapped(e)}},{key:"request",value:function(e,t){var n=this;return Promise.resolve().then((function(){return n.hasAccessToken?t?n.requestWrapped(e):n.requestWrapped(e).catch((function(t){return new Promise((function(e,n){!t||"GATEWAY_INVALID_TOKEN"!==t.code&&"InvalidParameter.InvalidToken"!==t.code?n(t):e()})).then((function(){return n.getAccessToken()})).then((function(){var t=n.rebuildRequest(e);return n.request(t,!0)}))})):n.getAccessToken().then((function(){var t=n.rebuildRequest(e);return n.request(t,!0)}))}))}},{key:"rebuildRequest",value:function(e){var t=Object.assign({},e);return t.data.token=this.accessToken,t.header["x-basement-token"]=this.accessToken,t.header["x-serverless-sign"]=be.sign(t.data,this.config.clientSecret),t}},{key:"setupRequest",value:function(e,t){var n=Object.assign({},e,{spaceId:this.config.spaceId,timestamp:Date.now()}),r={"Content-Type":"application/json"};return"auth"!==t&&(n.token=this.accessToken,r["x-basement-token"]=this.accessToken),r["x-serverless-sign"]=be.sign(n,this.config.clientSecret),{url:this.config.requestUrl,method:"POST",data:n,dataType:"json",header:r}}},{key:"getAccessToken",value:function(){return this._getAccessTokenPromiseHub.exec()}},{key:"authorize",value:function(){var e=(0,d.default)(a.default.mark((function e(){return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.getAccessToken();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"callFunction",value:function(e){var t={method:"serverless.function.runtime.invoke",params:JSON.stringify({functionTarget:e.name,functionArgs:e.data||{}})};return this.request(this.setupRequest(t))}},{key:"getOSSUploadOptionsFromPath",value:function(e){var t={method:"serverless.file.resource.generateProximalSign",params:JSON.stringify(e)};return this.request(this.setupRequest(t))}},{key:"uploadFileToOSS",value:function(e){var t=this,n=e.url,r=e.formData,o=e.name,i=e.filePath,a=e.fileType,s=e.onUploadProgress;return new Promise((function(e,u){var c=t.adapter.uploadFile({url:n,formData:r,name:o,filePath:i,fileType:a,header:{"X-OSS-server-side-encrpytion":"AES256"},success:function(t){t&&t.statusCode<400?e(t):u(new Ie({code:"UPLOAD_FAILED",message:"文件上传失败"}))},fail:function(e){u(new Ie({code:e.code||"UPLOAD_FAILED",message:e.message||e.errMsg||"文件上传失败"}))}});"function"==typeof s&&c&&"function"==typeof c.onProgressUpdate&&c.onProgressUpdate((function(e){s({loaded:e.totalBytesSent,total:e.totalBytesExpectedToSend})}))}))}},{key:"reportOSSUpload",value:function(e){var t={method:"serverless.file.resource.report",params:JSON.stringify(e)};return this.request(this.setupRequest(t))}},{key:"uploadFile",value:function(){var e=(0,d.default)(a.default.mark((function e(t){var n,r,o,i,s,u,c,l,d,f,p,h,g,v,_,m,y,I,M,T,S,E;return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.filePath,r=t.cloudPath,o=t.fileType,i=void 0===o?"image":o,s=t.cloudPathAsRealPath,u=void 0!==s&&s,c=t.onUploadProgress,l=t.config,"string"===U(r)){e.next=3;break}throw new Ie({code:"INVALID_PARAM",message:"cloudPath必须为字符串类型"});case 3:if(r=r.trim()){e.next=5;break}throw new Ie({code:"INVALID_PARAM",message:"cloudPath不可为空"});case 5:if(!/:\/\//.test(r)){e.next=7;break}throw new Ie({code:"INVALID_PARAM",message:"cloudPath不合法"});case 7:if(d=l&&l.envType||this.config.envType,!(u&&("/"!==r[0]&&(r="/"+r),r.indexOf("\\")>-1))){e.next=10;break}throw new Ie({code:"INVALID_PARAM",message:"使用cloudPath作为路径时，cloudPath不可包含“\\”"});case 10:return e.next=12,this.getOSSUploadOptionsFromPath({env:d,filename:u?r.split("/").pop():r,fileId:u?r:void 0});case 12:return f=e.sent.result,p="https://"+f.cdnDomain+"/"+f.ossPath,h=f.securityToken,g=f.accessKeyId,v=f.signature,_=f.host,m=f.ossPath,y=f.id,I=f.policy,M=f.ossCallbackUrl,T={"Cache-Control":"max-age=2592000","Content-Disposition":"attachment",OSSAccessKeyId:g,Signature:v,host:_,id:y,key:m,policy:I,success_action_status:200},h&&(T["x-oss-security-token"]=h),M&&(S=JSON.stringify({callbackUrl:M,callbackBody:JSON.stringify({fileId:y,spaceId:this.config.spaceId}),callbackBodyType:"application/json"}),T.callback=be.toBase64(S)),E={url:"https://"+f.host,formData:T,fileName:"file",name:"file",filePath:n,fileType:i},e.next=27,this.uploadFileToOSS(Object.assign({},E,{onUploadProgress:c}));case 27:if(!M){e.next=29;break}return e.abrupt("return",{success:!0,filePath:n,fileID:p});case 29:return e.next=31,this.reportOSSUpload({id:y});case 31:if(!e.sent.success){e.next=33;break}return e.abrupt("return",{success:!0,filePath:n,fileID:p});case 33:throw new Ie({code:"UPLOAD_FAILED",message:"文件上传失败"});case 34:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getTempFileURL",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.fileList;return new Promise((function(e,n){Array.isArray(t)&&0!==t.length||n(new Ie({code:"INVALID_PARAM",message:"fileList的元素必须是非空的字符串"})),e({fileList:t.map((function(e){return{fileID:e,tempFileURL:e}}))})}))}},{key:"getFileInfo",value:function(){var e=(0,d.default)(a.default.mark((function e(){var t,n,r,o=arguments;return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=o.length>0&&void 0!==o[0]?o[0]:{},n=t.fileList,Array.isArray(n)&&0!==n.length){e.next=3;break}throw new Ie({code:"INVALID_PARAM",message:"fileList的元素必须是非空的字符串"});case 3:return r={method:"serverless.file.resource.info",params:JSON.stringify({id:n.map((function(e){return e.split("?")[0]})).join(",")})},e.next=6,this.request(this.setupRequest(r));case 6:return e.t0=e.sent.result,e.abrupt("return",{fileList:e.t0});case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),Ae={init:function(e){var t=new De(e),n={signInAnonymously:function(){return t.authorize()},getLoginState:function(){return Promise.resolve(!1)}};return t.auth=function(){return n},t.customAuth=t.auth,t}},Oe="undefined"!=typeof location&&"http:"===location.protocol?"http:":"https:";!function(e){e.local="local",e.none="none",e.session="session"}(ke||(ke={}));var Re,Ne=function(){},we=C((function(e,t){var n;e.exports=(n=b,function(e){var t=n,r=t.lib,o=r.WordArray,i=r.Hasher,a=t.algo,s=[],u=[];!function(){function t(t){for(var n=e.sqrt(t),r=2;r<=n;r++)if(!(t%r))return!1;return!0}function n(e){return 4294967296*(e-(0|e))|0}for(var r=2,o=0;o<64;)t(r)&&(o<8&&(s[o]=n(e.pow(r,.5))),u[o]=n(e.pow(r,1/3)),o++),r++}();var c=[],l=a.SHA256=i.extend({_doReset:function(){this._hash=new o.init(s.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],o=n[1],i=n[2],a=n[3],s=n[4],l=n[5],d=n[6],f=n[7],p=0;p<64;p++){if(p<16)c[p]=0|e[t+p];else{var h=c[p-15],g=(h<<25|h>>>7)^(h<<14|h>>>18)^h>>>3,v=c[p-2],_=(v<<15|v>>>17)^(v<<13|v>>>19)^v>>>10;c[p]=g+c[p-7]+_+c[p-16]}var m=r&o^r&i^o&i,y=(r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22),I=f+((s<<26|s>>>6)^(s<<21|s>>>11)^(s<<7|s>>>25))+(s&l^~s&d)+u[p]+c[p];f=d,d=l,l=s,s=a+I|0,a=i,i=o,o=r,r=I+(y+m)|0}n[0]=n[0]+r|0,n[1]=n[1]+o|0,n[2]=n[2]+i|0,n[3]=n[3]+a|0,n[4]=n[4]+s|0,n[5]=n[5]+l|0,n[6]=n[6]+d|0,n[7]=n[7]+f|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,o=8*t.sigBytes;return n[o>>>5]|=128<<24-o%32,n[14+(o+64>>>9<<4)]=e.floor(r/4294967296),n[15+(o+64>>>9<<4)]=r,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=i._createHelper(l),t.HmacSHA256=i._createHmacHelper(l)}(Math),n.SHA256)})),Le=we,Pe=C((function(e,t){e.exports=b.HmacSHA256})),Ue=function(){var e;if(!Promise){e=function(){},e.promise={};var t=function(){throw new Ie({message:'Your Node runtime does support ES6 Promises. Set "global.Promise" to your preferred implementation of promises.'})};return Object.defineProperty(e.promise,"then",{get:t}),Object.defineProperty(e.promise,"catch",{get:t}),e}var n=new Promise((function(t,n){e=function(e,r){return e?n(e):t(r)}}));return e.promise=n,e};function Ge(e){return void 0===e}function xe(e){return"[object Null]"===Object.prototype.toString.call(e)}!function(e){e.WEB="web",e.WX_MP="wx_mp"}(Re||(Re={}));var Fe={adapter:null,runtime:void 0},qe=["anonymousUuidKey"],Ve=function(e){(0,p.default)(n,e);var t=E(n);function n(){var e;return(0,_.default)(this,n),e=t.call(this),Fe.adapter.root.tcbObject||(Fe.adapter.root.tcbObject={}),e}return(0,m.default)(n,[{key:"setItem",value:function(e,t){Fe.adapter.root.tcbObject[e]=t}},{key:"getItem",value:function(e){return Fe.adapter.root.tcbObject[e]}},{key:"removeItem",value:function(e){delete Fe.adapter.root.tcbObject[e]}},{key:"clear",value:function(){delete Fe.adapter.root.tcbObject}}]),n}(Ne);function Be(e,t){switch(e){case"local":return t.localStorage||new Ve;case"none":return new Ve;default:return t.sessionStorage||new Ve}}var je=function(){function e(t){if((0,_.default)(this,e),!this._storage){this._persistence=Fe.adapter.primaryStorage||t.persistence,this._storage=Be(this._persistence,Fe.adapter);var n="access_token_".concat(t.env),r="access_token_expire_".concat(t.env),o="refresh_token_".concat(t.env),i="anonymous_uuid_".concat(t.env),a="login_type_".concat(t.env),s="user_info_".concat(t.env);this.keys={accessTokenKey:n,accessTokenExpireKey:r,refreshTokenKey:o,anonymousUuidKey:i,loginTypeKey:a,userInfoKey:s}}}return(0,m.default)(e,[{key:"updatePersistence",value:function(e){if(e!==this._persistence){var t="local"===this._persistence;this._persistence=e;var n=Be(e,Fe.adapter);for(var r in this.keys){var o=this.keys[r];if(!t||!qe.includes(r)){var i=this._storage.getItem(o);Ge(i)||xe(i)||(n.setItem(o,i),this._storage.removeItem(o))}}this._storage=n}}},{key:"setStore",value:function(e,t,n){if(this._storage){var r={version:n||"localCachev1",content:t},o=JSON.stringify(r);try{this._storage.setItem(e,o)}catch(e){throw e}}}},{key:"getStore",value:function(e,t){try{if(!this._storage)return}catch(e){return""}t=t||"localCachev1";var n=this._storage.getItem(e);return n&&n.indexOf(t)>=0?JSON.parse(n).content:""}},{key:"removeStore",value:function(e){this._storage.removeItem(e)}}]),e}(),He={},Ke={};function We(e){return He[e]}var Ye=(0,m.default)((function e(t,n){(0,_.default)(this,e),this.data=n||null,this.name=t})),ze=function(e){(0,p.default)(n,e);var t=E(n);function n(e,r){var o;return(0,_.default)(this,n),o=t.call(this,"error",{error:e,data:r}),o.error=e,o}return(0,m.default)(n)}(Ye),Je=new(function(){function e(){(0,_.default)(this,e),this._listeners={}}return(0,m.default)(e,[{key:"on",value:function(e,t){return function(e,t,n){n[e]=n[e]||[],n[e].push(t)}(e,t,this._listeners),this}},{key:"off",value:function(e,t){return function(e,t,n){if(n&&n[e]){var r=n[e].indexOf(t);-1!==r&&n[e].splice(r,1)}}(e,t,this._listeners),this}},{key:"fire",value:function(e,t){if(e instanceof ze)return console.error(e.error),this;var n="string"==typeof e?new Ye(e,t||{}):e,r=n.name;if(this._listens(r)){n.target=this;var o,i=this._listeners[r]?(0,l.default)(this._listeners[r]):[],a=I(i);try{for(a.s();!(o=a.n()).done;){var s=o.value;s.call(this,n)}}catch(u){a.e(u)}finally{a.f()}}return this}},{key:"_listens",value:function(e){return this._listeners[e]&&this._listeners[e].length>0}}]),e}());function Xe(e,t){Je.on(e,t)}function $e(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Je.fire(e,t)}function Ze(e,t){Je.off(e,t)}var Qe,et="loginStateChanged",tt="loginStateExpire",nt="loginTypeChanged",rt="anonymousConverted",ot="refreshAccessToken";!function(e){e.ANONYMOUS="ANONYMOUS",e.WECHAT="WECHAT",e.WECHAT_PUBLIC="WECHAT-PUBLIC",e.WECHAT_OPEN="WECHAT-OPEN",e.CUSTOM="CUSTOM",e.EMAIL="EMAIL",e.USERNAME="USERNAME",e.NULL="NULL"}(Qe||(Qe={}));var it=["auth.getJwt","auth.logout","auth.signInWithTicket","auth.signInAnonymously","auth.signIn","auth.fetchAccessTokenWithRefreshToken","auth.signUpWithEmailAndPassword","auth.activateEndUserMail","auth.sendPasswordResetEmail","auth.resetPasswordWithToken","auth.isUsernameRegistered"],at={"X-SDK-Version":"1.3.5"};function st(e,t,n){var r=e[t];e[t]=function(t){var o={},i={};n.forEach((function(n){var r=n.call(e,t),a=r.data,s=r.headers;Object.assign(o,a),Object.assign(i,s)}));var a=t.data;return a&&function(){var e;if(e=a,"[object FormData]"!==Object.prototype.toString.call(e))t.data=S(S({},a),o);else for(var n in o)a.append(n,o[n])}(),t.headers=S(S({},t.headers||{}),i),r.call(e,t)}}function ut(){var e=Math.random().toString(16).slice(2);return{data:{seqId:e},headers:S(S({},at),{},{"x-seqid":e})}}var ct=function(){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,_.default)(this,e),this.config=n,this._reqClass=new Fe.adapter.reqClass({timeout:this.config.timeout,timeoutMsg:"请求在".concat(this.config.timeout/1e3,"s内未完成，已中断"),restrictedMethods:["post"]}),this._cache=We(this.config.env),this._localCache=(t=this.config.env,Ke[t]),st(this._reqClass,"post",[ut]),st(this._reqClass,"upload",[ut]),st(this._reqClass,"download",[ut])}return(0,m.default)(e,[{key:"post",value:function(){var e=(0,d.default)(a.default.mark((function e(t){return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this._reqClass.post(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"upload",value:function(){var e=(0,d.default)(a.default.mark((function e(t){return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this._reqClass.upload(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"download",value:function(){var e=(0,d.default)(a.default.mark((function e(t){return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this._reqClass.download(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"refreshAccessToken",value:function(){var e=(0,d.default)(a.default.mark((function e(){var t,n;return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this._refreshAccessTokenPromise||(this._refreshAccessTokenPromise=this._refreshAccessToken()),e.prev=1,e.next=4,this._refreshAccessTokenPromise;case 4:t=e.sent,e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](1),n=e.t0;case 10:if(this._refreshAccessTokenPromise=null,this._shouldRefreshAccessTokenHook=null,!n){e.next=12;break}throw n;case 12:return e.abrupt("return",t);case 13:case"end":return e.stop()}}),e,this,[[1,7]])})));return function(){return e.apply(this,arguments)}}()},{key:"_refreshAccessToken",value:function(){var e=(0,d.default)(a.default.mark((function e(){var t,n,r,o,i,s,u,c,l,d,f,p,h;return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=this._cache.keys,n=t.accessTokenKey,r=t.accessTokenExpireKey,o=t.refreshTokenKey,i=t.loginTypeKey,s=t.anonymousUuidKey,this._cache.removeStore(n),this._cache.removeStore(r),u=this._cache.getStore(o),u){e.next=5;break}throw new Ie({message:"未登录CloudBase"});case 5:return c={refresh_token:u},e.next=8,this.request("auth.fetchAccessTokenWithRefreshToken",c);case 8:if(l=e.sent,!l.data.code){e.next=21;break}if(d=l.data.code,"SIGN_PARAM_INVALID"!==d&&"REFRESH_TOKEN_EXPIRED"!==d&&"INVALID_REFRESH_TOKEN"!==d){e.next=20;break}if(this._cache.getStore(i)!==Qe.ANONYMOUS||"INVALID_REFRESH_TOKEN"!==d){e.next=19;break}return f=this._cache.getStore(s),p=this._cache.getStore(o),e.next=17,this.send("auth.signInAnonymously",{anonymous_uuid:f,refresh_token:p});case 17:return h=e.sent,e.abrupt("return",(this.setRefreshToken(h.refresh_token),this._refreshAccessToken()));case 19:$e(tt),this._cache.removeStore(o);case 20:throw new Ie({code:l.data.code,message:"刷新access token失败：".concat(l.data.code)});case 21:if(!l.data.access_token){e.next=23;break}return e.abrupt("return",($e(ot),this._cache.setStore(n,l.data.access_token),this._cache.setStore(r,l.data.access_token_expire+Date.now()),{accessToken:l.data.access_token,accessTokenExpire:l.data.access_token_expire}));case 23:l.data.refresh_token&&(this._cache.removeStore(o),this._cache.setStore(o,l.data.refresh_token),this._refreshAccessToken());case 24:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getAccessToken",value:function(){var e=(0,d.default)(a.default.mark((function e(){var t,n,r,o,i,s,u;return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=this._cache.keys,n=t.accessTokenKey,r=t.accessTokenExpireKey,o=t.refreshTokenKey,this._cache.getStore(o)){e.next=3;break}throw new Ie({message:"refresh token不存在，登录状态异常"});case 3:if(i=this._cache.getStore(n),s=this._cache.getStore(r),u=!0,e.t0=this._shouldRefreshAccessTokenHook,!e.t0){e.next=9;break}return e.next=8,this._shouldRefreshAccessTokenHook(i,s);case 8:e.t0=!e.sent;case 9:if(e.t1=e.t0,!e.t1){e.next=12;break}u=!1;case 12:return e.abrupt("return",(!i||!s||s<Date.now())&&u?this.refreshAccessToken():{accessToken:i,accessTokenExpire:s});case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"request",value:function(){var e=(0,d.default)(a.default.mark((function e(t,n,r){var o,i,s,u,c,l,d,f,p,h,g,v,_,m,y,I;return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(o="x-tcb-trace_".concat(this.config.env),i="application/x-www-form-urlencoded",s=S({action:t,env:this.config.env,dataVersion:"2019-08-16"},n),-1!==it.indexOf(t)){e.next=10;break}if(u=this._cache.keys.refreshTokenKey,e.t0=this._cache.getStore(u),!e.t0){e.next=10;break}return e.next=9,this.getAccessToken();case 9:s.access_token=e.sent.accessToken;case 10:if("storage.uploadFile"===t){for(l in c=new FormData,c)c.hasOwnProperty(l)&&void 0!==c[l]&&c.append(l,s[l]);i="multipart/form-data"}else for(d in i="application/json",c={},s)void 0!==s[d]&&(c[d]=s[d]);return f={headers:{"content-type":i}},r&&r.onUploadProgress&&(f.onUploadProgress=r.onUploadProgress),p=this._localCache.getStore(o),p&&(f.headers["X-TCB-Trace"]=p),h=n.parse,g=n.inQuery,v=n.search,_={env:this.config.env},h&&(_.parse=!0),g&&(_=S(S({},g),_)),m=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=/\?/.test(t),o="";for(var i in n)""===o?!r&&(t+="?"):o+="&",o+="".concat(i,"=").concat(encodeURIComponent(n[i]));return/^http(s)?\:\/\//.test(t+=o)?t:"".concat(e).concat(t)}(Oe,"//tcb-api.tencentcloudapi.com/web",_),v&&(m+=v),e.next=22,this.post(S({url:m,data:c},f));case 22:if(y=e.sent,I=y.header&&y.header["x-tcb-trace"],I&&this._localCache.setStore(o,I),(200===Number(y.status)||200===Number(y.statusCode))&&y.data){e.next=26;break}throw new Ie({code:"NETWORK_ERROR",message:"network request error"});case 26:return e.abrupt("return",y);case 27:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"send",value:function(){var e=(0,d.default)(a.default.mark((function e(t){var n,r,o,i=arguments;return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:{},e.next=3,this.request(t,n,{onUploadProgress:n.onUploadProgress});case 3:if(r=e.sent,"ACCESS_TOKEN_EXPIRED"!==r.data.code||-1!==it.indexOf(t)){e.next=13;break}return e.next=7,this.refreshAccessToken();case 7:return e.next=9,this.request(t,n,{onUploadProgress:n.onUploadProgress});case 9:if(o=e.sent,!o.data.code){e.next=12;break}throw new Ie({code:o.data.code,message:o.data.message});case 12:return e.abrupt("return",o.data);case 13:if(!r.data.code){e.next=15;break}throw new Ie({code:r.data.code,message:r.data.message});case 15:return e.abrupt("return",r.data);case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setRefreshToken",value:function(e){var t=this._cache.keys,n=t.accessTokenKey,r=t.accessTokenExpireKey,o=t.refreshTokenKey;this._cache.removeStore(n),this._cache.removeStore(r),this._cache.setStore(o,e)}}]),e}(),lt={};function dt(e){return lt[e]}var ft=function(){function e(t){(0,_.default)(this,e),this.config=t,this._cache=We(t.env),this._request=dt(t.env)}return(0,m.default)(e,[{key:"setRefreshToken",value:function(e){var t=this._cache.keys,n=t.accessTokenKey,r=t.accessTokenExpireKey,o=t.refreshTokenKey;this._cache.removeStore(n),this._cache.removeStore(r),this._cache.setStore(o,e)}},{key:"setAccessToken",value:function(e,t){var n=this._cache.keys,r=n.accessTokenKey,o=n.accessTokenExpireKey;this._cache.setStore(r,e),this._cache.setStore(o,t)}},{key:"refreshUserInfo",value:function(){var e=(0,d.default)(a.default.mark((function e(){var t,n;return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this._request.send("auth.getUserInfo",{});case 2:return t=e.sent,n=t.data,e.abrupt("return",(this.setLocalUserInfo(n),n));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setLocalUserInfo",value:function(e){var t=this._cache.keys.userInfoKey;this._cache.setStore(t,e)}}]),e}(),pt=function(){function e(t){if((0,_.default)(this,e),!t)throw new Ie({code:"PARAM_ERROR",message:"envId is not defined"});this._envId=t,this._cache=We(this._envId),this._request=dt(this._envId),this.setUserInfo()}return(0,m.default)(e,[{key:"linkWithTicket",value:function(e){if("string"!=typeof e)throw new Ie({code:"PARAM_ERROR",message:"ticket must be string"});return this._request.send("auth.linkWithTicket",{ticket:e})}},{key:"linkWithRedirect",value:function(e){e.signInWithRedirect()}},{key:"updatePassword",value:function(e,t){return this._request.send("auth.updatePassword",{oldPassword:t,newPassword:e})}},{key:"updateEmail",value:function(e){return this._request.send("auth.updateEmail",{newEmail:e})}},{key:"updateUsername",value:function(e){if("string"!=typeof e)throw new Ie({code:"PARAM_ERROR",message:"username must be a string"});return this._request.send("auth.updateUsername",{username:e})}},{key:"getLinkedUidList",value:function(){var e=(0,d.default)(a.default.mark((function e(){var t,n,r,o;return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this._request.send("auth.getLinkedUidList",{});case 2:return t=e.sent,n=t.data,r=!1,o=n.users,e.abrupt("return",(o.forEach((function(e){e.wxOpenId&&e.wxPublicId&&(r=!0)})),{users:o,hasPrimaryUid:r}));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setPrimaryUid",value:function(e){return this._request.send("auth.setPrimaryUid",{uid:e})}},{key:"unlink",value:function(e){return this._request.send("auth.unlink",{platform:e})}},{key:"update",value:function(){var e=(0,d.default)(a.default.mark((function e(t){var n,r,o,i,s,u,c,l;return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.nickName,r=t.gender,o=t.avatarUrl,i=t.province,s=t.country,u=t.city,e.next=8,this._request.send("auth.updateUserInfo",{nickName:n,gender:r,avatarUrl:o,province:i,country:s,city:u});case 8:c=e.sent,l=c.data,this.setLocalUserInfo(l);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"refresh",value:function(){var e=(0,d.default)(a.default.mark((function e(){var t,n;return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this._request.send("auth.getUserInfo",{});case 2:return t=e.sent,n=t.data,e.abrupt("return",(this.setLocalUserInfo(n),n));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setUserInfo",value:function(){var e=this,t=this._cache.keys.userInfoKey,n=this._cache.getStore(t);["uid","loginType","openid","wxOpenId","wxPublicId","unionId","qqMiniOpenId","email","hasPassword","customUserId","nickName","gender","avatarUrl"].forEach((function(t){e[t]=n[t]})),this.location={country:n.country,province:n.province,city:n.city}}},{key:"setLocalUserInfo",value:function(e){var t=this._cache.keys.userInfoKey;this._cache.setStore(t,e),this.setUserInfo()}}]),e}(),ht=function(){function e(t){if((0,_.default)(this,e),!t)throw new Ie({code:"PARAM_ERROR",message:"envId is not defined"});this._cache=We(t);var n=this._cache.keys,r=n.refreshTokenKey,o=n.accessTokenKey,i=n.accessTokenExpireKey,a=this._cache.getStore(r),s=this._cache.getStore(o),u=this._cache.getStore(i);this.credential={refreshToken:a,accessToken:s,accessTokenExpire:u},this.user=new pt(t)}return(0,m.default)(e,[{key:"isAnonymousAuth",get:function(){return this.loginType===Qe.ANONYMOUS}},{key:"isCustomAuth",get:function(){return this.loginType===Qe.CUSTOM}},{key:"isWeixinAuth",get:function(){return this.loginType===Qe.WECHAT||this.loginType===Qe.WECHAT_OPEN||this.loginType===Qe.WECHAT_PUBLIC}},{key:"loginType",get:function(){return this._cache.getStore(this._cache.keys.loginTypeKey)}}]),e}(),gt=function(e){(0,p.default)(n,e);var t=E(n);function n(){return(0,_.default)(this,n),t.apply(this,arguments)}return(0,m.default)(n,[{key:"signIn",value:function(){var e=(0,d.default)(a.default.mark((function e(){var t,n,r,o,i,s,u;return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this._cache.updatePersistence("local"),t=this._cache.keys,n=t.anonymousUuidKey,r=t.refreshTokenKey,o=this._cache.getStore(n)||void 0,i=this._cache.getStore(r)||void 0,e.next=8,this._request.send("auth.signInAnonymously",{anonymous_uuid:o,refresh_token:i});case 8:if(s=e.sent,!s.uuid||!s.refresh_token){e.next=20;break}return this._setAnonymousUUID(s.uuid),this.setRefreshToken(s.refresh_token),e.next=14,this._request.refreshAccessToken();case 14:return $e(et),$e(nt,{env:this.config.env,loginType:Qe.ANONYMOUS,persistence:"local"}),u=new ht(this.config.env),e.next=19,u.user.refresh();case 19:return e.abrupt("return",u);case 20:throw new Ie({message:"匿名登录失败"});case 21:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"linkAndRetrieveDataWithTicket",value:function(){var e=(0,d.default)(a.default.mark((function e(t){var n,r,o,i,s,u;return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=this._cache.keys,r=n.anonymousUuidKey,o=n.refreshTokenKey,i=this._cache.getStore(r),s=this._cache.getStore(o),e.next=7,this._request.send("auth.linkAndRetrieveDataWithTicket",{anonymous_uuid:i,refresh_token:s,ticket:t});case 7:if(u=e.sent,!u.refresh_token){e.next=16;break}return this._clearAnonymousUUID(),this.setRefreshToken(u.refresh_token),e.next=13,this._request.refreshAccessToken();case 13:return $e(rt,{env:this.config.env}),$e(nt,{loginType:Qe.CUSTOM,persistence:"local"}),e.abrupt("return",{credential:{refreshToken:u.refresh_token}});case 16:throw new Ie({message:"匿名转化失败"});case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_setAnonymousUUID",value:function(e){var t=this._cache.keys,n=t.anonymousUuidKey,r=t.loginTypeKey;this._cache.removeStore(n),this._cache.setStore(n,e),this._cache.setStore(r,Qe.ANONYMOUS)}},{key:"_clearAnonymousUUID",value:function(){this._cache.removeStore(this._cache.keys.anonymousUuidKey)}}]),n}(ft),vt=function(e){(0,p.default)(n,e);var t=E(n);function n(){return(0,_.default)(this,n),t.apply(this,arguments)}return(0,m.default)(n,[{key:"signIn",value:function(){var e=(0,d.default)(a.default.mark((function e(t){var n,r;return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("string"==typeof t){e.next=2;break}throw new Ie({code:"PARAM_ERROR",message:"ticket must be a string"});case 2:return n=this._cache.keys.refreshTokenKey,e.next=5,this._request.send("auth.signInWithTicket",{ticket:t,refresh_token:this._cache.getStore(n)||""});case 5:if(r=e.sent,!r.refresh_token){e.next=15;break}return this.setRefreshToken(r.refresh_token),e.next=10,this._request.refreshAccessToken();case 10:return $e(et),$e(nt,{env:this.config.env,loginType:Qe.CUSTOM,persistence:this.config.persistence}),e.next=14,this.refreshUserInfo();case 14:return e.abrupt("return",new ht(this.config.env));case 15:throw new Ie({message:"自定义登录失败"});case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(ft),_t=function(e){(0,p.default)(n,e);var t=E(n);function n(){return(0,_.default)(this,n),t.apply(this,arguments)}return(0,m.default)(n,[{key:"signIn",value:function(){var e=(0,d.default)(a.default.mark((function e(t,n){var r,o,i,s,u;return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("string"==typeof t){e.next=2;break}throw new Ie({code:"PARAM_ERROR",message:"email must be a string"});case 2:return r=this._cache.keys.refreshTokenKey,e.next=5,this._request.send("auth.signIn",{loginType:"EMAIL",email:t,password:n,refresh_token:this._cache.getStore(r)||""});case 5:if(o=e.sent,i=o.refresh_token,s=o.access_token,u=o.access_token_expire,!i){e.next=22;break}if(this.setRefreshToken(i),!s||!u){e.next=15;break}this.setAccessToken(s,u),e.next=17;break;case 15:return e.next=17,this._request.refreshAccessToken();case 17:return e.next=19,this.refreshUserInfo();case 19:return $e(et),$e(nt,{env:this.config.env,loginType:Qe.EMAIL,persistence:this.config.persistence}),e.abrupt("return",new ht(this.config.env));case 22:throw o.code?new Ie({code:o.code,message:"邮箱登录失败: ".concat(o.message)}):new Ie({message:"邮箱登录失败"});case 23:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"activate",value:function(){var e=(0,d.default)(a.default.mark((function e(t){return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",this._request.send("auth.activateEndUserMail",{token:t}));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"resetPasswordWithToken",value:function(){var e=(0,d.default)(a.default.mark((function e(t,n){return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",this._request.send("auth.resetPasswordWithToken",{token:t,newPassword:n}));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(ft),mt=function(e){(0,p.default)(n,e);var t=E(n);function n(){return(0,_.default)(this,n),t.apply(this,arguments)}return(0,m.default)(n,[{key:"signIn",value:function(){var e=(0,d.default)(a.default.mark((function e(t,n){var r,o,i,s,u;return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("string"==typeof t){e.next=2;break}throw new Ie({code:"PARAM_ERROR",message:"username must be a string"});case 2:return"string"!=typeof n&&(n="",console.warn("password is empty")),r=this._cache.keys.refreshTokenKey,e.next=6,this._request.send("auth.signIn",{loginType:Qe.USERNAME,username:t,password:n,refresh_token:this._cache.getStore(r)||""});case 6:if(o=e.sent,i=o.refresh_token,s=o.access_token_expire,u=o.access_token,!i){e.next=23;break}if(this.setRefreshToken(i),!u||!s){e.next=16;break}this.setAccessToken(u,s),e.next=18;break;case 16:return e.next=18,this._request.refreshAccessToken();case 18:return e.next=20,this.refreshUserInfo();case 20:return $e(et),$e(nt,{env:this.config.env,loginType:Qe.USERNAME,persistence:this.config.persistence}),e.abrupt("return",new ht(this.config.env));case 23:throw o.code?new Ie({code:o.code,message:"用户名密码登录失败: ".concat(o.message)}):new Ie({message:"用户名密码登录失败"});case 24:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(ft),yt=function(){function e(t){(0,_.default)(this,e),this.config=t,this._cache=We(t.env),this._request=dt(t.env),this._onAnonymousConverted=this._onAnonymousConverted.bind(this),this._onLoginTypeChanged=this._onLoginTypeChanged.bind(this),Xe(nt,this._onLoginTypeChanged)}return(0,m.default)(e,[{key:"currentUser",get:function(){var e=this.hasLoginState();return e&&e.user||null}},{key:"loginType",get:function(){return this._cache.getStore(this._cache.keys.loginTypeKey)}},{key:"anonymousAuthProvider",value:function(){return new gt(this.config)}},{key:"customAuthProvider",value:function(){return new vt(this.config)}},{key:"emailAuthProvider",value:function(){return new _t(this.config)}},{key:"usernameAuthProvider",value:function(){return new mt(this.config)}},{key:"signInAnonymously",value:function(){var e=(0,d.default)(a.default.mark((function e(){return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new gt(this.config).signIn());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"signInWithEmailAndPassword",value:function(){var e=(0,d.default)(a.default.mark((function e(t,n){return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new _t(this.config).signIn(t,n));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"signInWithUsernameAndPassword",value:function(e,t){return new mt(this.config).signIn(e,t)}},{key:"linkAndRetrieveDataWithTicket",value:function(){var e=(0,d.default)(a.default.mark((function e(t){return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this._anonymousAuthProvider||(this._anonymousAuthProvider=new gt(this.config)),Xe(rt,this._onAnonymousConverted),e.next=3,this._anonymousAuthProvider.linkAndRetrieveDataWithTicket(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"signOut",value:function(){var e=(0,d.default)(a.default.mark((function e(){var t,n,r,o,i,s;return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.loginType!==Qe.ANONYMOUS){e.next=2;break}throw new Ie({message:"匿名用户不支持登出操作"});case 2:if(t=this._cache.keys,n=t.refreshTokenKey,r=t.accessTokenKey,o=t.accessTokenExpireKey,i=this._cache.getStore(n),i){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,this._request.send("auth.logout",{refresh_token:i});case 7:return s=e.sent,e.abrupt("return",(this._cache.removeStore(n),this._cache.removeStore(r),this._cache.removeStore(o),$e(et),$e(nt,{env:this.config.env,loginType:Qe.NULL,persistence:this.config.persistence}),s));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"signUpWithEmailAndPassword",value:function(){var e=(0,d.default)(a.default.mark((function e(t,n){return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",this._request.send("auth.signUpWithEmailAndPassword",{email:t,password:n}));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"sendPasswordResetEmail",value:function(){var e=(0,d.default)(a.default.mark((function e(t){return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",this._request.send("auth.sendPasswordResetEmail",{email:t}));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onLoginStateChanged",value:function(e){var t=this;Xe(et,(function(){var n=t.hasLoginState();e.call(t,n)}));var n=this.hasLoginState();e.call(this,n)}},{key:"onLoginStateExpired",value:function(e){Xe(tt,e.bind(this))}},{key:"onAccessTokenRefreshed",value:function(e){Xe(ot,e.bind(this))}},{key:"onAnonymousConverted",value:function(e){Xe(rt,e.bind(this))}},{key:"onLoginTypeChanged",value:function(e){var t=this;Xe(nt,(function(){var n=t.hasLoginState();e.call(t,n)}))}},{key:"getAccessToken",value:function(){var e=(0,d.default)(a.default.mark((function e(){return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this._request.getAccessToken();case 2:return e.t0=e.sent.accessToken,e.t1=this.config.env,e.abrupt("return",{accessToken:e.t0,env:e.t1});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"hasLoginState",value:function(){var e=this._cache.keys.refreshTokenKey;return this._cache.getStore(e)?new ht(this.config.env):null}},{key:"isUsernameRegistered",value:function(){var e=(0,d.default)(a.default.mark((function e(t){var n,r;return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("string"==typeof t){e.next=2;break}throw new Ie({code:"PARAM_ERROR",message:"username must be a string"});case 2:return e.next=4,this._request.send("auth.isUsernameRegistered",{username:t});case 4:return n=e.sent,r=n.data,e.abrupt("return",r&&r.isRegistered);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getLoginState",value:function(){return Promise.resolve(this.hasLoginState())}},{key:"signInWithTicket",value:function(){var e=(0,d.default)(a.default.mark((function e(t){return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new vt(this.config).signIn(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"shouldRefreshAccessToken",value:function(e){this._request._shouldRefreshAccessTokenHook=e.bind(this)}},{key:"getUserInfo",value:function(){return this._request.send("auth.getUserInfo",{}).then((function(e){return e.code?e:S(S({},e.data),{},{requestId:e.seqId})}))}},{key:"getAuthHeader",value:function(){var e=this._cache.keys,t=e.refreshTokenKey,n=e.accessTokenKey,r=this._cache.getStore(t);return{"x-cloudbase-credentials":this._cache.getStore(n)+"/@@/"+r}}},{key:"_onAnonymousConverted",value:function(e){var t=e.data.env;t===this.config.env&&this._cache.updatePersistence(this.config.persistence)}},{key:"_onLoginTypeChanged",value:function(e){var t=e.data,n=t.loginType,r=t.persistence,o=t.env;o===this.config.env&&(this._cache.updatePersistence(r),this._cache.setStore(this._cache.keys.loginTypeKey,n))}}]),e}(),It=function(e,t){t=t||Ue();var n=dt(this.config.env),r=e.cloudPath,o=e.filePath,i=e.onUploadProgress,a=e.fileType,s=void 0===a?"image":a;return n.send("storage.getUploadMetadata",{path:r}).then((function(e){var a=e.data,u=a.url,c=a.authorization,l=a.token,d=a.fileId,f=a.cosFileId,p=e.requestId,h={key:r,signature:c,"x-cos-meta-fileid":f,success_action_status:"201","x-cos-security-token":l};n.upload({url:u,data:h,file:o,name:r,fileType:s,onUploadProgress:i}).then((function(e){201===e.statusCode?t(null,{fileID:d,requestId:p}):t(new Ie({code:"STORAGE_REQUEST_FAIL",message:"STORAGE_REQUEST_FAIL: ".concat(e.data)}))})).catch((function(e){t(e)}))})).catch((function(e){t(e)})),t.promise},Mt=function(e,t){t=t||Ue();var n=dt(this.config.env),r=e.cloudPath;return n.send("storage.getUploadMetadata",{path:r}).then((function(e){t(null,e)})).catch((function(e){t(e)})),t.promise},Tt=function(e,t){var n=e.fileList;if(t=t||Ue(),!n||!Array.isArray(n))return{code:"INVALID_PARAM",message:"fileList必须是非空的数组"};var r,o=I(n);try{for(o.s();!(r=o.n()).done;){var i=r.value;if(!i||"string"!=typeof i)return{code:"INVALID_PARAM",message:"fileList的元素必须是非空的字符串"}}}catch(s){o.e(s)}finally{o.f()}var a={fileid_list:n};return dt(this.config.env).send("storage.batchDeleteFile",a).then((function(e){e.code?t(null,e):t(null,{fileList:e.data.delete_list,requestId:e.requestId})})).catch((function(e){t(e)})),t.promise},St=function(e,t){var n=e.fileList;t=t||Ue(),n&&Array.isArray(n)||t(null,{code:"INVALID_PARAM",message:"fileList必须是非空的数组"});var r,o=[],i=I(n);try{for(i.s();!(r=i.n()).done;){var a=r.value;"object"==(0,c.default)(a)?(a.hasOwnProperty("fileID")&&a.hasOwnProperty("maxAge")||t(null,{code:"INVALID_PARAM",message:"fileList的元素必须是包含fileID和maxAge的对象"}),o.push({fileid:a.fileID,max_age:a.maxAge})):"string"==typeof a?o.push({fileid:a}):t(null,{code:"INVALID_PARAM",message:"fileList的元素必须是字符串"})}}catch(u){i.e(u)}finally{i.f()}var s={file_list:o};return dt(this.config.env).send("storage.batchGetDownloadUrl",s).then((function(e){e.code?t(null,e):t(null,{fileList:e.data.download_list,requestId:e.requestId})})).catch((function(e){t(e)})),t.promise},Et=function(){var e=(0,d.default)(a.default.mark((function e(t,n){var r,o,i,s;return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=t.fileID,e.next=3,St.call(this,{fileList:[{fileID:r,maxAge:600}]});case 3:if(o=e.sent.fileList[0],"SUCCESS"===o.code){e.next=6;break}return e.abrupt("return",n?n(o):new Promise((function(e){e(o)})));case 6:if(i=dt(this.config.env),s=o.download_url,s=encodeURI(s),n){e.next=10;break}return e.abrupt("return",i.download({url:s}));case 10:return e.t0=n,e.next=13,i.download({url:s});case 13:e.t1=e.sent,(0,e.t0)(e.t1);case 15:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),Ct=function(e,t){var n,r=e.name,o=e.data,i=e.query,a=e.parse,s=e.search,u=t||Ue();try{n=o?JSON.stringify(o):""}catch(r){return Promise.reject(r)}if(!r)return Promise.reject(new Ie({code:"PARAM_ERROR",message:"函数名不能为空"}));var c={inQuery:i,parse:a,search:s,function_name:r,request_data:n};return dt(this.config.env).send("functions.invokeFunction",c).then((function(e){if(e.code)u(null,e);else{var t=e.data.response_data;if(a)u(null,{result:t,requestId:e.requestId});else try{t=JSON.parse(e.data.response_data),u(null,{result:t,requestId:e.requestId})}catch(e){u(new Ie({message:"response data must be json"}))}}return u.promise})).catch((function(e){u(e)})),u.promise},kt={timeout:15e3,persistence:"session"},bt={},Dt=function(){function e(t){(0,_.default)(this,e),this.config=t||this.config,this.authObj=void 0}return(0,m.default)(e,[{key:"init",value:function(t){switch(Fe.adapter||(this.requestClient=new Fe.adapter.reqClass({timeout:t.timeout||5e3,timeoutMsg:"请求在".concat((t.timeout||5e3)/1e3,"s内未完成，已中断")})),this.config=S(S({},kt),t),!0){case this.config.timeout>6e5:console.warn("timeout大于可配置上限[10分钟]，已重置为上限数值"),this.config.timeout=6e5;break;case this.config.timeout<100:console.warn("timeout小于可配置下限[100ms]，已重置为下限数值"),this.config.timeout=100}return new e(this.config)}},{key:"auth",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.persistence;if(this.authObj)return this.authObj;var n,r=t||Fe.adapter.primaryStorage||kt.persistence;return r!==this.config.persistence&&(this.config.persistence=r),function(e){var t=e.env;He[t]=new je(e),Ke[t]=new je(S(S({},e),{},{persistence:"local"}))}(this.config),n=this.config,lt[n.env]=new ct(n),this.authObj=new yt(this.config),this.authObj}},{key:"on",value:function(e,t){return Xe.apply(this,[e,t])}},{key:"off",value:function(e,t){return Ze.apply(this,[e,t])}},{key:"callFunction",value:function(e,t){return Ct.apply(this,[e,t])}},{key:"deleteFile",value:function(e,t){return Tt.apply(this,[e,t])}},{key:"getTempFileURL",value:function(e,t){return St.apply(this,[e,t])}},{key:"downloadFile",value:function(e,t){return Et.apply(this,[e,t])}},{key:"uploadFile",value:function(e,t){return It.apply(this,[e,t])}},{key:"getUploadMetadata",value:function(e,t){return Mt.apply(this,[e,t])}},{key:"registerExtension",value:function(e){bt[e.name]=e}},{key:"invokeExtension",value:function(){var e=(0,d.default)(a.default.mark((function e(t,n){var r;return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=bt[t],r){e.next=3;break}throw new Ie({message:"扩展".concat(t," 必须先注册")});case 3:return e.next=5,r.invoke(n,this);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"useAdapters",value:function(e){var t=function(e){var t,n,r=(t=e,"[object Array]"===Object.prototype.toString.call(t)?e:[e]),o=I(r);try{for(o.s();!(n=o.n()).done;){var i=n.value,a=i.isMatch,s=i.genAdapter,u=i.runtime;if(a())return{adapter:s(),runtime:u}}}catch(c){o.e(c)}finally{o.f()}}(e)||{},n=t.adapter,r=t.runtime;n&&(Fe.adapter=n),r&&(Fe.runtime=r)}}]),e}(),At=new Dt;function Ot(e,t,n){void 0===n&&(n={});var r=/\?/.test(t),o="";for(var i in n)""===o?!r&&(t+="?"):o+="&",o+=i+"="+encodeURIComponent(n[i]);return/^http(s)?:\/\//.test(t+=o)?t:""+e+t}var Rt=function(){function e(){(0,_.default)(this,e)}return(0,m.default)(e,[{key:"post",value:function(e){var t=e.url,n=e.data,r=e.headers;return new Promise((function(e,o){Me.request({url:Ot("https:",t),data:n,method:"POST",header:r,success:function(t){e(t)},fail:function(e){o(e)}})}))}},{key:"upload",value:function(e){return new Promise((function(t,n){var r=e.url,o=e.file,i=e.data,a=e.headers,s=e.fileType,u=Me.uploadFile({url:Ot("https:",r),name:"file",formData:Object.assign({},i),filePath:o,fileType:s,header:a,success:function(e){var n={statusCode:e.statusCode,data:e.data||{}};200===e.statusCode&&i.success_action_status&&(n.statusCode=parseInt(i.success_action_status,10)),t(n)},fail:function(e){n(new Error(e.errMsg||"uploadFile:fail"))}});"function"==typeof e.onUploadProgress&&u&&"function"==typeof u.onProgressUpdate&&u.onProgressUpdate((function(t){e.onUploadProgress({loaded:t.totalBytesSent,total:t.totalBytesExpectedToSend})}))}))}}]),e}(),Nt={setItem:function(e,t){Me.setStorageSync(e,t)},getItem:function(e){return Me.getStorageSync(e)},removeItem:function(e){Me.removeStorageSync(e)},clear:function(){Me.clearStorageSync()}},wt={genAdapter:function(){return{root:{},reqClass:Rt,localStorage:Nt,primaryStorage:"local"}},isMatch:function(){return!0},runtime:"uni_app"};At.useAdapters(wt);var Lt=At,Pt=Lt.init;Lt.init=function(e){e.env=e.spaceId;var t=Pt.call(this,e);t.config.provider="tencent",t.config.spaceId=e.spaceId;var n=t.auth;return t.auth=function(e){var t=n.call(this,e);return["linkAndRetrieveDataWithTicket","signInAnonymously","signOut","getAccessToken","getLoginState","signInWithTicket","getUserInfo"].forEach((function(e){var n;t[e]=(n=t[e],function(e){e=e||{};var t=_e(e),r=t.success,o=t.fail,i=t.complete;if(!(r||o||i))return n.call(this,e);n.call(this,e).then((function(e){r&&r(e),i&&i(e)}),(function(e){o&&o(e),i&&i(e)}))}).bind(t)})),t},t.customAuth=t.auth,t};var Ut=Lt,Gt=function(e){(0,p.default)(n,e);var t=E(n);function n(){return(0,_.default)(this,n),t.apply(this,arguments)}return(0,m.default)(n,[{key:"getAccessToken",value:function(){var e=this;return new Promise((function(t,n){var r="Anonymous_Access_token";e.setAccessToken(r),t(r)}))}},{key:"setupRequest",value:function(e,t){var n=Object.assign({},e,{spaceId:this.config.spaceId,timestamp:Date.now()}),r={"Content-Type":"application/json"};"auth"!==t&&(n.token=this.accessToken,r["x-basement-token"]=this.accessToken),r["x-serverless-sign"]=be.sign(n,this.config.clientSecret);var o=Ce();r["x-client-info"]=encodeURIComponent(JSON.stringify(o));var i=Te(),a=i.token;return r["x-client-token"]=a,{url:this.config.requestUrl,method:"POST",data:n,dataType:"json",header:JSON.parse(JSON.stringify(r))}}},{key:"uploadFileToOSS",value:function(e){var t=this,n=e.url,r=e.formData,o=e.name,i=e.filePath,a=e.fileType,s=e.onUploadProgress;return new Promise((function(e,u){var c=t.adapter.uploadFile({url:n,formData:r,name:o,filePath:i,fileType:a,success:function(t){t&&t.statusCode<400?e(t):u(new Ie({code:"UPLOAD_FAILED",message:"文件上传失败"}))},fail:function(e){u(new Ie({code:e.code||"UPLOAD_FAILED",message:e.message||e.errMsg||"文件上传失败"}))}});"function"==typeof s&&c&&"function"==typeof c.onProgressUpdate&&c.onProgressUpdate((function(e){s({loaded:e.totalBytesSent,total:e.totalBytesExpectedToSend})}))}))}},{key:"uploadFile",value:function(e){var t,n=this,r=e.filePath,o=e.cloudPath,i=e.fileType,a=void 0===i?"image":i,s=e.onUploadProgress;if(!o)throw new Ie({code:"CLOUDPATH_REQUIRED",message:"cloudPath不可为空"});return this.getOSSUploadOptionsFromPath({cloudPath:o}).then((function(e){var o=e.result,i=o.url,u=o.formData,c=o.name;t=e.result.fileUrl;var l={url:i,formData:u,name:c,filePath:r,fileType:a};return n.uploadFileToOSS(Object.assign({},l,{onUploadProgress:s}))})).then((function(){return n.reportOSSUpload({cloudPath:o})})).then((function(e){return new Promise((function(n,o){e.success?n({success:!0,filePath:r,fileID:t}):o(new Ie({code:"UPLOAD_FAILED",message:"文件上传失败"}))}))}))}},{key:"deleteFile",value:function(e){var t=e.fileList,n={method:"serverless.file.resource.delete",params:JSON.stringify({fileList:t})};return this.request(this.setupRequest(n)).then((function(e){if(e.success)return e.result;throw new Ie({code:"DELETE_FILE_FAILED",message:"删除文件失败"})}))}},{key:"getTempFileURL",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.fileList,n=e.maxAge;if(!Array.isArray(t)||0===t.length)throw new Ie({code:"INVALID_PARAM",message:"fileList的元素必须是非空的字符串"});var r={method:"serverless.file.resource.getTempFileURL",params:JSON.stringify({fileList:t,maxAge:n})};return this.request(this.setupRequest(r)).then((function(e){if(e.success)return{fileList:e.result.fileList.map((function(e){return{fileID:e.fileID,tempFileURL:e.tempFileURL}}))};throw new Ie({code:"GET_TEMP_FILE_URL_FAILED",message:"获取临时文件链接失败"})}))}}]),n}(De),xt={init:function(e){var t=new Gt(e),n={signInAnonymously:function(){return t.authorize()},getLoginState:function(){return Promise.resolve(!1)}};return t.auth=function(){return n},t.customAuth=t.auth,t}},Ft=C((function(e,t){e.exports=b.enc.Hex}));function qt(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.data,r=t.functionName,o=t.method,i=t.headers,a=t.signHeaderKeys,s=void 0===a?[]:a,c=t.config,l=Date.now(),d="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})),f=Object.assign({},i,{"x-from-app-id":c.spaceAppId,"x-from-env-id":c.spaceId,"x-to-env-id":c.spaceId,"x-from-instance-id":l,"x-from-function-name":r,"x-client-timestamp":l,"x-alipay-source":"client","x-request-id":d,"x-alipay-callid":d}),p=["x-from-app-id","x-from-env-id","x-to-env-id","x-from-instance-id","x-from-function-name","x-client-timestamp"].concat(s),h=e.split("?")||[],g=(0,u.default)(h,2),v=g[0],_=void 0===v?"":v,m=g[1],y=void 0===m?"":m,I=function(e){var t=e.signedHeaders.join(";"),n=e.signedHeaders.map((function(t){return"".concat(t.toLowerCase(),":").concat(e.headers[t],"\n")})).join(""),r=Le(e.body).toString(Ft),o="".concat(e.method.toUpperCase(),"\n").concat(e.path,"\n").concat(e.query,"\n").concat(n,"\n").concat(t,"\n").concat(r,"\n"),i=Le(o).toString(Ft),a="HMAC-SHA256\n".concat(e.timestamp,"\n").concat(i,"\n"),s=Pe(a,e.secretKey).toString(Ft);return"HMAC-SHA256 Credential=".concat(e.secretId,", SignedHeaders=").concat(t,", Signature=").concat(s)}({path:_,query:y,method:o,headers:f,timestamp:l,body:JSON.stringify(n),secretId:c.accessKey,secretKey:c.secretKey,signedHeaders:p.sort()});return{url:"".concat(c.endpoint).concat(e),headers:Object.assign({},f,{Authorization:I})}}function Vt(e){var t=e.url,n=e.data,r=e.method,o=void 0===r?"POST":r,i=e.headers,a=void 0===i?{}:i;return new Promise((function(e,r){Me.request({url:t,method:o,data:n,header:a,dataType:"json",complete:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!t.statusCode||t.statusCode>=400){var n=t.data||{},o=n.errMsg;return r(new Ie({code:"SYS_ERR",message:o||t.errMsg||"request:fail",requestId:t.requestID}))}e({status:t.statusCode,data:t.data,headers:t.header,requestId:t.requestID})}})}))}function Bt(e,t){var n=e.path,r=e.data,o=e.method,i=void 0===o?"GET":o,a=qt(n,{functionName:"",data:r,method:i,headers:{"x-alipay-cloud-mode":"oss","x-data-api-type":"oss","x-expire-timestamp":Date.now()+6e4},signHeaderKeys:["x-data-api-type","x-expire-timestamp"],config:t}),s=a.url,u=a.headers;return Vt({url:s,data:r,method:i,headers:u}).then((function(e){var t=e.data||{};if(!t.success)throw new Ie({code:e.code,message:e.message,requestId:e.trace_id});return t.data||{}})).catch((function(e){throw new Ie({code:e.errCode,message:e.errMsg,requestId:e.requestId})}))}function jt(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=e.trim().replace(/^cloud:\/\//,""),n=t.indexOf("/");if(n<=0)throw new Ie({code:"INVALID_PARAM",message:"fileID不合法"});var r=t.substring(0,n),o=t.substring(n+1);return r!==this.config.spaceId&&console.warn("file ".concat(e," does not belong to env ").concat(this.config.spaceId)),o}var Ht=function(){function e(t){if((0,_.default)(this,e),["spaceId","spaceAppId","accessKey","secretKey"].forEach((function(e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new Error("".concat(e," required"))})),t.endpoint){if("string"!=typeof t.endpoint)throw new Error("endpoint must be string");if(!/^https:\/\//.test(t.endpoint))throw new Error("endpoint must start with https://");t.endpoint=t.endpoint.replace(/\/$/,"")}this.config=Object.assign({},t,{endpoint:t.endpoint||"https://".concat(t.spaceId,".api-hz.cloudbasefunction.cn")})}return(0,m.default)(e,[{key:"callFunction",value:function(e){return function(e,t){var n=e.name,r=e.data,o="POST",i=qt("/functions/invokeFunction",{functionName:n,data:r,method:o,headers:{"x-to-function-name":n},signHeaderKeys:["x-to-function-name"],config:t}),a=i.url,s=i.headers;return Vt({url:a,data:r,method:o,headers:s}).then((function(e){return{errCode:0,success:!0,requestId:e.requestId,result:e.data}})).catch((function(e){throw new Ie({code:e.errCode,message:e.errMsg,requestId:e.requestId})}))}(e,this.config)}},{key:"uploadFileToOSS",value:function(e){var t=e.url,n=e.filePath,r=e.fileType,o=e.formData,i=e.onUploadProgress;return new Promise((function(e,a){var s=Me.uploadFile({url:t,filePath:n,fileType:r,formData:o,name:"file",success:function(t){t&&t.statusCode<400?e(t):a(new Ie({code:"UPLOAD_FAILED",message:"文件上传失败"}))},fail:function(e){a(new Ie({code:e.code||"UPLOAD_FAILED",message:e.message||e.errMsg||"文件上传失败"}))}});"function"==typeof i&&s&&"function"==typeof s.onProgressUpdate&&s.onProgressUpdate((function(e){i({loaded:e.totalBytesSent,total:e.totalBytesExpectedToSend})}))}))}},{key:"uploadFile",value:function(){var e=(0,d.default)(a.default.mark((function e(t){var n,r,o,i,s,u,c,l,d,f,p;return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.filePath,r=t.cloudPath,o=void 0===r?"":r,i=t.fileType,s=void 0===i?"image":i,u=t.onUploadProgress,"string"===U(o)){e.next=3;break}throw new Ie({code:"INVALID_PARAM",message:"cloudPath必须为字符串类型"});case 3:if(o=o.trim()){e.next=5;break}throw new Ie({code:"INVALID_PARAM",message:"cloudPath不可为空"});case 5:if(!/:\/\//.test(o)){e.next=7;break}throw new Ie({code:"INVALID_PARAM",message:"cloudPath不合法"});case 7:return e.next=9,Bt({path:"/".concat(o.replace(/^\//,""),"?post_url")},this.config);case 9:return c=e.sent,l=c.file_id,d=c.upload_url,f=c.form_data,p=f&&f.reduce((function(e,t){return e[t.key]=t.value,e}),{}),e.abrupt("return",this.uploadFileToOSS({url:d,filePath:n,fileType:s,formData:p,onUploadProgress:u}).then((function(){return{fileID:l}})));case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getTempFileURL",value:function(){var e=(0,d.default)(a.default.mark((function e(t){var n,r=this;return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.fileList,e.abrupt("return",new Promise((function(e,t){(!n||n.length<0)&&t(new Ie({errCode:"INVALID_PARAM",errMsg:"fileList不能为空数组"})),n.length>50&&t(new Ie({errCode:"INVALID_PARAM",errMsg:"fileList数组长度不能超过50"}));var o,i=[],a=I(n);try{for(a.s();!(o=a.n()).done;){var s=o.value;"string"!==U(s)&&t(new Ie({errCode:"INVALID_PARAM",errMsg:"fileList的元素必须是非空的字符串"}));var u=jt.call(r,s);i.push({file_id:u,expire:600})}}catch(c){a.e(c)}finally{a.f()}Bt({path:"/?download_url",data:{file_list:i},method:"POST"},r.config).then((function(t){var n=t.file_list,r=void 0===n?[]:n;e({fileList:r.map((function(e){return{fileID:e.file_id,tempFileURL:e.download_url}}))})})).catch((function(e){return t(e)}))})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),Kt={init:function(e){e.provider="alipay";var t=new Ht(e);return t.auth=function(){return{signInAnonymously:function(){return Promise.resolve()},getLoginState:function(){return Promise.resolve(!0)}}},t}};function Wt(e){var t,n=e.data;t=Ce();var r=JSON.parse(JSON.stringify(n||{}));if(Object.assign(r,{clientInfo:t}),!r.uniIdToken){var o=Te(),i=o.token;i&&(r.uniIdToken=i)}return r}var Yt=[{rule:/fc_function_not_found|FUNCTION_NOT_FOUND/,content:"，云函数[{functionName}]在云端不存在，请检查此云函数名称是否正确以及该云函数是否已上传到服务空间",mode:"append"}],zt=/[\\^$.*+?()[\]{}|]/g,Jt=RegExp(zt.source);function Xt(e,t,n){return e.replace(new RegExp((r=t)&&Jt.test(r)?r.replace(zt,"\\$&"):r,"g"),n);var r}var $t="request",Zt="response";var Qt;Qt="0123456789abcdef";var en={code:2e4,message:"System error"},tn={code:20101,message:"Invalid client"};function nn(e){var t=e||{},n=t.errSubject,r=t.subject,o=t.errCode,i=t.errMsg,a=t.code,s=t.message,u=t.cause;return new Ie({subject:n||r||"uni-secure-network",code:o||a||en.code,message:i||s,cause:u})}var rn;function on(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.secretType;return t===$t||t===Zt||"both"===t}function an(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.name,n=e.data,r=void 0===n?{}:n;return"app"===W&&"DCloud-clientDB"===t&&"encryption"===r.redirectTo&&"getAppClientKey"===r.action}function sn(e){e.functionName,e.result,e.logPvd}function un(e){var t=e.callFunction,n=function(n){var r=this,o=n.name;n.data=Wt.call(e,{data:n.data});var i={aliyun:"aliyun",tencent:"tcb",tcb:"tcb",alipay:"alipay"}[this.config.provider],a=on(n),s=an(n),u=a||s;return t.call(this,n).then((function(e){return e.errCode=0,!u&&sn.call(r,{functionName:o,result:e,logPvd:i}),Promise.resolve(e)}),(function(e){return!u&&sn.call(r,{functionName:o,result:e,logPvd:i}),e&&e.message&&(e.message=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.message,n=void 0===t?"":t,r=e.extraInfo,o=void 0===r?{}:r,i=e.formatter,a=void 0===i?[]:i,s=0;s<a.length;s++){var u=a[s],c=u.rule,l=u.content,d=u.mode,f=n.match(c);if(f){for(var p=l,h=1;h<f.length;h++)p=Xt(p,"{$".concat(h,"}"),f[h]);for(var g in o)p=Xt(p,"{".concat(g,"}"),o[g]);return"replace"===d?p:n+p}}return n}({message:"[".concat(n.name,"]: ").concat(e.message),formatter:Yt,extraInfo:{functionName:o}})),Promise.reject(e)}))};e.callFunction=function(t){var r,o,i=e.config,a=i.provider,s=i.spaceId,u=t.name;return t.data=t.data||{},r=n,r=r.bind(e),o=an(t)?n.call(e,t):function(e){var t=e.name,n=e.data,r=void 0===n?{}:n;return"mp-weixin"===W&&"uni-id-co"===t&&"secureNetworkHandshakeByWeixin"===r.method}(t)?r.call(e,t):on(t)?new rn({secretType:t.secretType,uniCloudIns:e}).wrapEncryptDataCallFunction(n.bind(e))(t):function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.provider,n=e.spaceId,r=e.functionName,o=Ee(),i=o.appId,a=o.uniPlatform,s=o.osName,u=a;"app"===a&&(u=s);var c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.provider,n=e.spaceId,r=K;if(!r)return{};t=function(e){return"tencent"===e?"tcb":e}(t);var o=r.find((function(e){return e.provider===t&&e.spaceId===n}));return o&&o.config}({provider:t,spaceId:n});if(!c||!c.accessControl||!c.accessControl.enable)return!1;var l=c.accessControl.function||{},d=Object.keys(l);if(0===d.length)return!0;var f=function(e,t){for(var n,r,o,i=0;i<e.length;i++){var a=e[i];a!==t?"*"!==a?a.split(",").map((function(e){return e.trim()})).indexOf(t)>-1&&(r=a):o=a:n=a}return n||r||o}(d,r);if(!f)return!1;if((l[f]||[]).find((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.appId===i&&(e.platform||"").toLowerCase()===u.toLowerCase()})))return!0;throw console.error("此应用[appId: ".concat(i,", platform: ").concat(u,"]不在云端配置的允许访问的应用列表内，参考：https://uniapp.dcloud.net.cn/uniCloud/secure-network.html#verify-client")),nn(tn)}({provider:a,spaceId:s,functionName:u})?new rn({secretType:t.secretType,uniCloudIns:e}).wrapVerifyClientCallFunction(n.bind(e))(t):r(t),Object.defineProperty(o,"result",{get:function(){return console.warn("当前返回结果为Promise类型，不可直接访问其result属性，详情请参考：https://uniapp.dcloud.net.cn/uniCloud/faq?id=promise"),{}}}),o}}rn="mp-weixin"!==W&&"app"!==W?function(){return(0,m.default)((function e(){throw(0,_.default)(this,e),nn({message:"Platform ".concat(W," is not supported by secure network")})}))}():function(){return(0,m.default)((function e(){throw(0,_.default)(this,e),nn({message:"Platform ".concat(W," is not enabled, please check whether secure network module is enabled in your manifest.json")})}))}();var cn=Symbol("CLIENT_DB_INTERNAL");function ln(e,t){return e.then="DoNotReturnProxyWithAFunctionNamedThen",e._internalType=cn,e.inspect=null,e.__ob__=void 0,new Proxy(e,{get:function(e,n,r){if("_uniClient"===n)return null;if("symbol"==(0,c.default)(n))return e[n];if(n in e||"string"!=typeof n){var o=e[n];return"function"==typeof o?o.bind(e):o}return t.get(e,n,r)}})}function dn(e){return{on:function(t,n){e[t]=e[t]||[],e[t].indexOf(n)>-1||e[t].push(n)},off:function(t,n){e[t]=e[t]||[];var r=e[t].indexOf(n);-1!==r&&e[t].splice(r,1)}}}var fn=["db.Geo","db.command","command.aggregate"];function pn(e,t){return fn.indexOf("".concat(e,".").concat(t))>-1}function hn(e){switch(U(e)){case"array":return e.map((function(e){return hn(e)}));case"object":return e._internalType===cn||Object.keys(e).forEach((function(t){e[t]=hn(e[t])})),e;case"regexp":return{$regexp:{source:e.source,flags:e.flags}};case"date":return{$date:e.toISOString()};default:return e}}function gn(e){return e&&e.content&&e.content.$method}var vn=function(){function e(t,n,r){(0,_.default)(this,e),this.content=t,this.prevStage=n||null,this.udb=null,this._database=r}return(0,m.default)(e,[{key:"toJSON",value:function(){for(var e=this,t=[e.content];e.prevStage;)e=e.prevStage,t.push(e.content);return{$db:t.reverse().map((function(e){return{$method:e.$method,$param:hn(e.$param)}}))}}},{key:"toString",value:function(){return JSON.stringify(this.toJSON())}},{key:"getAction",value:function(){var e=this.toJSON().$db.find((function(e){return"action"===e.$method}));return e&&e.$param&&e.$param[0]}},{key:"getCommand",value:function(){return{$db:this.toJSON().$db.filter((function(e){return"action"!==e.$method}))}}},{key:"isAggregate",get:function(){for(var e=this;e;){var t=gn(e),n=gn(e.prevStage);if("aggregate"===t&&"collection"===n||"pipeline"===t)return!0;e=e.prevStage}return!1}},{key:"isCommand",get:function(){for(var e=this;e;){if("command"===gn(e))return!0;e=e.prevStage}return!1}},{key:"isAggregateCommand",get:function(){for(var e=this;e;){var t=gn(e),n=gn(e.prevStage);if("aggregate"===t&&"command"===n)return!0;e=e.prevStage}return!1}},{key:"getNextStageFn",value:function(e){var t=this;return function(){return _n({$method:e,$param:hn(Array.from(arguments))},t,t._database)}}},{key:"count",get:function(){return this.isAggregate?this.getNextStageFn("count"):function(){return this._send("count",Array.from(arguments))}}},{key:"remove",get:function(){return this.isCommand?this.getNextStageFn("remove"):function(){return this._send("remove",Array.from(arguments))}}},{key:"get",value:function(){return this._send("get",Array.from(arguments))}},{key:"add",get:function(){return this.isCommand?this.getNextStageFn("add"):function(){return this._send("add",Array.from(arguments))}}},{key:"update",value:function(){return this._send("update",Array.from(arguments))}},{key:"end",value:function(){return this._send("end",Array.from(arguments))}},{key:"set",get:function(){return this.isCommand?this.getNextStageFn("set"):function(){throw new Error("JQL禁止使用set方法")}}},{key:"_send",value:function(e,t){var n=this.getAction(),r=this.getCommand();return r.$db.push({$method:e,$param:hn(t)}),this._database._callCloudFunction({action:n,command:r})}}]),e}();function _n(e,t,n){return ln(new vn(e,t,n),{get:function(e,t){var r="db";return e&&e.content&&(r=e.content.$method),pn(r,t)?_n({$method:t},e,n):function(){return _n({$method:t,$param:hn(Array.from(arguments))},e,n)}}})}function mn(e){var t=e.path,n=e.method;return function(){function e(){(0,_.default)(this,e),this.param=Array.from(arguments)}return(0,m.default)(e,[{key:"toJSON",value:function(){return{$newDb:[].concat((0,l.default)(t.map((function(e){return{$method:e}}))),[{$method:n,$param:this.param}])}}},{key:"toString",value:function(){return JSON.stringify(this.toJSON())}}]),e}()}function yn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ln(new e(t),{get:function(e,t){return pn("db",t)?_n({$method:t},null,e):function(){return _n({$method:t,$param:hn(Array.from(arguments))},null,e)}}})}var In=function(e){(0,p.default)(n,e);var t=E(n);function n(){return(0,_.default)(this,n),t.apply(this,arguments)}return(0,m.default)(n,[{key:"_parseResult",value:function(e){return this._isJQL?e.result:e}},{key:"_callCloudFunction",value:function(e){var t=this,n=e.action,r=e.command,o=e.multiCommand,i=e.queryList;function a(e,t){if(o&&i)for(var n=0;n<i.length;n++){var r=i[n];r.udb&&"function"==typeof r.udb.setResult&&(t?r.udb.setResult(t):r.udb.setResult(e.result.dataList[n]))}}var s=this,u=this._isJQL?"databaseForJQL":"database";function c(e){return s._callback("error",[e]),ee(te(u,"fail"),e).then((function(){return ee(te(u,"complete"),e)})).then((function(){return a(null,e),pe(oe,{type:se,content:e}),Promise.reject(e)}))}var l=ee(te(u,"invoke")),d=this._uniClient;return l.then((function(){return d.callFunction({name:"DCloud-clientDB",type:"CLIENT_DB",data:{action:n,command:r,multiCommand:o}})})).then((function(e){var n=e.result,r=n.code,o=n.message,i=n.token,l=n.tokenExpired,d=n.systemInfo,f=void 0===d?[]:d;if(f)for(var p=0;p<f.length;p++){var h=f[p],g=h.level,v=h.message,_=h.detail,m=console["app"===W&&"warn"===g?"error":g]||console.log,y="[System Info]"+v;_&&(y="".concat(y,"\n详细信息：").concat(_)),m(y)}if(r)return c(new Ie({code:r,message:o,requestId:e.requestId}));e.result.errCode=e.result.errCode||e.result.code,e.result.errMsg=e.result.errMsg||e.result.message,i&&l&&(Se({token:i,tokenExpired:l}),t._callbackAuth("refreshToken",[{token:i,tokenExpired:l}]),t._callback("refreshToken",[{token:i,tokenExpired:l}]),pe(ae,{token:i,tokenExpired:l}));for(var I=[{prop:"affectedDocs",tips:"affectedDocs不再推荐使用，请使用inserted/deleted/updated/data.length替代"},{prop:"code",tips:"code不再推荐使用，请使用errCode替代"},{prop:"message",tips:"message不再推荐使用，请使用errMsg替代"}],M=function(t){var n=I[t],r=n.prop,o=n.tips;if(r in e.result){var i=e.result[r];Object.defineProperty(e.result,r,{get:function(){return console.warn(o),i}})}},T=0;T<I.length;T++)M(T);return function(e){return ee(te(u,"success"),e).then((function(){return ee(te(u,"complete"),e)})).then((function(){a(e,null);var t=s._parseResult(e);return pe(oe,{type:se,content:t}),Promise.resolve(t)}))}(e)}),(function(e){return/fc_function_not_found|FUNCTION_NOT_FOUND/g.test(e.message)&&console.warn("clientDB未初始化，请在web控制台保存一次schema以开启clientDB"),c(new Ie({code:e.code||"SYSTEM_ERROR",message:e.message,requestId:e.requestId}))}))}}]),n}(function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.uniClient,r=void 0===n?{}:n,o=t.isJQL,i=void 0!==o&&o;(0,_.default)(this,e),this._uniClient=r,this._authCallBacks={},this._dbCallBacks={},r._isDefault&&(this._dbCallBacks=J("_globalUniCloudDatabaseCallback")),i||(this.auth=dn(this._authCallBacks)),this._isJQL=i,Object.assign(this,dn(this._dbCallBacks)),this.env=ln({},{get:function(e,t){return{$env:t}}}),this.Geo=ln({},{get:function(e,t){return mn({path:["Geo"],method:t})}}),this.serverDate=mn({path:[],method:"serverDate"}),this.RegExp=mn({path:[],method:"RegExp"})}return(0,m.default)(e,[{key:"getCloudEnv",value:function(e){if("string"!=typeof e||!e.trim())throw new Error("getCloudEnv参数错误");return{$env:e.replace("$cloudEnv_","")}}},{key:"_callback",value:function(e,t){var n=this._dbCallBacks;n[e]&&n[e].forEach((function(e){e.apply(void 0,(0,l.default)(t))}))}},{key:"_callbackAuth",value:function(e,t){var n=this._authCallBacks;n[e]&&n[e].forEach((function(e){e.apply(void 0,(0,l.default)(t))}))}},{key:"multiSend",value:function(){var e=Array.from(arguments),t=e.map((function(e){var t=e.getAction(),n=e.getCommand();if("getTemp"!==n.$db[n.$db.length-1].$method)throw new Error("multiSend只支持子命令内使用getTemp");return{action:t,command:n}}));return this._callCloudFunction({multiCommand:t,queryList:e})}}]),e}()),Mn="token无效，跳转登录页面",Tn="token过期，跳转登录页面",Sn={TOKEN_INVALID_TOKEN_EXPIRED:Tn,TOKEN_INVALID_INVALID_CLIENTID:Mn,TOKEN_INVALID:Mn,TOKEN_INVALID_WRONG_TOKEN:Mn,TOKEN_INVALID_ANONYMOUS_USER:Mn},En={"uni-id-token-expired":Tn,"uni-id-check-token-failed":Mn,"uni-id-token-not-exist":Mn,"uni-id-check-device-feature-failed":Mn};function Cn(e,t){var n="";return n=e?"".concat(e,"/").concat(t):t,n.replace(/^\//,"")}function kn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=[],r=[];return e.forEach((function(e){!0===e.needLogin?n.push(Cn(t,e.path)):!1===e.needLogin&&r.push(Cn(t,e.path))})),{needLoginPage:n,notNeedLoginPage:r}}function bn(e){return e.split("?")[0].replace(/^\//,"")}function Dn(){return function(e){var t=e&&e.$page&&e.$page.fullPath||"";return t?("/"!==t.charAt(0)&&(t="/"+t),t):t}(function(){var e=getCurrentPages();return e[e.length-1]}())}function An(){return bn(Dn())}function On(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)return!1;if(!(t&&t.list&&t.list.length))return!1;var n=t.list,r=bn(e);return n.some((function(e){return e.pagePath===r}))}var Rn,Nn=!!y.default.uniIdRouter,wn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y.default,t=e.pages,n=void 0===t?[]:t,r=e.subPackages,o=void 0===r?[]:r,i=e.uniIdRouter,a=void 0===i?{}:i,s=e.tabBar,u=void 0===s?{}:s,c=a.loginPage,d=a.needLogin,f=void 0===d?[]:d,p=a.resToLogin,h=void 0===p||p,g=kn(n),v=g.needLoginPage,_=g.notNeedLoginPage,m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=[],n=[];return e.forEach((function(e){var r=e.root,o=e.pages,i=void 0===o?[]:o,a=kn(i,r),s=a.needLoginPage,u=a.notNeedLoginPage;t.push.apply(t,(0,l.default)(s)),n.push.apply(n,(0,l.default)(u))})),{needLoginPage:t,notNeedLoginPage:n}}(o),I=m.needLoginPage,M=m.notNeedLoginPage;return{loginPage:c,routerNeedLogin:f,resToLogin:h,needLoginPage:[].concat((0,l.default)(v),(0,l.default)(I)),notNeedLoginPage:[].concat((0,l.default)(_),(0,l.default)(M)),loginPageInTabBar:On(c,u)}}(),Ln=wn.loginPage,Pn=wn.routerNeedLogin,Un=wn.resToLogin,Gn=wn.needLoginPage,xn=wn.notNeedLoginPage,Fn=wn.loginPageInTabBar;if(Gn.indexOf(Ln)>-1)throw new Error("Login page [".concat(Ln,'] should not be "needLogin", please check your pages.json'));function qn(e){var t=An();if("/"===e.charAt(0))return e;var n=e.split("?"),r=(0,u.default)(n,2),o=r[0],i=r[1],a=o.replace(/^\//,"").split("/"),s=t.split("/");s.pop();for(var c=0;c<a.length;c++){var l=a[c];".."===l?s.pop():"."!==l&&s.push(l)}return""===s[0]&&s.shift(),"/"+s.join("/")+(i?"?"+i:"")}function Vn(e){var t=bn(qn(e));return!(xn.indexOf(t)>-1)&&(Gn.indexOf(t)>-1||Pn.some((function(t){return function(e,t){return new RegExp(t).test(e)}(e,t)})))}function Bn(e){var t=e.redirect,n=bn(t),r=bn(Ln);return An()!==r&&n!==r}function jn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.api,n=e.redirect;if(n&&Bn({redirect:n})){var o=function(e,t){return"/"!==e.charAt(0)&&(e="/"+e),t?e.indexOf("?")>-1?e+"&uniIdRedirectUrl=".concat(encodeURIComponent(t)):e+"?uniIdRedirectUrl=".concat(encodeURIComponent(t)):e}(Ln,n);Fn?"navigateTo"!==t&&"redirectTo"!==t||(t="switchTab"):"switchTab"===t&&(t="navigateTo");var i={navigateTo:r.navigateTo,redirectTo:r.redirectTo,switchTab:r.switchTab,reLaunch:r.reLaunch};setTimeout((function(){i[t]({url:o})}))}}function Hn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.url,n={abortLoginPageJump:!1,autoToLoginPage:!1},r=function(){var e,t=Te(),n=t.token,r=t.tokenExpired;if(n){if(r<Date.now()){var o="uni-id-token-expired";e={errCode:o,errMsg:En[o]}}}else{var i="uni-id-check-token-failed";e={errCode:i,errMsg:En[i]}}return e}();if(Vn(t)&&r){if(r.uniIdRedirectUrl=t,le(ie).length>0)return setTimeout((function(){pe(ie,r)}),0),n.abortLoginPageJump=!0,n;n.autoToLoginPage=!0}return n}function Kn(){!function(){var e=Dn(),t=Hn({url:e}),n=t.abortLoginPageJump,r=t.autoToLoginPage;n||r&&jn({api:"redirectTo",redirect:e})}();for(var e=["navigateTo","redirectTo","reLaunch","switchTab"],t=function(t){var n=e[t];r.addInterceptor(n,{invoke:function(e){var t=Hn({url:e.url}),r=t.abortLoginPageJump,o=t.autoToLoginPage;return r?e:o?(jn({api:n,redirect:qn(e.url)}),!1):e}})},n=0;n<e.length;n++)t(n)}function Wn(){this.onResponse((function(e){var t=e.type,n=e.content,r=!1;switch(t){case"cloudobject":r=function(e){if("object"!=(0,c.default)(e))return!1;var t=e||{},n=t.errCode;return n in En}(n);break;case"clientdb":r=function(e){if("object"!=(0,c.default)(e))return!1;var t=e||{},n=t.errCode;return n in Sn}(n)}r&&function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=le(ie);ve().then((function(){var n=Dn();if(n&&Bn({redirect:n}))return t.length>0?pe(ie,Object.assign({uniIdRedirectUrl:n},e)):void(Ln&&jn({api:"navigateTo",redirect:n}))}))}(n)}))}function Yn(e){!function(e){e.onResponse=function(e){de(oe,e)},e.offResponse=function(e){fe(oe,e)}}(e),function(e){e.onNeedLogin=function(e){de(ie,e)},e.offNeedLogin=function(e){fe(ie,e)},Nn&&(J("_globalUniCloudStatus").needLoginInit||(J("_globalUniCloudStatus").needLoginInit=!0,ve().then((function(){Kn.call(e)})),Un&&Wn.call(e)))}(e),function(e){e.onRefreshToken=function(e){de(ae,e)},e.offRefreshToken=function(e){fe(ae,e)}}(e)}var zn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Jn=/^(?:[A-Za-z\d+/]{4})*?(?:[A-Za-z\d+/]{2}(?:==)?|[A-Za-z\d+/]{3}=?)?$/;function Xn(){var e,t,n=Te().token||"",r=n.split(".");if(!n||3!==r.length)return{uid:null,role:[],permission:[],tokenExpired:0};try{e=JSON.parse((t=r[1],decodeURIComponent(Rn(t).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""))))}catch(n){throw new Error("获取当前用户信息出错，详细错误信息为："+n.message)}return e.tokenExpired=1e3*e.exp,delete e.exp,delete e.iat,e}Rn="function"!=typeof atob?function(e){if(e=String(e).replace(/[\t\n\f\r ]+/g,""),!Jn.test(e))throw new Error("Failed to execute 'atob' on 'Window': The string to be decoded is not correctly encoded.");var t;e+="==".slice(2-(3&e.length));for(var n,r,o="",i=0;i<e.length;)t=zn.indexOf(e.charAt(i++))<<18|zn.indexOf(e.charAt(i++))<<12|(n=zn.indexOf(e.charAt(i++)))<<6|(r=zn.indexOf(e.charAt(i++))),o+=64===n?String.fromCharCode(t>>16&255):64===r?String.fromCharCode(t>>16&255,t>>8&255):String.fromCharCode(t>>16&255,t>>8&255,255&t);return o}:atob;var $n=C((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n="chooseAndUploadFile:ok",i="chooseAndUploadFile:fail";function a(e,t){return e.tempFiles.forEach((function(e,n){e.name||(e.name=e.path.substring(e.path.lastIndexOf("/")+1)),t&&(e.fileType=t),e.cloudPath=Date.now()+"_"+n+e.name.substring(e.name.lastIndexOf("."))})),e.tempFilePaths||(e.tempFilePaths=e.tempFiles.map((function(e){return e.path}))),e}function s(e,t,r){var o=r.onChooseFile,i=r.onUploadProgress;return t.then((function(e){if(o){var t=o(e);if(void 0!==t)return Promise.resolve(t).then((function(t){return void 0===t?e:t}))}return e})).then((function(t){return!1===t?{errMsg:n,tempFilePaths:[],tempFiles:[]}:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,o=arguments.length>3?arguments[3]:void 0;(t=Object.assign({},t)).errMsg=n;var i=t.tempFiles,a=i.length,s=0;return new Promise((function(n){for(;s<r;)u();function u(){var r=s++;if(r>=a)!i.find((function(e){return!e.url&&!e.errMsg}))&&n(t);else{var c=i[r];e.uploadFile({filePath:c.path,cloudPath:c.cloudPath,fileType:c.fileType,cloudPathAsRealPath:c.cloudPathAsRealPath,onUploadProgress:function(e){e.index=r,e.tempFile=c,e.tempFilePath=c.path,o&&o(e)}}).then((function(e){c.url=e.fileID,r<a&&u()})).catch((function(e){c.errMsg=e.errMsg||e.message,r<a&&u()}))}}}))}(e,t,5,i)}))}t.initChooseAndUploadFile=function(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{type:"all"};return"image"===t.type?s(e,function(e){var t=e.count,n=e.sizeType,o=e.sourceType,s=void 0===o?["album","camera"]:o,u=e.extension;return new Promise((function(e,o){r.chooseImage({count:t,sizeType:n,sourceType:s,extension:u,success:function(t){e(a(t,"image"))},fail:function(e){o({errMsg:e.errMsg.replace("chooseImage:fail",i)})}})}))}(t),t):"video"===t.type?s(e,function(e){var t=e.camera,n=e.compressed,o=e.maxDuration,s=e.sourceType,u=void 0===s?["album","camera"]:s,c=e.extension;return new Promise((function(e,s){r.chooseVideo({camera:t,compressed:n,maxDuration:o,sourceType:u,extension:c,success:function(t){var n=t.tempFilePath,r=t.duration,o=t.size,i=t.height,s=t.width;e(a({errMsg:"chooseVideo:ok",tempFilePaths:[n],tempFiles:[{name:t.tempFile&&t.tempFile.name||"",path:n,size:o,type:t.tempFile&&t.tempFile.type||"",width:s,height:i,duration:r,fileType:"video",cloudPath:""}]},"video"))},fail:function(e){s({errMsg:e.errMsg.replace("chooseVideo:fail",i)})}})}))}(t),t):s(e,function(e){var t=e.count,n=e.extension;return new Promise((function(e,s){var u=r.chooseFile;if("undefined"!=typeof o&&"function"==typeof o.chooseMessageFile&&(u=o.chooseMessageFile),"function"!=typeof u)return s({errMsg:i+" 请指定 type 类型，该平台仅支持选择 image 或 video。"});u({type:"all",count:t,extension:n,success:function(t){e(a(t))},fail:function(e){s({errMsg:e.errMsg.replace("chooseFile:fail",i)})}})}))}(t),t)}}})),Zn=function(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}($n);function Qn(e){return{props:{localdata:{type:Array,default:function(){return[]}},options:{type:[Object,Array],default:function(){return{}}},spaceInfo:{type:Object,default:function(){return{}}},collection:{type:[String,Array],default:""},action:{type:String,default:""},field:{type:String,default:""},orderby:{type:String,default:""},where:{type:[String,Object],default:""},pageData:{type:String,default:"add"},pageCurrent:{type:Number,default:1},pageSize:{type:Number,default:20},getcount:{type:[Boolean,String],default:!1},gettree:{type:[Boolean,String],default:!1},gettreepath:{type:[Boolean,String],default:!1},startwith:{type:String,default:""},limitlevel:{type:Number,default:10},groupby:{type:String,default:""},groupField:{type:String,default:""},distinct:{type:[Boolean,String],default:!1},foreignKey:{type:String,default:""},loadtime:{type:String,default:"auto"},manual:{type:Boolean,default:!1}},data:function(){return{mixinDatacomLoading:!1,mixinDatacomHasMore:!1,mixinDatacomResData:[],mixinDatacomErrorMessage:"",mixinDatacomPage:{}}},created:function(){var e=this;this.mixinDatacomPage={current:this.pageCurrent,size:this.pageSize,count:0},this.$watch((function(){var t=[];return["pageCurrent","pageSize","localdata","collection","action","field","orderby","where","getont","getcount","gettree","groupby","groupField","distinct"].forEach((function(n){t.push(e[n])})),t}),(function(t,n){if("manual"!==e.loadtime){for(var r=!1,o=[],i=2;i<t.length;i++)t[i]!==n[i]&&(o.push(t[i]),r=!0);t[0]!==n[0]&&(e.mixinDatacomPage.current=e.pageCurrent),e.mixinDatacomPage.size=e.pageSize,e.onMixinDatacomPropsChange(r,o)}}))},methods:{onMixinDatacomPropsChange:function(e,t){},mixinDatacomEasyGet:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.getone,r=void 0!==n&&n,o=t.success,i=t.fail;this.mixinDatacomLoading||(this.mixinDatacomLoading=!0,this.mixinDatacomErrorMessage="",this.mixinDatacomGet().then((function(t){e.mixinDatacomLoading=!1;var n=t.result,i=n.data,a=n.count;e.getcount&&(e.mixinDatacomPage.count=a),e.mixinDatacomHasMore=i.length<e.pageSize;var s=r?i.length?i[0]:void 0:i;e.mixinDatacomResData=s,o&&o(s)})).catch((function(t){e.mixinDatacomLoading=!1,e.mixinDatacomErrorMessage=t,i&&i(t)})))},mixinDatacomGet:function(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.database(this.spaceInfo),o=n.action||this.action;o&&(r=r.action(o));var i=n.collection||this.collection;r=Array.isArray(i)?(t=r).collection.apply(t,(0,l.default)(i)):r.collection(i);var a=n.where||this.where;a&&Object.keys(a).length&&(r=r.where(a));var s=n.field||this.field;s&&(r=r.field(s));var u=n.foreignKey||this.foreignKey;u&&(r=r.foreignKey(u));var c=n.groupby||this.groupby;c&&(r=r.groupBy(c));var d=n.groupField||this.groupField;d&&(r=r.groupField(d)),!0===(void 0!==n.distinct?n.distinct:this.distinct)&&(r=r.distinct());var f=n.orderby||this.orderby;f&&(r=r.orderBy(f));var p=void 0!==n.pageCurrent?n.pageCurrent:this.mixinDatacomPage.current,h=void 0!==n.pageSize?n.pageSize:this.mixinDatacomPage.size,g=void 0!==n.getcount?n.getcount:this.getcount,v=void 0!==n.gettree?n.gettree:this.gettree,_=void 0!==n.gettreepath?n.gettreepath:this.gettreepath,m={getCount:g},y={limitLevel:void 0!==n.limitlevel?n.limitlevel:this.limitlevel,startWith:void 0!==n.startwith?n.startwith:this.startwith};return v&&(m.getTree=y),_&&(m.getTreePath=y),r=r.skip(h*(p-1)).limit(h).get(m),r}}}}function er(e){return J("_globalUniCloudSecureNetworkCache__{spaceId}".replace("{spaceId}",e.config.spaceId))}function tr(){return nr.apply(this,arguments)}function nr(){return nr=(0,d.default)(a.default.mark((function e(){var t,n,o,i,s,u,c,l=arguments;return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=l.length>0&&void 0!==l[0]?l[0]:{},n=t.openid,o=t.callLoginByWeixin,i=void 0!==o&&o,s=er(this),"mp-weixin"===W){e.next=4;break}throw new Error("[SecureNetwork] API `initSecureNetworkByWeixin` is not supported on platform `".concat(W,"`"));case 4:if(!n||!i){e.next=6;break}throw new Error("[SecureNetwork] openid and callLoginByWeixin cannot be passed at the same time");case 6:if(!n){e.next=8;break}return e.abrupt("return",(s.mpWeixinOpenid=n,{}));case 8:return e.next=10,new Promise((function(e,t){r.login({success:function(t){e(t.code)},fail:function(e){t(new Error(e.errMsg))}})}));case 10:return u=e.sent,c=this.importObject("uni-id-co",{customUI:!0}),e.next=14,c.secureNetworkHandshakeByWeixin({code:u,callLoginByWeixin:i});case 14:return s.mpWeixinCode=u,e.abrupt("return",{code:u});case 16:case"end":return e.stop()}}),e,this)}))),nr.apply(this,arguments)}function rr(e){return or.apply(this,arguments)}function or(){return or=(0,d.default)(a.default.mark((function e(t){var n;return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=er(this),e.abrupt("return",(n.initPromise||(n.initPromise=tr.call(this,t)),n.initPromise));case 2:case"end":return e.stop()}}),e,this)}))),or.apply(this,arguments)}function ir(e){var t={getSystemInfo:r.getSystemInfo,getPushClientId:r.getPushClientId};return function(n){return new Promise((function(r,o){t[e](S(S({},n),{},{success:function(e){r(e)},fail:function(e){o(e)}}))}))}}var ar=function(e){(0,p.default)(n,e);var t=E(n);function n(){var e;return(0,_.default)(this,n),e=t.call(this),e._uniPushMessageCallback=e._receivePushMessage.bind((0,s.default)(e)),e._currentMessageId=-1,e._payloadQueue=[],e}return(0,m.default)(n,[{key:"init",value:function(){var e=this;return Promise.all([ir("getSystemInfo")(),ir("getPushClientId")()]).then((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=(0,u.default)(t,2),r=n[0];r=void 0===r?{}:r;var o=r.appId,i=n[1];i=void 0===i?{}:i;var a=i.cid;if(!o)throw new Error("Invalid appId, please check the manifest.json file");if(!a)throw new Error("Invalid push client id");e._appId=o,e._pushClientId=a,e._seqId=Date.now()+"-"+Math.floor(9e5*Math.random()+1e5),e.emit("open"),e._initMessageListener()}),(function(t){throw e.emit("error",t),e.close(),t}))}},{key:"open",value:function(){var e=(0,d.default)(a.default.mark((function e(){return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",this.init());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_isUniCloudSSE",value:function(e){if("receive"!==e.type)return!1;var t=e&&e.data&&e.data.payload;return!(!t||"UNI_CLOUD_SSE"!==t.channel||t.seqId!==this._seqId)}},{key:"_receivePushMessage",value:function(e){if(this._isUniCloudSSE(e)){var t=e&&e.data&&e.data.payload,n=t.action,r=t.messageId,o=t.message;this._payloadQueue.push({action:n,messageId:r,message:o}),this._consumMessage()}}},{key:"_consumMessage",value:function(){for(var e=this;;){var t=this._payloadQueue.find((function(t){return t.messageId===e._currentMessageId+1}));if(!t)break;this._currentMessageId++,this._parseMessagePayload(t)}}},{key:"_parseMessagePayload",value:function(e){var t=e.action,n=e.messageId,r=e.message;"end"===t?this._end({messageId:n,message:r}):"message"===t&&this._appendMessage({messageId:n,message:r})}},{key:"_appendMessage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(e.messageId,e.message);this.emit("message",t)}},{key:"_end",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(e.messageId,e.message);this.emit("end",t),this.close()}},{key:"_initMessageListener",value:function(){r.onPushMessage(this._uniPushMessageCallback)}},{key:"_destroy",value:function(){r.offPushMessage(this._uniPushMessageCallback)}},{key:"toJSON",value:function(){return{appId:this._appId,pushClientId:this._pushClientId,seqId:this._seqId}}},{key:"close",value:function(){this._destroy(),this.emit("close")}}]),n}(function(){function e(){(0,_.default)(this,e),this._callback={}}return(0,m.default)(e,[{key:"addListener",value:function(e,t){this._callback[e]||(this._callback[e]=[]),this._callback[e].push(t)}},{key:"on",value:function(e,t){return this.addListener(e,t)}},{key:"removeListener",value:function(e,t){if(!t)throw new Error('The "listener" argument must be of type function. Received undefined');var n=this._callback[e];if(n){var r=function(e,t){for(var n=e.length-1;n>=0;n--)if(e[n]===t)return n;return-1}(n,t);n.splice(r,1)}}},{key:"off",value:function(e,t){return this.removeListener(e,t)}},{key:"removeAllListener",value:function(e){delete this._callback[e]}},{key:"emit",value:function(e){for(var t=this._callback[e],n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];if(t)for(var i=0;i<t.length;i++)t[i].apply(t,r)}}]),e}());var sr={tcb:Ut,tencent:Ut,aliyun:Ae,private:xt,alipay:Kt},ur=new(function(){function e(){(0,_.default)(this,e)}return(0,m.default)(e,[{key:"init",value:function(e){var t={},n=sr[e.provider];if(!n)throw new Error("未提供正确的provider参数");return t=n.init(e),function(e){e._initPromiseHub||(e._initPromiseHub=new B({createPromise:function(){var t=Promise.resolve();t=new Promise((function(e){setTimeout((function(){e()}),1)}));var n=e.auth();return t.then((function(){return n.getLoginState()})).then((function(e){return e?Promise.resolve():n.signInAnonymously()}))}}))}(t),un(t),function(e){var t=e.uploadFile;e.uploadFile=function(e){return t.call(this,e)}}(t),function(e){e.database=function(t){if(t&&Object.keys(t).length>0)return e.init(t).database();if(this._database)return this._database;var n=yn(In,{uniClient:e});return this._database=n,n},e.databaseForJQL=function(t){if(t&&Object.keys(t).length>0)return e.init(t).databaseForJQL();if(this._databaseForJQL)return this._databaseForJQL;var n=yn(In,{uniClient:e,isJQL:!0});return this._databaseForJQL=n,n}}(t),function(e){e.getCurrentUserInfo=Xn,e.chooseAndUploadFile=Zn.initChooseAndUploadFile(e),Object.assign(e,{get mixinDatacom(){return Qn(e)}}),e.SSEChannel=ar,e.initSecureNetworkByWeixin=function(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.openid,r=t.callLoginByWeixin,o=void 0!==r&&r;return rr.call(e,{openid:n,callLoginByWeixin:o})}}(e),e.importObject=function(e){return function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.customUI=t.customUI||e.customUI,e.parseSystemError=t.parseSystemError||e.parseSystemError,Object.assign(e.loadingOptions,t.loadingOptions),Object.assign(e.errorOptions,t.errorOptions),"object"==(0,c.default)(t.secretMethods)&&(e.secretMethods=t.secretMethods),e}({customUI:!1,loadingOptions:{title:"加载中...",mask:!0},errorOptions:{type:"modal",retry:!1}},n);var o=n,i=o.customUI,s=o.loadingOptions,u=o.errorOptions,l=o.parseSystemError,f=!i;return new Proxy({},{get:function(o,i){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.fn,n=e.interceptorName,r=e.getCallbackArgs;return(0,d.default)(a.default.mark((function e(){var o,i,s,u,c,l,d=arguments;return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(o=d.length,i=new Array(o),s=0;s<o;s++)i[s]=d[s];return u=r?r({params:i}):{},e.prev=2,e.next=5,ee(te(n,"invoke"),S({},u));case 5:return e.next=7,t.apply(void 0,i);case 7:return c=e.sent,e.next=10,ee(te(n,"success"),S(S({},u),{},{result:c}));case 10:return e.abrupt("return",c);case 13:return e.prev=13,e.t0=e["catch"](2),l=e.t0,e.next=18,ee(te(n,"fail"),S(S({},u),{},{error:l}));case 18:throw l;case 19:return e.prev=19,e.next=22,ee(te(n,"complete"),S(S({},u),{},l?{error:l}:{result:c}));case 22:return e.finish(19);case 23:case"end":return e.stop()}}),e,null,[[2,13,19,23]])})))}({fn:function(){var o=(0,d.default)(a.default.mark((function o(){var h,g,v,_,m,y,I,M,T,E,C,k,b,D,A,O=arguments;return a.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:for(f&&r.showLoading({title:s.title,mask:s.mask}),g=O.length,v=new Array(g),_=0;_<g;_++)v[_]=O[_];return m={name:t,type:N,data:{method:i,params:v}},"object"==(0,c.default)(n.secretMethods)&&function(e,t){var n=t.data.method,r=e.secretMethods||{},o=r[n]||r["*"];o&&(t.secretType=o)}(n,m),y=!1,o.prev=5,o.next=8,e.callFunction(m);case 8:h=o.sent,o.next=14;break;case 11:o.prev=11,o.t0=o["catch"](5),y=!0,h={result:new Ie(o.t0)};case 14:if(I=h.result||{},M=I.errSubject,T=I.errCode,E=I.errMsg,C=I.newToken,f&&r.hideLoading(),C&&C.token&&C.tokenExpired&&(Se(C),pe(ae,S({},C))),!T){o.next=39;break}if(k=E,!y||!l){o.next=24;break}return o.next=20,l({objectName:t,methodName:i,params:v,errSubject:M,errCode:T,errMsg:E});case 20:if(o.t1=o.sent.errMsg,o.t1){o.next=23;break}o.t1=E;case 23:k=o.t1;case 24:if(!f){o.next=37;break}if("toast"!==u.type){o.next=29;break}r.showToast({title:k,icon:"none"}),o.next=37;break;case 29:if("modal"===u.type){o.next=31;break}throw new Error("Invalid errorOptions.type: ".concat(u.type));case 31:return o.next=33,(0,d.default)(a.default.mark((function e(){var t,n,o,i,s,u,c=arguments;return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=c.length>0&&void 0!==c[0]?c[0]:{},n=t.title,o=t.content,i=t.showCancel,s=t.cancelText,u=t.confirmText,e.abrupt("return",new Promise((function(e,t){r.showModal({title:n,content:o,showCancel:i,cancelText:s,confirmText:u,success:function(t){e(t)},fail:function(){e({confirm:!1,cancel:!0})}})})));case 2:case"end":return e.stop()}}),e)})))({title:"提示",content:k,showCancel:u.retry,cancelText:"取消",confirmText:u.retry?"重试":"确定"});case 33:if(b=o.sent,D=b.confirm,!u.retry||!D){o.next=37;break}return o.abrupt("return",p.apply(void 0,v));case 37:throw A=new Ie({subject:M,code:T,message:E,requestId:h.requestId}),A.detail=h.result,pe(oe,{type:ce,content:A}),A;case 39:return o.abrupt("return",(pe(oe,{type:ce,content:h.result}),h.result));case 40:case"end":return o.stop()}}),o,null,[[5,11]])})));function p(){return o.apply(this,arguments)}return p}(),interceptorName:"callObject",getCallbackArgs:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.params;return{objectName:t,methodName:i,params:n}}})}})}}(e)}(t),["callFunction","uploadFile","deleteFile","getTempFileURL","downloadFile","chooseAndUploadFile"].forEach((function(e){if(t[e]){var n=t[e];t[e]=function(){return n.apply(t,Array.from(arguments))},t[e]=function(e,t){return function(n){var r=this,o=!1;if("callFunction"===t){var i=n&&n.type||R;o=i!==R}var a="callFunction"===t&&!o,s=this._initPromiseHub.exec();n=n||{};var u=_e(n),c=u.success,l=u.fail,d=u.complete,f=s.then((function(){return o?Promise.resolve():ee(te(t,"invoke"),n)})).then((function(){return e.call(r,n)})).then((function(e){return o?Promise.resolve(e):ee(te(t,"success"),e).then((function(){return ee(te(t,"complete"),e)})).then((function(){return a&&pe(oe,{type:ue,content:e}),Promise.resolve(e)}))}),(function(e){return o?Promise.reject(e):ee(te(t,"fail"),e).then((function(){return ee(te(t,"complete"),e)})).then((function(){return pe(oe,{type:ue,content:e}),Promise.reject(e)}))}));if(!(c||l||d))return f;f.then((function(e){c&&c(e),d&&d(e),a&&pe(oe,{type:ue,content:e})}),(function(e){l&&l(e),d&&d(e),a&&pe(oe,{type:ue,content:e})}))}}(t[e],e).bind(t)}})),t.init=this.init,t}}]),e}());(function(){var e=Y,t={};if(e&&1===e.length)t=e[0],ur=ur.init(t),ur._isDefault=!0;else{var n;n=e&&e.length>0?"应用有多个服务空间，请通过uniCloud.init方法指定要使用的服务空间":"应用未关联服务空间，请在uniCloud目录右键关联服务空间",["auth","callFunction","uploadFile","deleteFile","getTempFileURL","downloadFile","database","getCurrentUSerInfo","importObject"].forEach((function(e){ur[e]=function(){return console.error(n),Promise.reject(new Ie({code:"SYS_ERR",message:n}))}}))}Object.assign(ur,{get mixinDatacom(){return Qn(ur)}}),Yn(ur),ur.addInterceptor=Z,ur.removeInterceptor=Q,ur.interceptObject=ne})();var cr=ur;t.default=cr}).call(this,n("c8ba"),n("543d")["default"],n("bc2e")["default"])},ae85:function(e,t,n){"use strict";var r=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n("7037")),i=r(n("970b")),a=r(n("5bc3")),s=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(t.date,t.selected),r=t.startDate,o=t.endDate,a=t.range;(0,i.default)(this,e),this.date=this.getDate(new Date),this.selected=n||[],this.startDate=r,this.endDate=o,this.range=a,this.cleanMultipleStatus(),this.weeks={},this.lastHover=!1}return(0,a.default)(e,[{key:"setDate",value:function(e){this.selectDate=this.getDate(e),this._getWeek(this.selectDate.fullDate)}},{key:"cleanMultipleStatus",value:function(){this.multipleStatus={before:"",after:"",data:[]}}},{key:"resetSatrtDate",value:function(e){this.startDate=e}},{key:"resetEndDate",value:function(e){this.endDate=e}},{key:"getDate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"day";e||(e=new Date),"object"!==(0,o.default)(e)&&(e=e.replace(/-/g,"/"));var r=new Date(e);switch(n){case"day":r.setDate(r.getDate()+t);break;case"month":if(31===r.getDate()&&t>0)r.setDate(r.getDate()+t);else{var i=r.getMonth();r.setMonth(i+t);var a=r.getMonth();t<0&&0!==i&&a-i>t&&r.setMonth(a+(a-i+t)),t>0&&a-i>t&&r.setMonth(a-(a-i-t))}break;case"year":r.setFullYear(r.getFullYear()+t);break}var s=r.getFullYear(),u=r.getMonth()+1<10?"0"+(r.getMonth()+1):r.getMonth()+1,c=r.getDate()<10?"0"+r.getDate():r.getDate();return{fullDate:s+"-"+u+"-"+c,year:s,month:u,date:c,day:r.getDay()}}},{key:"_getLastMonthDays",value:function(e,t){for(var n=[],r=e;r>0;r--){var o=new Date(t.year,t.month-1,1-r).getDate();n.push({date:o,month:t.month-1,disable:!0})}return n}},{key:"_currentMonthDys",value:function(e,t){for(var n=this,r=[],o=this.date.fullDate,i=function(e){var i=t.year+"-"+(t.month,t.month+"-")+(e<10?"0"+e:e),a=o===i,s=n.selected&&n.selected.find((function(e){if(n.dateEqual(i,e.date))return e})),u=!0,c=!0;n.startDate&&(u=n.dateCompare(n.startDate,i)),n.endDate&&(c=n.dateCompare(i,n.endDate));var l=n.multipleStatus.data,d=!1,f=-1;n.range&&(l&&(f=l.findIndex((function(e){return n.dateEqual(e,i)}))),-1!==f&&(d=!0));var p={fullDate:i,year:t.year,date:e,multiple:!!n.range&&d,beforeMultiple:n.isLogicBefore(i,n.multipleStatus.before,n.multipleStatus.after),afterMultiple:n.isLogicAfter(i,n.multipleStatus.before,n.multipleStatus.after),month:t.month,disable:!(u&&c),isDay:a,userChecked:!1};s&&(p.extraInfo=s),r.push(p)},a=1;a<=e;a++)i(a);return r}},{key:"_getNextMonthDays",value:function(e,t){for(var n=[],r=1;r<e+1;r++)n.push({date:r,month:Number(t.month)+1,disable:!0});return n}},{key:"getInfo",value:function(e){var t=this;e||(e=new Date);var n=this.canlender.find((function(n){return n.fullDate===t.getDate(e).fullDate}));return n}},{key:"dateCompare",value:function(e,t){return e=new Date(e.replace("-","/").replace("-","/")),t=new Date(t.replace("-","/").replace("-","/")),e<=t}},{key:"dateEqual",value:function(e,t){return e=new Date(e.replace("-","/").replace("-","/")),t=new Date(t.replace("-","/").replace("-","/")),e.getTime()-t.getTime()===0}},{key:"isLogicBefore",value:function(e,t,n){var r=t;return t&&n&&(r=this.dateCompare(t,n)?t:n),this.dateEqual(r,e)}},{key:"isLogicAfter",value:function(e,t,n){var r=n;return t&&n&&(r=this.dateCompare(t,n)?n:t),this.dateEqual(r,e)}},{key:"geDateAll",value:function(e,t){var n=[],r=e.split("-"),o=t.split("-"),i=new Date;i.setFullYear(r[0],r[1]-1,r[2]);var a=new Date;a.setFullYear(o[0],o[1]-1,o[2]);for(var s=i.getTime()-864e5,u=a.getTime()-864e5,c=s;c<=u;)c+=864e5,n.push(this.getDate(new Date(parseInt(c))).fullDate);return n}},{key:"setMultiple",value:function(e){var t=this.multipleStatus,n=t.before,r=t.after;if(this.range){if(n&&r){if(!this.lastHover)return void(this.lastHover=!0);this.multipleStatus.before=e,this.multipleStatus.after="",this.multipleStatus.data=[],this.multipleStatus.fulldate="",this.lastHover=!1}else n?(this.multipleStatus.after=e,this.dateCompare(this.multipleStatus.before,this.multipleStatus.after)?this.multipleStatus.data=this.geDateAll(this.multipleStatus.before,this.multipleStatus.after):this.multipleStatus.data=this.geDateAll(this.multipleStatus.after,this.multipleStatus.before),this.lastHover=!0):(this.multipleStatus.before=e,this.lastHover=!1);this._getWeek(e)}}},{key:"setHoverMultiple",value:function(e){var t=this.multipleStatus,n=t.before;t.after;this.range&&(this.lastHover||(n?(this.multipleStatus.after=e,this.dateCompare(this.multipleStatus.before,this.multipleStatus.after)?this.multipleStatus.data=this.geDateAll(this.multipleStatus.before,this.multipleStatus.after):this.multipleStatus.data=this.geDateAll(this.multipleStatus.after,this.multipleStatus.before)):this.multipleStatus.before=e,this._getWeek(e)))}},{key:"setDefaultMultiple",value:function(e,t){this.multipleStatus.before=e,this.multipleStatus.after=t,e&&t&&(this.dateCompare(e,t)?(this.multipleStatus.data=this.geDateAll(e,t),this._getWeek(t)):(this.multipleStatus.data=this.geDateAll(t,e),this._getWeek(e)))}},{key:"_getWeek",value:function(e){var t=this.getDate(e),n=(t.fullDate,t.year),r=t.month,o=(t.date,t.day,new Date(n,r-1,1).getDay()),i=new Date(n,r,0).getDate(),a={lastMonthDays:this._getLastMonthDays(o,this.getDate(e)),currentMonthDys:this._currentMonthDys(i,this.getDate(e)),nextMonthDays:[],weeks:[]},s=[],u=42-(a.lastMonthDays.length+a.currentMonthDys.length);a.nextMonthDays=this._getNextMonthDays(u,this.getDate(e)),s=s.concat(a.lastMonthDays,a.currentMonthDys,a.nextMonthDays);for(var c={},l=0;l<s.length;l++)l%7===0&&(c[parseInt(l/7)]=new Array(7)),c[parseInt(l/7)][l%7]=s[l];this.canlender=s,this.weeks=c}}]),e}(),u=s;t.default=u},b012:function(e){e.exports=JSON.parse('{"uni-datetime-picker.selectDate":"選擇日期","uni-datetime-picker.selectTime":"選擇時間","uni-datetime-picker.selectDateTime":"選擇日期時間","uni-datetime-picker.startDate":"開始日期","uni-datetime-picker.endDate":"結束日期","uni-datetime-picker.startTime":"開始时间","uni-datetime-picker.endTime":"結束时间","uni-datetime-picker.ok":"確定","uni-datetime-picker.clear":"清除","uni-datetime-picker.cancel":"取消","uni-datetime-picker.year":"年","uni-datetime-picker.month":"月","uni-calender.SUN":"日","uni-calender.MON":"一","uni-calender.TUE":"二","uni-calender.WED":"三","uni-calender.THU":"四","uni-calender.FRI":"五","uni-calender.SAT":"六","uni-calender.confirm":"確認"}')},b17c:function(e,t,n){var r=n("4a4b"),o=n("6f8f");function i(t,n,a){return o()?(e.exports=i=Reflect.construct.bind(),e.exports.__esModule=!0,e.exports["default"]=e.exports):(e.exports=i=function(e,t,n){var o=[null];o.push.apply(o,t);var i=Function.bind.apply(e,o),a=new i;return n&&r(a,n.prototype),a},e.exports.__esModule=!0,e.exports["default"]=e.exports),i.apply(null,arguments)}e.exports=i,e.exports.__esModule=!0,e.exports["default"]=e.exports},b1c5:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={lunarInfo:[19416,19168,42352,21717,53856,55632,91476,22176,39632,21970,19168,42422,42192,53840,119381,46400,54944,44450,38320,84343,18800,42160,46261,27216,27968,109396,11104,38256,21234,18800,25958,54432,59984,28309,23248,11104,100067,37600,116951,51536,54432,120998,46416,22176,107956,9680,37584,53938,43344,46423,27808,46416,86869,19872,42416,83315,21168,43432,59728,27296,44710,43856,19296,43748,42352,21088,62051,55632,23383,22176,38608,19925,19152,42192,54484,53840,54616,46400,46752,103846,38320,18864,43380,42160,45690,27216,27968,44870,43872,38256,19189,18800,25776,29859,59984,27480,23232,43872,38613,37600,51552,55636,54432,55888,30034,22176,43959,9680,37584,51893,43344,46240,47780,44368,21977,19360,42416,86390,21168,43312,31060,27296,44368,23378,19296,42726,42208,53856,60005,54576,23200,30371,38608,19195,19152,42192,118966,53840,54560,56645,46496,22224,21938,18864,42359,42160,43600,111189,27936,44448,84835,37744,18936,18800,25776,92326,59984,27424,108228,43744,41696,53987,51552,54615,54432,55888,23893,22176,42704,21972,21200,43448,43344,46240,46758,44368,21920,43940,42416,21168,45683,26928,29495,27296,44368,84821,19296,42352,21732,53600,59752,54560,55968,92838,22224,19168,43476,41680,53584,62034,54560],solarMonth:[31,28,31,30,31,30,31,31,30,31,30,31],Gan:["甲","乙","丙","丁","戊","己","庚","辛","壬","癸"],Zhi:["子","丑","寅","卯","辰","巳","午","未","申","酉","戌","亥"],Animals:["鼠","牛","虎","兔","龙","蛇","马","羊","猴","鸡","狗","猪"],solarTerm:["小寒","大寒","立春","雨水","惊蛰","春分","清明","谷雨","立夏","小满","芒种","夏至","小暑","大暑","立秋","处暑","白露","秋分","寒露","霜降","立冬","小雪","大雪","冬至"],sTermInfo:["9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c3598082c95f8c965cc920f","97bd0b06bdb0722c965ce1cfcc920f","b027097bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c359801ec95f8c965cc920f","97bd0b06bdb0722c965ce1cfcc920f","b027097bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c359801ec95f8c965cc920f","97bd0b06bdb0722c965ce1cfcc920f","b027097bd097c36b0b6fc9274c91aa","9778397bd19801ec9210c965cc920e","97b6b97bd19801ec95f8c965cc920f","97bd09801d98082c95f8e1cfcc920f","97bd097bd097c36b0b6fc9210c8dc2","9778397bd197c36c9210c9274c91aa","97b6b97bd19801ec95f8c965cc920e","97bd09801d98082c95f8e1cfcc920f","97bd097bd097c36b0b6fc9210c8dc2","9778397bd097c36c9210c9274c91aa","97b6b97bd19801ec95f8c965cc920e","97bcf97c3598082c95f8e1cfcc920f","97bd097bd097c36b0b6fc9210c8dc2","9778397bd097c36c9210c9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c3598082c95f8c965cc920f","97bd097bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c3598082c95f8c965cc920f","97bd097bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c359801ec95f8c965cc920f","97bd097bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c359801ec95f8c965cc920f","97bd097bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf97c359801ec95f8c965cc920f","97bd097bd07f595b0b6fc920fb0722","9778397bd097c36b0b6fc9210c8dc2","9778397bd19801ec9210c9274c920e","97b6b97bd19801ec95f8c965cc920f","97bd07f5307f595b0b0bc920fb0722","7f0e397bd097c36b0b6fc9210c8dc2","9778397bd097c36c9210c9274c920e","97b6b97bd19801ec95f8c965cc920f","97bd07f5307f595b0b0bc920fb0722","7f0e397bd097c36b0b6fc9210c8dc2","9778397bd097c36c9210c9274c91aa","97b6b97bd19801ec9210c965cc920e","97bd07f1487f595b0b0bc920fb0722","7f0e397bd097c36b0b6fc9210c8dc2","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf7f1487f595b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf7f1487f595b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf7f1487f531b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c965cc920e","97bcf7f1487f531b0b0bb0b6fb0722","7f0e397bd07f595b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b97bd19801ec9210c9274c920e","97bcf7f0e47f531b0b0bb0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","9778397bd097c36b0b6fc9210c91aa","97b6b97bd197c36c9210c9274c920e","97bcf7f0e47f531b0b0bb0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","9778397bd097c36b0b6fc9210c8dc2","9778397bd097c36c9210c9274c920e","97b6b7f0e47f531b0723b0b6fb0722","7f0e37f5307f595b0b0bc920fb0722","7f0e397bd097c36b0b6fc9210c8dc2","9778397bd097c36b0b70c9274c91aa","97b6b7f0e47f531b0723b0b6fb0721","7f0e37f1487f595b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc9210c8dc2","9778397bd097c36b0b6fc9274c91aa","97b6b7f0e47f531b0723b0b6fb0721","7f0e27f1487f595b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","9778397bd097c36b0b6fc9274c91aa","97b6b7f0e47f531b0723b0787b0721","7f0e27f0e47f531b0b0bb0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","9778397bd097c36b0b6fc9210c91aa","97b6b7f0e47f149b0723b0787b0721","7f0e27f0e47f531b0723b0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","9778397bd097c36b0b6fc9210c8dc2","977837f0e37f149b0723b0787b0721","7f07e7f0e47f531b0723b0b6fb0722","7f0e37f5307f595b0b0bc920fb0722","7f0e397bd097c35b0b6fc9210c8dc2","977837f0e37f14998082b0787b0721","7f07e7f0e47f531b0723b0b6fb0721","7f0e37f1487f595b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc9210c8dc2","977837f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","977837f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e397bd097c35b0b6fc920fb0722","977837f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","977837f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","977837f0e37f14998082b0787b06bd","7f07e7f0e47f149b0723b0787b0721","7f0e27f0e47f531b0b0bb0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","977837f0e37f14998082b0723b06bd","7f07e7f0e37f149b0723b0787b0721","7f0e27f0e47f531b0723b0b6fb0722","7f0e397bd07f595b0b0bc920fb0722","977837f0e37f14898082b0723b02d5","7ec967f0e37f14998082b0787b0721","7f07e7f0e47f531b0723b0b6fb0722","7f0e37f1487f595b0b0bb0b6fb0722","7f0e37f0e37f14898082b0723b02d5","7ec967f0e37f14998082b0787b0721","7f07e7f0e47f531b0723b0b6fb0722","7f0e37f1487f531b0b0bb0b6fb0722","7f0e37f0e37f14898082b0723b02d5","7ec967f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e37f1487f531b0b0bb0b6fb0722","7f0e37f0e37f14898082b072297c35","7ec967f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e37f0e37f14898082b072297c35","7ec967f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e37f0e366aa89801eb072297c35","7ec967f0e37f14998082b0787b06bd","7f07e7f0e47f149b0723b0787b0721","7f0e27f1487f531b0b0bb0b6fb0722","7f0e37f0e366aa89801eb072297c35","7ec967f0e37f14998082b0723b06bd","7f07e7f0e47f149b0723b0787b0721","7f0e27f0e47f531b0723b0b6fb0722","7f0e37f0e366aa89801eb072297c35","7ec967f0e37f14998082b0723b06bd","7f07e7f0e37f14998083b0787b0721","7f0e27f0e47f531b0723b0b6fb0722","7f0e37f0e366aa89801eb072297c35","7ec967f0e37f14898082b0723b02d5","7f07e7f0e37f14998082b0787b0721","7f07e7f0e47f531b0723b0b6fb0722","7f0e36665b66aa89801e9808297c35","665f67f0e37f14898082b0723b02d5","7ec967f0e37f14998082b0787b0721","7f07e7f0e47f531b0723b0b6fb0722","7f0e36665b66a449801e9808297c35","665f67f0e37f14898082b0723b02d5","7ec967f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e36665b66a449801e9808297c35","665f67f0e37f14898082b072297c35","7ec967f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e26665b66a449801e9808297c35","665f67f0e37f1489801eb072297c35","7ec967f0e37f14998082b0787b06bd","7f07e7f0e47f531b0723b0b6fb0721","7f0e27f1487f531b0b0bb0b6fb0722"],nStr1:["日","一","二","三","四","五","六","七","八","九","十"],nStr2:["初","十","廿","卅"],nStr3:["正","二","三","四","五","六","七","八","九","十","冬","腊"],lYearDays:function(e){var t,n=348;for(t=32768;t>8;t>>=1)n+=this.lunarInfo[e-1900]&t?1:0;return n+this.leapDays(e)},leapMonth:function(e){return 15&this.lunarInfo[e-1900]},leapDays:function(e){return this.leapMonth(e)?65536&this.lunarInfo[e-1900]?30:29:0},monthDays:function(e,t){return t>12||t<1?-1:this.lunarInfo[e-1900]&65536>>t?30:29},solarDays:function(e,t){if(t>12||t<1)return-1;var n=t-1;return 1==n?e%4==0&&e%100!=0||e%400==0?29:28:this.solarMonth[n]},toGanZhiYear:function(e){var t=(e-3)%10,n=(e-3)%12;return 0==t&&(t=10),0==n&&(n=12),this.Gan[t-1]+this.Zhi[n-1]},toAstro:function(e,t){return"魔羯水瓶双鱼白羊金牛双子巨蟹狮子处女天秤天蝎射手魔羯".substr(2*e-(t<[20,19,21,21,21,22,23,23,23,23,22,22][e-1]?2:0),2)+"座"},toGanZhi:function(e){return this.Gan[e%10]+this.Zhi[e%12]},getTerm:function(e,t){if(e<1900||e>2100)return-1;if(t<1||t>24)return-1;var n=this.sTermInfo[e-1900],r=[parseInt("0x"+n.substr(0,5)).toString(),parseInt("0x"+n.substr(5,5)).toString(),parseInt("0x"+n.substr(10,5)).toString(),parseInt("0x"+n.substr(15,5)).toString(),parseInt("0x"+n.substr(20,5)).toString(),parseInt("0x"+n.substr(25,5)).toString()],o=[r[0].substr(0,1),r[0].substr(1,2),r[0].substr(3,1),r[0].substr(4,2),r[1].substr(0,1),r[1].substr(1,2),r[1].substr(3,1),r[1].substr(4,2),r[2].substr(0,1),r[2].substr(1,2),r[2].substr(3,1),r[2].substr(4,2),r[3].substr(0,1),r[3].substr(1,2),r[3].substr(3,1),r[3].substr(4,2),r[4].substr(0,1),r[4].substr(1,2),r[4].substr(3,1),r[4].substr(4,2),r[5].substr(0,1),r[5].substr(1,2),r[5].substr(3,1),r[5].substr(4,2)];return parseInt(o[t-1])},toChinaMonth:function(e){if(e>12||e<1)return-1;var t=this.nStr3[e-1];return t+="月",t},toChinaDay:function(e){var t;switch(e){case 10:t="初十";break;case 20:t="二十";break;case 30:t="三十";break;default:t=this.nStr2[Math.floor(e/10)],t+=this.nStr1[e%10]}return t},getAnimal:function(e){return this.Animals[(e-4)%12]},solar2lunar:function(e,t,n){if(e<1900||e>2100)return-1;if(1900==e&&1==t&&n<31)return-1;if(e)r=new Date(e,parseInt(t)-1,n);else var r=new Date;var o,i=0,a=(e=r.getFullYear(),t=r.getMonth()+1,n=r.getDate(),(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate())-Date.UTC(1900,0,31))/864e5);for(o=1900;o<2101&&a>0;o++)i=this.lYearDays(o),a-=i;a<0&&(a+=i,o--);var s=new Date,u=!1;s.getFullYear()==e&&s.getMonth()+1==t&&s.getDate()==n&&(u=!0);var c=r.getDay(),l=this.nStr1[c];0==c&&(c=7);var d=o,f=this.leapMonth(o),p=!1;for(o=1;o<13&&a>0;o++)f>0&&o==f+1&&0==p?(--o,p=!0,i=this.leapDays(d)):i=this.monthDays(d,o),1==p&&o==f+1&&(p=!1),a-=i;0==a&&f>0&&o==f+1&&(p?p=!1:(p=!0,--o)),a<0&&(a+=i,--o);var h=o,g=a+1,v=t-1,_=this.toGanZhiYear(d),m=this.getTerm(e,2*t-1),y=this.getTerm(e,2*t),I=this.toGanZhi(12*(e-1900)+t+11);n>=m&&(I=this.toGanZhi(12*(e-1900)+t+12));var M=!1,T=null;m==n&&(M=!0,T=this.solarTerm[2*t-2]),y==n&&(M=!0,T=this.solarTerm[2*t-1]);var S=Date.UTC(e,v,1,0,0,0,0)/864e5+25567+10,E=this.toGanZhi(S+n-1),C=this.toAstro(t,n);return{lYear:d,lMonth:h,lDay:g,Animal:this.getAnimal(d),IMonthCn:(p?"闰":"")+this.toChinaMonth(h),IDayCn:this.toChinaDay(g),cYear:e,cMonth:t,cDay:n,gzYear:_,gzMonth:I,gzDay:E,isToday:u,isLeap:p,nWeek:c,ncWeek:"星期"+l,isTerm:M,Term:T,astro:C}},lunar2solar:function(e,t,n,r){r=!!r;var o=this.leapMonth(e);this.leapDays(e);if(r&&o!=t)return-1;if(2100==e&&12==t&&n>1||1900==e&&1==t&&n<31)return-1;var i=this.monthDays(e,t),a=i;if(r&&(a=this.leapDays(e,t)),e<1900||e>2100||n>a)return-1;for(var s=0,u=1900;u<e;u++)s+=this.lYearDays(u);var c=0,l=!1;for(u=1;u<t;u++)c=this.leapMonth(e),l||c<=u&&c>0&&(s+=this.leapDays(e),l=!0),s+=this.monthDays(e,u);r&&(s+=i);var d=Date.UTC(1900,1,30,0,0,0),f=new Date(864e5*(s+n-31)+d),p=f.getUTCFullYear(),h=f.getUTCMonth()+1,g=f.getUTCDate();return this.solar2lunar(p,h,g)}},o=r;t.default=o},b2e8:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.searchMessageTimeList=t.searchMessageTimeKeys=t.searchMessageTimeDefault=void 0;var r={all:{key:"all",label:"全部",value:{timePosition:0,timePeriod:0}},oneDay:{key:"today",label:"今天",value:{timePosition:0,timePeriod:86400}},threeDay:{key:"threeDays",label:"近三天",value:{timePosition:0,timePeriod:259200}},sevenDay:{key:"sevenDays",label:"近七天",value:{timePosition:0,timePeriod:604800}}};t.searchMessageTimeList=r;var o=Object.keys(r);t.searchMessageTimeKeys=o;var i=r["all"];t.searchMessageTimeDefault=i},b4d1:function(e,t,n){},b4fc:function(e,t,n){"use strict";var r=n("4ea4"),o=n("7037");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n("2eee")),a=r(n("c973")),s=r(n("970b")),u=r(n("5bc3")),c=r(n("9523")),l=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==o(e)&&"function"!==typeof e)return{default:e};var n=g(t);if(n&&n.has(e))return n.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(r,a,s):r[a]=e[a]}r.default=e,n&&n.set(e,r);return r}(n("e16a")),d=n("a6ed"),f=r(n("1056")),p=n("d31c"),h=n("8e85");function g(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(g=function(e){return e?n:t})(e)}var v=function(){function e(){(0,s.default)(this,e),(0,c.default)(this,"onCallParamsMap",void 0),(0,c.default)(this,"onCallCallbackMap",void 0),(0,c.default)(this,"constants",void 0),l.default.registerService(l.TUIConstants.TUIGroup.SERVICE.NAME,this),l.default.registerExtension(l.TUIConstants.TUIChat.EXTENSION.CHAT_HEADER.EXT_ID,this),this.onCallParamsMap=new Map,this.onCallCallbackMap=new Map,this.constants=l.TUIConstants}return(0,u.default)(e,[{key:"getOnCallParams",value:function(e){return this.onCallParamsMap.get(e)}},{key:"getOnCallCallback",value:function(e){return this.onCallCallbackMap.get(e)}},{key:"onCall",value:function(){var e=(0,a.default)(i.default.mark((function e(t,n,r){return i.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.onCallParamsMap.set(t,n),this.onCallCallbackMap.set(t,r),e.t0=t,e.next=e.t0===l.TUIConstants.TUIGroup.SERVICE.METHOD.CREATE_GROUP?5:e.t0===l.TUIConstants.TUIGroup.SERVICE.METHOD.OPEN_GROUP_MANAGEMENT?8:e.t0===l.TUIConstants.TUIGroup.SERVICE.METHOD.SELECT_GROUP_MEMBER?12:16;break;case 5:return d.TUIStore.update(d.StoreName.GRP,"isShowCreateComponent",!0),p.isUniFrameWork&&(null===h.TUIGlobal||void 0===h.TUIGlobal||h.TUIGlobal.reLaunch({url:"/TUIKit/components/TUIGroup/index"})),e.abrupt("break",16);case 8:return d.TUIGroupService.switchGroup(n.groupID),d.TUIStore.update(d.StoreName.GRP,"isShowManageComponent",!0),p.isUniFrameWork&&(null===h.TUIGlobal||void 0===h.TUIGlobal||h.TUIGlobal.navigateTo({url:"/TUIKit/components/TUIGroup/index"})),e.abrupt("break",16);case 12:return d.TUIGroupService.switchGroup(n.groupID),d.TUIStore.update(d.StoreName.GRP,"isShowSelectComponent",!0),p.isUniFrameWork&&(null===h.TUIGlobal||void 0===h.TUIGlobal||h.TUIGlobal.navigateTo({url:"/TUIKit/components/TUIGroup/index"})),e.abrupt("break",16);case 16:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"onGetExtension",value:function(e,t){var n=[];switch(e){case l.TUIConstants.TUIChat.EXTENSION.CHAT_HEADER.EXT_ID:null!==t&&void 0!==t&&t.filterManageGroup||n.push({weight:100,icon:f.default,text:"更多",data:{},listener:{onClicked:this.groupManage.bind(this)}});break}return n}},{key:"groupManage",value:function(e){l.default.callService({serviceName:l.TUIConstants.TUIGroup.SERVICE.NAME,method:l.TUIConstants.TUIGroup.SERVICE.METHOD.OPEN_GROUP_MANAGEMENT,params:e,callback:function(){p.isUniFrameWork&&(null===h.TUIGlobal||void 0===h.TUIGlobal||h.TUIGlobal.navigateBack())}})}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();t.default=v,(0,c.default)(v,"instance",void 0)},b9c3:function(e){e.exports=JSON.parse('{"uni-calender.ok":"確定","uni-calender.cancel":"取消","uni-calender.today":"今日","uni-calender.SUN":"日","uni-calender.MON":"一","uni-calender.TUE":"二","uni-calender.WED":"三","uni-calender.THU":"四","uni-calender.FRI":"五","uni-calender.SAT":"六"}')},b9f3:function(e,t,n){"use strict";var r=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n("5d05")),i=r(n("a285")),a=r(n("5297")),s=r(n("658f")),u=r(n("8e39")),c=r(n("6504")),l=r(n("c2eb")),d=r(n("4e95")),f=r(n("32e2")),p=r(n("9430")),h={zh_cn:{"取消":"取消","发送":"发送","系统通知":"系统通知","关闭":"关闭","确定":"确定","开始时间":"开始时间","结束时间":"结束时间",TUIChat:o.default,TUIConversation:i.default,TUIGroup:a.default,TUIContact:s.default,message:c.default,component:l.default,time:d.default,Evaluate:p.default,Words:f.default,TUISearch:u.default}},g=h;t.default=g},bbaa:function(e){e.exports=JSON.parse('{"uni-calender.ok":"确定","uni-calender.cancel":"取消","uni-calender.today":"今日","uni-calender.SUN":"日","uni-calender.MON":"一","uni-calender.TUE":"二","uni-calender.WED":"三","uni-calender.THU":"四","uni-calender.FRI":"五","uni-calender.SAT":"六"}')},bc2e:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=["qy","env","error","version","lanDebug","cloud","serviceMarket","router","worklet","__webpack_require_UNI_MP_PLUGIN__"],o=["lanDebug","router","worklet"],i="undefined"!==typeof globalThis?globalThis:function(){return this}(),a=["w","x"].join(""),s=i[a],u=s.getLaunchOptionsSync?s.getLaunchOptionsSync():null;function c(e){return(!u||1154!==u.scene||!o.includes(e))&&(r.indexOf(e)>-1||"function"===typeof s[e])}i[a]=function(){var e={};for(var t in s)c(t)&&(e[t]=s[t]);return e}();var l=i[a];t.default=l},bc6e:function(e,t,n){"use strict";var r=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n("2e5d")),i=r(n("bebe")),a=r(n("1106")),s={en:o.default,"zh-Hans":i.default,"zh-Hant":a.default};t.default=s},be0f:function(e,t,n){"use strict";var r=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.searchMessageTypeList=t.searchMessageTypeKeys=t.searchMessageTypeDefault=t.searchMessageSingleTypeKeys=t.searchInGlobalDefaultType=t.searchInConversationDefaultType=t.globalSearchTypeList=t.globalSearchTypeKeys=t.conversationSearchTypeList=t.conversationSearchTypeKeys=t.allMessageTypeList=void 0;var o=r(n("a6ed")),i=[o.default.TYPES.MSG_TEXT,o.default.TYPES.MSG_FILE,o.default.TYPES.MSG_IMAGE,o.default.TYPES.MSG_VIDEO,o.default.TYPES.MSG_AUDIO,o.default.TYPES.MSG_LOCATION,o.default.TYPES.MSG_CUSTOM,o.default.TYPES.MSG_MERGER];t.allMessageTypeList=i;var a={allMessage:{key:"allMessage",label:"全部",value:i},textMessage:{key:"textMessage",label:"文本",value:[o.default.TYPES.MSG_TEXT]},fileMessage:{key:"fileMessage",label:"文件",value:[o.default.TYPES.MSG_FILE]},imageMessage:{key:"imageMessage",label:"图片/视频",value:[o.default.TYPES.MSG_IMAGE,o.default.TYPES.MSG_VIDEO]},otherMessage:{key:"otherMessage",label:"其他",value:[o.default.TYPES.MSG_AUDIO,o.default.TYPES.MSG_LOCATION,o.default.TYPES.MSG_CUSTOM,o.default.TYPES.MSG_MERGER]}};t.searchMessageTypeList=a;var s=Object.keys(a);t.searchMessageTypeKeys=s;var u=Object.keys(a).filter((function(e){return"all"!==e}));t.searchMessageSingleTypeKeys=u;var c=a["allMessage"];t.searchInGlobalDefaultType=c;var l=a["textMessage"];t.searchInConversationDefaultType=l;var d={global:c,conversation:l};t.searchMessageTypeDefault=d;var f=["allMessage","textMessage","fileMessage","otherMessage"];t.globalSearchTypeKeys=f;var p=Object.keys(a).filter((function(e){return null===f||void 0===f?void 0:f.includes(e)})).reduce((function(e,t){return e[t]=a[t],e}),{});t.globalSearchTypeList=p;var h=["textMessage","fileMessage","imageMessage","otherMessage"];t.conversationSearchTypeKeys=h;var g=Object.keys(a).filter((function(e){return null===h||void 0===h?void 0:h.includes(e)})).reduce((function(e,t){return e[t]=a[t],e}),{});t.conversationSearchTypeList=g},bebe:function(e){e.exports=JSON.parse('{"uni-load-more.contentdown":"上拉显示更多","uni-load-more.contentrefresh":"正在加载...","uni-load-more.contentnomore":"没有更多数据了"}')},bf01:function(e){e.exports=JSON.parse('{"uni-calender.ok":"ok","uni-calender.cancel":"cancel","uni-calender.today":"today","uni-calender.MON":"MON","uni-calender.TUE":"TUE","uni-calender.WED":"WED","uni-calender.THU":"THU","uni-calender.FRI":"FRI","uni-calender.SAT":"SAT","uni-calender.SUN":"SUN"}')},c135:function(e,t){e.exports=function(e){if(Array.isArray(e))return e},e.exports.__esModule=!0,e.exports["default"]=e.exports},c1fa:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;var r=n("66fd");t.init=function(){var e,t=r.default?r.default:r,n=t.config.optionMergeStrategies.mounted;t.config.optionMergeStrategies.mounted=function(t,r){var o=n.call(this,t,r);if(Array.isArray(o)){var i=void 0;e?i=o.indexOf(e):(i=o.findIndex((function(e){return e.toString().includes("onReady")})),e=o[i]),-1!==i&&(o.splice(i,1),o.push(e))}return o}}},c240:function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports["default"]=e.exports},c2eb:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={"取消":"取消","完成":"完成","已选中":"已选中","人":"人","保存":"保存","请输入userID":"请输入userID","请输入groupID":"请输入groupID","确定":"确定","全选":"全选","已在群聊中":"已在群聊中","查看更多":"查看更多","图片 url 不存在":"图片 url 不存在","已取消":"已取消","获取权限失败":"获取权限失败","已保存至相册":"已保存至相册","图片下载失败":"图片下载失败","暂不支持下载此类型图片":"暂不支持下载此类型图片"};t.default=r},c59a:function(e,t,n){"use strict";var r=n("25d1"),o=n.n(r);o.a},c5f7:function(e,t){e.exports=function(e){return-1!==Function.toString.call(e).indexOf("[native code]")},e.exports.__esModule=!0,e.exports["default"]=e.exports},c8ba:function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(r){"object"===typeof window&&(n=window)}e.exports=n},c973:function(e,t){function n(e,t,n,r,o,i,a){try{var s=e[i](a),u=s.value}catch(c){return void n(c)}s.done?t(u):Promise.resolve(u).then(r,o)}e.exports=function(e){return function(){var t=this,r=arguments;return new Promise((function(o,i){var a=e.apply(t,r);function s(e){n(a,o,i,s,u,"next",e)}function u(e){n(a,o,i,s,u,"throw",e)}s(void 0)}))}},e.exports.__esModule=!0,e.exports["default"]=e.exports},d085:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={tip:{"群成员":"group members","加入群组":"joined the group","退出群组":"left the group","被":"by","踢出群组":"was kicked out of the group","成为管理员":"was set as an admin","被撤销管理员":"was revoked","被禁言":" was unmuted","被取消禁言":"cancel the prohibition","群提示消息":"group prompt message","管理员":"The admin","开启全员禁言":"enabled Mute All","取消全员禁言":"disabled Mute All","成为新的群主":"became the new group owner","修改群名为":"changed the group name to","发布新公告":"posted a new notice","申请加入群组":"requested to join the group","成功加入群组":"Successfully joined the group","被拒绝":"The request to join the group was refused","你被管理员":"You","群":"group","解散":"disbanded","创建群":"created the group","邀请你加群":"invite you to join the group","你退出群组":"You left the group","你被":"You were","设置为群":"set as group","的管理员":"as an admin","撤销群":"revoked","的管理员身份":"admin role of the group","同意加群":"agreed to join the group","拒接加群":"refused to join the group","自定义群系统通知":"Custom group system notification"},custom:{"自定义消息":"Custom message","通话时长":"Call duration","结束群聊":"End","切换语音通话":"Switch voice call","切换视频通话":"Switch video call","发起通话":"Start a call","取消通话":"Cancel","已接听":"Answered","拒绝通话":"Decline","无应答":"No answer","对本次服务评价":"Rate this service","查看详情>>":"View details >>"}};t.default=r},d153:function(e,t,n){(function(e){var t=n("7037");e.addInterceptor({returnValue:function(e){return!e||"object"!==t(e)&&"function"!==typeof e||"function"!==typeof e.then?e:new Promise((function(t,n){e.then((function(e){return e[0]?n(e[0]):t(e[1])}))}))}})}).call(this,n("543d")["default"])},d31c:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.isWeChat=t.isUniFrameWork=t.isPC=t.isMobile=t.isH5=t.isApp=void 0;var r=n("8e85"),o="pc"===(0,r.getPlatform)();t.isPC=o;var i="h5"===(0,r.getPlatform)();t.isH5=i;var a="wechat"===(0,r.getPlatform)();t.isWeChat=a;var s="app"===(0,r.getPlatform)();t.isApp=s;var u="undefined"!==typeof e;t.isUniFrameWork=u;var c=i||a||s;t.isMobile=c}).call(this,n("543d")["default"])},d672:function(e,t,n){"use strict";var r=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n("bf01")),i=r(n("bbaa")),a=r(n("b9c3")),s={en:o.default,"zh-Hans":i.default,"zh-Hant":a.default};t.default=s},d782:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={"取消":"Cancel","完成":"Done","已选中":"Selected","人":"","保存":"Save","请输入userID":"Enter a userID","请输入groupID":"Enter a groupID","确定":"submit","全选":"All","已在群聊中":"exists","查看更多":"More","图片 url 不存在":"Image url does not exist","已取消":"Cancelled","获取权限失败":"Failed to obtain permission","已保存至相册":"Saved to album","图片下载失败":"Image download failed","暂不支持下载此类型图片":"Downloading this type of pictures is not supported yet"};t.default=r},d783:function(e,t,n){"use strict";(function(e){t.__esModule=!0,t.initUtsClassName=t.initUtsIndexClassName=t.initUtsPackageName=t.initUtsProxyClass=t.initUtsProxyFunction=t.normalizeArg=void 0;var r,o=n("914e"),i=1,a={};function s(e){if("function"===typeof e){var t=Object.keys(a).find((function(t){return a[t]===e})),n=t?parseInt(t):i++;return a[n]=e,n}return(0,o.isPlainObject)(e)&&Object.keys(e).forEach((function(t){e[t]=s(e[t])})),e}function u(e,t,n){return f(e,t,n)}function c(){return r||(r=e.requireNativePlugin("UTS-Proxy")),r}function l(e){if(e.errMsg)throw new Error(e.errMsg);return e.params}function d(e){if(e.errMsg)throw new Error(e.errMsg);return delete e.errMsg,l(c().invokeSync(e,(function(){})))}function f(e,t,n){var r=t.package,i=t["class"],u=t.name,d=t.method,f=t.companion,p=t.params,h=t.errMsg,g=function(e){var t=e.id,n=e.name,o=e.params,s=e.keepAlive,c=a[t];c?(c.apply(void 0,o),s||delete a[t]):console.error("".concat(r).concat(i,".").concat(u," ").concat(n," is not found"))},v=n?{id:n,name:u,method:p}:{package:r,class:i,name:d||u,companion:f,method:p};return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(h)throw new Error(h);var r=(0,o.extend)({},v,{params:t.map((function(e){return s(e)}))});return e?new Promise((function(e,t){c().invokeAsync(r,(function(n){"return"!==n.type?g(n):n.errMsg?t(n.errMsg):e(n.params)}))})):l(c().invokeSync(r,g))}}function p(e,t){return t.main&&!t.method&&"undefined"!==typeof plus&&"iOS"===plus.os.name&&(t.method="s_"+t.name),f(e,t,0)}function h(e,t,n){return"undefined"===typeof plus?"":"Android"===plus.os.name?t:"iOS"===plus.os.name?"UTSSDK"+(n?"Modules":"")+(0,o.capitalize)(e)+(0,o.capitalize)(t):""}t.normalizeArg=s,t.initUtsProxyFunction=p,t.initUtsProxyClass=function(e){var t=e.package,n=e["class"],r=e.constructor.params,i=e.methods,a=e.props,s=e.staticProps,c=e.staticMethods,l=e.errMsg,h={package:t,class:n,errMsg:l},g=function(){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(l)throw new Error(l);var s={},c=f(!1,(0,o.extend)({name:"constructor",params:r},h),0).apply(null,e);if(!c)throw new Error("new ".concat(n," is failed"));return new Proxy(this,{get:function(e,t){if(!s[t])if((0,o.hasOwn)(i,t)){var n=i[t],r=n.async,f=n.params;s[t]=u(!!r,(0,o.extend)({name:t,params:f},h),c)}else if(a.includes(t))return d({id:c,name:t,errMsg:l});return s[t]}})}}(),v={};return new Proxy(g,{get:function(e,t,n){if((0,o.hasOwn)(c,t)){if(!v[t]){var r=c[t],i=r.async,a=r.params;v[t]=p(!!i,(0,o.extend)({name:t,companion:!0,params:a},h))}return v[t]}return s.includes(t)?d((0,o.extend)({name:t,companion:!0},h)):Reflect.get(e,t,n)}})},t.initUtsPackageName=function(e,t){return"undefined"!==typeof plus&&"Android"===plus.os.name?"uts.sdk."+(t?"modules.":"")+e:""},t.initUtsIndexClassName=function(e,t){return"undefined"===typeof plus?"":h(e,"iOS"===plus.os.name?"IndexSwift":"IndexKt",t)},t.initUtsClassName=h}).call(this,n("543d")["default"])},d7d6:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA0AAAAPCAYAAAA/I0V3AAAAAXNSR0IArs4c6QAAAWlJREFUOE9t0j+oT3EYx/HXx8Ci7iCRQSELxSS5IWVSom4ZDaIUUZQMQjEpZGG5y73FyL0mxSJluAtK+ZNFMegqo4U8+nKOjnt/p751Op/nfZ7P9/M8MXiqagtOYDdW4Cue4naSt31p+pequoR2nuEhvmANJrAdG5J8avV/oKo6j8s4nOT+sHunb8YbrEwyn6pah3c4muRuV7QUa/Exyc/u2zgeY2ODruBgkq2duAMzWIXPOJDkZVUtwXtMNugJXiRpFpvVV/iAi7iOsSS7Ou0OVjdoDg+SXOuEbzibZKqqTuFckma1/fAqxhvUrMwnOd4Jk80SZnEI00nOdNo9/GpQm0uLen2S71W1DM3qNjzHjSQ/qmqsBYPTDVreXXA2ycmFcQ/mOI2d2NTPaQ8e4WaSCyPmdAvHsDfJ3HAj9rVAFoJV1QP7k7SV+rsRAwv/gaOARVCXUA++bv7xr8OihR3RsQ3ySG9pqP8GK32m/BDtDP4AAAAASUVORK5CYII="},d87d:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n={UNITS:{"年":315576e5,"月":26298e5,"天":864e5,"小时":36e5,"分钟":6e4,"秒":1e3},humanize:function(e){var t="";for(var n in this.UNITS)if(e>=this.UNITS[n]){t=Math.floor(e/this.UNITS[n])+n+"前";break}return t||"刚刚"},format:function(e){var t=this.parse(e),n=Date.now()-t.getTime();if(n<this.UNITS["天"])return this.humanize(n);var r=function(e){return e<10?"0"+e:e};return t.getFullYear()+"/"+r(t.getMonth()+1)+"/"+r(t.getDate())+"-"+r(t.getHours())+":"+r(t.getMinutes())},parse:function(e){var t=e.split(/[^0-9]/);return new Date(t[0],t[1]-1,t[2],t[3],t[4],t[5])},isEmpty:function(e){return""===e||void 0===e||null===e},isTel:function(e){return/^1[3456789]\d{9}$/.test(e)},isIDcard:function(e){return/(^\d{15}$)|(^\d{17}(\d|X|x)$)/.test(e)}},r={formatTime:function(e){if("number"!==typeof e||e<0)return e;var t=parseInt(e/3600);e%=3600;var n=parseInt(e/60);e%=60;var r=e;return[t,n,r].map((function(e){return e=e.toString(),e[1]?e:"0"+e})).join(":")},formatLocation:function(e,t){return"string"===typeof e&&"string"===typeof t&&(e=parseFloat(e),t=parseFloat(t)),e=e.toFixed(2),t=t.toFixed(2),{longitude:e.toString().split("."),latitude:t.toString().split(".")}},onNetWork:function(){var t=function(t){"none"===t.networkType&&e.showToast({title:"当前处于断网状态,请先连接",icon:"none"})};e.getNetworkType({success:t}),e.onNetworkStatusChange(t)},dateUtils:n,pathToBase64:function(t){var n=new Promise((function(n,r){e.getFileSystemManager().readFile({filePath:t,encoding:"base64",success:function(e){var t="data:image/jpg;base64,"+e.data;n(t)},fail:function(e){return r(e.errMsg)}})}));return n},gotoPage:function(t){e.navigateTo({url:t})},gotoPageTab:function(t){e.switchTab({url:t})},backPage:function(t){e.navigateBack(t)},checkTip:function(t){e.showToast({icon:"none",title:t})},gotoPageAndClosePage:function(t){e.reLaunch({url:t})}};t.default=r}).call(this,n("543d")["default"])},dafa:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EMOJI_TYPE=t.DIALOG_CONTENT=t.CONV_OPERATION=t.CONV_CREATE_TYPE=t.CONTACT_INFO_MORE_EDIT_TYPE=t.CONTACT_INFO_LABEL_POSITION=t.CONTACT_INFO_BUTTON_TYPE=t.CHAT_MSG_CUSTOM_TYPE=void 0;t.CONV_OPERATION={DELETE:"delete",ISPINNED:"ispinned",DISPINNED:"dispinned",MUTE:"mute",NOTMUTE:"notmute"};t.CONV_CREATE_TYPE={TYPEC2C:"isC2C",TYPEGROUP:"isGroup",JOINGROUP:"joinGroup"};t.CHAT_MSG_CUSTOM_TYPE={SERVICE:"consultion",EVALUATE:"evaluation",LINK:"text_link",CALL:1,ORDER:"order"};t.DIALOG_CONTENT={USERLIST:"userList",GROUPINFORMATION:"groupInformation"};t.EMOJI_TYPE={BASIC:"basic",BIG:"big",CUSTOM:"CUSTOM"};t.CONTACT_INFO_LABEL_POSITION={LEFT:"left",TOP:"top"};t.CONTACT_INFO_MORE_EDIT_TYPE={INPUT:"input",TEXTAREA:"textarea",SWITCH:"switch"};t.CONTACT_INFO_BUTTON_TYPE={SUBMIT:"submit",CANCEL:"cancel"}},dea3:function(e,t,n){"use strict";(function(e){var r=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n("7037")),i={props:{localdata:{type:[Array,Object],default:function(){return[]}},spaceInfo:{type:Object,default:function(){return{}}},collection:{type:String,default:""},action:{type:String,default:""},field:{type:String,default:""},orderby:{type:String,default:""},where:{type:[String,Object],default:""},pageData:{type:String,default:"add"},pageCurrent:{type:Number,default:1},pageSize:{type:Number,default:20},getcount:{type:[Boolean,String],default:!1},getone:{type:[Boolean,String],default:!1},gettree:{type:[Boolean,String],default:!1},manual:{type:Boolean,default:!1},value:{type:[Array,String,Number],default:function(){return[]}},modelValue:{type:[Array,String,Number],default:function(){return[]}},preload:{type:Boolean,default:!1},stepSearh:{type:Boolean,default:!0},selfField:{type:String,default:""},parentField:{type:String,default:""},multiple:{type:Boolean,default:!1},map:{type:Object,default:function(){return{text:"text",value:"value"}}}},data:function(){return{loading:!1,errorMessage:"",loadMore:{contentdown:"",contentrefresh:"",contentnomore:""},dataList:[],selected:[],selectedIndex:0,page:{current:this.pageCurrent,size:this.pageSize,count:0}}},computed:{isLocaldata:function(){return!this.collection.length},postField:function(){var e=[this.field];return this.parentField&&e.push("".concat(this.parentField," as parent_value")),e.join(",")},dataValue:function(){var e=Array.isArray(this.modelValue)?this.modelValue.length>0:null!==this.modelValue||void 0!==this.modelValue;return e?this.modelValue:this.value},hasValue:function(){return"number"===typeof this.dataValue||null!=this.dataValue&&this.dataValue.length>0}},created:function(){var e=this;this.$watch((function(){var t=[];return["pageCurrent","pageSize","spaceInfo","value","modelValue","localdata","collection","action","field","orderby","where","getont","getcount","gettree"].forEach((function(n){t.push(e[n])})),t}),(function(t,n){for(var r=2;r<t.length;r++)if(t[r]!=n[r]){!0;break}t[0]!=n[0]&&(e.page.current=e.pageCurrent),e.page.size=e.pageSize,e.onPropsChange()})),this._treeData=[]},methods:{onPropsChange:function(){this._treeData=[]},getCommand:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.database(this.spaceInfo),r=t.action||this.action;r&&(n=n.action(r));var o=t.collection||this.collection;n=n.collection(o);var i=t.where||this.where;i&&Object.keys(i).length&&(n=n.where(i));var a=t.field||this.field;a&&(n=n.field(a));var s=t.orderby||this.orderby;s&&(n=n.orderBy(s));var u=void 0!==t.pageCurrent?t.pageCurrent:this.page.current,c=void 0!==t.pageSize?t.pageSize:this.page.size,l=void 0!==t.getcount?t.getcount:this.getcount,d=void 0!==t.gettree?t.gettree:this.gettree,f={getCount:l,getTree:d};return t.getTreePath&&(f.getTreePath=t.getTreePath),n=n.skip(c*(u-1)).limit(c).get(f),n},getNodeData:function(e){var t=this;this.loading||(this.loading=!0,this.getCommand({field:this.postField,where:this._pathWhere()}).then((function(n){t.loading=!1,t.selected=n.result.data,e&&e()})).catch((function(e){t.loading=!1,t.errorMessage=e})))},getTreePath:function(e){var t=this;this.loading||(this.loading=!0,this.getCommand({field:this.postField,getTreePath:{startWith:"".concat(this.selfField,"=='").concat(this.dataValue,"'")}}).then((function(n){t.loading=!1;var r=[];t._extractTreePath(n.result.data,r),t.selected=r,e&&e()})).catch((function(e){t.loading=!1,t.errorMessage=e})))},loadData:function(){var e=this;this.isLocaldata?this._processLocalData():null==this.dataValue?this.stepSearh?this._loadNodeData((function(t){e._treeData=t,e._updateBindData()})):this._loadAllData((function(t){e._treeData=[],e._extractTree(t,e._treeData,null),e._updateBindData()})):this._loadNodeData((function(t){e._treeData=t,e._updateBindData(),e._updateSelected()}))},_loadAllData:function(e){var t=this;this.loading||(this.loading=!0,this.getCommand({field:this.postField,gettree:!0,startwith:"".concat(this.selfField,"=='").concat(this.dataValue,"'")}).then((function(n){t.loading=!1,e(n.result.data),t.onDataChange()})).catch((function(e){t.loading=!1,t.errorMessage=e})))},_loadNodeData:function(e,t){var n=this;this.loading||(this.loading=!0,this.getCommand({field:this.postField,where:t||this._postWhere(),pageSize:500}).then((function(t){n.loading=!1,e(t.result.data),n.onDataChange()})).catch((function(e){n.loading=!1,n.errorMessage=e})))},_pathWhere:function(){var e=[],t=this._getParentNameByField();return t&&e.push("".concat(t," == '").concat(this.dataValue,"'")),this.where?"(".concat(this.where,") && (").concat(e.join(" || "),")"):e.join(" || ")},_postWhere:function(){var e=[],t=this.selected,n=this.parentField;if(n&&e.push("".concat(n," == null || ").concat(n,' == ""')),t.length)for(var r=0;r<t.length-1;r++)e.push("".concat(n," == '").concat(t[r].value,"'"));var o=[];return this.where&&o.push("(".concat(this.where,")")),e.length&&o.push("(".concat(e.join(" || "),")")),o.join(" && ")},_nodeWhere:function(){var e=[],t=this.selected;return t.length&&e.push("".concat(this.parentField," == '").concat(t[t.length-1].value,"'")),this.where?"(".concat(this.where,") && (").concat(e.join(" || "),")"):e.join(" || ")},_getParentNameByField:function(){for(var e=this.field.split(","),t=null,n=0;n<e.length;n++){var r=e[n].split("as");if(!(r.length<2)&&"value"===r[1].trim()){t=r[0].trim();break}}return t},_isTreeView:function(){return this.parentField&&this.selfField},_updateSelected:function(){for(var e=this.dataList,t=this.selected,n=this.map.text,r=this.map.value,o=0;o<t.length;o++)for(var i=t[o].value,a=e[o],s=0;s<a.length;s++){var u=a[s];if(u[r]===i){t[o].text=u[n];break}}},_updateBindData:function(e){var t=this._filterData(this._treeData,this.selected),n=t.dataList,r=t.hasNodes,o=!1===this._stepSearh&&!r;return e&&(e.isleaf=o),this.dataList=n,this.selectedIndex=n.length-1,!o&&this.selected.length<n.length&&this.selected.push({value:null,text:"请选择"}),{isleaf:o,hasNodes:r}},_filterData:function(e,t){var n=[],r=!0;n.push(e.filter((function(e){return null===e.parent_value||void 0===e.parent_value||""===e.parent_value})));for(var o=0;o<t.length;o++){var i=t[o].value,a=e.filter((function(e){return e.parent_value===i}));a.length?n.push(a):r=!1}return{dataList:n,hasNodes:r}},_extractTree:function(e,t,n){for(var r=this.map.value,o=0;o<e.length;o++){var i=e[o],a={};for(var s in i)"children"!==s&&(a[s]=i[s]);null!==n&&void 0!==n&&""!==n&&(a.parent_value=n),t.push(a);var u=i.children;u&&this._extractTree(u,t,i[r])}},_extractTreePath:function(e,t){for(var n=0;n<e.length;n++){var r=e[n],o={};for(var i in r)"children"!==i&&(o[i]=r[i]);t.push(o);var a=r.children;a&&this._extractTreePath(a,t)}},_findNodePath:function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=this.map.text,o=this.map.value,i=0;i<t.length;i++){var a=t[i],s=a.children,u=a[r],c=a[o];if(n.push({value:c,text:u}),c===e)return n;if(s){var l=this._findNodePath(e,s,n);if(l.length)return l}n.pop()}return[]},_processLocalData:function(){this._treeData=[],this._extractTree(this.localdata,this._treeData);var e=this.dataValue;void 0!==e&&(Array.isArray(e)&&(e=e[e.length-1],"object"===(0,o.default)(e)&&e[this.map.value]&&(e=e[this.map.value])),this.selected=this._findNodePath(e,this.localdata))}}};t.default=i}).call(this,n("a9ff")["default"])},e16a:function(e,t,n){"use strict";(function(e,r){var o=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.TUILogin=t.TUICore=t.TUIConstants=void 0;var i=o(n("970b")),a=o(n("5bc3")),s=o(n("1815")),u=o(n("9d02")),c=o(n("0e47")),l=function(){function e(){(0,i.default)(this,e),this.serviceMap=new Map}return(0,a.default)(e,[{key:"registerService",value:function(e,t){this.serviceMap.has(e)||(console.log("TUIServiceManager.registerService serviceName:".concat(e)),this.serviceMap.set(e,t))}},{key:"unregisterService",value:function(e){this.serviceMap.has(e)&&(console.log("TUIServiceManager.unregisterService serviceName:".concat(e)),this.serviceMap.delete(e))}},{key:"getService",value:function(e){return this.serviceMap.get(e)}},{key:"callService",value:function(e){var t=e.serviceName,n=e.method,r=e.params,o=e.callback,i=this.getService(t);if(console.log("TUIServiceManager.callService serviceName:".concat(t,", service:"),i),i)return i.onCall(n,r,o)}}]),e}(),d=function(){function e(){(0,i.default)(this,e),this.extensionMap=new Map}return(0,a.default)(e,[{key:"registerExtension",value:function(e,t){if(console.log("TUIExtensionManager.registerExtension extensionID:".concat(e)),!this.extensionMap.has(e)){this.extensionMap.set(e,[])}var n=this.extensionMap.get(e);-1===n.indexOf(t)&&n.push(t)}},{key:"unregisterExtension",value:function(e,t){if(console.log("TUIExtensionManager.unregisterExtension extensionID:".concat(e)),this.extensionMap.has(e)){var n=this.extensionMap.get(e),r=n.indexOf(t);r>-1&&n.splice(r,1)}}},{key:"getExtensionList",value:function(e,t){console.log("TUIExtensionManager.getExtensionList extensionID:".concat(e,", params:").concat(t?JSON.stringify(t):void 0));var n=[],r=[];if(this.extensionMap.has(e)){n=this.extensionMap.get(e);for(var o=0;o<n.length;o++){var i=n[o].onGetExtension(e,t);r=r.concat(i)}}return r}}]),e}(),f=function(){function e(){(0,i.default)(this,e),this.eventMap=new Map}return(0,a.default)(e,[{key:"registerEvent",value:function(e,t,n){var r=this.getKey(e,t);if(console.log("TUIEventManager.registerEvent eventName:".concat(e," subKey:").concat(t)),!this.eventMap.has(r)){this.eventMap.set(r,[])}var o=this.eventMap.get(r);-1===o.indexOf(n)&&o.push(n)}},{key:"unregisterEvent",value:function(e,t,n){console.log("TUIEventManager.unregisterEvent eventName:".concat(e," subKey:").concat(t));var r=this.getKey(e,t);if(this.eventMap.has(r)){var o=this.eventMap.get(r),i=o.indexOf(n);i>-1&&o.splice(i,1)}}},{key:"notifyEvent",value:function(e,t,n){var r=this.getKey(e,t);console.log("TUIEventManager.notifyEvent eventName:".concat(e," subKey:").concat(t," params:").concat(JSON.stringify(n))),this.eventMap.has(r)&&this.eventMap.get(r).forEach((function(r){r.onNotifyEvent(e,t,n)}))}},{key:"getKey",value:function(e,t){var n=e;return t&&(n="".concat(e,"-").concat(n)),n}}]),e}(),p=function(){function e(){(0,i.default)(this,e),this.serviceManager=new l,this.extensionManager=new d,this.eventManager=new f}return(0,a.default)(e,[{key:"registerService",value:function(e,t){return this.serviceManager.registerService(e,t)}},{key:"unregisterService",value:function(e){return this.serviceManager.unregisterService(e)}},{key:"getService",value:function(e){return this.serviceManager.getService(e)}},{key:"callService",value:function(e){return this.serviceManager.callService(e)}},{key:"registerExtension",value:function(e,t){return this.extensionManager.registerExtension(e,t)}},{key:"unregisterExtension",value:function(e,t){return this.extensionManager.unregisterExtension(e,t)}},{key:"getExtensionList",value:function(e,t){return this.extensionManager.getExtensionList(e,t)}},{key:"registerEvent",value:function(e,t,n){return this.eventManager.registerEvent(e,t,n)}},{key:"unregisterEvent",value:function(e,t,n){return this.eventManager.unregisterEvent(e,t,n)}},{key:"notifyEvent",value:function(e,t,n){return this.eventManager.notifyEvent(e,t,n)}}],[{key:"getInstance",value:function(){return e.instance||(console.log("TUICore.getInstance ok."),e.instance=new e),e.instance}}]),e}(),h=["vue2","vue3"],g={TUILogin:{EVENT:{LOGIN_STATE_CHANGED:"loginStateChanged"},EVENT_SUB_KEY:{USER_LOGIN_SUCCESS:"userLoginSuccess",USER_LOGOUT_SUCCESS:"userLogoutSuccess",USER_KICKED_OFFLINE:"userKickedOffline",USER_SIG_EXPIRED:"userSigExpired"}},TUIConversation:{SERVICE:{NAME:"TUIConversationService",METHOD:{CREATE_CONVERSATION:"createConversation",HIDE_CONVERSATION_HEADER:"hideConversationHeader"}},EXTENSION:{CONV_POP_MENU:{EXT_ID:"conversationPopMenu"},CONV_GROUP:{EXT_ID:"conversationGroup"}}},TUIChat:{SERVICE:{NAME:"TUIChatService",METHOD:{UPDATE_MESSAGE_LIST:"updateMessageList",SEND_CUSTOM_MESSAGE:"sendCustomMessage",SEND_TEXT_MESSAGE:"sendTextMessage",SET_CHAT_TYPE:"setChatType"}},EXTENSION:{INPUT_MORE:{EXT_ID:"inputToolBarMore"},MSG_POP_MENU:{EXT_ID:"messagePopMenu"},CHAT_HEADER:{EXT_ID:"chatHeader"}}},TUIGroup:{SERVICE:{NAME:"TUIGroupService",METHOD:{CREATE_GROUP:"createGroup",OPEN_GROUP_MANAGEMENT:"openGroupManagement",SELECT_GROUP_MEMBER:"selectGroupMember"}}},TUIContact:{SERVICE:{NAME:"TUIContactService",METHOD:{SELECT_FRIEND:"selectFriend"}},EXTENSION:{CONTACT_LIST:{EXT_ID:"contactList"}}},TUISearch:{SERVICE:{NAME:"TUISearchService",METHOD:{SEARCH_GROUP:"searchGroup",SEARCH_USER:"searchUser",SEARCH_FRIEND:"searchFriend",SEARCH_GROUP_MEMBER:"searchGroupMember"}},EXTENSION:{SEARCH_MORE:{EXT_ID:"searchMore"}}},TUICalling:{SERVICE:{NAME:"TUICallingService",METHOD:{START_CALL:"startCall"}}},TUICustomerServicePlugin:{SERVICE:{NAME:"TUICustomerServicePlugin",METHOD:{ACTIVE_CONVERSATION:"activeConversation",FILTER_MESSAGE:"filterMessage"}},EXTENSION:{}},TUITranslate:{EVENT:{LANGUAGE_CHANGED:"languageChanged"},EVENT_SUB_KEY:{CHANGE_SUCCESS:"changeSuccess"}}},v="undefined"!=typeof e&&"function"==typeof e.getSystemInfoSync&&Boolean(e.getSystemInfoSync().fontSizeSetting),_="undefined"!=typeof r&&"undefined"==typeof window,m=v||_,y="undefined"!=typeof r,I=("undefined"!=typeof r||"undefined"!=typeof window)&&!m;t.TUIConstants=g,v||y||window;var M=I&&window&&window.navigator&&window.navigator.userAgent||"",T=/Android/i.test(M),S=/(?:Windows Phone)/.test(M),E=/(?:SymbianOS)/.test(M),C=/iPad/i.test(M)||/iPhone/i.test(M)||/iPod/i.test(M),k=T||S||E||C,b=I&&!k,D=_&&!v,A=function(){function e(){(0,i.default)(this,e),this.loginStatusPromise=new Map,this.SDKAppID=0,this.userID="",this.userSig=""}return(0,a.default)(e,[{key:"login",value:function(e){var t=e.SDKAppID,n=e.userID,r=e.userSig,o=e.framework;return this.chat=s.default.create(Object.assign(Object.assign({},e),{scene:this.getStatScene(o)})),this.EVENT=s.default.EVENT,this.TYPES=s.default.TYPES,this.SDKAppID=t,this.userID=n,this.userSig=r,this.onChatEvent(),this.registerPlugin(e),this.loginChat(e)}},{key:"logout",value:function(){return this.chat.logout().then((function(e){return p.getInstance().notifyEvent(g.TUILogin.EVENT.LOGIN_STATE_CHANGED,g.TUILogin.EVENT_SUB_KEY.USER_LOGOUT_SUCCESS),Promise.resolve(e)}))}},{key:"destroy",value:function(){return this.chat.destroy().then((function(e){return p.getInstance().notifyEvent(g.TUILogin.EVENT.LOGIN_STATE_CHANGED,g.TUILogin.EVENT_SUB_KEY.USER_LOGOUT_SUCCESS),Promise.resolve(e)}))}},{key:"setLogLevel",value:function(e){return this.chat.setLogLevel(e)}},{key:"getContext",value:function(){return{chat:this.chat,SDKAppID:this.SDKAppID,userID:this.userID,userSig:this.userSig}}},{key:"loginChat",value:function(e){var t=this,n=e.userID,r=e.userSig;return new Promise((function(e,o){t.chat.login({userID:n,userSig:r}).then((function(n){n.data.repeatLogin&&t.chat.isReady()&&e(n),t.loginStatusPromise.set("login",{resolve:e,reject:o,imResponse:n})})).catch((function(e){o(e)}))}))}},{key:"onChatEvent",value:function(){this.chat.on(this.EVENT.SDK_READY,this.onSDKReady,this),this.chat.on(this.EVENT.SDK_NOT_READY,this.onSDKNotReady,this),this.chat.on(this.EVENT.KICKED_OUT,this.onUserKicked,this)}},{key:"onSDKReady",value:function(){if(this.loginStatusPromise.has("login")){var e=this.loginStatusPromise.get("login");e.resolve(e.imResponse),p.getInstance().notifyEvent(g.TUILogin.EVENT.LOGIN_STATE_CHANGED,g.TUILogin.EVENT_SUB_KEY.USER_LOGIN_SUCCESS)}this.loginStatusPromise.delete("login")}},{key:"onSDKNotReady",value:function(){this.loginStatusPromise.has("login")&&this.loginStatusPromise.get("login").reject(new Error("sdk not ready")),this.loginStatusPromise.delete("login")}},{key:"onUserKicked",value:function(e){e.data.type!==this.TYPES.KICKED_OUT_USERSIG_EXPIRED?p.getInstance().notifyEvent(g.TUILogin.EVENT.LOGIN_STATE_CHANGED,g.TUILogin.EVENT_SUB_KEY.USER_KICKED_OFFLINE):p.getInstance().notifyEvent(g.TUILogin.EVENT.LOGIN_STATE_CHANGED,g.TUILogin.EVENT_SUB_KEY.USER_SIG_EXPIRED)}},{key:"registerPlugin",value:function(e){var t=e.useUploadPlugin,n=void 0!==t&&t,r=e.useProfanityFilterPlugin,o=void 0!==r&&r,i=e.TUIOfflinePush,a=e.offlinePushConfig;!0===n&&this.chat.registerPlugin({"tim-upload-plugin":u.default}),!0===o&&this.chat.registerPlugin({"tim-profanity-filter-plugin":c.default}),D&&i&&a&&this.chat.registerPlugin({"tim-offline-push-plugin":i,offlinePushConfig:a})}},{key:"getStatScene",value:function(e){var t;return e&&h.indexOf(e)>-1&&(t=this.genStatScene(e)),t}},{key:"genStatScene",value:function(e){var t="";return y?(b&&(t="k-".concat(e,"-pc-uni")),k&&(t="k-".concat(e,"-h5-uni")),D&&(t="k-".concat(e,"-app-uni")),v&&(t="k-".concat(e,"-mp-uni")),t):(b&&(t="k-".concat(e,"-pc")),k&&(t="k-".concat(e,"-h5")),t)}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();console.log("TUICore.VERSION:2.0.2");var O=p.getInstance(),R=A.getInstance();t.TUILogin=R,t.default=t.TUICore=O}).call(this,n("bc2e")["default"],n("543d")["default"])},e47a:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={data:function(){return{}},created:function(){this.popup=this.getParent()},methods:{getParent:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"uniPopup",t=this.$parent,n=t.$options.name;while(n!==e){if(t=t.$parent,!t)return!1;n=t.$options.name}return t}}};t.default=r},e50d:function(e,t,n){var r=n("7037")["default"];e.exports=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)},e.exports.__esModule=!0,e.exports["default"]=e.exports},e56c:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={pages:{"pages/index/index":{navigationBarTitleText:"",enablePullDownRefresh:!1,backgroundColor:"#fdfdfd",navigationStyle:"custom",usingAutoImportComponents:{},usingComponents:{"user-index":"/pages/user/index/index","doctor-index":"/pages/doctor/index/index",login:"/pages/login/index","login-doctor":"/pages/login/login-doctor"}},"pages/msg/index":{usingComponents:{},usingAutoImportComponents:{}},"pages/my/index":{navigationBarTitleText:"",backgroundColor:"#f8f8f8",navigationStyle:"custom",usingAutoImportComponents:{},usingComponents:{"my-index":"/pages/user/my/index","doctor-index":"/pages/doctor/my/index"}},"pages/user/my/index":{navigationBarTitleText:"",navigationStyle:"custom",usingComponents:{},usingAutoImportComponents:{"uni-icons":"/uni_modules/uni-icons/components/uni-icons/uni-icons"}},"pages/login/register":{navigationBarTitleText:"",navigationStyle:"custom",usingAutoImportComponents:{"uni-forms":"/uni_modules/uni-forms/components/uni-forms/uni-forms","uni-forms-item":"/uni_modules/uni-forms/components/uni-forms-item/uni-forms-item","uni-easyinput":"/uni_modules/uni-easyinput/components/uni-easyinput/uni-easyinput","uni-data-checkbox":"/uni_modules/uni-data-checkbox/components/uni-data-checkbox/uni-data-checkbox"},usingComponents:{region:"/pages/login/components/city-select/index"}},"pages/login/register-doctor":{navigationBarTitleText:"",navigationStyle:"custom",usingComponents:{},usingAutoImportComponents:{"uni-icons":"/uni_modules/uni-icons/components/uni-icons/uni-icons","uni-forms":"/uni_modules/uni-forms/components/uni-forms/uni-forms","uni-forms-item":"/uni_modules/uni-forms/components/uni-forms-item/uni-forms-item","uni-easyinput":"/uni_modules/uni-easyinput/components/uni-easyinput/uni-easyinput","uni-data-checkbox":"/uni_modules/uni-data-checkbox/components/uni-data-checkbox/uni-data-checkbox","uni-data-picker":"/uni_modules/uni-data-picker/components/uni-data-picker/uni-data-picker"}},"pages/login/index":{navigationBarTitleText:"",navigationStyle:"custom",usingComponents:{},usingAutoImportComponents:{"uni-forms":"/uni_modules/uni-forms/components/uni-forms/uni-forms","uni-forms-item":"/uni_modules/uni-forms/components/uni-forms-item/uni-forms-item","uni-easyinput":"/uni_modules/uni-easyinput/components/uni-easyinput/uni-easyinput"}},"pages/login/login-doctor":{navigationBarTitleText:"",navigationStyle:"custom",usingComponents:{},usingAutoImportComponents:{"uni-forms":"/uni_modules/uni-forms/components/uni-forms/uni-forms","uni-forms-item":"/uni_modules/uni-forms/components/uni-forms-item/uni-forms-item","uni-easyinput":"/uni_modules/uni-easyinput/components/uni-easyinput/uni-easyinput"}},"pages/sub-packages-doctor/my/statistics-manage/index":{navigationBarTitleText:"",navigationStyle:"custom",usingAutoImportComponents:{},usingComponents:{"my-echarts":"/pages/sub-packages-doctor/components/mpvue-echarts/echarts"}},"pages/sub-packages-doctor/my/number-of-services/index":{navigationBarTitleText:"",navigationStyle:"custom",usingAutoImportComponents:{"uni-icons":"/uni_modules/uni-icons/components/uni-icons/uni-icons","uni-calendar":"/uni_modules/uni-calendar/components/uni-calendar/uni-calendar"},usingComponents:{"sign-list":"/components/doctor/sign-list/index"}},"pages/sub-packages-doctor/my/number-of-signatories/index":{navigationBarTitleText:"",navigationStyle:"custom",usingAutoImportComponents:{"uni-easyinput":"/uni_modules/uni-easyinput/components/uni-easyinput/uni-easyinput"},usingComponents:{"sign-list":"/components/doctor/sign-list/index"}},"pages/sub-packages-doctor/my/online-signing-list/index":{navigationBarTitleText:"",navigationStyle:"custom"},"pages/sub-packages-doctor/my/put-on-record/index":{navigationBarTitleText:"",navigationStyle:"custom"},"pages/sub-packages-doctor/my/user-detail/index":{navigationBarTitleText:"",navigationStyle:"custom"},"pages/sub-packages-user/my/about/index":{navigationBarTitleText:"",navigationStyle:"custom"},"pages/sub-packages-user/my/add-file/index":{navigationBarTitleText:"",navigationStyle:"custom"},"pages/sub-packages-user/my/change-user/index":{navigationBarTitleText:"",navigationStyle:"custom"},"pages/sub-packages-user/my/contact-us/index":{navigationBarTitleText:"",navigationStyle:"custom",usingComponents:{},usingAutoImportComponents:{}},"pages/sub-packages-user/my/doctor-details/index":{navigationBarTitleText:"",navigationStyle:"custom",usingComponents:{},usingAutoImportComponents:{"uni-section":"/uni_modules/uni-section/components/uni-section/uni-section"}},"pages/sub-packages-user/my/doctor-introduction/index":{navigationBarTitleText:"",navigationStyle:"custom",usingComponents:{},usingAutoImportComponents:{"uni-data-select":"/uni_modules/uni-data-select/components/uni-data-select/uni-data-select"}},"pages/sub-packages-user/my/review-file/index":{navigationBarTitleText:"",navigationStyle:"custom",usingAutoImportComponents:{"uni-icons":"/uni_modules/uni-icons/components/uni-icons/uni-icons"},usingComponents:{"my-steps":"/components/my-steps/index"}},"pages/sub-packages-user/my/sign-tip/index":{navigationBarTitleText:"",navigationStyle:"custom",usingAutoImportComponents:{},usingComponents:{"sign-tip":"/components/sign-tip/index"}},"pages/sub-packages-user/my/unbound-user/index":{navigationBarTitleText:"",navigationStyle:"custom",usingAutoImportComponents:{},usingComponents:{"sign-tip":"/pages/sub-packages-user/components/sign-tip/index"}},"pages/sub-packages-user/my/un-sign/index":{navigationBarTitleText:"",navigationStyle:"custom",usingAutoImportComponents:{},usingComponents:{"sign-tip":"/pages/sub-packages-user/components/sign-tip/index"}},"pages/sub-packages-user/my/upload-info/index":{navigationBarTitleText:"",navigationStyle:"custom",usingAutoImportComponents:{"uni-icons":"/uni_modules/uni-icons/components/uni-icons/uni-icons","uni-forms":"/uni_modules/uni-forms/components/uni-forms/uni-forms","uni-forms-item":"/uni_modules/uni-forms/components/uni-forms-item/uni-forms-item","uni-easyinput":"/uni_modules/uni-easyinput/components/uni-easyinput/uni-easyinput","uni-data-checkbox":"/uni_modules/uni-data-checkbox/components/uni-data-checkbox/uni-data-checkbox"},usingComponents:{region:"/pages/login/components/city-select/index"}},"pages/sub-packages-user/my/online-signing/index":{navigationBarTitleText:"",navigationStyle:"custom",usingComponents:{},usingAutoImportComponents:{}},"pages/sub-packages-user/index/news-info/index":{navigationBarTitleText:"",navigationStyle:"custom",usingComponents:{},usingAutoImportComponents:{}},"pages/sub-packages-user/my/signature/index":{enablePullDownRefresh:!1,pageOrientation:"landscape",navigationBarTitleText:"",navigationStyle:"custom",usingAutoImportComponents:{},usingComponents:{"my-sign":"/pages/sub-packages-user/components/my-sign/index"}},"TUIKit/components/TUIConversation/index":{navigationBarTitleText:"消息列表",usingAutoImportComponents:{},usingComponents:{"conversation-network":"/TUIKit/components/TUIConversation/conversation-network/index","conversation-list":"/TUIKit/components/TUIConversation/conversation-list/index"}},"TUIKit/components/TUIChat/index":{navigationBarTitleText:"腾讯云 IM",usingAutoImportComponents:{},usingComponents:{"chat-header":"/TUIKit/components/TUIChat/chat-header/index",forward:"/TUIKit/components/TUIChat/forward/index","message-list":"/TUIKit/components/TUIChat/message-list/index","message-input-toolbar":"/TUIKit/components/TUIChat/message-input-toolbar/index","message-input":"/TUIKit/components/TUIChat/message-input/index"}},"TUIKit/components/TUIChat/video-play":{navigationBarTitleText:"腾讯云 IM",usingComponents:{},usingAutoImportComponents:{}},"TUIKit/components/TUIChat/web-view":{navigationBarTitleText:"腾讯云 IM",usingComponents:{},usingAutoImportComponents:{}},"TUIKit/components/TUIContact/index":{navigationBarTitleText:"腾讯云 IM",usingAutoImportComponents:{},usingComponents:{"select-friend":"/TUIKit/components/TUIContact/select-friend/index","contact-search":"/TUIKit/components/TUIContact/contact-search/index","contact-list":"/TUIKit/components/TUIContact/contact-list/index","contact-info":"/TUIKit/components/TUIContact/contact-info/index"}},"TUIKit/components/TUIGroup/index":{navigationBarTitleText:"腾讯云 IM",usingAutoImportComponents:{},usingComponents:{"create-group":"/TUIKit/components/TUIGroup/create-group/index","manage-group":"/TUIKit/components/TUIGroup/manage-group/index","select-member":"/TUIKit/components/TUIGroup/select-member/index"}}},globalStyle:{navigationBarTextStyle:"black",navigationBarTitleText:"家庭签约",navigationBarBackgroundColor:"#FFFFFF",backgroundColor:"#FFFFFF"}}},e6c7:function(e,t,n){"use strict";(function(e){var r=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.createAnimation=function(e,t){if(!t)return;return clearTimeout(t.timer),new c(e,t)};var o=r(n("9523")),i=r(n("970b")),a=r(n("5bc3"));function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){(0,o.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var c=function(){function t(n,r){(0,i.default)(this,t),this.options=n,this.animation=e.createAnimation(n),this.currentStepAnimates={},this.next=0,this.$=r}return(0,a.default)(t,[{key:"_nvuePushAnimates",value:function(e,t){var n=this.currentStepAnimates[this.next],r={};if(r=n||{styles:{},config:{}},l.includes(e)){r.styles.transform||(r.styles.transform="");var o="";"rotate"===e&&(o="deg"),r.styles.transform+="".concat(e,"(").concat(t+o,") ")}else r.styles[e]="".concat(t);this.currentStepAnimates[this.next]=r}},{key:"_animateRun",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.$.$refs["ani"].ref;if(n)return new Promise((function(r,o){nvueAnimation.transition(n,u({styles:e},t),(function(e){r()}))}))}},{key:"_nvueNextAnimate",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0,o=e[n];if(o){var i=o.styles,a=o.config;this._animateRun(i,a).then((function(){n+=1,t._nvueNextAnimate(e,n,r)}))}else this.currentStepAnimates={},"function"===typeof r&&r(),this.isEnd=!0}},{key:"step",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.animation.step(e),this}},{key:"run",value:function(e){this.$.animationData=this.animation.export(),this.$.timer=setTimeout((function(){"function"===typeof e&&e()}),this.$.durationTime)}}]),t}(),l=["matrix","matrix3d","rotate","rotate3d","rotateX","rotateY","rotateZ","scale","scale3d","scaleX","scaleY","scaleZ","skew","skewX","skewY","translate","translate3d","translateX","translateY","translateZ"];l.concat(["opacity","backgroundColor"],["width","height","left","right","top","bottom"]).forEach((function(e){c.prototype[e]=function(){var t;return(t=this.animation)[e].apply(t,arguments),this}}))}).call(this,n("543d")["default"])},e6e8:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.onNavigationBarSearchInputClicked=t.onNavigationBarSearchInputConfirmed=t.onNavigationBarSearchInputChanged=t.onBackPress=t.onNavigationBarButtonTap=t.onTabItemTap=t.onResize=t.onPageScroll=t.onAddToFavorites=t.onShareTimeline=t.onShareAppMessage=t.onReachBottom=t.onPullDownRefresh=t.onUnload=t.onReady=t.onLoad=t.onInit=t.onUniNViewMessage=t.onThemeChange=t.onUnhandledRejection=t.onPageNotFound=t.onError=t.onLaunch=t.onHide=t.onShow=t.initUtsPackageName=t.initUtsClassName=t.initUtsIndexClassName=t.initUtsProxyFunction=t.initUtsProxyClass=void 0;var r=n("fd0e"),o=n("c1fa"),i=n("2011"),a=n("d783");Object.defineProperty(t,"initUtsProxyClass",{enumerable:!0,get:function(){return a.initUtsProxyClass}}),Object.defineProperty(t,"initUtsProxyFunction",{enumerable:!0,get:function(){return a.initUtsProxyFunction}}),Object.defineProperty(t,"initUtsIndexClassName",{enumerable:!0,get:function(){return a.initUtsIndexClassName}}),Object.defineProperty(t,"initUtsClassName",{enumerable:!0,get:function(){return a.initUtsClassName}}),Object.defineProperty(t,"initUtsPackageName",{enumerable:!0,get:function(){return a.initUtsPackageName}});var s=[],u=function(e){s.push(e);var t=(0,r.createLifeCycle)(e);return function(e,n){return t(e,n)}};"object"===typeof plus?o.init():"object"===typeof window&&"document"in window||i.init(s),t.onShow=u("onShow"),t.onHide=u("onHide"),t.onLaunch=u("onLaunch"),t.onError=u("onError"),t.onPageNotFound=u("onPageNotFound"),t.onUnhandledRejection=u("onUnhandledRejection"),t.onThemeChange=u("onThemeChange"),t.onUniNViewMessage=u("onUniNViewMessage"),t.onInit=u("onInit"),t.onLoad=u("onLoad"),t.onReady=u("onReady"),t.onUnload=u("onUnload"),t.onPullDownRefresh=u("onPullDownRefresh"),t.onReachBottom=u("onReachBottom"),t.onShareAppMessage=u("onShareAppMessage"),t.onShareTimeline=u("onShareTimeline"),t.onAddToFavorites=u("onAddToFavorites"),t.onPageScroll=u("onPageScroll"),t.onResize=u("onResize"),t.onTabItemTap=u("onTabItemTap"),t.onNavigationBarButtonTap=u("onNavigationBarButtonTap"),t.onBackPress=u("onBackPress"),t.onNavigationBarSearchInputChanged=u("onNavigationBarSearchInputChanged"),t.onNavigationBarSearchInputConfirmed=u("onNavigationBarSearchInputConfirmed"),t.onNavigationBarSearchInputClicked=u("onNavigationBarSearchInputClicked")},ed6d:function(e,t,n){var r=n("4a4b");e.exports=function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&r(e,t)},e.exports.__esModule=!0,e.exports["default"]=e.exports},ef7d:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={"请对本次服务进行评价":"Please rate this service","提交评价":"Feedback","常用语-快捷回复工具":"Common Expressions - Quick Reply Tool","使用":"Build with","自定义消息":"Custom message","搭建":"","在吗？在吗？在吗？重要的话说三遍。":"Are you there? ","好久没聊天了，快来和我说说话～":"It’s been a long time. How about you?","好的，就这么说定了。":"Okay. It's a deal.","感恩的心，感谢有你。":"So grateful! ","糟糕！是心动的感觉！":"Oh, no. Flipped.","心疼地抱抱自己，我太难了！":"Give myself a warm hug. ","没关系，别在意，事情过去就过去了。":"Take it easy.","早上好，今天也是让人期待的一天呢！":"Good morning. Have a wonderful day.","熬夜有什么用，又没人陪你聊天，早点休息吧。":"It's better to go to bed early."};t.default=r},f0c5:function(e,t,n){"use strict";function r(e,t,n,r,o,i,a,s,u,c){var l,d="function"===typeof e?e.options:e;if(u){d.components||(d.components={});var f=Object.prototype.hasOwnProperty;for(var p in u)f.call(u,p)&&!f.call(d.components,p)&&(d.components[p]=u[p])}if(c&&("function"===typeof c.beforeCreate&&(c.beforeCreate=[c.beforeCreate]),(c.beforeCreate||(c.beforeCreate=[])).unshift((function(){this[c.__module]=this})),(d.mixins||(d.mixins=[])).push(c)),t&&(d.render=t,d.staticRenderFns=n,d._compiled=!0),r&&(d.functional=!0),i&&(d._scopeId="data-v-"+i),a?(l=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),o&&o.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(a)},d._ssrRegister=l):o&&(l=s?function(){o.call(this,this.$root.$options.shadowRoot)}:o),l)if(d.functional){d._injectStyles=l;var h=d.render;d.render=function(e,t){return l.call(t),h(e,t)}}else{var g=d.beforeCreate;d.beforeCreate=g?[].concat(g,l):[l]}return{exports:e,options:d}}n.d(t,"a",(function(){return r}))},f4b4:function(e,t,n){"use strict";var r=n("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n("c7b9")),i=r(n("1eb1"));new i.default;var a=o.default;t.default=a},f7e4:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("707c");Object.keys(r).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===r[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}}))}))},f927:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB0AAAAcCAYAAACdz7SqAAAAAXNSR0IArs4c6QAAAe9JREFUSEvtlj9IVmEUxn9PREhFRKAQTVFNgThEtjQ61hBEaAkNNTRl/4ZIpwwH+6NbkNFQGDQ45OrWkuIgQVNDSyokRIhFhPDEkfvKh37fh3Lf69SZLve+9/nd89xzzvuKJmG7DXgJvJU03mztdp6p0WLb54AxIMDLQIekr9sRb7R2E9T2PuApcB2I5wZGgfuS/mSH2j4NvAFOFOLzwFVJUzlgSWMtU9u7gQdAPxDXEe+AG5J+5ASGlmwfB14DZ2rEJ4p7ZXm/gc+SwrH1COgCcLiserMmAD4AdyTNpkw/Ap0VQpP0X6Bb0kRkugtoLSo1N/sgcB4YAPYDYXd7wz7NSbcd9RIWR5GO7Qi06JCYaN3A/E5C7wLDqZA60iCQtJTT1lot233AswSNMRdxS9LIf2hZB2xHWx7ZaO89SY/Lim/l/RgO34oviI26ZysvlV0T0BfANWAVOCspxmKlEdBjwCdgL7ACPATeAz8rIEenLKX99EKcg4A9FYA2Sk6vTyTbp4AnYXFFwz/BF+udkaKsTxZ2l028FwgXU0S99FYye20fAp4DFwtaFOkg8EjSanao7S7gVRoEwBfgiqSZlG42qO0WYAi4WXN0jXa8LelX7X/KCT0KzAEHgO/R+5Im6xVFNmiI274MXCqAAa4b/wBJVa+b4SNYwAAAAABJRU5ErkJggg=="},fba4:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={"输入groupID搜索":"Enter groupId search","群名称":"Group name","群ID":"Group ID","加入群聊":"Join","解散群聊":"Dissolution","退出群聊":"Quit","群类型":"Group type","请填写验证信息":"Please fill in the verification information","申请加入":"Apply Join","群公告":"Group notice","群成员":"Group member","群管理":"Manage group","好友工作群":"Work","陌生人社交群":"Public","临时会议群":"Meeting","直播群":"AVChatRoom","社群":"Community","自由加入":"Join freely","需要验证":"Require approval","禁止加群":"Disallow group joining","人":"","确认":"Confirm","群头像":"Group profile photo","加群方式":"Group joining mode","转让群组":"Transfer ownership","退出群组":"Quit group","群管理员":"Group admin","全员禁言":"Mute All","全员禁言开启后，只允许群主和管理员发言。":"If Mute All is enabled, only the group owner and admin can speak.","单独禁言人员":"Mute a member","删除成员":"Remove member","确定从群聊中删除该成员？":"Are you sure you want to remove this member from the group chat?","确定从群聊中删除所选成员？":"Are you sure you want to remove selected member(s) from the group chat?","暂无公告":"No notice","发布":"Post","编辑":"Edit","查看更多":"View more","管理员":"Admin","群主":"Group owner","我":"me","添加成员":"Add member","新增管理员":"Add admin","移除管理员":"Revoke admin","新增禁言用户":"Add muted member","移除禁言用户":"Remove muted member","修改群聊名称":"Edit group name","修改群聊名称后，将在群内通知其他成员":"After modifying the group chat name, other members will be notified in the group","仅限中文、字母、数字和下划线，2-20个字":"Chinese, letters, numbers and underscores only, 2-20 words","请先注册 TUIGroup 模块":"Please register the TUIGroup module first","该用户不存在":"The user does not exist","该用户不在群组内":"The user is not in the group","添加群聊":"Add a group chat","该群组不存在":"The group does not exist","创建群聊，请注册 TUIGroup 模块":"To create a group chat, please register the TUIGroup module","创建成功":"Creation successful","发起多人会话（群聊）":"New group chat","选填":"Optional","取消":"Cancel","创建":"Create","类似普通微信群，创建后仅支持已在群内的好友邀请加群，且无需被邀请方同意或群主神奇。详见":"Similar to a WeChat group. Users can join the group only via invitation by existing members. The invitation does not need to be agreed by the invitee or approved by the group owner. See the documentation for details.","类似 QQ 群，创建后群主可以指定群管理员，用户搜索群 ID 发起加群申请后，需要群主或管理员审批通过才能入群。详见":"Similar to a QQ group. After a public group is created, the group owner can designate group admins. To join the group, a user needs to search the group ID and send a request, which needs to be approved by the group owner or an admin before the user can join the group. See the documentation for details. ","创建后可以随意进出，且支持查看入群前消息；适合用于音视频会议场景、在线教育场景等与实时音视频产品结合的场景。详见":"After the group is created, a user can join and quit the group freely and can view the messages sent before joining the group. It is suitable for scenarios that integrate Tencent Real-Time Communication (TRTC), such as audio and video conferences and online education. See the documentation for details.","创建后可以随意进出，没有群成员数量上限，但不支持历史消息存储；适合与直播产品结合，用于弹幕聊天场景。详见":"After creation, a user can join and quit the group freely. The group can have an unlimited number of members, but it does not store message history. It can be combined with Live Video Broadcasting (LVB) to support on-screen comment scenarios. See the documentation for details. ","创建后可以随意进出，最多支持100000人，支持历史消息存储，用户搜索群 ID 发起加群申请后，无需管理员审批即可进群。详见":"After creation, you can enter and leave at will, support up to 100,000 people, support historical message storage, and after users search for group ID and initiate a group application, they can join the group without administrator approval. See product documentation for details. ","产品文档":"product documentation","设置群名称":"Group name","请输入群名称":"Enter the group name","设置群ID":"Group ID","请输入群ID":"Enter the group ID","选择群类型":"Group type","陌生人社交群（Public）":"Stranger social group (Public)","临时会议群（Meeting）":"Temporary meeting group (Meeting)","好友工作群（Work）":"Friends work group (Work)","直播群（AVChatroom）":"Live Streaming Group (AVChatroom)","社群（Community）":"Community（Community）","群组创建成功":"Create group success","群组解散成功":"Dismiss group success","禁言设置成功":"Mute all success","取消禁言成功":"Remove mute success","群名称不能为空":"Group name cannot be empty","群名称修改成功":"Group name modified success","群公告字数超出限制，最大长度为150":"The number of characters in the group announcement exceeds the limit, the maximum length is 150"};t.default=r},fd0e:function(e,t,n){"use strict";e.exports=n("7679")},fde7:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("2e55");Object.keys(r).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===r[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}}))}))},ff45:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={"请对本次服务进行评价":"Please rate this service","提交评价":"Feedback","服务评价工具":"Service rate tool","使用":"Build with","自定义消息":"Custom message","搭建":"","星":"Star"};t.default=r}}]);